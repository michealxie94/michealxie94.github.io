<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>006 è®ºæ–‡æ³›è¯»</title>
      <link href="/post/nlp006.html"/>
      <url>/post/nlp006.html</url>
      
        <content type="html"><![CDATA[<h2 id="2019-06-Adapter-Tuning"><a href="#2019-06-Adapter-Tuning" class="headerlink" title="2019.06 Adapter Tuning"></a><code>2019.06 Adapter Tuning</code></h2><p><a href="https://arxiv.org/pdf/1902.00751.pdf">@Parameter-Efficient Transfer Learning for NLP</a><br>Fine-tuning large pre-trained models is an effective transfer mechanism in NLP. However, in the presence of many downstream tasks, fine-tuning is parameter inefficient: an entire new model is required for every task. As an alternative, we propose transfer with adapter modules. Adapter modules yield a compact and extensible model;they add only a few trainable parameters per task,and new tasks can be added without revisiting previous ones. The parameters of the original network remain fixed, yielding a high degree of parameter sharing. To demonstrate adapterâ€™s effectiveness, we transfer the recently proposed<br>BERT Transformer model to 26 diverse text classification tasks, including the GLUE benchmark.Adapters attain near state-of-the-art performance,whilst adding only a few parameters per task. On GLUE, we attain within 0.4% of the performance<br>of full fine-tuning, adding only 3.6% parameters per task. By contrast, fine-tuning trains 100% of the parameters per task.1<br>å¾®è°ƒå¤§å‹é¢„è®­ç»ƒæ¨¡å‹æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ä¸€ç§æœ‰æ•ˆçš„è¿ç§»æœºåˆ¶ã€‚ç„¶è€Œï¼Œåœ¨å­˜åœ¨è®¸å¤šä¸‹æ¸¸ä»»åŠ¡çš„æƒ…å†µä¸‹ï¼Œå¾®è°ƒè¿‡ç¨‹çš„å‚æ•°æ•ˆç‡ä½ä¸‹ï¼šæ¯ä¸ªä»»åŠ¡éƒ½éœ€è¦ä¸€ä¸ªå…¨æ–°çš„æ¨¡å‹ã€‚ä½œä¸ºä¸€ç§æ›¿ä»£æ–¹æ¡ˆï¼Œæˆ‘ä»¬æå‡ºäº†ä½¿ç”¨é€‚é…å™¨æ¨¡å—è¿›è¡Œè¿ç§»å­¦ä¹ ã€‚é€‚é…å™¨æ¨¡å—å¯ä»¥ç”Ÿæˆä¸€ä¸ªç´§å‡‘ä¸”å¯æ‰©å±•çš„æ¨¡å‹ï¼›æ¯ä¸ªä»»åŠ¡åªéœ€æ·»åŠ å°‘é‡å¯è®­ç»ƒå‚æ•°ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸å½±å“ä¹‹å‰ä»»åŠ¡çš„æƒ…å†µä¸‹æ·»åŠ æ–°ä»»åŠ¡ã€‚åŸå§‹ç½‘ç»œçš„å‚æ•°ä¿æŒå›ºå®šï¼Œå®ç°äº†é«˜åº¦çš„å‚æ•°å…±äº«ã€‚ä¸ºäº†è¯æ˜é€‚é…å™¨çš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬å°†æœ€è¿‘æå‡ºçš„BERT Transformeræ¨¡å‹è¿ç§»åˆ°26ä¸ªä¸åŒçš„æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ä¸­ï¼ŒåŒ…æ‹¬GLUEåŸºå‡†ä»»åŠ¡ã€‚é€‚é…å™¨æ¨¡å‹å¯ä»¥è¾¾åˆ°æ¥è¿‘æœ€å…ˆè¿›æ€§èƒ½ï¼Œè€Œæ¯ä¸ªä»»åŠ¡åªå¢åŠ äº†å¾ˆå°‘çš„å‚æ•°ã€‚åœ¨GLUEä¸Šï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä»…æ¯”å®Œå…¨å¾®è°ƒæ–¹æ³•ä½0.4%ï¼Œè€Œæ¯ä¸ªä»»åŠ¡ä»…æ·»åŠ äº†3.6%çš„å‚æ•°ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¼ ç»Ÿå¾®è°ƒæ–¹æ³•éœ€è¦è®­ç»ƒæ¯ä¸ªä»»åŠ¡çš„100%å‚æ•°ã€‚)<br><img src="/post/nlp006/Adaptertuning.jpg" class title="img"></p><h2 id="2021-01-Prefix-Tuning"><a href="#2021-01-Prefix-Tuning" class="headerlink" title="2021.01 Prefix-Tuning"></a><code>2021.01 Prefix-Tuning</code></h2><p><a href="https://arxiv.org/pdf/2101.00190.pdf">@Prefix-Tuning: Optimizing Continuous Prompts for Generation</a><br>Fine-tuning is the de facto way to leverage large pretrained language models to perform downstream tasks. However, it modifies all the language model parameters and therefore necessitates storing a full copy for each task.In this paper, we propose prefix-tuning, a lightweight alternative to fine-tuning for natural language generation tasks, which keeps language model parameters frozen, but optimizes a small continuous task-specific vector (called the prefix). Prefix-tuning draws inspiration from prompting, allowing subsequent tokens to attend to this prefix as if it were â€œvirtual tokensâ€. We apply prefix-tuning to GPT-2 for table-to-text generation and to BART for summarization. We find that by learning only 0.1% of the parameters, prefix-tuning obtains comparable performance in the full data setting, outperforms fine-tuning in low-data settings, and extrapolates better to examples with topics unseen during training.<br>å¾®è°ƒå®é™…ä¸Šæ˜¯åˆ©ç”¨å¤§å‹é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹æ¥æ‰§è¡Œä¸‹æ¸¸ä»»åŠ¡çš„æ–¹æ³•ã€‚ç„¶è€Œï¼Œå®ƒä¿®æ”¹äº†æ‰€æœ‰çš„è¯­è¨€æ¨¡å‹å‚æ•°ï¼Œå› æ­¤éœ€è¦ä¸ºæ¯ä¸ªä»»åŠ¡å­˜å‚¨ä¸€ä¸ªå®Œæ•´çš„å‰¯æœ¬ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†å‰ç¼€è°ƒä¼˜ï¼Œè¿™æ˜¯è‡ªç„¶è¯­è¨€ç”Ÿæˆä»»åŠ¡å¾®è°ƒçš„ä¸€ç§è½»é‡çº§æ›¿ä»£æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥ä¿æŒè¯­è¨€æ¨¡å‹å‚æ•°çš„å†»ç»“ï¼Œä½†å¯ä»¥ä¼˜åŒ–ä¸€ä¸ªå°çš„è¿ç»­ä»»åŠ¡ç‰¹å®šå‘é‡ï¼ˆç§°ä¸ºå‰ç¼€ï¼‰ã€‚<code>Prefix-tuning</code>çµæ„Ÿæºè‡ª<code>prompting</code>ï¼Œå…è®¸åç»­çš„ä»¤ç‰Œå…³æ³¨è¿™ä¸ªå‰ç¼€ï¼Œå°±å¥½åƒå®ƒæ˜¯â€è™šæ‹Ÿä»¤ç‰Œâ€ã€‚æˆ‘ä»¬å°†å‰ç¼€è°ƒæ•´åº”ç”¨äºGPT-2è¿›è¡Œè¡¨æ ¼åˆ°æ–‡æœ¬ç”Ÿæˆï¼Œä»¥åŠåº”ç”¨äºBARTæ‘˜è¦ç”Ÿæˆã€‚æˆ‘ä»¬å‘ç°ï¼Œé€šè¿‡ä»…å­¦ä¹ 0.1%çš„å‚æ•°ï¼Œå‰ç¼€è°ƒæ•´åœ¨å…¨æ•°æ®è®¾ç½®ä¸­è·å¾—äº†å¯æ¯”çš„æ€§èƒ½ï¼Œåœ¨ä½æ•°æ®è®¾ç½®ä¸­ä¼˜äºå¾®è°ƒï¼Œå¹¶æ›´å¥½åœ°å¤–æ¨åˆ°è®­ç»ƒä¸­æœªå‘ç°ä¸»é¢˜çš„ç¤ºä¾‹ã€‚<br><img src="/post/nlp006/PrefixTuning.jpg" class title="img"></p><h2 id="2021-03-P-Tuning"><a href="#2021-03-P-Tuning" class="headerlink" title="2021.03 P Tuning"></a><code>2021.03 P Tuning</code></h2><p><a href="https://arxiv.org/pdf/2103.10385.pdf">@GPT Understands, Too</a><br>While GPTs with traditional fine-tuning fail to achieve strong results on natural language understanding (NLU), we show that GPTs can be better than or comparable to similar-sized BERTs on NLU tasks with a novel method P-tuningâ€” which employs trainable continuous prompt embeddings. On the knowledge probing (LAMA) benchmark, the best GPT recovers 64% (P@1) of world knowledge without any additional text provided during test time, which substantially improves the previous best by 20+ percentage points. On the SuperGlue benchmark, GPTs achieve comparable and sometimes better performance to similar-sized BERTs in supervised learning. Importantly, we find that P-tuning also improves BERTsâ€™ performance in both few-shot and supervised settings while largely reducing the need for prompt engineering. Consequently, Ptuning outperforms the state-of-the-art approaches on the few-shot SuperGlue benchmark.<br>ä¼ ç»Ÿçš„ç²¾è°ƒæ–¹æ³•ä½¿å¾—GPTåœ¨è‡ªç„¶è¯­è¨€ç†è§£ï¼ˆNLUï¼‰ä¸Šæ— æ³•å–å¾—å¼ºå¤§çš„ç»“æœã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å±•ç¤ºäº†ä¸€ç§åä¸ºP-tuningçš„æ–°æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä½¿ç”¨å¯è®­ç»ƒçš„è¿ç»­æç¤ºåµŒå…¥ï¼Œä½¿å¾—GPTåœ¨NLUä»»åŠ¡ä¸Šæ¯”ç±»ä¼¼å¤§å°çš„BERTè¡¨ç°æ›´å¥½æˆ–è€…å¯ä»¥åª²ç¾å®ƒã€‚åœ¨çŸ¥è¯†æ¢ç´¢ï¼ˆLAMAï¼‰åŸºå‡†æµ‹è¯•ä¸­ï¼Œæœ€å¥½çš„GPTåœ¨æ²¡æœ‰åœ¨æµ‹è¯•æ—¶æä¾›ä»»ä½•é¢å¤–æ–‡æœ¬çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æ¢å¤64ï¼…ï¼ˆP@1ï¼‰çš„ä¸–ç•ŒçŸ¥è¯†ï¼Œè¿™å¤§å¤§æé«˜äº†å…ˆå‰æœ€å¥½ç»“æœçš„20ï¼…ä»¥ä¸Šã€‚åœ¨SuperGlueåŸºå‡†æµ‹è¯•ä¸­ï¼ŒGPTåœ¨ç›‘ç£å­¦ä¹ æ–¹é¢å®ç°äº†ä¸ç±»ä¼¼å¤§å°çš„BERTç›¸å½“ç”šè‡³æ›´å¥½çš„æ€§èƒ½ã€‚é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬å‘ç°P-tuningè¿˜æ”¹å–„äº†BERTåœ¨å°‘æ ·æœ¬å’Œç›‘ç£è®¾ç½®ä¸­çš„æ€§èƒ½ï¼ŒåŒæ—¶å¤§å¤§å‡å°‘äº†æç¤ºå·¥ç¨‹çš„éœ€æ±‚ã€‚å› æ­¤ï¼ŒP-tuningåœ¨å°‘æ ·æœ¬SuperGlueåŸºå‡†æµ‹è¯•ä¸Šä¼˜äºç°æœ‰çš„æœ€å…ˆè¿›æ–¹æ³•ã€‚<br><img src="/post/nlp006/PTuning.jpg" class title="img"></p><h2 id="2021-09-Prompt-Tuning"><a href="#2021-09-Prompt-Tuning" class="headerlink" title="2021.09 Prompt Tuning"></a><code>2021.09 Prompt Tuning</code></h2><p><a href>@The Power of Scale for Parameter-Efficient Prompt Tuning</a><br>In this work, we explore â€œprompt tuning,â€a simple yet effective mechanism for learning â€œsoft promptsâ€ to condition frozen language models to perform specific downstream tasks. Unlike the discrete text prompts used by GPT-3, soft prompts are learned through backpropagation and can be tuned to incorporate signals from any number of labeled examples.Our end-to-end learned approach outperforms GPT-3â€™s few-shot learning by a large margin.More remarkably, through ablations on model size using T5, we show that prompt tuning becomes more competitive with scale: as models exceed billions of parameters, our method â€œcloses the gapâ€ and matches the strong performance of model tuning (where all model weights are tuned). This finding is especially relevant because large models are costly to share and serve and the ability to reuse one frozen model for multiple downstream tasks can ease this burden. Our method can be seen as a simplification of the recently proposed â€œprefix tuningâ€ of Li and Liang (2021) and we provide a comparison to this and other similar approaches. Finally, we show that conditioning a frozen model with soft prompts confers benefits in robustness to domain transfer and enables efficient â€œprompt ensembling.â€<br>åœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº†ä¸€ç§åä¸ºâ€œprompt tuningâ€çš„ç®€å•è€Œæœ‰æ•ˆçš„æœºåˆ¶ï¼Œé€šè¿‡è¯¥æœºåˆ¶å¯ä»¥å­¦ä¹ â€œè½¯æç¤ºâ€ï¼Œä»¥ä½¿å†»ç»“çš„è¯­è¨€æ¨¡å‹èƒ½å¤Ÿæ‰§è¡Œç‰¹å®šçš„ä¸‹æ¸¸ä»»åŠ¡ã€‚ä¸GPT-3ä½¿ç”¨çš„ç¦»æ•£æ–‡æœ¬æç¤ºä¸åŒï¼Œè½¯æç¤ºæ˜¯é€šè¿‡åå‘ä¼ æ’­å­¦ä¹ å¾—åˆ°çš„ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è°ƒæ•´æ¥ç»¼åˆä»»æ„æ•°é‡çš„æ ‡è®°ç¤ºä¾‹ä¸­çš„ä¿¡å·ã€‚æˆ‘ä»¬çš„ç«¯åˆ°ç«¯å­¦ä¹ æ–¹æ³•åœ¨æ€§èƒ½ä¸Šå¤§å¤§ä¼˜äºGPT-3çš„å°‘æ ·æœ¬å­¦ä¹ ã€‚æ›´ä¸ºå¼•äººæ³¨ç›®çš„æ˜¯ï¼Œé€šè¿‡ä½¿ç”¨T5æ¨¡å‹è¿›è¡Œæ¨¡å‹å¤§å°çš„æ¶ˆèå®éªŒï¼Œæˆ‘ä»¬å‘ç°éšç€æ¨¡å‹å‚æ•°è¶…è¿‡æ•°åäº¿ï¼Œæˆ‘ä»¬çš„prompt tuningæ–¹æ³•å˜å¾—ä¸æ¨¡å‹è°ƒä¼˜ï¼ˆå³è°ƒæ•´æ‰€æœ‰æ¨¡å‹æƒé‡ï¼‰å…·æœ‰ç›¸å½“ç«äº‰åŠ›ã€‚è¿™ä¸€å‘ç°ç‰¹åˆ«é‡è¦ï¼Œå› ä¸ºå¤§å‹æ¨¡å‹çš„å…±äº«å’Œéƒ¨ç½²æˆæœ¬è¾ƒé«˜ï¼Œèƒ½å¤Ÿå°†ä¸€ä¸ªå†»ç»“æ¨¡å‹é‡å¤ä½¿ç”¨äºå¤šä¸ªä¸‹æ¸¸ä»»åŠ¡å¯ä»¥å‡è½»è¿™ç§è´Ÿæ‹…ã€‚æˆ‘ä»¬çš„æ–¹æ³•å¯ä»¥çœ‹ä½œæ˜¯æœ€è¿‘æå‡ºçš„Liå’ŒLiangï¼ˆ2021ï¼‰çš„â€œprefix tuningâ€çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œå¹¶ä¸æ­¤ä»¥åŠå…¶ä»–ç±»ä¼¼æ–¹æ³•è¿›è¡Œäº†æ¯”è¾ƒã€‚æœ€åï¼Œæˆ‘ä»¬è¿˜å±•ç¤ºäº†ä½¿ç”¨è½¯æç¤ºå¯¹å†»ç»“æ¨¡å‹è¿›è¡Œæ¡ä»¶è®­ç»ƒçš„å¥½å¤„ï¼ŒåŒ…æ‹¬æé«˜é¢†åŸŸè½¬ç§»çš„é²æ£’æ€§å’Œå®ç°é«˜æ•ˆçš„â€œprompté›†æˆâ€ã€‚<br><img src="/post/nlp006/PromptTuning.jpg" class title="img"></p><h2 id="2021-10-LoRA"><a href="#2021-10-LoRA" class="headerlink" title="2021.10 LoRA"></a><code>2021.10 LoRA</code></h2><p><a href="https://arxiv.org/pdf/2106.09685.pdf">@LoRA: Low-Rank Adaptation of Large Language Models</a><br>An important paradigm of natural language processing consists of large-scale pretraining on general domain data and adaptation to particular tasks or domains. As we pre-train larger models, full fine-tuning, which retrains all model parameters,becomes less feasible. Using GPT-3 175B as an example â€“ deploying independent instances of fine-tuned models, each with 175B parameters, is prohibitively expensive. We propose Low-Rank Adaptation, or LoRA, which freezes the pretrained model weights and injects trainable rank decomposition matrices into each layer of the Transformer architecture, greatly reducing the number of trainable parameters for downstream tasks. Compared to GPT-3 175B fine-tuned with Adam,LoRA can reduce the number of trainable parameters by 10,000 times and the GPU memory requirement by 3 times. LoRA performs on-par or better than finetuning in model quality on RoBERTa, DeBERTa, GPT-2, and GPT-3, despite having fewer trainable parameters, a higher training throughput, and, unlike adapters,no additional inference latency. We also provide an empirical investigation into rank-deficiency in language model adaptation, which sheds light on the efficacy of LoRA. We release a package that facilitates the integration of LoRA with PyTorch models and provide our implementations and model checkpoints for RoBERTa,DeBERTa, and GPT-2 at <a href="https://github.com/microsoft/LoRA">https://github.com/microsoft/LoRA</a>.<br>è‡ªç„¶è¯­è¨€å¤„ç†çš„ä¸€ä¸ªé‡è¦èŒƒå¼æ˜¯åœ¨é€šç”¨é¢†åŸŸæ•°æ®ä¸Šè¿›è¡Œå¤§è§„æ¨¡é¢„è®­ç»ƒï¼Œå¹¶é€‚åº”ç‰¹å®šä»»åŠ¡æˆ–é¢†åŸŸã€‚éšç€æˆ‘ä»¬å¯¹æ¨¡å‹è¿›è¡Œæ›´å¤§è§„æ¨¡çš„é¢„è®­ç»ƒï¼Œå¯¹æ‰€æœ‰æ¨¡å‹å‚æ•°è¿›è¡Œå®Œå…¨å¾®è°ƒå˜å¾—è¶Šæ¥è¶Šä¸å¯è¡Œã€‚ä»¥GPT-3 175Bä¸ºä¾‹ï¼Œéƒ¨ç½²ç‹¬ç«‹çš„ç»è¿‡å¾®è°ƒçš„æ¨¡å‹å®ä¾‹ï¼Œæ¯ä¸ªæ¨¡å‹å®ä¾‹éƒ½æœ‰175Bä¸ªå‚æ•°ï¼Œæˆæœ¬éå¸¸é«˜æ˜‚ã€‚æˆ‘ä»¬æå‡ºäº†ä½ç§©é€‚åº”ï¼ˆLoRAï¼‰çš„æ–¹æ³•ï¼Œå®ƒå†»ç»“é¢„è®­ç»ƒæ¨¡å‹çš„æƒé‡ï¼Œå¹¶å°†å¯è®­ç»ƒçš„ç§©åˆ†è§£çŸ©é˜µæ³¨å…¥åˆ°Transformeræ¶æ„çš„æ¯ä¸ªå±‚ä¸­ï¼Œå¤§å¤§é™ä½äº†ç”¨äºä¸‹æ¸¸ä»»åŠ¡çš„å¯è®­ç»ƒå‚æ•°æ•°é‡ã€‚ä¸ä½¿ç”¨Adamè¿›è¡Œå¾®è°ƒçš„GPT-3 175Bç›¸æ¯”ï¼ŒLoRAå¯ä»¥å°†å¯è®­ç»ƒå‚æ•°çš„æ•°é‡å‡å°‘10,000å€ï¼Œå¹¶å°†GPUå†…å­˜éœ€æ±‚é™ä½3å€ã€‚å°½ç®¡å¯è®­ç»ƒå‚æ•°æ›´å°‘ã€è®­ç»ƒååé‡æ›´é«˜ï¼Œå¹¶ä¸”ä¸é€‚é…å™¨ä¸åŒï¼Œæ²¡æœ‰é¢å¤–çš„æ¨æ–­å»¶è¿Ÿï¼Œä½†LoRAåœ¨RoBERTaã€DeBERTaã€GPT-2å’ŒGPT-3çš„æ¨¡å‹è´¨é‡ä¸Šè¡¨ç°ç›¸å½“æˆ–æ›´å¥½ã€‚æˆ‘ä»¬è¿˜è¿›è¡Œäº†å…³äºè¯­è¨€æ¨¡å‹é€‚åº”ä¸­ç§©äºç¼ºçš„å®è¯ç ”ç©¶ï¼Œè¿™ä¸ºLoRAçš„æœ‰æ•ˆæ€§æä¾›äº†ä¸€äº›å¯ç¤ºã€‚æˆ‘ä»¬å‘å¸ƒäº†ä¸€ä¸ªæ–¹ä¾¿å°†LoRAä¸PyTorchæ¨¡å‹é›†æˆçš„è½¯ä»¶åŒ…ï¼Œå¹¶åœ¨ <a href="https://github.com/microsoft/LoRA">https://github.com/microsoft/LoRA</a> ä¸Šæä¾›äº†æˆ‘ä»¬å¯¹RoBERTaã€DeBERTaå’ŒGPT-2çš„å®ç°å’Œæ¨¡å‹æ£€æŸ¥ç‚¹ã€‚<br><img src="/post/nlp006/LoRA.jpg" class title="img"></p><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>LoRAå‘é¢„è®­ç»ƒå‚æ•°ä¸­æ³¨å…¥å‚æ•°çŸ©é˜µ</p><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>2.1 é¢„è®­ç»ƒæ¨¡å‹å…±äº«å‚æ•°+å¤šä¸ªLoRA = å¤šä¸ªä¸‹æ¸¸ä»»åŠ¡<br>2.2 æ— æ¨ç†å»¶è¿Ÿ ä¸¤ä¸ªæƒé‡çŸ©é˜µç›¸åŠ å³å¯ï¼Œå’Œå…¶ä»–æ–¹æ³•æ˜¯æ­£äº¤çš„ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨å…¶ä»–tuningï¼Œä¾‹å¦‚prefix-tuning</p><h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p>3.1 Adateræ’å…¥mlpå¢åŠ ç½‘ç»œæ·±åº¦ï¼Œå¢åŠ æ¨ç†å»¶è¿Ÿã€åªä¼šæ”¶æ•›åˆ°mlpçš„æœ€ä¼˜è§£ï¼Œä¸ä¸€å®šå…¨å±€æœ€ä¼˜<br>3.2 prefix tuningå¢åŠ tokensï¼Œä¼šå‡å°‘è¾“å…¥tokensçš„é•¿åº¦ï¼Œå½±å“ä¸‹æ¸¸ä»»åŠ¡</p><h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p>4.1 ä¸éœ€è¦å¯¹æ–°å¢çš„çŸ©é˜µè¿›è¡Œå…¨ç§©çš„å¾®è°ƒï¼Œåªéœ€è¦å¯¹rç§©(r=4/8)è¿›è¡Œå¾®è°ƒ<br>4.2 å¾®è°ƒèŒƒå›´huggface peftåº“å¯¹attentionä¸­çš„wqå’Œwk(wvå’Œwoæ²¡æœ‰)è¿›è¡Œè®­ç»ƒ<br>4.3 wqçš„å†…åœ¨ç§©æ¯”è¾ƒå¤§ï¼Œwvçš„å†…åœ¨ç§©æ¯”è¾ƒå°ï¼Œå•ç‹¬wvæ•ˆæœæ¯”wqå¥½</p><h3 id="ä¼˜åŒ–æ–¹å‘"><a href="#ä¼˜åŒ–æ–¹å‘" class="headerlink" title="ä¼˜åŒ–æ–¹å‘"></a>ä¼˜åŒ–æ–¹å‘</h3><p>5.1 ä¸åŒçš„wçŸ©é˜µçš„å†…åœ¨ç§©ä¸åŒï¼Œéœ€è¦ä¸åŒçš„r<br>5.2 AdaLoRAæ ¹æ®svdçš„å¤§å°å†³å®šä¸åŒçŸ©é˜µrçš„å¤§å°</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><p>6.1 <a href="https://www.bilibili.com/video/BV17g4y1g7S6/">@LoRAï¼šè®­ç»ƒä½ çš„GPTã€è®ºæ–‡ç²—è¯»Â·1ã€‘-bilibili-å°æ¨ä¸åŠªåŠ›</a></p><h2 id="2022-03-P-Tuning-v2"><a href="#2022-03-P-Tuning-v2" class="headerlink" title="2022.03 P-Tuning v2"></a><code>2022.03 P-Tuning v2</code></h2><p><a href="https://arxiv.org/pdf/2110.07602.pdf">@P-Tuning v2: Prompt Tuning Can Be Comparable to Fine-tuning Universally Across Scales and Tasks</a><br>Prompt tuning, which only tunes continuous prompts with a frozen language model, substantially reduces per-task storage and memory usage at training. However, in the context of NLU, prior work reveals that prompt tuning does not perform well for normal-sized pretrained models. We also find that existing methods of prompt tuning cannot handle hard sequence labeling tasks, indicating a lack of universality. We present a novel empirical finding that properly optimized prompt tuning can be universally effective across a wide range of model scales and NLU tasks. It matches the performance of finetuning while having only 0.1%-3% tuned parameters. Our method P-Tuning v2 is an implementation of Deep Prompt Tuning (Li and Liang, 2021; Qin and Eisner, 2021) optimized and adapted for NLU. Given the universality and simplicity of P-Tuning v2, we believe it can serve as an alternative to finetuning and a strong baseline for future research.1<br>Promptè°ƒä¼˜æ˜¯ä¸€ç§åªå¯¹å†»ç»“çš„è¯­è¨€æ¨¡å‹è°ƒä¼˜è¿ç»­æç¤ºçš„æ–¹æ³•ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘è®­ç»ƒè¿‡ç¨‹ä¸­æ¯ä¸ªä»»åŠ¡çš„å­˜å‚¨å’Œå†…å­˜ä½¿ç”¨é‡ã€‚ç„¶è€Œï¼Œåœ¨è‡ªç„¶è¯­è¨€ç†è§£ï¼ˆNLUï¼‰é¢†åŸŸï¼Œä¹‹å‰çš„ç ”ç©¶è¡¨æ˜ï¼Œå¯¹äºæ™®é€šå¤§å°çš„é¢„è®­ç»ƒæ¨¡å‹ï¼ŒPromptè°ƒä¼˜æ•ˆæœä¸ä½³ã€‚æˆ‘ä»¬è¿˜å‘ç°ï¼Œç°æœ‰çš„Promptè°ƒä¼˜æ–¹æ³•æ— æ³•å¤„ç†å›°éš¾çš„åºåˆ—æ ‡æ³¨ä»»åŠ¡ï¼Œè¡¨æ˜ç¼ºä¹æ™®éæ€§ã€‚æˆ‘ä»¬æå‡ºäº†ä¸€é¡¹æ–°çš„ç»éªŒæ€§å‘ç°ï¼Œå³ç»è¿‡é€‚å½“ä¼˜åŒ–çš„Promptè°ƒä¼˜å¯ä»¥åœ¨å„ç§æ¨¡å‹è§„æ¨¡å’ŒNLUä»»åŠ¡ä¸­æ™®éæœ‰æ•ˆã€‚å®ƒä¸å¾®è°ƒçš„æ€§èƒ½ç›¸å½“ï¼Œä½†åªæœ‰0.1% - 3%çš„è°ƒä¼˜å‚æ•°ã€‚æˆ‘ä»¬çš„æ–¹æ³•P-Tuning v2æ˜¯Deep Prompt Tuningï¼ˆLi and Liang, 2021; Qin and Eisner, 2021ï¼‰åœ¨NLUé¢†åŸŸè¿›è¡Œäº†ä¼˜åŒ–å’Œé€‚åº”çš„å®ç°ã€‚é‰´äºP-Tuning v2çš„æ™®é€‚æ€§å’Œç®€å•æ€§ï¼Œæˆ‘ä»¬ç›¸ä¿¡å®ƒå¯ä»¥ä½œä¸ºå¾®è°ƒçš„æ›¿ä»£æ–¹æ³•ï¼Œå¹¶ä¸ºæœªæ¥çš„ç ”ç©¶æä¾›ä¸€ä¸ªå¼ºæœ‰åŠ›çš„åŸºå‡†ã€‚<br><img src="/post/nlp006/PTuningV2.jpg" class title="img"></p><h2 id="2023-03-AdaLoRA"><a href="#2023-03-AdaLoRA" class="headerlink" title="2023.03 AdaLoRA"></a><code>2023.03 AdaLoRA</code></h2><p><a href="https://arxiv.org/pdf/2303.10512.pdf">@ADAPTIVE BUDGET ALLOCATION FOR PARAMETER EFFICIENT FINE-TUNING</a><br>Fine-tuning large pre-trained language models on downstream tasks has become an important paradigm in NLP. However, common practice fine-tunes all of the parameters in a pre-trained model, which becomes prohibitive when a large number of downstream tasks are present. Therefore, many fine-tuning methods are proposed to learn incremental updates of pre-trained weights in a parameter efficient way,e.g., low-rank increments. These methods often evenly distribute the budget of incremental updates across all pre-trained weight matrices, and overlook the varying importance of different weight parameters. As a consequence, the finetuning performance is suboptimal. To bridge this gap, we propose AdaLoRA,which adaptively allocates the parameter budget among weight matrices according to their importance score. In particular, AdaLoRA parameterizes the incremental updates in the form of singular value decomposition. Such a novel approach allows us to effectively prune the singular values of unimportant updates, which is essentially to reduce their parameter budget but circumvent intensive exact SVD computations. We conduct extensive experiments with several pre-trained<br>models on natural language processing, question answering, and natural language generation to validate the effectiveness of AdaLoRA. Results demonstrate that AdaLoRA manifests notable improvement over baselines, especially in the low budget settings.<br>åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ä¸­ï¼Œå°†å¤§å‹é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šè¿›è¡Œå¾®è°ƒå·²ç»æˆä¸ºä¸€ä¸ªé‡è¦çš„èŒƒå¼ã€‚ç„¶è€Œï¼Œé€šå¸¸çš„åšæ³•æ˜¯å¾®è°ƒé¢„è®­ç»ƒæ¨¡å‹ä¸­çš„æ‰€æœ‰å‚æ•°ï¼Œå½“å­˜åœ¨å¤§é‡ä¸‹æ¸¸ä»»åŠ¡æ—¶ï¼Œè¿™ç§åšæ³•å˜å¾—ä¸å¯è¡Œã€‚å› æ­¤ï¼Œè®¸å¤šå¾®è°ƒæ–¹æ³•è¢«æå‡ºæ¥ä»¥ä»¥å‚æ•°é«˜æ•ˆçš„æ–¹å¼å­¦ä¹ é¢„è®­ç»ƒæƒé‡çš„å¢é‡æ›´æ–°ï¼Œä¾‹å¦‚ä½ç§©å¢é‡ã€‚è¿™äº›æ–¹æ³•é€šå¸¸å‡åŒ€åœ°åˆ†é…å¢é‡æ›´æ–°çš„é¢„ç®—åˆ°æ‰€æœ‰é¢„è®­ç»ƒæƒé‡çŸ©é˜µä¸Šï¼Œå¹¶å¿½è§†äº†ä¸åŒæƒé‡å‚æ•°çš„é‡è¦æ€§å·®å¼‚ã€‚ç»“æœå¯¼è‡´å¾®è°ƒæ€§èƒ½ä¸ä½³ã€‚ä¸ºäº†å¼¥è¡¥è¿™ä¸€å·®è·ï¼Œæˆ‘ä»¬æå‡ºäº†AdaLoRAï¼Œå®ƒæ ¹æ®æƒé‡çŸ©é˜µçš„é‡è¦æ€§åˆ†æ•°è‡ªé€‚åº”åœ°åˆ†é…å‚æ•°é¢„ç®—ã€‚å…·ä½“è€Œè¨€ï¼ŒAdaLoRAå°†å¢é‡æ›´æ–°å‚æ•°åŒ–ä¸ºå¥‡å¼‚å€¼åˆ†è§£çš„å½¢å¼ã€‚è¿™ç§æ–°é¢–çš„æ–¹æ³•ä½¿æˆ‘ä»¬èƒ½å¤Ÿæœ‰æ•ˆåœ°ä¿®å‰ªä¸é‡è¦æ›´æ–°çš„å¥‡å¼‚å€¼ï¼Œä»è€Œå‡å°‘å®ƒä»¬çš„å‚æ•°é¢„ç®—ï¼ŒåŒæ—¶é¿å…äº†ç¹é‡çš„ç²¾ç¡®å¥‡å¼‚å€¼åˆ†è§£è®¡ç®—ã€‚æˆ‘ä»¬åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ã€é—®ç­”å’Œè‡ªç„¶è¯­è¨€ç”Ÿæˆç­‰å¤šä¸ªé¢„è®­ç»ƒæ¨¡å‹ä¸Šè¿›è¡Œäº†å¤§é‡å®éªŒè¯æ˜äº†AdaLoRAçš„æœ‰æ•ˆæ€§ã€‚ç»“æœè¡¨æ˜ï¼ŒAdaLoRAåœ¨åŸºå‡†æ¨¡å‹ä¸Šè¡¨ç°å‡ºæ˜¾è‘—çš„æ”¹è¿›ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½é¢„ç®—è®¾ç½®ä¸‹ã€‚<br><img src="/post/nlp006/AdaLoRA.jpg" class title="img"></p>]]></content>
      
      
      
        <tags>
            
            <tag> NLP </tag>
            
            <tag> LLM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>005 å¤§è¯­è¨€æ¨¡å‹ç»¼è¿°[æŒç»­æ›´æ–°]-csdn-ç‹å˜‰å®</title>
      <link href="/post/nlp005.html"/>
      <url>/post/nlp005.html</url>
      
        <content type="html"><![CDATA[<h2 id="è½¬è½½"><a href="#è½¬è½½" class="headerlink" title="è½¬è½½"></a><strong>è½¬è½½</strong></h2><p>æœ¬æ–‡è½¬è½½äºï¼š<a href="https://wjn1996.blog.csdn.net/article/details/120607050">@csdn-åå¸ˆæ•°æ®å­¦é™¢Â·ç‹å˜‰å®</a><a href="https://zhuanlan.zhihu.com/p/619566088">@çŸ¥ä¹-åå¸ˆæ•°æ®ç‹å˜‰å®</a></p><h2 id="Prompt-Tuningâ€”â€”æ·±åº¦è§£è¯»ä¸€ç§å…¨æ–°çš„å¾®è°ƒèŒƒå¼"><a href="#Prompt-Tuningâ€”â€”æ·±åº¦è§£è¯»ä¸€ç§å…¨æ–°çš„å¾®è°ƒèŒƒå¼" class="headerlink" title="Prompt-Tuningâ€”â€”æ·±åº¦è§£è¯»ä¸€ç§å…¨æ–°çš„å¾®è°ƒèŒƒå¼"></a>Prompt-Tuningâ€”â€”æ·±åº¦è§£è¯»ä¸€ç§å…¨æ–°çš„å¾®è°ƒèŒƒå¼</h2><p>é¦–æ¬¡å‘å¸ƒæ—¥æœŸï¼š2021å¹´11æœˆ19æ—¥<br>ç¬¬ä¸€æ¬¡å…¨é¢æ›´æ–°ï¼š2023å¹´2æœˆ3æ—¥<br>ç¬¬äºŒæ¬¡å…¨é¢æ›´æ–°ï¼š2023å¹´3æœˆ29æ—¥</p><hr><p>é˜…è¯»è¯¥åšå®¢ï¼Œæ‚¨å°†ç³»ç»Ÿåœ°æŒæ¡å¦‚ä¸‹çŸ¥è¯†ç‚¹ï¼š</p><ul><li>ä»€ä¹ˆæ˜¯é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Ÿ</li><li>ä»€ä¹ˆæ˜¯promptï¼Ÿä¸ºä»€ä¹ˆè¦å¼•å…¥promptï¼Ÿç›¸æ¯”ä¼ ç»Ÿfine-tuningæœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</li><li>è‡ª20å¹´åº•å¼€å§‹ï¼Œpromptçš„å‘å±•å†ç¨‹ï¼Œå“ªäº›ç»å…¸çš„ä»£è¡¨æ–¹æ³•ï¼Ÿ</li><li>é¢å‘ä¸åŒç§ç±»NLPä»»åŠ¡ï¼Œpromptå¦‚ä½•é€‰æ‹©å’Œè®¾è®¡ï¼Ÿ</li><li>é¢å‘è¶…å¤§è§„æ¨¡æ¨¡å‹ï¼Œå¦‚ä½•å€ŸåŠ©promptè¿›è¡Œå‚æ•°æœ‰æ•ˆæ€§è®­ç»ƒï¼Ÿ</li><li>é¢å‘GPT3ï¼Œä»€ä¹ˆæ˜¯In-Context Learningï¼Ÿä»€ä¹ˆæ˜¯Chain-Of-Thoughtï¼Ÿ</li><li>é¢å‘é»‘ç›’æ¨¡å‹ï¼Œå¦‚ä½•ä½¿ç”¨promptï¼Ÿ</li><li>ChatGPTé‡Œæœ‰å“ªäº›promptæŠ€æœ¯ï¼Ÿ</li><li>æœªæ¥promptçš„å‘å±•ä¸ç ”ç©¶å‰æ™¯</li></ul><p>Promptçš„ç”±æµ…å…¥æ·±çš„ç†è§£ï¼š</p><ul><li>1çº§ï¼šPromptæ˜¯ä¸€ç§å¯¹ä»»åŠ¡çš„æŒ‡ä»¤ï¼›</li><li>2çº§ï¼šPromptæ˜¯ä¸€ç§å¯¹é¢„è®­ç»ƒç›®æ ‡çš„å¤ç”¨ï¼›</li><li>3çº§ï¼šPromptæœ¬è´¨æ˜¯å‚æ•°æœ‰æ•ˆæ€§è®­ç»ƒï¼›</li></ul><hr><h2 id="çƒ­ç‚¹é¢„è§ˆ"><a href="#çƒ­ç‚¹é¢„è§ˆ" class="headerlink" title="**çƒ­ç‚¹é¢„è§ˆ"></a>**çƒ­ç‚¹é¢„è§ˆ</h2><h2 id="ğŸ”¥é¢„å‘Šï¼š-HugNLP-æ­£å¼å‘å¸ƒâŒ›ï¸âŒ›ï¸"><a href="#ğŸ”¥é¢„å‘Šï¼š-HugNLP-æ­£å¼å‘å¸ƒâŒ›ï¸âŒ›ï¸" class="headerlink" title="ğŸ”¥é¢„å‘Šï¼š HugNLP æ­£å¼å‘å¸ƒâŒ›ï¸âŒ›ï¸"></a>ğŸ”¥é¢„å‘Šï¼š HugNLP æ­£å¼å‘å¸ƒâŒ›ï¸âŒ›ï¸</h2><p><strong>HugNLP</strong> æ¡†æ¶å³å°†å‘å¸ƒï¼ç›®å‰å·²ç»å¼€æ”¾å¼€æºåœ°å€ï¼š<a href="https://github.com/HugAILab/HugNLP">https://github.com/HugAILab/HugNLP</a>ï¼Œæ¬¢è¿<strong>Star</strong>ã€<strong>Issue</strong>å’Œ<strong>PR</strong>ï¼</p><p><img src="https://img-blog.csdnimg.cn/ad92e7f1c50a444499b90320b9236940.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li><p>HugNLPæ˜¯ä¸€ä¸ª<strong>ç»Ÿä¸€çš„é¢å‘è‡ªç„¶è¯­è¨€å¤„ç†çš„è®­ç»ƒå’Œéƒ¨ç½²æ¡†æ¶</strong>ï¼Œå…¶æ”¯æŒ<strong>é¢„è®­ç»ƒ</strong>ã€<strong>æ–‡æœ¬åˆ†ç±»</strong>ã€<strong>ä¿¡æ¯æŠ½å–</strong>ã€<strong>é˜…è¯»ç†è§£</strong>ã€<strong>å¤šé¡¹é€‰æ‹©</strong>ã€<strong>ä»£ç å…‹éš†ç›‘æµ‹ä¸ä¿®å¤</strong>ç­‰ä¼—å¤šè‡ªç„¶è¯­è¨€ç†è§£å’Œç”Ÿæˆä»»åŠ¡çš„è®­ç»ƒå’Œæ¨ç†ã€‚HugNLPå®Œå…¨åŸºäºHuggingFaceå¼€å‘ï¼Œå…·å¤‡å¯æ‰©å±•æ€§å¼ºã€é€šç”¨å‹å¥½çš„ç‰¹ç‚¹ï¼ŒHugNLPçš„æ‰“é€ ï¼Œå¯ä»¥æå¤§åœ°æ–¹ä¾¿ç ”ç©¶è€…å’Œç”¨æˆ·ä¸Šæ‰‹NLPçš„è®­ç»ƒå’Œéƒ¨ç½²ï¼›</p></li><li><p>å¦‚ä»Šå¤§è¯­è¨€æ¨¡å‹å’ŒPrompt-Tuningçš„å‘å±•è¿…é€Ÿï¼ŒHugNLPåŒæ ·é›†æˆäº†é¢å‘åˆ†ç±»å’Œç”Ÿæˆçš„<strong>Prompt-tuning</strong>ã€<strong>In-Context Learning</strong>ã€<strong>Instruction-tuning</strong>ç­‰æŠ€æœ¯ï¼Œå¹¶åº”ç”¨åœ¨NLPå„ç§ç±»å‹ä»»åŠ¡ä¸Šï¼Œæœªæ¥ä¹Ÿå°†é›†æˆå„ç§å¤§æ¨¡å‹APIæœåŠ¡ï¼›</p></li><li><p>ç›®å‰åšä¸»å·²ç»æ¨å‡ºä¸¤ä¸ªåŸºäº HugNLP æ¡†æ¶è®­ç»ƒçš„äº§å“å’ŒæŠ€æœ¯æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š</p></li><li><ul><li><strong>HugChat</strong>ï¼šæ¨¡æ‹ŸChatGPTè®­ç»ƒçš„é¢å‘ä¸­å°è§„æ¨¡è¯­è¨€æ¨¡å‹çš„å¯¹è¯æ¨¡å‹ï¼Œä¸»è¦æŠ€æœ¯æ˜¯Instruction-tuningï¼ŒGPT-2ã€LLaMAç­‰å¼€æºæ¨¡å‹ä½œä¸ºBackboneã€‚HugNLPå¼€æºäº†è®­ç»ƒæ•°æ®å’ŒæŠ€æœ¯æ–¹æ¡ˆï¼›</li></ul></li><li><ul><li><strong>HugIE</strong>ï¼šç»Ÿä¸€çš„ä¸­æ–‡ä¿¡æ¯æŠ½å–æ¡†æ¶ï¼Œé‡‡ç”¨Global Pointerå®ç°æ–‡æœ¬ä¸­ç»“æ„åŒ–ä¿¡æ¯çš„æŠ½å–ï¼›</li></ul></li></ul><p><strong>HugNLPå®æ—¶æ›´æ–°ï¼Œæ¬¢è¿Starã€Issueå’ŒPRï¼</strong></p><h2 id="ğŸ”¥é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‘å±•å†ç¨‹ï¼š"><a href="#ğŸ”¥é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‘å±•å†ç¨‹ï¼š" class="headerlink" title="ğŸ”¥é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‘å±•å†ç¨‹ï¼š"></a>ğŸ”¥<a href="https://so.csdn.net/so/search?q=%E9%A2%84%E8%AE%AD%E7%BB%83&amp;spm=1001.2101.3001.7020">é¢„è®­ç»ƒ</a>è¯­è¨€æ¨¡å‹çš„å‘å±•å†ç¨‹ï¼š</h2><p><img src="https://img-blog.csdnimg.cn/1614c2f147bf4ed4a4cee9af5c751a46.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>â€ƒâ€ƒæˆªæ­¢23å¹´3æœˆåº•ï¼Œè¯­è¨€æ¨¡å‹å‘å±•èµ°è¿‡äº†ä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li><strong>ç¬¬ä¸€é˜¶æ®µ</strong>ï¼šè®¾è®¡ä¸€ç³»åˆ—çš„è‡ªç›‘ç£è®­ç»ƒç›®æ ‡ï¼ˆMLMã€NSPç­‰ï¼‰ï¼Œè®¾è®¡æ–°é¢–çš„æ¨¡å‹æ¶æ„ï¼ˆTransformerï¼‰ï¼Œéµå¾ªPre-trainingå’ŒFine-tuningèŒƒå¼ã€‚å…¸å‹ä»£è¡¨æ˜¯BERTã€GPTã€XLNetç­‰ï¼›</li><li><strong>ç¬¬äºŒé˜¶æ®µ</strong>ï¼šé€æ­¥æ‰©å¤§æ¨¡å‹å‚æ•°å’Œè®­ç»ƒè¯­æ–™è§„æ¨¡ï¼Œæ¢ç´¢ä¸åŒç±»å‹çš„æ¶æ„ã€‚å…¸å‹ä»£è¡¨æ˜¯BARTã€T5ã€GPT-3ç­‰ï¼›</li><li><strong>ç¬¬ä¸‰é˜¶æ®µ</strong>ï¼šèµ°å‘AIGCï¼ˆArtificial Intelligent Generated Contentï¼‰æ—¶ä»£ï¼Œæ¨¡å‹å‚æ•°è§„æ¨¡æ­¥å…¥åƒä¸‡äº¿ï¼Œæ¨¡å‹æ¶æ„ä¸ºè‡ªå›å½’æ¶æ„ï¼Œå¤§æ¨¡å‹èµ°å‘å¯¹è¯å¼ã€ç”Ÿæˆå¼ã€å¤šæ¨¡æ€æ—¶ä»£ï¼Œæ›´åŠ æ³¨é‡ä¸äººç±»äº¤äº’è¿›è¡Œå¯¹é½ï¼Œå®ç°å¯é ã€å®‰å…¨ã€æ— æ¯’çš„æ¨¡å‹ã€‚å…¸å‹ä»£è¡¨æ˜¯InstructionGPTã€ChatGPTã€Bardã€GPT-4ç­‰ã€‚</li></ul><h2 id="ğŸ”¥é¢å‘é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„Prompt-TuningæŠ€æœ¯å‘å±•å†ç¨‹ï¼š"><a href="#ğŸ”¥é¢å‘é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„Prompt-TuningæŠ€æœ¯å‘å±•å†ç¨‹ï¼š" class="headerlink" title="ğŸ”¥é¢å‘é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„Prompt-TuningæŠ€æœ¯å‘å±•å†ç¨‹ï¼š"></a>ğŸ”¥é¢å‘é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„Prompt-TuningæŠ€æœ¯å‘å±•å†ç¨‹ï¼š</h2><p><img src="https://img-blog.csdnimg.cn/9022caf1c4a74c75942539454f1b689f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>Prompt-Tuningè‡ªä»GPT-3è¢«æå‡ºä»¥æ¥ï¼Œä»ä¼ ç»Ÿçš„ç¦»æ•£ã€è¿ç»­çš„Promptçš„æ„å»ºã€èµ°å‘é¢å‘è¶…å¤§è§„æ¨¡æ¨¡å‹çš„In-Context Learningã€Instruction-tuningå’ŒChain-of-Thoughtã€‚</p><hr><p>â€ƒâ€ƒè‡ªä»GPTã€EMLOã€BERTçš„ç›¸ç»§æå‡ºï¼Œä»¥<code>Pre-training + Fine-tuning</code> çš„æ¨¡å¼åœ¨è¯¸å¤šè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ä»»åŠ¡ä¸­è¢«å¹¿æ³›ä½¿ç”¨ï¼Œå…¶å…ˆåœ¨<code>Pre-training</code>é˜¶æ®µé€šè¿‡ä¸€ä¸ªæ¨¡å‹åœ¨å¤§è§„æ¨¡æ— ç›‘ç£è¯­æ–™ä¸Šé¢„å…ˆè®­ç»ƒä¸€ä¸ª<strong>é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼ˆPre-trained Language Modelï¼ŒPLMï¼‰</strong>ï¼Œç„¶ååœ¨<code>Fine-tuning</code>é˜¶æ®µåŸºäºè®­ç»ƒå¥½çš„è¯­è¨€æ¨¡å‹åœ¨å…·ä½“çš„ä¸‹æ¸¸ä»»åŠ¡ä¸Šå†æ¬¡è¿›è¡Œ<strong>å¾®è°ƒï¼ˆFine-tuningï¼‰</strong>ï¼Œä»¥è·å¾—é€‚åº”ä¸‹æ¸¸ä»»åŠ¡çš„æ¨¡å‹ã€‚è¿™ç§æ¨¡å¼åœ¨è¯¸å¤šä»»åŠ¡çš„è¡¨ç°ä¸Šè¶…è¶Šäº†ä¼ ç»Ÿçš„ç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œä¸è®ºåœ¨å·¥ä¸šç”Ÿäº§ã€ç§‘ç ”åˆ›æ–°è¿˜æ˜¯ç«èµ›ä¸­å‡ä½œä¸ºæ–°çš„ä¸»æµæ–¹å¼ã€‚ç„¶è€Œï¼Œè¿™å¥—æ¨¡å¼ä¹Ÿå­˜åœ¨ç€ä¸€äº›é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œåœ¨å¤§å¤šæ•°çš„ä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒæ—¶ï¼Œ<strong>ä¸‹æ¸¸ä»»åŠ¡çš„ç›®æ ‡ä¸é¢„è®­ç»ƒçš„ç›®æ ‡å·®è·è¿‡å¤§</strong>å¯¼è‡´æå‡æ•ˆæœä¸æ˜æ˜¾ï¼Œ<strong>å¾®è°ƒè¿‡ç¨‹ä¸­ä¾èµ–å¤§é‡çš„ç›‘ç£è¯­æ–™</strong>ç­‰ã€‚<strong>è‡³æ­¤ï¼Œä»¥GPT-3ã€PETä¸ºé¦–æå‡ºä¸€ç§åŸºäºé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„æ–°çš„å¾®è°ƒèŒƒå¼â€”â€”Prompt-Tuning</strong>ï¼Œå…¶æ—¨åœ¨é€šè¿‡æ·»åŠ æ¨¡æ¿çš„æ–¹æ³•æ¥é¿å…å¼•å…¥é¢å¤–çš„å‚æ•°ï¼Œä»è€Œè®©è¯­è¨€æ¨¡å‹å¯ä»¥åœ¨å°æ ·æœ¬ï¼ˆFew-shotï¼‰æˆ–é›¶æ ·æœ¬ï¼ˆZero-shotï¼‰åœºæ™¯ä¸‹è¾¾åˆ°ç†æƒ³çš„æ•ˆæœã€‚Prompt-Tuningåˆå¯ä»¥ç§°ä¸ºPromptã€Promptingã€Prompt-based Fine-tuningç­‰ã€‚</p><p>â€ƒâ€ƒå› æ­¤ç®€å•çš„æ¥è¯´ï¼ŒPrompt-Tuningçš„åŠ¨æœºæ—¨åœ¨è§£å†³ç›®å‰ä¼ ç»ŸFine-tuningçš„ä¸¤ä¸ªç—›ç‚¹é—®é¢˜ï¼š</p><ul><li><strong>é™ä½è¯­ä¹‰å·®å¼‚ï¼ˆBridge the gap between Pre-training and Fine-tuningï¼‰</strong>ï¼šé¢„è®­ç»ƒä»»åŠ¡ä¸»è¦ä»¥Masked Language Modelingï¼ˆMLMï¼‰ä¸ºä¸»ï¼Œè€Œä¸‹æ¸¸ä»»åŠ¡åˆ™é‡æ–°å¼•å…¥æ–°çš„è®­ç»ƒå‚æ•°ï¼Œå› æ­¤ä¸¤ä¸ªé˜¶æ®µçš„ç›®æ ‡é€šå¸¸æœ‰è¾ƒå¤§å·®å¼‚ã€‚å› æ­¤éœ€è¦è§£å†³å¦‚ä½•ç¼©å°Pre-trainingå’ŒFine-tuningä¸¤ä¸ªé˜¶æ®µç›®æ ‡å·®è·è¿‡å¤§çš„é—®é¢˜ï¼›</li><li><strong>é¿å…è¿‡æ‹Ÿåˆï¼ˆOverfitting of the headï¼‰</strong>ï¼šç”±äºå†Fine-tuningé˜¶æ®µéœ€è¦æ–°å¼•å…¥é¢å¤–çš„å‚æ•°ä»¥é€‚é…ç›¸åº”çš„ä»»åŠ¡éœ€è¦ï¼Œå› æ­¤åœ¨æ ·æœ¬æ•°é‡æœ‰é™çš„æƒ…å†µå®¹æ˜“å‘ç”Ÿè¿‡æ‹Ÿåˆï¼Œé™ä½äº†æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚å› æ­¤éœ€è¦é¢å¯¹é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„è¿‡æ‹Ÿåˆé—®é¢˜ã€‚</li></ul><p>â€ƒâ€ƒæœ¬æ–‡å°†æ·±å…¥è§£è¯»Prompt-Tuningçš„å¾®è°ƒèŒƒå¼ï¼Œä»¥ç»¼è¿°+è®¨è®ºçš„å½¢å¼å±•å¼€ã€‚</p><hr><h2 id><a href="#" class="headerlink" title=" "></a> </h2><h2 id="ç¬¬ä¸€ç« ï¼šé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹"><a href="#ç¬¬ä¸€ç« ï¼šé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹" class="headerlink" title="ç¬¬ä¸€ç« ï¼šé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹"></a>ç¬¬ä¸€ç« ï¼šé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹</h2><hr><blockquote><p>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼š</p><ul><li>å•å‘è¯­è¨€æ¨¡å‹ã€åŒå‘è¯­è¨€æ¨¡å‹ï¼›</li><li>Transformerï¼›</li><li>é¢„è®­ç»ƒä»»åŠ¡ï¼ŒåŒ…æ‹¬MLMã€NSPç­‰ï¼›</li><li>NLPçš„ä»»åŠ¡ç±»å‹ä»¥åŠfine-tuningï¼›</li></ul></blockquote><p>â€ƒâ€ƒé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹æƒ³å¿…å¤§å®¶å·²ç»ä¸å†é™Œç”Ÿï¼Œä»¥GPTã€ELMOå’ŒBERTä¸ºé¦–çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åœ¨è¿‘ä¸¤å¹´å†…å¤§æ”¾å¼‚å½©ã€‚é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ä¸»è¦åˆ†ä¸ºå•å‘å’ŒåŒå‘ä¸¤ç§ç±»å‹ï¼š</p><ul><li><strong>å•å‘</strong>ï¼šä»¥GPTä¸ºé¦–ï¼Œå¼ºè°ƒ<strong>ä»å·¦å‘å³</strong>çš„ç¼–ç é¡ºåºï¼Œé€‚ç”¨äºEncoder-Decoderæ¨¡å¼çš„è‡ªå›å½’ï¼ˆAuto-regressiveï¼‰æ¨¡å‹ï¼›</li><li><strong>åŒå‘</strong>ï¼šä»¥ELMOä¸ºé¦–ï¼Œå¼ºè°ƒä»å·¦å‘å³å’Œä»å³å‘å·¦<strong>åŒå‘ç¼–ç </strong>ï¼Œä½†ELMOçš„ä¸»ä½“æ˜¯LSTMï¼Œç”±äºå…¶æ˜¯ä¸²å½¢åœ°è¿›è¡Œç¼–ç ï¼Œå¯¼è‡´å…¶è¿è¡Œé€Ÿåº¦è¾ƒæ…¢ï¼Œå› æ­¤æœ€è¿‘BERTåˆ™ä»¥Transformerä¸ºä¸»ä½“ç»“æ„ä½œä¸ºåŒå‘è¯­è¨€æ¨¡å‹çš„åŸºå‡†ã€‚</li></ul><p>â€ƒâ€ƒç°å¦‚ä»Šå¸¸ç”¨çš„è¯­è¨€æ¨¡å‹å¤§å¤šæ•°æ˜¯BERTåŠå…¶å˜ä½“ï¼Œå®ƒçš„ä¸»ä½“ç»“æ„Transformeræ¨¡å‹æ˜¯ç”±è°·æ­Œæœºå™¨ç¿»è¯‘å›¢é˜Ÿåœ¨17å¹´æœ«æå‡ºçš„ï¼Œæ˜¯ä¸€ç§å®Œå…¨åˆ©ç”¨attentionæœºåˆ¶æ„å»ºçš„ç«¯åˆ°ç«¯æ¨¡å‹ï¼Œå…·ä½“ç®—æ³•è¯¦è§£å¯è¯¦æƒ…<a href="https://blog.csdn.net/qq_36426650/article/details/112222115">ã€é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ã€‘Attention Is All You Needï¼ˆTransformerï¼‰</a>ã€‚ä¹‹æ‰€ä»¥é€‰æ‹©Transformerï¼Œæ˜¯å› ä¸º<strong>å…¶å®Œå…¨ä»¥Attentionä½œä¸ºè®¡ç®—æ¨ç†æŠ€æœ¯</strong>ï¼Œä»»æ„çš„ä¸¤ä¸ªtokenå‡å¯ä»¥ä¸¤ä¸¤äº¤äº’ï¼Œä½¿å¾—æ¨ç†å®Œå…¨å¯ä»¥ç”±çŸ©é˜µä¹˜æœºæ¥æ›¿ä»£ï¼Œå®ç°äº†<strong>å¯å¹¶è¡ŒåŒ–è®¡ç®—</strong>ï¼Œå› æ­¤Transformerä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªå…¨è¿æ¥å›¾ï¼Œ<strong>ç¼“è§£äº†åºåˆ—æ•°æ®æ™®éå­˜åœ¨çš„é•¿è·ç¦»ä¾èµ–å’Œæ¢¯åº¦æ¶ˆå¤±ç­‰ç¼ºé™·</strong>ã€‚</p><blockquote><p>â€ƒâ€ƒåœ¨NLPé¢†åŸŸä¸­ï¼ŒAttentionæœºåˆ¶çš„ç›®æ ‡æ˜¯å¯¹å…·æœ‰å¼ºç›¸å…³çš„tokenä¹‹é—´æé«˜æ¨¡å‹çš„å…³æ³¨åº¦ã€‚ä¾‹å¦‚åœ¨æ–‡æœ¬åˆ†ç±»ä¸­ï¼Œéƒ¨åˆ†è¯å¯¹åˆ†ç±»äº§ç”Ÿçš„è´¡çŒ®æ›´å¤§ï¼Œåˆ™ä¼šåˆ†é…è¾ƒå¤§çš„æƒé‡ã€‚<br>â€ƒâ€ƒå¯¹å¥å­çš„ç¼–ç ä¸»è¦ç›®æ ‡æ˜¯ä¸ºäº†è®©æ¨¡å‹è®°ä½tokençš„è¯­ä¹‰ã€‚ä¼ ç»Ÿçš„LSTMåˆ™åªèƒ½é€šè¿‡é•¿çŸ­æœŸè®°å¿†çš„æ–¹æ³•æ¥æ•æ‰tokenä¹‹é—´çš„å…³ç³»ï¼Œå®¹æ˜“å¯¼è‡´æ¢¯åº¦æ¶ˆå¤±æˆ–è®°å¿†æ¨¡ç³Šé—®é¢˜ï¼Œè€ŒTransformerä¸­ï¼Œä»»æ„çš„tokenä¹‹é—´éƒ½æœ‰æ˜¾å¼çš„è¿æ¥ï¼Œé¿å…äº†é•¿è·ç¦»ä¾èµ–æ€§é—®é¢˜ã€‚å½“ç„¶Transformerä¹Ÿå¢åŠ äº†position embeddingä»¥åŒºåˆ†ä¸åŒtokençš„ä½ç½®å…³ç³»ï¼Œ</p></blockquote><h3 id="1-1-ç»å…¸çš„Pre-trainedä»»åŠ¡"><a href="#1-1-ç»å…¸çš„Pre-trainedä»»åŠ¡" class="headerlink" title="1.1 ç»å…¸çš„Pre-trainedä»»åŠ¡"></a>1.1 ç»å…¸çš„Pre-trainedä»»åŠ¡</h3><p>â€ƒâ€ƒæœ¬æ–‡çš„ç›®æ ‡æ˜¯ä»‹ç»Prompt-Tuningçš„æ–¹æ³•ï¼Œè€ŒPrompt-Tuningçš„åŠ¨æœºåˆ™æ˜¯è¿›ä¸€æ­¥æ‹‰è¿‘å¾®è°ƒä¸é¢„è®­ç»ƒé˜¶æ®µçš„ä»»åŠ¡ç›®æ ‡ï¼Œå› æ­¤æœ¬éƒ¨åˆ†åˆ™ä»¥å¸¸ç”¨çš„BERTä¸ºä¸»ï¼Œç®€å•ä»‹ç»Pre-trainingçš„ç»å…¸æ–¹æ³•ï¼Œæ›´åŠ è¯¦ç»†çš„è§£è¯»ï¼Œå¯å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_36426650/article/details/112223838">ã€é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ã€‘BERT: Pre-training of Deep Bidirectional Transformers for Language Understandingï¼ˆBERTï¼‰</a>ã€‚</p><h4 id="ï¼ˆ1ï¼‰Masked-Language-Modelingï¼ˆMLMï¼‰"><a href="#ï¼ˆ1ï¼‰Masked-Language-Modelingï¼ˆMLMï¼‰" class="headerlink" title="ï¼ˆ1ï¼‰Masked Language Modelingï¼ˆMLMï¼‰"></a>ï¼ˆ1ï¼‰Masked Language Modelingï¼ˆMLMï¼‰</h4><p>â€ƒâ€ƒä¼ ç»Ÿçš„è¯­è¨€æ¨¡å‹æ˜¯ä»¥word2vecã€GloVeä¸ºä»£è¡¨çš„è¯å‘é‡æ¨¡å‹ï¼Œä»–ä»¬ä¸»è¦æ˜¯ä»¥è¯è¢‹ï¼ˆN-Gramï¼‰ä¸ºåŸºç¡€ã€‚ä¾‹å¦‚åœ¨word2vecçš„CBOWæ–¹æ³•ä¸­ï¼Œéšæœºé€‰å–ä¸€ä¸ªå›ºå®šé•¿åº¦çš„è¯è¢‹åŒºé—´ï¼Œç„¶åæŒ–æ‰ä¸­å¿ƒéƒ¨åˆ†çš„è¯åï¼Œè®©æ¨¡å‹ï¼ˆä¸€ä¸ªç®€å•çš„æ·±åº¦ç¥ç»ç½‘ç»œï¼‰é¢„æµ‹è¯¥ä½ç½®çš„è¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/d2f37671b6cc4c6fb4f88021e41d1a75.png" alt></p><p>â€ƒâ€ƒMasked Language Modelingï¼ˆMLMï¼‰åˆ™é‡‡ç”¨äº†N-Gramçš„æ–¹æ³•ï¼Œä¸åŒçš„æ˜¯ï¼ŒN-Gramå–‚å…¥çš„æ˜¯è¢«æˆªæ–­çš„çŸ­æ–‡æœ¬ï¼Œè€ŒMLMåˆ™æ˜¯å®Œæ•´çš„æ–‡æœ¬ï¼Œå› æ­¤MLMæ›´èƒ½å¤Ÿä¿ç•™åŸå§‹çš„è¯­ä¹‰ï¼š</p><p><img src="https://img-blog.csdnimg.cn/5d2a6b9a27ef4176a658a1b7a0e0d8a0.png" alt></p><p>â€ƒâ€ƒMLMæ˜¯ä¸€ç§è‡ªç›‘ç£çš„è®­ç»ƒæ–¹æ³•ï¼Œå…¶å…ˆä»å¤§è§„æ¨¡çš„æ— ç›‘ç£è¯­æ–™ä¸Šé€šè¿‡å›ºå®šçš„æ›¿æ¢ç­–ç•¥è·å¾—è‡ªç›‘ç£è¯­æ–™ï¼Œè®¾è®¡é¢„è®­ç»ƒçš„ç›®æ ‡æ¥è®­ç»ƒæ¨¡å‹ï¼Œå…·ä½“çš„å¯ä»¥æè¿°ä¸ºï¼š</p><ul><li>æ›¿æ¢ç­–ç•¥ï¼šåœ¨æ‰€æœ‰è¯­æ–™ä¸­ï¼ŒéšæœºæŠ½å–15%çš„æ–‡æœ¬ã€‚è¢«é€‰ä¸­çš„æ–‡æœ¬ä¸­ï¼Œåˆ™æœ‰80%çš„æ–‡æœ¬ä¸­ï¼ŒéšæœºæŒ‘é€‰ä¸€ä¸ªtokenå¹¶æ›¿æ¢ä¸º <code>[mask]</code>ï¼Œ10%çš„æ–‡æœ¬ä¸­åˆ™éšæœºæŒ‘é€‰ä¸€ä¸ªtokenæ›¿æ¢ä¸ºå…¶ä»–tokenï¼Œ10%çš„æ–‡æœ¬ä¸­ä¿æŒä¸å˜ã€‚</li><li>è®­ç»ƒç›®æ ‡ï¼šå½“æ¨¡å‹é‡è§ <code>[mask]</code> tokenæ—¶ï¼Œåˆ™æ ¹æ®å­¦ä¹ å¾—åˆ°çš„ä¸Šä¸‹æ–‡è¯­ä¹‰å»é¢„æµ‹è¯¥ä½ç½®å¯èƒ½çš„è¯ï¼Œå› æ­¤ï¼Œè®­ç»ƒçš„ç›®æ ‡æ˜¯å¯¹æ•´ä¸ªè¯è¡¨ä¸Šçš„åˆ†ç±»ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨äº¤å‰ä¿¡æ¯ç†µä½œä¸ºç›®æ ‡å‡½æ•°ã€‚</li></ul><p>â€ƒâ€ƒå› æ­¤ä»¥BERTä¸ºä¾‹ï¼Œé¦–å…ˆå–‚å…¥ä¸€ä¸ªæ–‡æœ¬<code>It is very cold today, we need to wear more clothes.</code> ï¼Œç„¶åéšæœºmaskæ‰ä¸€ä¸ªtokenï¼Œå¹¶ç»“åˆä¸€äº›ç‰¹æ®Šæ ‡è®°å¾—åˆ°ï¼š<code>[cls] It is very cold today, we need to [mask] more clothes. [sep]</code> ï¼Œå–‚å…¥åˆ°å¤šå±‚çš„Transformerç»“æ„ä¸­ï¼Œåˆ™å¯ä»¥å¾—åˆ°æœ€åä¸€å±‚æ¯ä¸ªtokençš„éšçŠ¶æ€å‘é‡ã€‚MLMåˆ™é€šè¿‡åœ¨<code>[mask]</code>å¤´éƒ¨æ·»åŠ ä¸€ä¸ªMLPæ˜ å°„åˆ°è¯è¡¨ä¸Šï¼Œå¾—åˆ°æ‰€æœ‰è¯é¢„æµ‹çš„æ¦‚ç‡åˆ†å¸ƒã€‚</p><p>â€ƒâ€ƒç°å¦‚ä»Šæœ‰è¯¸å¤šé’ˆå¯¹MLMçš„æ”¹è¿›ç‰ˆæœ¬ï¼Œæˆ‘ä»¬æŒ‘é€‰ä¸¤ä¸ªç»å…¸çš„æ”¹è¿›è¿›è¡Œä»‹ç»ï¼š</p><ul><li><strong>Whole Word Maskingï¼ˆWWMï¼‰</strong>ï¼šæ¥æºäºRoBERTaç­‰ï¼Œå…¶è®¤ä¸ºBERTç»è¿‡åˆ†è¯åå¾—åˆ°çš„æ˜¯word pieceï¼Œè€ŒBERTçš„MLMåˆ™æ˜¯åŸºäºword pieceè¿›è¡Œéšæœºæ›¿æ¢æ“ä½œçš„ï¼Œå³Single-token Maskingï¼Œå› æ­¤è¢«maskçš„tokenè¯­ä¹‰å¹¶ä¸å®Œæ•´ã€‚è€ŒWWMåˆ™è¡¨ç¤ºè¢«maskçš„å¿…é¡»æ˜¯ä¸€ä¸ªå®Œæ•´çš„å•è¯ã€‚</li><li><strong>Entity Mention Replacementï¼ˆEMRï¼‰</strong>ï¼šæ¥æºäºERNIE-BAIDUç­‰ï¼Œå…¶é€šå¸¸æ˜¯åœ¨çŸ¥è¯†å¢å¼ºçš„é¢„è®­ç»ƒåœºæ™¯ä¸­ï¼Œå³ç»™å®šå·²çŸ¥çš„çŸ¥è¯†åº“ï¼ˆå®ä½“ï¼‰ï¼Œå¯¹æ–‡æœ¬ä¸­çš„æ•´ä¸ªå®ä½“è¿›è¡Œmaskï¼Œè€Œä¸æ˜¯å•ä¸€çš„tokenæˆ–å­—ç¬¦ã€‚</li></ul><p>â€ƒâ€ƒä¸‹é¢ç»™å‡ºå¯¹æ¯”æ ·ä¾‹ã€‚ä»¥æ–‡æœ¬â€œ<em>Michael Jackson is one of the best-selling music artists of all time, with estimated sales of over 400 million records worldwide</em>â€ä¸ºä¾‹ï¼š</p><div class="table-container"><table><thead><tr><th>MLMçš„Maskingç­–ç•¥</th><th>åŸå§‹åˆ†è¯</th><th>è¢«Maskåç»“æœ</th></tr></thead><tbody><tr><td>Single-token Masking</td><td>Michael Jackson is one of the best - ###selling music artists of all time, with estimate ###ed sales of over 400 million records world ###wide</td><td><code>[mask]</code> Jackson is one of the best - ###selling music artists of all time, with estimate <code>[mask]</code> sales of <code>[mask]</code> 400 million records <code>[mask]</code> ###wide.</td></tr><tr><td>Whole Word Masking</td><td>Michael Jackson is one of the best - ###selling music artists of all time, with estimate ###ed sales of over 400 million records world ###wide</td><td><code>[mask]</code> Jackson is one of the <code>[mask]</code> <code>[mask]</code> <code>[mask]</code> music artists of all time, with <code>[mask]</code> <code>[mask]</code> sales of over 400 million records <code>[mask]</code> <code>[mask]</code>.</td></tr><tr><td>Entity Mention Replacement</td><td>Michael Jackson is one of the best - ###selling music artists of all time, with estimate ###ed sales of over 400 million records world ###wide</td><td><code>[mask]</code> <code>[mask]</code> is one of the best - ###selling music artists of all time, with estimate ###ed sales of over 400 million records world ###wide.</td></tr></tbody></table></div><h4 id="ï¼ˆ2ï¼‰Next-Sentence-Predictionï¼ˆNSPï¼‰"><a href="#ï¼ˆ2ï¼‰Next-Sentence-Predictionï¼ˆNSPï¼‰" class="headerlink" title="ï¼ˆ2ï¼‰Next Sentence Predictionï¼ˆNSPï¼‰"></a>ï¼ˆ2ï¼‰Next Sentence Predictionï¼ˆNSPï¼‰</h4><p>â€ƒâ€ƒåœ¨BERTåŸæ–‡ä¸­ï¼Œè¿˜æ·»åŠ äº†NSPä»»åŠ¡ï¼Œå…¶ä¸»è¦ç›®æ ‡æ˜¯ç»™å®šä¸¤ä¸ªå¥å­ï¼Œæ¥åˆ¤æ–­ä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå±äºä¸€ç§è‡ªç„¶è¯­è¨€æ¨ç†ï¼ˆNLIï¼‰ä»»åŠ¡ã€‚åœ¨NSPä¸­åˆ™å­˜åœ¨ä¸‰ç§å…³ç³»ï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li>entailmentï¼ˆisNextï¼‰ï¼šå­˜åœ¨è•´å«å…³ç³»ï¼ŒNSPä¸­åˆ™è®¤ä¸ºç´§ç›¸é‚»çš„ä¸¤ä¸ªå¥å­å±äºentailmentï¼Œå³isNextå…³ç³»ï¼›</li><li>contradictionï¼ˆisNotNextï¼‰ï¼šçŸ›ç›¾å…³ç³»ï¼ŒNSPä¸­åˆ™è®¤ä¸ºè¿™ä¸¤ä¸ªå¥å­ä¸å­˜åœ¨å‰åå…³ç³»ï¼Œä¾‹å¦‚ä¸¤ä¸ªå¥å­æ¥è‡ªäºä¸åŒçš„æ–‡ç« ï¼›</li><li>Neutralï¼šä¸­æ€§å…³ç³»ï¼ŒNSPä¸­è®¤ä¸ºå½“å‰çš„ä¸¤ä¸ªå¥å­å¯èƒ½æ¥è‡ªäºåŒä¸€ç¯‡æ–‡ç« ï¼Œä½†æ˜¯ä¸å±äºisNextå…³ç³»çš„</li></ul><p>è€Œæ˜¾ç„¶ï¼Œæ„å»ºNSPè¯­æ–™ä¹Ÿå¯ä»¥é€šè¿‡è‡ªç›‘ç£çš„æ–¹æ³•è·å¾—ï¼Œé¦–å…ˆç»™å®šä¸€ä¸ªå¤§è§„æ¨¡æ— ç›‘ç£è¯­æ–™ï¼ŒæŒ‰ç…§æ–‡ç« è¿›è¡Œåˆ†ç±»ã€‚åœ¨åŒä¸€ç¯‡æ–‡ç« é‡Œï¼ŒéšæœºæŒ‘é€‰ä¸€ä¸ªå¥å­ä½œä¸ºpremiseï¼Œå› æ­¤entailmentç±»å¯¹åº”çš„åˆ™æ˜¯å…¶ä¸‹ä¸€ä¸ªå¥å­ï¼Œå¦å¤–å†éšæœºæŒ‘é€‰åŒä¸€ç¯‡æ–‡ç« ä¸­çš„å…¶ä»–å¥å­ä½œä¸ºNeutralç±»ï¼Œå…¶ä»–æ–‡ç« ä¸­çš„å¥å­ä½œä¸ºcontradictionç±»ã€‚</p><p>â€ƒâ€ƒåœ¨BERTä¸­ï¼ŒNSPä»»åŠ¡åˆ™è§†ä¸ºsentence-pairä»»åŠ¡ï¼Œä¾‹å¦‚è¾“å…¥ä¸¤ä¸ªå¥å­<code>S1ï¼šIt is very cold today.</code> å’Œ <code>S2ï¼šWe need to wear more clothes.</code>ï¼Œé€šè¿‡æ‹¼æ¥ç‰¹æ®Šå­—ç¬¦åï¼Œå¾—åˆ°ï¼š<code>[cls] It is very cold today. [sep] We need to wear more clothes. [sep]</code>ï¼Œç„¶åå–‚å…¥åˆ°å¤šå±‚Transformerä¸­ï¼Œå¯ä»¥å¾—åˆ°<code>[cls]</code>tokençš„éšçŠ¶æ€å‘é‡ï¼ŒåŒæ ·é€šè¿‡MLPæ˜ å°„åˆ°ä¸€ä¸ª3åˆ†ç±»ä¸Šè·å¾—å„ä¸ªç±»çš„æ¦‚ç‡åˆ†å¸ƒï¼š</p><p><img src="https://img-blog.csdnimg.cn/263c8685ae71488b90f4c6681e844d70.png" alt></p><p>â€ƒâ€ƒåœ¨ä»¥ALBETRã€RoBERTaç­‰ç³»åˆ—çš„æ¨¡å‹ï¼Œç”±äºå‘ç°NSPå¯¹å®éªŒçš„æ•ˆæœå¹¶æ²¡æœ‰å¤ªå¤šæ­£å‘å½±å“ï¼Œå› æ­¤å‡åˆ é™¤äº†NSPçš„ä»»åŠ¡ï¼Œåœ¨åç»­çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ä¸­ï¼Œä¹Ÿçº·çº·æå‡ºå…¶ä»–çš„é¢„è®­ç»ƒç›®æ ‡ï¼Œæœ¬æ–‡ä¸å†è¿‡å¤šèµ˜è¿°ã€‚åœ¨åç»­çš„Prompt-TuningæŠ€æœ¯ä¸­ï¼Œå¤§å¤šæ•°åˆ™ä»¥MLMä½œä¸ºåˆ‡å…¥ç‚¹ã€‚</p><h3 id="1-2-Task-specific-Fine-tuning"><a href="#1-2-Task-specific-Fine-tuning" class="headerlink" title="1.2 Task-specific Fine-tuning"></a>1.2 Task-specific Fine-tuning</h3><p>â€ƒâ€ƒè·å¾—äº†é¢„è®­ç»ƒçš„è¯­è¨€æ¨¡å‹åï¼Œåœ¨é¢å¯¹å…·ä½“çš„ä¸‹æ¸¸ä»»åŠ¡æ—¶ï¼Œåˆ™éœ€è¦è¿›è¡Œå¾®è°ƒã€‚é€šå¸¸å¾®è°ƒçš„ä»»åŠ¡ç›®æ ‡å–å†³äºä¸‹æ¸¸ä»»åŠ¡çš„æ€§è´¨ã€‚æˆ‘ä»¬ç®€å•åˆ—ä¸¾äº†å‡ ç§NLPæœ‰å…³çš„ä¸‹æ¸¸ä»»åŠ¡ï¼š</p><ul><li><strong>Single-text Classificationï¼ˆå•å¥åˆ†ç±»ï¼‰</strong>ï¼šå¸¸è§çš„å•å¥åˆ†ç±»ä»»åŠ¡æœ‰çŸ­æ–‡æœ¬åˆ†ç±»ã€é•¿æ–‡æœ¬åˆ†ç±»ã€æ„å›¾è¯†åˆ«ã€æƒ…æ„Ÿåˆ†æã€å…³ç³»æŠ½å–ç­‰ã€‚ç»™å®šä¸€ä¸ªæ–‡æœ¬ï¼Œå–‚å…¥å¤šå±‚Transformeræ¨¡å‹ä¸­ï¼Œè·å¾—æœ€åä¸€å±‚çš„éšçŠ¶æ€å‘é‡åï¼Œå†è¾“å…¥åˆ°æ–°æ·»åŠ çš„åˆ†ç±»å™¨MLPä¸­è¿›è¡Œåˆ†ç±»ã€‚åœ¨Fine-tuningé˜¶æ®µï¼Œåˆ™é€šè¿‡äº¤å‰ä¿¡æ¯ç†µæŸå¤±å‡½æ•°è®­ç»ƒåˆ†ç±»å™¨ï¼›</li></ul><blockquote><ul><li>çŸ­/é•¿æ–‡æœ¬åˆ†ç±»ï¼šç›´æ¥å¯¹å¥å­è¿›è¡Œå½’ç±»ï¼Œä¾‹å¦‚æ–°é—»å½’ç±»ã€ä¸»é¢˜åˆ†ç±»ã€åœºæ™¯è¯†åˆ«ç­‰ï¼›</li><li>æ„å›¾è¯†åˆ«ï¼šæ ¹æ®ç»™å®šçš„é—®å¥åˆ¤æ–­å…¶æ„å›¾ï¼Œå¸¸ç”¨äºæ£€ç´¢å¼é—®ç­”ã€å¤šè½®å¯¹è¯ã€çŸ¥è¯†å›¾è°±é—®ç­”ç­‰ï¼›</li><li>æƒ…æ„Ÿåˆ†æï¼šå¯¹è¯„è®ºç±»å‹çš„æ–‡æœ¬è¿›è¡Œæƒ…æ„Ÿå–å‘åˆ†ç±»æˆ–æ‰“åˆ†ï¼›</li><li>å…³ç³»æŠ½å–ï¼šç»™å®šä¸¤ä¸ªå®ä½“åŠå¯¹åº”çš„ä¸€ä¸ªæè¿°ç±»å¥å­ï¼Œåˆ¤æ–­è¿™ä¸¤ä¸ªå®ä½“çš„å…³ç³»ç±»å‹ï¼›</li></ul></blockquote><ul><li><strong>Sentence-pair Classificationï¼ˆå¥å­åŒ¹é…/æˆå¯¹åˆ†ç±»ï¼‰</strong>ï¼šå¸¸è§çš„åŒ¹é…ç±»å‹ä»»åŠ¡æœ‰è¯­ä¹‰æ¨ç†ã€è¯­ä¹‰è•´å«ã€æ–‡æœ¬åŒ¹é…ä¸æ£€ç´¢ç­‰ã€‚ç»™å®šä¸¤ä¸ªæ–‡æœ¬ï¼Œç”¨äºåˆ¤æ–­å…¶æ˜¯å¦å­˜åœ¨åŒ¹é…å…³ç³»ã€‚æ­¤æ—¶å°†ä¸¤ä¸ªæ–‡æœ¬æ‹¼æ¥åå–‚å…¥æ¨¡å‹ä¸­ï¼Œè®­ç»ƒç­–ç•¥åˆ™ä¸Single-text Classificationä¸€æ ·ï¼›</li></ul><blockquote><ul><li>è¯­ä¹‰æ¨ç†/è•´å«ï¼šåˆ¤æ–­ä¸¤ä¸ªå¥å­æ˜¯å¦å­˜åœ¨æ¨ç†å…³ç³»ï¼Œä¾‹å¦‚entailmentã€contradictionï¼Œneutralä¸‰ç§æ¨ç†å…³ç³»ï¼›</li><li>æ–‡æœ¬åŒ¹é…ä¸æ£€ç´¢ï¼šè¾“å…¥ä¸€ä¸ªæ–‡æœ¬ï¼Œå¹¶ä»æ•°æ®åº“ä¸­æ£€ç´¢ä¸ä¹‹é«˜ç›¸ä¼¼åº¦åŒ¹é…çš„å…¶ä»–å¥å­</li></ul></blockquote><ul><li><strong>Span Text Predictionï¼ˆåŒºé—´é¢„æµ‹ï¼‰</strong>ï¼šå¸¸è§çš„ä»»åŠ¡ç±»å‹æœ‰æŠ½å–å¼é˜…è¯»ç†è§£ã€å®ä½“æŠ½å–ã€æŠ½å–å¼æ‘˜è¦ç­‰ã€‚ç»™å®šä¸€ä¸ªpassageå’Œqueryï¼Œæ ¹æ®queryå¯»æ‰¾passageä¸­å¯é çš„å­—åºåˆ—ä½œä¸ºé¢„æµ‹ç­”æ¡ˆã€‚é€šå¸¸è¯¥ç±»ä»»åŠ¡éœ€è¦æ¨¡å‹é¢„æµ‹åŒºé—´çš„èµ·å§‹ä½ç½®ï¼Œå› æ­¤åœ¨Transformerå¤´éƒ¨æ·»åŠ ä¸¤ä¸ªåˆ†ç±»å™¨ä»¥é¢„æµ‹ä¸¤ä¸ªä½ç½®ã€‚</li></ul><blockquote><ul><li>æŠ½å–å¼é˜…è¯»ç†è§£ï¼šç»™å®šqueryå’Œpassageï¼Œå¯»æ‰¾passageä¸­çš„ä¸€ä¸ªæ–‡æœ¬åŒºé—´ä½œä¸ºç­”æ¡ˆï¼›</li><li>å®ä½“æŠ½å–ï¼šå¯¹ä¸€æ®µæ–‡æœ¬ä¸­å¯»æ‰¾æ‰€æœ‰å¯èƒ½çš„å®ä½“ï¼›</li><li>æŠ½å–å¼æ‘˜è¦ï¼šç»™å®šä¸€ä¸ªé•¿æ–‡æœ¬æ®µè½ï¼Œå¯»æ‰¾ä¸€ä¸ªæˆ–å¤šä¸ªåŒºé—´ä½œä¸ºè¯¥æ®µè½çš„æ‘˜è¦ï¼›</li></ul></blockquote><ul><li><strong>Single-token Classificationï¼ˆå­—ç¬¦åˆ†ç±»ï¼‰</strong>ï¼šæ­¤ç±»æ¶µç›–åºåˆ—æ ‡æ³¨ã€å®Œå½¢å¡«ç©ºã€æ‹¼å†™æ£€æµ‹ç­‰ä»»åŠ¡ã€‚è·å¾—ç»™å®šæ–‡æœ¬çš„éšçŠ¶æ€å‘é‡åï¼Œå–‚å…¥MLPä¸­ï¼Œè·å¾—æ¯ä¸ªtokenå¯¹åº”çš„é¢„æµ‹ç»“æœï¼Œå¹¶é‡‡ç”¨äº¤å‰ç†µè¿›è¡Œè®­ç»ƒã€‚</li></ul><blockquote><ul><li>åºåˆ—æ ‡æ³¨ï¼šå¯¹ç»™å®šçš„æ–‡æœ¬æ¯ä¸ªtokenè¿›è¡Œæ ‡æ³¨ï¼Œé€šå¸¸æœ‰è¯æ€§æ ‡æ³¨ã€æ§½ä½å¡«å……ã€å¥æ³•åˆ†æã€å®ä½“è¯†åˆ«ç­‰ï¼›</li><li>å®Œå½¢å¡«ç©ºï¼šä¸MLMä¸€è‡´ï¼Œé¢„æµ‹ç»™å®šæ–‡æœ¬ä¸­ç©ºä½å¤„å¯èƒ½çš„è¯</li><li>æ‹¼å†™æ£€æµ‹ï¼šå¯¹ç»™å®šçš„æ–‡æœ¬ä¸­å¯»æ‰¾åœ¨è¯­æ³•æˆ–è¯­ä¹‰ä¸Šçš„é”™è¯¯æ‹¼å†™ï¼Œå¹¶è¿›è¡Œçº æ­£ï¼›</li></ul></blockquote><ul><li><strong>Text Generationï¼ˆæ–‡æœ¬ç”Ÿæˆï¼‰</strong>ï¼šæ–‡æœ¬ç”Ÿæˆä»»åŠ¡å¸¸ç”¨äºç”Ÿæˆå¼æ‘˜è¦ã€æœºå™¨ç¿»è¯‘ã€é—®ç­”ç­‰ã€‚é€šå¸¸é€‰æ‹©å•å‘çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹å®ç°æ–‡æœ¬çš„è‡ªå›å½’ç”Ÿæˆï¼Œå½“ç„¶ä¹Ÿæœ‰éƒ¨åˆ†ç ”ç©¶æ¢ç´¢éè‡ªå›å½’çš„åŒå‘Transformerè¿›è¡Œæ–‡æœ¬ç”Ÿæˆä»»åŠ¡ã€‚BARTç­‰æ¨¡å‹åˆ™ç»“åˆå•å‘å’ŒåŒå‘å®ç°ç”Ÿæˆä»»åŠ¡ã€‚</li></ul><blockquote><ul><li>ç”Ÿæˆå¼æ‘˜è¦ï¼šåœ¨æ–‡æœ¬æ‘˜è¦ä¸­ï¼Œé€šè¿‡ç”Ÿæˆæ–¹æ³•è·å¾—æ‘˜è¦ï¼›</li><li>æœºå™¨ç¿»è¯‘ï¼šç»™å®šåŸå§‹è¯­è¨€çš„æ–‡æœ¬ï¼Œæ¥ç”Ÿæˆç›®æ ‡è¯­è¨€çš„ç¿»è¯‘å¥å­ï¼›</li><li>é—®ç­”ï¼šç»™å®šqueryï¼Œç›´æ¥ç”Ÿæˆç­”æ¡ˆï¼›</li></ul></blockquote><p>â€ƒâ€ƒç›¸å…³çš„ä»»åŠ¡ç±»å‹ã€å¸¸è§çš„Benchmarkä»¥åŠå½¢å¼åŒ–å®šä¹‰å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/f2a4e73f7ca547b1ad287899b08add13.png" alt></p><p>â€ƒâ€ƒè¿™å‡ ç±»ä»»åŠ¡åŸºæœ¬å¯ä»¥æ¶µç›–ç°æœ‰çš„è‡ªç„¶è¯­è¨€å¤„ç†åœºæ™¯ä¸­ï¼Œè€Œè¿™äº”ç±»ä»»åŠ¡åœ¨Fine-tuningé˜¶æ®µå‡ ä¹éƒ½æ¶‰åŠ<strong>åœ¨æ¨¡å‹å¤´éƒ¨å¼•å…¥æ–°å‚æ•°</strong>çš„æƒ…å†µï¼Œä¸”éƒ½å­˜åœ¨<strong>å°æ ·æœ¬åœºæ™¯è¿‡æ‹Ÿåˆ</strong>çš„é—®é¢˜ï¼Œå› æ­¤Prompt-Tuningçš„å¼•å…¥éå¸¸å…³é”®ã€‚</p><hr><h2 id="-1"><a href="#-1" class="headerlink" title=" "></a> </h2><h2 id="ç¬¬äºŒç« ï¼šPrompt-Tuningçš„å®šä¹‰"><a href="#ç¬¬äºŒç« ï¼šPrompt-Tuningçš„å®šä¹‰" class="headerlink" title="ç¬¬äºŒç« ï¼šPrompt-Tuningçš„å®šä¹‰"></a>ç¬¬äºŒç« ï¼šPrompt-Tuningçš„å®šä¹‰</h2><hr><blockquote><p>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼š</p><ul><li>Templateä¸Verbalizerçš„å®šä¹‰ï¼›</li></ul></blockquote><p>â€ƒâ€ƒé‚£ä¹ˆä»€ä¹ˆæ˜¯Promptå‘¢ï¼Ÿåœ¨äº†è§£é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„åŸºç¡€ï¼Œä»¥åŠé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åœ¨Pre-trainingå’ŒFine-tuningä¹‹åï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥é¢„æƒ³åˆ°<strong>Promptçš„ç›®çš„æ˜¯å°†Fine-tuningçš„ä¸‹æ¸¸ä»»åŠ¡ç›®æ ‡è½¬æ¢ä¸ºPre-trainingçš„ä»»åŠ¡</strong>ã€‚é‚£ä¹ˆå…·ä½“å¦‚ä½•å·¥ä½œå‘¢ï¼Ÿ</p><p>â€ƒâ€ƒæˆ‘ä»¬ä¾ç„¶ä»¥äºŒåˆ†ç±»çš„æƒ…æ„Ÿåˆ†æä½œä¸ºä¾‹å­ï¼Œæè¿°Prompt-tuningçš„å·¥ä½œåŸç†ã€‚ç»™å®šä¸€ä¸ªå¥å­<code>[CLS] I like the Disney films very much. [SEP]</code> ä¼ ç»Ÿçš„Fine-tuningæ–¹æ³•æ˜¯å°†å…¶é€šè¿‡BERTçš„Transformerè·å¾— <code>[CLS]</code>è¡¨å¾ä¹‹åå†å–‚å…¥æ–°å¢åŠ çš„MLPåˆ†ç±»å™¨è¿›è¡ŒäºŒåˆ†ç±»ï¼Œé¢„æµ‹è¯¥å¥å­æ˜¯ç§¯æçš„ï¼ˆpositiveï¼‰è¿˜æ˜¯æ¶ˆæçš„ï¼ˆnegativeï¼‰ï¼Œå› æ­¤éœ€è¦ä¸€å®šé‡çš„è®­ç»ƒæ•°æ®æ¥è®­ç»ƒã€‚</p><p>â€ƒâ€ƒè€ŒPrompt-Tuningåˆ™æ‰§è¡Œå¦‚ä¸‹æ­¥éª¤ï¼š</p><ul><li><strong>æ„å»ºæ¨¡æ¿ï¼ˆTemplate Constructionï¼‰</strong>ï¼šé€šè¿‡äººå·¥å®šä¹‰ã€è‡ªåŠ¨æœç´¢ã€æ–‡æœ¬ç”Ÿæˆç­‰æ–¹æ³•ï¼Œç”Ÿæˆä¸ç»™å®šå¥å­ç›¸å…³çš„ä¸€ä¸ªå«æœ‰<code>[MASK]</code>æ ‡è®°çš„æ¨¡æ¿ã€‚ä¾‹å¦‚<code>It was [MASK].</code>ï¼Œå¹¶æ‹¼æ¥åˆ°åŸå§‹çš„æ–‡æœ¬ä¸­ï¼Œè·å¾—Prompt-Tuningçš„è¾“å…¥ï¼š<code>[CLS] I like the Disney films very much. [SEP] It was [MASK]. [SEP]</code>ã€‚å°†å…¶å–‚å…¥BERTæ¨¡å‹ä¸­ï¼Œå¹¶å¤ç”¨é¢„è®­ç»ƒå¥½çš„MLMåˆ†ç±»å™¨ï¼ˆåœ¨huggingfaceä¸­ä¸ºBertForMaskedLMï¼‰ï¼Œå³å¯ç›´æ¥å¾—åˆ°<code>[MASK]</code>é¢„æµ‹çš„å„ä¸ªtokençš„æ¦‚ç‡åˆ†å¸ƒï¼›</li><li><strong>æ ‡ç­¾è¯æ˜ å°„ï¼ˆLabel Word Verbalizerï¼‰</strong>ï¼šå› ä¸º<code>[MASK]</code>éƒ¨åˆ†æˆ‘ä»¬åªå¯¹éƒ¨åˆ†è¯æ„Ÿå…´è¶£ï¼Œå› æ­¤éœ€è¦å»ºç«‹ä¸€ä¸ªæ˜ å°„å…³ç³»ã€‚ä¾‹å¦‚å¦‚æœ<code>[MASK]</code>é¢„æµ‹çš„è¯æ˜¯â€œgreatâ€ï¼Œåˆ™è®¤ä¸ºæ˜¯positiveç±»ï¼Œå¦‚æœæ˜¯â€œterribleâ€ï¼Œåˆ™è®¤ä¸ºæ˜¯negativeç±»ã€‚</li></ul><blockquote><p>â€ƒâ€ƒæ­¤æ—¶ä¼šæœ‰è¯»è€…æ€è€ƒï¼Œä¸åŒçš„å¥å­åº”è¯¥æœ‰ä¸åŒçš„templateå’Œlabel wordï¼Œæ²¡é”™ï¼Œå› ä¸ºæ¯ä¸ªå¥å­å¯èƒ½æœŸæœ›é¢„æµ‹å‡ºæ¥çš„label wordéƒ½ä¸åŒï¼Œå› æ­¤å¦‚ä½•æœ€å¤§åŒ–çš„å¯»æ‰¾å½“å‰ä»»åŠ¡æ›´åŠ åˆé€‚çš„templateå’Œlabel wordæ˜¯Prompt-tuningéå¸¸é‡è¦çš„æŒ‘æˆ˜ã€‚</p></blockquote><ul><li><strong>è®­ç»ƒ</strong>ï¼šæ ¹æ®Verbalizerï¼Œåˆ™å¯ä»¥è·å¾—æŒ‡å®šlabel wordçš„é¢„æµ‹æ¦‚ç‡åˆ†å¸ƒï¼Œå¹¶é‡‡ç”¨äº¤å‰ä¿¡æ¯ç†µè¿›è¡Œè®­ç»ƒã€‚æ­¤æ—¶å› ä¸ºåªå¯¹é¢„è®­ç»ƒå¥½çš„MLM headè¿›è¡Œå¾®è°ƒï¼Œæ‰€ä»¥é¿å…äº†è¿‡æ‹Ÿåˆé—®é¢˜</li></ul><p>â€ƒâ€ƒåœ¨hugging faceä¸Šä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡Œæµ‹è¯•ï¼š</p><ul><li><p><a href="https://huggingface.co/roberta-base?text=I%20like%20the%20Disney%20films%20very%20much.%20It%20was%20%3Cmask%3E.">I like the Disney films very much.</a><br><img src="https://img-blog.csdnimg.cn/4502c82dcfe140d68eee033d8d11120c.png#pic_center" alt></p></li><li><p><a href="https://huggingface.co/roberta-base?text=I%20dislike%20the%20Disney%20films%20very%20much.%20It%20was%20%3Cmask%3E.">I dislike the Disney films very much.</a><br><img src="https://img-blog.csdnimg.cn/4a7118ebed7743b1b271035085d7ee01.png#pic_center" alt></p></li></ul><blockquote><p>â€ƒâ€ƒå…¶å®æˆ‘ä»¬å¯ä»¥ç†è§£ï¼Œå¼•å…¥çš„æ¨¡æ¿å’Œæ ‡ç­¾è¯æœ¬è´¨ä¸Šä¹Ÿå±äºä¸€ç§æ•°æ®å¢å¼ºï¼Œé€šè¿‡æ·»åŠ æç¤ºçš„æ–¹å¼å¼•å…¥å…ˆéªŒçŸ¥è¯†</p></blockquote><hr><h2 id="-2"><a href="#-2" class="headerlink" title=" "></a> </h2><h2 id="ç¬¬ä¸‰ç« ï¼šPrompt-Tuningçš„ç ”ç©¶è¿›å±•"><a href="#ç¬¬ä¸‰ç« ï¼šPrompt-Tuningçš„ç ”ç©¶è¿›å±•" class="headerlink" title="ç¬¬ä¸‰ç« ï¼šPrompt-Tuningçš„ç ”ç©¶è¿›å±•"></a>ç¬¬ä¸‰ç« ï¼šPrompt-Tuningçš„ç ”ç©¶è¿›å±•</h2><hr><blockquote><p>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼š</p><ul><li>GPT-3ï¼›</li><li>Promptçš„å½¢å¼åŒ–å®šä¹‰ã€Promptçš„é›†æˆï¼›</li><li>ç»å…¸çš„Templateçš„æ„å»ºæ–¹æ³•â€”â€”å¯å‘å¼ã€ç”Ÿæˆå¼ã€è¿ç»­æç¤ºã€æ··åˆæç¤ºï¼›</li><li>ç»å…¸çš„Verbalizerçš„æ„å»ºæ–¹æ³•â€”â€”å¯å‘å¼ã€è¿ç»­å¼ã€‚</li></ul></blockquote><p>â€ƒâ€ƒé‚£ä¹ˆPrompt-Tuningå…·ä½“å¦‚ä½•å®ç°ï¼Œå…¶æœ‰ä»€ä¹ˆæŒ‘æˆ˜å’Œå›°éš¾å‘¢ï¼Œæœ¬èŠ‚å°†è¯¦ç»†æè¿°Prompt-Tuningåœ¨å­¦æœ¯ä¸Šçš„å‘å±•å†ç¨‹ã€‚ç”±äºPrompt-Tuningå‘å±•å¾ˆè¿…çŒ›ï¼Œå› æ­¤å¾ˆéš¾ä¿è¯å®Œå…¨æ¶µç›–æ‰€æœ‰è®ºæ–‡å’Œå­¦æœ¯æŠ¥å‘Šï¼Œå› æ­¤æˆ‘ä»¬æŒ‘é€‰ä¸€äº›å…·æœ‰ä»£è¡¨æ€§çš„å·¥ä½œè¿›è¡Œä»‹ç»ã€‚</p><h3 id="3-1-Prompt-Tuningçš„é¼»ç¥–â€”â€”GPT-3ä¸PET"><a href="#3-1-Prompt-Tuningçš„é¼»ç¥–â€”â€”GPT-3ä¸PET" class="headerlink" title="3.1 Prompt-Tuningçš„é¼»ç¥–â€”â€”GPT-3ä¸PET"></a>3.1 Prompt-Tuningçš„é¼»ç¥–â€”â€”GPT-3ä¸PET</h3><p>â€ƒâ€ƒPrompt-Tuningèµ·æºäºGPT-3çš„æå‡º<a href="https://proceedings.neurips.cc/paper/2020/hash/1457c0d6bfcb4967418bfb8ac142f64a-Abstract.html">ã€ŠLanguage Models are Few-Shot Learnersã€‹ï¼ˆNIPS2020ï¼‰</a>ï¼Œå…¶è®¤ä¸ºè¶…å¤§è§„æ¨¡çš„æ¨¡å‹åªè¦é…åˆå¥½åˆé€‚çš„æ¨¡æ¿å°±å¯ä»¥æå¤§åŒ–åœ°å‘æŒ¥å…¶æ¨ç†å’Œç†è§£èƒ½åŠ›ã€‚å…¶å¼€åˆ›æ€§æå‡º<strong>in-context learning</strong>æ¦‚å¿µï¼Œå³æ— é¡»ä¿®æ”¹æ¨¡å‹å³å¯å®ç°few-shot/zero-shot learningã€‚åŒæ—¶å¼•å…¥äº†demonstrate learningï¼Œå³è®©æ¨¡å‹çŸ¥é“ä¸æ ‡ç­¾ç›¸ä¼¼çš„è¯­ä¹‰æè¿°ï¼Œæå‡æ¨ç†èƒ½åŠ›ã€‚</p><ul><li><strong>In-context Learning</strong>ï¼šæ˜¯Promptçš„å‰èº«ã€‚å…¶é€šè¿‡ä»è®­ç»ƒé›†ä¸­æŒ‘é€‰ä¸€äº›æ ·æœ¬ä½œä¸ºä»»åŠ¡çš„æç¤ºæç¤ºï¼ˆNatural Language Promptï¼‰ï¼Œæ¥å®ç°å…å‚æ•°æ›´æ–°çš„æ¨¡å‹é¢„æµ‹ï¼›</li><li><strong>Demonstration Learning</strong>ï¼šæ·»åŠ ä¸€äº›æ–°çš„æ–‡æœ¬ä½œä¸ºæç¤ºã€‚ä¾‹å¦‚åœ¨å¯¹â€œI like the Disney film. It was [MASK]â€è¿›è¡Œæƒ…æ„Ÿåˆ†ææ—¶ï¼Œå¯ä»¥æ‹¼æ¥ä¸€äº›ç›¸ä¼¼åœºæ™¯çš„ground-truthæ–‡æœ¬â€œI like the book, it was great.â€ã€â€œThe music is boring. It is terrible for me.â€ç­‰ã€‚æ­¤æ—¶æ¨¡å‹åœ¨æ ¹æ®æ–°æ·»åŠ çš„ä¸¤ä¸ªæ ·ä¾‹å¥å­å°±å¯ä»¥â€œç…§è‘«èŠ¦ç”»ç“¢â€å¼åœ°é¢„æµ‹ç»“æœäº†ã€‚</li></ul><p>â€ƒâ€ƒä¸è¿‡ä»¥GPT-3ä¸ºé¦–çš„è¿™ç±»æ–¹æ³•æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºé™·æ˜¯â€”â€”<strong>å…¶å»ºç«‹åœ¨è¶…å¤§è§„æ¨¡çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ä¸Š</strong>ï¼Œæ­¤æ—¶çš„æ¨¡å‹å‚æ•°æ•°é‡é€šå¸¸è¶…è¿‡100äº¿ï¼Œ<strong>åœ¨çœŸå®åœºæ™¯ä¸­å¾ˆéš¾åº”ç”¨</strong>ï¼Œå› æ­¤ä¼—å¤šç ”ç©¶è€…å¼€å§‹æ¢ç´¢GPT-3çš„è¿™å¥—æ€è·¯åœ¨å°è§„æ¨¡çš„è¯­è¨€æ¨¡å‹ï¼ˆBERTï¼‰ä¸Šè¿˜æ˜¯å¦é€‚ç”¨ï¼Ÿäº‹å®ä¸Šï¼Œè¿™å¥—æ–¹æ³•åœ¨å°è§„æ¨¡çš„è¯­è¨€æ¨¡å‹ä¸Šæ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„å‡ ç‚¹ï¼š</p><ul><li>æ¨¡å‹å‚æ•°è§„æ¨¡å°äº†ï¼ŒPromptç›´æ¥ç”¨åœ¨Zero-shotä¸Šæ•ˆæœä¼šä¸‹é™ï¼Œå› æ­¤éœ€è¦è€ƒè™‘å°†in-context learningå’Œdemonstrate learningåº”ç”¨åœ¨Fine-tuningé˜¶æ®µï¼›</li><li>GPT-3ä¸­æä¾›çš„æç¤ºï¼ˆNatural Language Promptï¼‰è¿‡äºç®€å•ï¼Œå¹¶ä¸éš¾ä½¿ç”¨åœ¨ä¸€äº›å…·ä½“çš„ä»»åŠ¡åœºæ™¯ï¼Œå› æ­¤éœ€è¦å•ç‹¬è®¾è®¡ä¸€å¥—ç»„ä»¶å®ç°ã€‚</li></ul><p>â€ƒâ€ƒå› æ­¤ï¼Œå¤§åé¼é¼çš„PETæ¨¡å‹é—®ä¸–ï¼ŒPETï¼ˆPattern-Exploiting Trainingï¼‰å‡ºè‡ª<a href="https://doi.org/10.18653/v1/2021.eacl-main.20">ã€ŠExploiting Cloze Questions for Few Shot Text Classification and Natural Language Inferenceã€‹ï¼ˆEACL2021ï¼‰</a>ï¼Œæ ¹æ®è®ºæ–‡é¢˜ç›®åˆ™å¯ä»¥çŒœå‡ºï¼ŒPrompt-Tuningå¯å‘äºæ–‡æœ¬åˆ†ç±»ä»»åŠ¡ï¼Œå¹¶ä¸”è¯•å›¾å°†æ‰€æœ‰çš„åˆ†ç±»ä»»åŠ¡è½¬æ¢ä¸ºä¸MLMä¸€è‡´çš„å®Œå½¢å¡«ç©ºã€‚PETè¯¦ç»†åœ°è®¾è®¡äº†Prompt-Tuningçš„é‡è¦ç»„ä»¶â€”â€”Pattern-Verbalizer-Pairï¼ˆPVPï¼‰ï¼Œå¹¶æè¿°äº†Prompt-tuningå¦‚ä½•å®ç°Few-shot/Zero-shot Learningï¼Œå¦‚ä½•åº”ç”¨åœ¨å…¨ç›‘ç£å’ŒåŠç›‘ç£åœºæ™¯ï¼ˆiPETï¼‰ã€‚PETçš„è¯¦ç»†è®²è§£å¯å‚è€ƒ<a href="https://wjn1996.blog.csdn.net/article/details/120788059">PETçš„è®ºæ–‡è§£è¯»</a></p><p>â€ƒâ€ƒPETè®¾è®¡äº†ä¸¤ä¸ªå¾ˆé‡è¦çš„ç»„ä»¶ï¼š</p><ul><li><strong>Patternï¼ˆTemplateï¼‰</strong>ï¼šè®°ä½œ T \mathcal{T} T ï¼Œå³ä¸Šæ–‡æåˆ°çš„Templateï¼Œå…¶ä¸ºé¢å¤–æ·»åŠ çš„å¸¦æœ‰<code>[mask]</code>æ ‡è®°çš„çŸ­æ–‡æœ¬ï¼Œé€šå¸¸ä¸€ä¸ªæ ·æœ¬åªæœ‰ä¸€ä¸ªPatternï¼ˆå› ä¸ºæˆ‘ä»¬å¸Œæœ›åªæœ‰1ä¸ªè®©æ¨¡å‹é¢„æµ‹çš„<code>[mask]</code>æ ‡è®°ï¼‰ã€‚ä¸Šæ–‡ä¹Ÿæåˆ°ï¼Œä¸åŒçš„ä»»åŠ¡ã€ä¸åŒçš„æ ·æœ¬å¯èƒ½ä¼šæœ‰å…¶æ›´åŠ åˆé€‚çš„patternï¼Œå› æ­¤<strong>å¦‚ä½•æ„å»ºåˆé€‚çš„patternæ˜¯Prompt-Tuningçš„ç ”ç©¶ç‚¹ä¹‹ä¸€</strong>ï¼›</li><li><strong>Verbalizer</strong>ï¼šè®°ä½œ V \mathcal{V} V ï¼Œå³æ ‡ç­¾è¯çš„æ˜ å°„ï¼Œå¯¹äºå…·ä½“çš„åˆ†ç±»ä»»åŠ¡ï¼Œéœ€è¦é€‰æ‹©æŒ‡å®šçš„æ ‡ç­¾è¯ï¼ˆlabel wordï¼‰ã€‚ä¾‹å¦‚æƒ…æ„Ÿåˆ†æä¸­ï¼Œæˆ‘ä»¬æœŸæœ›Verbalizerå¯èƒ½æ˜¯ V ( positive ) = great \mathcal{V}(\text{positive})=\text{great} V(positive)\=greatï¼Œ V ( negative ) = terrible \mathcal{V}(\text{negative})=\text{terrible} V(negative)\=terrible ï¼ˆpositiveå’Œnegativeæ˜¯ç±»æ ‡ç­¾ï¼‰ã€‚åŒæ ·ï¼Œä¸åŒçš„ä»»åŠ¡æœ‰å…¶ç›¸åº”çš„label wordï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒVerbalizerçš„æ„å»ºéœ€è¦å–å†³äºå¯¹åº”çš„Patternã€‚å› æ­¤<strong>å¦‚ä½•æ„å»ºVerbalizeræ˜¯å¦ä¸€ä¸ªç ”ç©¶æŒ‘æˆ˜</strong>ã€‚<br>ä¸Šè¿°ä¸¤ä¸ªç»„ä»¶è¢«ç§°ä¸ºPattern-Verbalizer-Pairï¼ˆPVPï¼‰ï¼Œä¸€èˆ¬è®°ä½œ P = ( T , V ) \mathcal{P}=(\mathcal{T}, \mathcal{V}) P\=(T,V)ï¼Œåœ¨åç»­çš„å¤§å¤šæ•°ç ”ç©¶ä¸­å‡é‡‡ç”¨è¿™ç§PVPç»„ä»¶ã€‚</li></ul><p>â€ƒâ€ƒå› æ­¤åŸºäºPVPçš„è®­ç»ƒç›®æ ‡å¯ä»¥å½¢å¼åŒ–æè¿°ï¼š</p><blockquote><p>â€ƒâ€ƒç»™å®šä¸€ä¸ªå¥å­ x x x ï¼Œä»¥åŠå¯¹åº”çš„æ ‡ç­¾ y y yï¼Œç»™å®šå®šä¹‰çš„PVPç»„ä»¶ P = ( T , V ) \mathcal{P}=(\mathcal{T}, \mathcal{V}) P\=(T,V)ï¼Œåˆ™æœ‰ï¼š<br>p ( y âˆ£ x ) = âˆ j = 1 n p ( [ m a s k ] j = V ( y ) âˆ£ T ( x ) ) p(y|x) = \prod_{j=1}^{n}p([mask]_j=\mathcal{V}(y)|\mathcal{T}(x)) p(yâˆ£x)\=j\=1âˆnp([mask]j\=V(y)âˆ£T(x))</p></blockquote><p>â€ƒâ€ƒé‚£ä¹ˆä¼šæœ‰è¯»è€…ä¸€ç›´ä¼šæ€è€ƒï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå¥å­åªèƒ½æœ‰ä¸€ä¸ªPVPï¼ˆå› ä¸ºæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ª<code>[mask]</code>ç”¨æ¥é¢„æµ‹ï¼‰ï¼Œè¿™å¯èƒ½å¹¶ä¸æ˜¯æœ€ä¼˜çš„ï¼Œæ˜¯å¦å¯ä»¥ä¸ºä¸€ä¸ªå¥å­è®¾è®¡å¤šä¸ªä¸åŒçš„PVPå‘¢ï¼Ÿè¿™æ˜¯å¯ä»¥çš„ï¼Œè¿™å±äºPrompt-Tuningçš„é›†æˆã€‚PETæä¾›äº†ç®€å•çš„é›†æˆæ€è·¯ï¼š</p><p>â€ƒâ€ƒPETè¿˜æä¾›äº†åŠç›‘ç£çš„å­¦ä¹ æ–¹æ³•â€”â€”iterative PETï¼ˆiPETï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/30855d02e275415d915c39771342eb3d.png" alt></p><p>â€ƒâ€ƒiPETæ—¨åœ¨å…ˆä»é¢„è®­ç»ƒæ¨¡å‹å¼€å§‹ï¼Œåˆå§‹åŒ–å¤šä¸ªä¸åŒçš„æ¨¡å‹ï¼ˆå›¾ä¸­1æ­¥éª¤ï¼‰ï¼Œåœ¨æœ‰æ ‡æ³¨çš„å°‘é‡æ ·æœ¬ä¸Šè¿›è¡ŒPrompt-Tuningï¼Œç„¶åé€šè¿‡å¤šä¸ªä¸åŒçš„PVPè®­ç»ƒå¾—åˆ°å¤šä¸ªä¸åŒçš„æ¨¡å‹ï¼ˆå›¾ä¸­aæ­¥éª¤ï¼‰ï¼Œæ¯ä¸ªæ¨¡å‹åœ¨æ— æ ‡æ³¨æ•°æ®ä¸Šè¿›è¡Œæ¨ç†æ‰“æ ‡ï¼Œå¹¶æ ¹æ®ç½®ä¿¡åº¦ç­›é€‰ï¼ˆå›¾ä¸­bæ­¥éª¤ï¼‰ï¼Œæ ¹æ®æ–°æ ‡æ³¨çš„æ•°æ®ä¸åŸå§‹æ ‡æ³¨æ•°æ®èåˆåï¼Œå†é‡æ–°è¿›è¡ŒPrompt-Tuningï¼ˆå›¾ä¸­cæ­¥éª¤ï¼‰ï¼Œé‡å¤abcä¸‰ä¸ªæ­¥éª¤å¤šæ¬¡åï¼Œè·å¾—æ¯ä¸ªæ¨¡å‹åï¼Œåœ¨æµ‹è¯•æ—¶è¿›è¡Œé›†æˆæŠ•ç¥¨ï¼ˆå›¾ä¸­2ã€3æ­¥éª¤ï¼‰ã€‚</p><p>â€ƒâ€ƒå› æ­¤å¯ä»¥è¯´ï¼ŒPETæä¾›Prompt-Tuningæ¯”è¾ƒæˆç†Ÿçš„æ¡†æ¶â€”â€”PVPï¼ŒåŸºäºè¿™å¥—æ¡†æ¶ï¼Œç›®å‰çš„ç ”ç©¶å¼€å§‹å…³æ³¨<strong>å¦‚ä½•é€‰æ‹©æˆ–æ„å»ºåˆé€‚çš„Patternå’ŒVerbalizer</strong>ã€‚ä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯æ ¹æ®ç‰¹å®šä»»åŠ¡çš„æ€§è´¨å’Œå…ˆéªŒçŸ¥è¯†äººå·¥è®¾è®¡æ¨¡æ¿ã€‚ä¾‹å¦‚ä¸Šæ–‡ä¾‹å­ä¸­é€šå¸¸ä¼šé€‰æ‹©<code>It was [mask].</code> ä½œä¸ºæƒ…æ„Ÿåˆ†æç±»çš„æ¨¡æ¿ã€‚äººå·¥æ„å»ºæ–¹æ³•è™½ç„¶ç›´è§‚ç®€å•ï¼Œä½†æ˜¯è‡´å‘½é—®é¢˜ä¹Ÿå¾ˆçªå‡ºã€‚æœ‰ç›¸å…³å·¥ä½œåœ¨å®éªŒä¸­å‘ç°ï¼Œåœ¨åŒæ ·çš„æ•°æ®é›†å’Œè®­ç»ƒæ¡ä»¶ä¸‹ï¼Œ<strong>é€‰æ‹©ä¸åŒçš„Patternå’ŒVerbalizerä¼šäº§ç”Ÿå·®å¼‚å¾ˆå¤§çš„ç»“æœ</strong>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒTemplateç­‰åŒäºPatternï¼ŒVerbalizerç­‰åŒäºLabel wordï¼‰ï¼š</p><p><img src="https://img-blog.csdnimg.cn/1c0ee1c886a04269a2d64191524a58db.png#pic_center" alt></p><p>å¯å‘ç°ï¼Œåœ¨ç›¸åŒPatternæ—¶ï¼Œé€‰æ‹©ä¸åŒçš„label wordå¯¹ç»“æœå½±å“å¾ˆå¤§ï¼ŒåŒç†ï¼Œä¸åŒçš„Patternå¯¹ç»“æœå½±å“ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œåœ¨çœŸæ­£åº”ç”¨ä¸­ï¼Œè°ƒå‚è€…éœ€è¦å°è¯•å¤šä¸ªä¸åŒçš„æ¨¡æ¿å’Œæ ‡ç­¾è¯ä»¥ç©·ä¸¾å‡ºæœ€å¥½çš„ç»“æœï¼Œå¹¶ä¸èƒ½å……åˆ†å‘æŒ¥Promptç®€å•å¿«æ·çš„ä¼˜åŠ¿ã€‚å› æ­¤æˆ‘ä»¬æ€»ç»“äººå·¥è®¾è®¡æ–¹æ³•çš„ç¼ºé™·ï¼š</p><ul><li>é‡‡ç”¨äººå·¥æ„å»ºçš„æ–¹æ³•æˆæœ¬é«˜ï¼Œéœ€è¦ä¸é¢†åŸŸä»»åŠ¡ç›¸å…³çš„å…ˆéªŒçŸ¥è¯†ï¼›</li><li>äººå·¥è®¾è®¡çš„Patternå’ŒVerbalizerä¸èƒ½ä¿è¯è·å¾—æœ€ä¼˜è§£ï¼Œè®­ç»ƒä¸ç¨³å®šï¼Œä¸åŒçš„PVPå¯¹ç»“æœäº§ç”Ÿçš„å·®å¼‚æ˜æ˜¾ï¼Œæ–¹å·®å¤§ï¼›</li><li>åœ¨é¢„è®­ç»ƒé˜¶æ®µMLMä»»åŠ¡å¹¶éå®Œå…¨æŒ‰ç…§PVPçš„æ¨¡å¼è¿›è¡Œè®­ç»ƒçš„ï¼ˆæ¯”å¦‚MLMè®­ç»ƒé€šå¸¸éƒ½æ˜¯é•¿æ–‡æœ¬ï¼Œmaskçš„æ•°é‡ä¹Ÿå¹¶éåªæœ‰1ä¸ªï¼Œé¢„æµ‹çš„æ¦‚ç‡åˆ†å¸ƒä¹Ÿå¹¶éæ˜¯æœ‰é™çš„ï¼‰ï¼Œå› æ­¤äººå·¥æ„å»ºçš„Patternå’ŒVerbalizerä½¿å¾—Prompt-Tuningä¸MLMåœ¨è¯­ä¹‰å’Œåˆ†å¸ƒä¸Šä¾ç„¶å­˜åœ¨å·®å¼‚ã€‚</li></ul><p>â€ƒâ€ƒå› æ­¤å¦‚ä½•èƒ½å¤Ÿè‡ªåŠ¨åœ°æŒ‘é€‰åˆé€‚çš„PVPï¼Ÿ</p><h3 id="3-2-å¦‚ä½•æŒ‘é€‰åˆé€‚çš„Patternï¼Ÿ"><a href="#3-2-å¦‚ä½•æŒ‘é€‰åˆé€‚çš„Patternï¼Ÿ" class="headerlink" title="3.2 å¦‚ä½•æŒ‘é€‰åˆé€‚çš„Patternï¼Ÿ"></a>3.2 å¦‚ä½•æŒ‘é€‰åˆé€‚çš„Patternï¼Ÿ</h3><p>â€ƒâ€ƒè‡ª2020å¹´åº•è‡³ä»Šï¼Œå­¦æœ¯ç•Œå·²ç»æ¶Œç°å‡ºä¸€æ‰¹åŸºäºPrompt-Tuningçš„æ–¹æ¡ˆè¯•å›¾æ¢ç´¢å¦‚ä½•è‡ªåŠ¨æ„å»ºPVPã€‚æœ¬èŠ‚ä¸»è¦æ€»ç»“å‡ ç§æˆç†Ÿçš„Patternï¼ˆTemplateï¼‰æ„å»ºæ–¹æ³•ã€‚å¯ä»¥ç½—åˆ—ä¸ºå¦‚ä¸‹å‡ ç‚¹ï¼š</p><ul><li><strong>äººå·¥æ„å»ºï¼ˆManual Templateï¼‰</strong>ï¼šåœ¨å‰æ–‡å·²ç»æè¿°è¿‡ï¼Œä¸å†è¯¦ç»†è¯´æ˜ï¼›</li><li><strong>å¯å‘å¼æ³•ï¼ˆHeuristic-based Templateï¼‰</strong>ï¼šé€šè¿‡è§„åˆ™ã€å¯å‘å¼æœç´¢ç­‰æ–¹æ³•æ„å»ºåˆé€‚çš„æ¨¡æ¿ï¼›</li><li><strong>ç”Ÿæˆï¼ˆGenerationï¼‰</strong>ï¼šæ ¹æ®ç»™å®šçš„ä»»åŠ¡è®­ç»ƒæ•°æ®ï¼ˆé€šå¸¸æ˜¯å°æ ·æœ¬åœºæ™¯ï¼‰ï¼Œç”Ÿæˆå‡ºåˆé€‚çš„æ¨¡æ¿ï¼›</li><li><strong>è¯å‘é‡å¾®è°ƒï¼ˆWord Embeddingï¼‰</strong>ï¼šæ˜¾å¼åœ°å®šä¹‰ç¦»æ•£å­—ç¬¦çš„æ¨¡æ¿ï¼Œä½†åœ¨è®­ç»ƒæ—¶è¿™äº›æ¨¡æ¿å­—ç¬¦çš„è¯å‘é‡å‚ä¸æ¢¯åº¦ä¸‹é™ï¼Œåˆå§‹å®šä¹‰çš„ç¦»æ•£å­—ç¬¦ç”¨äºä½œä¸ºå‘é‡çš„åˆå§‹åŒ–ï¼›</li><li><strong>ä¼ªæ ‡è®°ï¼ˆPseudo Tokenï¼‰</strong>ï¼šä¸æ˜¾å¼åœ°å®šä¹‰ç¦»æ•£çš„æ¨¡æ¿ï¼Œè€Œæ˜¯å°†æ¨¡æ¿ä½œä¸ºå¯è®­ç»ƒçš„å‚æ•°ï¼›</li></ul><p>â€ƒâ€ƒå‰é¢3ç§ä¹Ÿè¢«ç§°ä¸º<strong>ç¦»æ•£çš„æ¨¡æ¿æ„å»º</strong>æ³•ï¼ˆè®°ä½œ<strong>Hard Template</strong>ã€<strong>Hard Prompt</strong>ã€<strong>Discrete Template</strong>ã€<strong>Discrete Prompt</strong>ï¼‰ï¼Œå…¶æ—¨åœ¨ç›´æ¥ä¸åŸå§‹æ–‡æœ¬æ‹¼æ¥æ˜¾å¼ç¦»æ•£çš„å­—ç¬¦ï¼Œä¸”åœ¨è®­ç»ƒä¸­<strong>å§‹ç»ˆä¿æŒä¸å˜</strong>ã€‚è¿™é‡Œçš„ä¿æŒä¸å˜æ˜¯æŒ‡<strong>è¿™äº›ç¦»æ•£å­—ç¬¦çš„è¯å‘é‡ï¼ˆWord Embeddingï¼‰åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¿æŒå›ºå®š</strong>ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œ<strong>ç¦»æ•£æ³•ä¸éœ€è¦å¼•å…¥ä»»ä½•å‚æ•°</strong>ã€‚</p><p>â€ƒâ€ƒåé¢2ç§åˆ™è¢«ç§°ä¸º<strong>è¿ç»­çš„æ¨¡æ¿æ„å»º</strong>æ³•ï¼ˆè®°ä½œ<strong>Soft Template</strong>ã€<strong>Soft Prompt</strong>ã€<strong>Continuous Template</strong>ã€<strong>Continuous Prompt</strong>ï¼‰ï¼Œå…¶æ—¨åœ¨è®©æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ ¹æ®å…·ä½“çš„ä¸Šä¸‹æ–‡è¯­ä¹‰å’Œä»»åŠ¡ç›®æ ‡å¯¹æ¨¡æ¿å‚æ•°è¿›è¡Œè¿ç»­å¯è°ƒã€‚è¿™å¥—æ–¹æ¡ˆçš„åŠ¨æœºåˆ™æ˜¯è®¤ä¸ºç¦»æ•£ä¸å˜çš„æ¨¡æ¿æ— æ³•å‚ä¸æ¨¡å‹çš„è®­ç»ƒç¯èŠ‚ï¼Œå®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼Œè€Œå¦‚æœå°†æ¨¡æ¿å˜ä¸ºå¯è®­ç»ƒçš„å‚æ•°ï¼Œé‚£ä¹ˆä¸åŒçš„æ ·æœ¬éƒ½å¯ä»¥åœ¨è¿ç»­çš„å‘é‡ç©ºé—´ä¸­å¯»æ‰¾åˆé€‚çš„ä¼ªæ ‡è®°ï¼ŒåŒæ—¶ä¹Ÿå¢åŠ æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚å› æ­¤ï¼Œ<strong>è¿ç»­æ³•éœ€è¦å¼•å…¥å°‘é‡çš„å‚æ•°å¹¶è®©æ¨¡å‹åœ¨è®­ç»ƒæ—¶è¿›è¡Œå‚æ•°æ›´æ–°</strong>ã€‚</p><p>â€ƒâ€ƒä¸‹é¢ç®€å•ä»‹ç»å‡ ä¸ªç»å…¸çš„æ–¹æ³•ï¼š</p><h4 id="ï¼ˆ1ï¼‰å¯å‘å¼æ³•æ„å»ºæ¨¡æ¿"><a href="#ï¼ˆ1ï¼‰å¯å‘å¼æ³•æ„å»ºæ¨¡æ¿" class="headerlink" title="ï¼ˆ1ï¼‰å¯å‘å¼æ³•æ„å»ºæ¨¡æ¿"></a>ï¼ˆ1ï¼‰å¯å‘å¼æ³•æ„å»ºæ¨¡æ¿</h4><p>â€ƒâ€ƒ<strong>å¯å‘å¼æ³•ä¸€èˆ¬æ˜¯é‡‡ç”¨è§„åˆ™ã€æ­£åˆ™åŒ–æ¨¡æ¿çš„æ–¹æ³•è‡ªåŠ¨æ„å»ºå‡ºç›¸åº”çš„Patternï¼Œæˆ–è€…ç›´æ¥é€šè¿‡å¯å‘å¼æœç´¢çš„æ–¹æ³•è·å¾—Patternã€‚</strong> è¿™ä¸€ç±»æ–¹æ³•åœ¨ç¨‹åºè®¾è®¡æ—¶åªéœ€è¦ç¼–å†™è§„åˆ™å’Œå°‘é‡çš„æ¨¡æ¿å³å¯å¿«é€Ÿçš„è·å¾—Patternã€‚</p><p>â€ƒâ€ƒç»™å®šä¸€ä¸ªå…·ä½“çš„ä»»åŠ¡ï¼ˆä¾‹å¦‚åˆ†ç±»ä»»åŠ¡ï¼‰ï¼Œå¯ä»¥å®ç°å®šä¹‰è‹¥å¹²ä¸ªæ¨¡æ¿ï¼ˆä¾‹å¦‚æ­£åˆ™åŒ–å·¥å…·ï¼‰ï¼Œç„¶åæ ¹æ®å…·ä½“çš„å¥å­å†…å®¹ï¼Œå‘æ¨¡æ¿ä¸­å¡«å……ç›¸å…³å®ä½“ï¼Œä»¥è´´åˆå¥å­å®é™…çš„æè¿°ã€‚ä¾‹å¦‚æ¸…åå¤§å­¦åˆ˜çŸ¥è¿œå›¢é˜Ÿæå‡ºçš„<strong>PTR</strong>ï¼ˆ<a href="https://arxiv.org/abs/2105.11259">PTR: Prompt Tuning with Rules for Text Classification</a>ï¼‰åˆ©ç”¨å¯å‘å¼çš„è§„åˆ™å®šä¹‰è‹¥å¹²å­æ¨¡æ¿ï¼ˆsub-promptï¼‰ï¼Œå¹¶é€šè¿‡è‹¥å¹²å­æ¨¡æ¿çš„ç»„åˆæ¥å½¢æˆæœ€ç»ˆçš„Patternã€‚</p><blockquote><p>â€ƒâ€ƒä¾‹å¦‚åœ¨å…³ç³»æŠ½å–ä»»åŠ¡ä¸­ï¼Œé€šå¸¸ç»™å®šä¸€ä¸ªçŸ­æ–‡æœ¬ï¼Œä¸¤ä¸ªå®ä½“ï¼ˆè®°ä½œsubjectå’Œobjectï¼‰ï¼Œå‡å¦‚ç»™å®šå¥å­â€œ<em>Mark Twain was the father of Langdon.</em> â€ä»¥åŠä¸¤ä¸ªå®ä½“â€œ<em>Mark Twain</em>â€å’Œâ€œ<em>Landon</em>â€ã€‚é‚£ä¹ˆå¯ä»¥å®šä¹‰3ä¸ªå­æ¨¡æ¿ï¼š</p><ul><li>å¤´å®ä½“ï¼ˆsubject entityï¼‰ï¼š f s = f_s= fs\= the [mask] x s x_s xsï¼Œå¯¹åº”äºï¼šâ€œthe [mask] Mark Twainâ€ï¼Œå¯ç”¨äºé¢„æµ‹å¤´å®ä½“çš„ç±»å‹ï¼›</li><li>å°¾å®ä½“ï¼ˆobject entityï¼‰ï¼š f o = f_o= fo\= the [mask] x o x_o xoï¼Œå¯¹åº”äºï¼šâ€œthe [mask] Landonâ€ï¼Œå¯ç”¨äºå°¾å®ä½“çš„ç±»å‹ï¼›</li><li>å®ä½“å…³ç³»ï¼ˆrelationï¼‰ï¼š f r = x s [mask] x o f_r=x_s\text{[mask]}x_o fr\=xs[mask]xo ï¼Œå¯¹åº”äºï¼šâ€œMark Twain [mask] Landonâ€ï¼Œå¯ç”¨äºå¤´å°¾å®ä½“å…³ç³»ï¼›</li></ul><p>â€ƒâ€ƒåŸºäºä¸Šè¿°å®šä¹‰çš„3ä¸ªè§„åˆ™ï¼Œåˆ™å¯ä»¥ç»“åˆèµ·æ¥å½¢æˆæœ€ç»ˆæ¨¡æ¿ï¼Œå³ f = f s âˆ§ f r âˆ§ f o f=f_s\wedge f_r\wedge f_o f\=fsâˆ§frâˆ§foï¼Œå³â€œthe [mask] Mark Twain [mask] the [mask] Landonâ€ã€‚å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="https://img-blog.csdnimg.cn/495b824af1104145b60913b3e37b06ec.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5Y2O5biI5pWw5o2u5a2m6ZmiwrfnjovlmInlroE=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>PTRçš„è¯¦ç»†è§£è¯»è¯·å‚è€ƒåšä¸»çš„è®ºæ–‡è§£è¯»ï¼š<a href="https://wjn1996.blog.csdn.net/article/details/120256178">è®ºæ–‡è§£è¯»ï¼šPTR: Prompt Tuning with Rules fo Text Classification</a></p></blockquote><p>â€ƒâ€ƒå› æ­¤ä¸è®ºç»™å®šå“ªä¸ªå¥å­ï¼Œæ¨¡æ¿ä¸ä¼šå®Œå…¨å›ºå®šä¸å˜ï¼Œè€Œæ˜¯æ ¹æ®ä¸åŒçš„å®ä½“è€Œç›¸åº”æ”¹å˜æ¨¡æ¿çš„å­—ç¬¦åºåˆ—ã€‚<br>â€ƒâ€ƒç›¸æ¯”ä¹‹ä¸‹ï¼Œ<strong>AutoPrompt</strong>åˆ™æ˜¯å¦ä¸€ç§å…¸å‹çš„æ–¹æ³•ï¼Œå…¶ç”±åŠ å·å¤§å­¦æå‡º<a href="https://aclanthology.org/2020.emnlp-main.346.pdf">ã€ŠAutoPrompt: Eliciting Knowledge from Language Models with Automatically Generated Promptsï¼ˆEMNLP2021ï¼‰</a>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç»™å®šåŸå§‹çš„è¾“å…¥ï¼Œé¢å¤–å®šä¹‰è‹¥å¹²ç¦»æ•£çš„å­—ç¬¦ä½œä¸ºtriggerï¼Œå¹¶ç»„æˆTemplateï¼Œå–‚å…¥MLMä¸­é¢„æµ‹å¯¹åº”label wordçš„æ¦‚ç‡ã€‚è€Œè¿™äº›triggeræœ€ç»ˆé€šè¿‡æ¢¯åº¦æœç´¢çš„æ–¹æ³•è¿›è¡ŒæŒ‘é€‰ã€‚</p><p><img src="https://img-blog.csdnimg.cn/2f7373e55a7742db9991e5982396d231.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5Y2O5biI5pWw5o2u5a2m6ZmiwrfnjovlmInlroE=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="ï¼ˆ2ï¼‰ç”Ÿæˆæ³•æ„å»ºæ¨¡æ¿"><a href="#ï¼ˆ2ï¼‰ç”Ÿæˆæ³•æ„å»ºæ¨¡æ¿" class="headerlink" title="ï¼ˆ2ï¼‰ç”Ÿæˆæ³•æ„å»ºæ¨¡æ¿"></a>ï¼ˆ2ï¼‰ç”Ÿæˆæ³•æ„å»ºæ¨¡æ¿</h4><p>â€ƒâ€ƒåŸºäºè§„åˆ™çš„æ–¹æ³•æ„å»ºçš„æ¨¡æ¿è™½ç„¶ç®€å•ï¼Œä½†æ˜¯è¿™äº›æ¨¡æ¿éƒ½æ˜¯â€œ<strong>ä¸€ä¸ªæ¨¡å­åˆ»å‡ºæ¥çš„</strong>â€ï¼Œåœ¨è¯­ä¹‰ä¸Šå…¶å®æŒºéš¾åšåˆ°ä¸å¥å­è´´åˆã€‚å› æ­¤ä¸€ç§ç­–ç•¥å°±æ˜¯<strong>ç›´æ¥è®©æ¨¡å‹æ¥ç”Ÿæˆåˆé€‚çš„æ¨¡æ¿</strong>ï¼Œå› ä¸ºæ–‡æœ¬ç”Ÿæˆæœ¬è´¨ä¸Šå°±æ˜¯å»ç†è§£åŸå§‹æ–‡æœ¬çš„è¯­ä¹‰ï¼Œå¹¶è·å¾—åœ¨è¯­ä¹‰ä¸Šè¾ƒä¸ºç›¸å…³çš„æ–‡æœ¬ã€‚è¿™æ ·ä¸è®ºç»™å®šä»€ä¹ˆå¥å­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°åœ¨è¯­ä¹‰å±‚é¢ä¸Šæ›´åŠ è´´åˆçš„æ¨¡æ¿ã€‚é™ˆä¸¹ç¦å›¢é˜Ÿæå‡º<strong>LM-BFF</strong>åˆ™ä½œä¸ºè¯¥ç±»æ–¹æ³•çš„å…¸èŒƒï¼Œå…¶å‡ºè‡ªäº<a href="https://doi.org/10.18653/v1/2021.acl-long.295">ã€ŠMaking Pre-trained Language Models Better Few-shot Learnersã€‹ï¼ˆACL2021ï¼‰</a>ã€‚LM-BFFæå‡ºäº†åŸºäºç”Ÿæˆçš„æ–¹æ³•æ¥æ„å»ºPatternï¼Œè€Œç»™å®šç›¸åº”çš„Patternä¹‹åï¼Œå†é€šè¿‡æœç´¢çš„æ–¹æ³•å¾—åˆ°ç›¸åº”çš„Verbalizerã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/e0dc87ed8e114c4abf4986a243477aed.png#pic_center" alt></p><p>â€ƒâ€ƒé¦–å…ˆå®šä¹‰ä¸€ä¸ªTemplateçš„æ¯ç‰ˆï¼ˆæœ‰ç‚¹ç±»ä¼¼äºPTRä¸­çš„å«æœ‰å ä½ç¬¦çš„å­æ¨¡æ¿ï¼‰ï¼Œå°†è¿™äº›æ¯ç‰ˆä¸åŸå§‹æ–‡æœ¬æ‹¼æ¥åå–‚å…¥T5æ¨¡å‹ï¼ˆT5æ¨¡å‹å±äºè‡ªå›å½’å¼çš„ç”Ÿæˆæ¨¡å‹ï¼‰ååœ¨<X>å’Œ<Y>å ä½ç¬¦éƒ¨åˆ†ç”Ÿæˆç›¸åº”çš„å­—ç¬¦ï¼Œæœ€ç»ˆå½¢æˆå¯¹åº”çš„Templateã€‚ç„¶åå†åŸºäºç”Ÿæˆçš„Templateå’Œlabel wordè¿›è¡Œè®­ç»ƒã€‚</Y></X></p><p>â€ƒâ€ƒé€šè¿‡å¤šä¸ªä»»åŠ¡çš„å°æ ·æœ¬åœºæ™¯æµ‹è¯•ï¼ˆåˆ†ç±»ä»»åŠ¡ï¼Œæ¯ä¸ªç±»åªæœ‰16ä¸ªæ ·æœ¬ï¼‰ï¼Œæ•´ä½“è§‚å¯Ÿå¯å‘ç°è¿™ç§åŸºäºç”Ÿæˆçš„æ–¹æ³•æ˜æ˜¾æ¯”äººå·¥æ„å»ºçš„æ•ˆæœæ›´å¥½ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/c213ae13271e4a00912fe08ad95ad843.png#pic_center" alt></p><blockquote><p>LM-BFFçš„è¯¦ç»†å†…å®¹è¯·å‚è€ƒåšä¸»çš„è®ºæ–‡è§£è¯»ï¼š<a href="https://wjn1996.blog.csdn.net/article/details/115640052">è®ºæ–‡è§£è¯»ï¼šMaking Pre-trained Language Models Better Few-shot Learnersï¼ˆLM-BFFï¼‰</a>ã€‚</p></blockquote><h4 id="ï¼ˆ3ï¼‰è¿ç»­æç¤ºæ¨¡æ¿"><a href="#ï¼ˆ3ï¼‰è¿ç»­æç¤ºæ¨¡æ¿" class="headerlink" title="ï¼ˆ3ï¼‰è¿ç»­æç¤ºæ¨¡æ¿"></a>ï¼ˆ3ï¼‰è¿ç»­æç¤ºæ¨¡æ¿</h4><p>â€ƒâ€ƒä¸è®ºæ˜¯å¯å‘å¼æ–¹æ³•ï¼Œè¿˜æ˜¯é€šè¿‡ç”Ÿæˆçš„æ–¹æ³•ï¼Œéƒ½éœ€è¦ä¸ºæ¯ä¸€ä¸ªä»»åŠ¡å•ç‹¬è®¾è®¡å¯¹åº”çš„æ¨¡æ¿ï¼Œå› ä¸ºè¿™äº›æ¨¡æ¿éƒ½æ˜¯å¯è¯»çš„ç¦»æ•£çš„tokenï¼ˆè¿™ç±»æ¨¡æ¿æˆ‘ä»¬ç§°ä½œDiscrete Promptæˆ–Hard Promptã€‚ï¼‰ï¼Œè¿™å¯¼è‡´å¾ˆéš¾å¯»æ‰¾åˆ°æœ€ä½³çš„æ¨¡æ¿ã€‚å¦å¤–ï¼Œå³ä¾¿æ˜¯åŒä¸€ä¸ªä»»åŠ¡ï¼Œä¸åŒçš„å¥å­ä¹Ÿä¼šæœ‰å…¶æ‰€è°“æœ€ä½³çš„æ¨¡æ¿ï¼Œè€Œä¸”æœ‰æ—¶å€™ï¼Œå³ä¾¿æ˜¯äººç±»ç†è§£çš„ç›¸ä¼¼çš„æ¨¡æ¿ï¼Œä¹Ÿä¼šå¯¹æ¨¡å‹é¢„æµ‹ç»“æœäº§ç”Ÿå¾ˆå¤§å·®å¼‚ã€‚ä¾‹å¦‚ä¸‹å›¾ï¼Œä»¥SNLIæ¨æ–­ä»»åŠ¡ä¸ºä¾‹ï¼Œä»…ä»…åªæ˜¯ä¿®æ”¹äº†æ¨¡æ¿ï¼Œæµ‹è¯•ç»“æœå·®å¼‚å¾ˆæ˜æ˜¾ï¼Œå› æ­¤ç¦»æ•£çš„æ¨¡æ¿å­˜åœ¨æ–¹å·®å¤§ã€ä¸ç¨³å®šç­‰é—®é¢˜ã€‚</p><p><img src="https://img-blog.csdnimg.cn/57133694e1f44f0ba58800e4f2f98b5a.png" alt></p><p>â€ƒâ€ƒå¦‚ä½•é¿å…è¿™ç§é—®é¢˜å‘¢ï¼Œä¸€ç§æ–°çš„ <strong>â€œè¿ç»­æç¤ºâ€</strong> è¢«æå‡ºï¼Œç§°ä½œContinuous Promptæˆ–Soft Promptï¼Œå…¶å°†æ¨¡æ¿è½¬æ¢ä¸ºå¯ä»¥è¿›è¡Œä¼˜åŒ–çš„è¿ç»­å‘é‡ï¼Œæ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šè¿™äº›æ¨¡æ¿ä¸­å„ä¸ªtokenå…·ä½“æ˜¯ä»€ä¹ˆï¼Œè€Œåªéœ€è¦åœ¨è¯­ä¹‰ç©ºé—´ä¸­è¡¨ç¤ºä¸€ä¸ªå‘é‡å³å¯ï¼Œè¿™æ ·ï¼Œä¸åŒçš„ä»»åŠ¡ã€æ•°æ®å¯ä»¥è‡ªé€‚åº”åœ°åœ¨è¯­ä¹‰ç©ºé—´ä¸­å¯»æ‰¾è‹¥å¹²åˆé€‚çš„å‘é‡ï¼Œæ¥ä»£è¡¨æ¨¡æ¿ä¸­çš„æ¯ä¸€ä¸ªè¯ï¼Œç›¸è¾ƒäºæ˜¾å¼çš„tokenï¼Œè¿™ç±»tokenç§°ä¸º <strong>ä¼ªæ ‡è®°ï¼ˆPseudo Tokenï¼‰</strong>ã€‚ä¸‹é¢ç»™å‡ºåŸºäºè¿ç»­æç¤ºçš„æ¨¡æ¿å®šä¹‰ï¼š</p><blockquote><p>å‡è®¾é’ˆå¯¹åˆ†ç±»ä»»åŠ¡ï¼Œç»™å®šä¸€ä¸ªè¾“å…¥å¥å­ x x x ï¼Œè¿ç»­æç¤ºçš„æ¨¡æ¿å¯ä»¥å®šä¹‰ä¸ºï¼š<br>T = [ x ] [ v 1 ] [ v 2 ] . . . [ v m ] [ mask ] \mathcal{T} = [x] [v_1] [v_2] â€¦ [v_m] [\text{mask}] T\=[x][v1][v2]â€¦[vm][mask]<br>å…¶ä¸­ [ v i ] [v_i] [vi] åˆ™æ˜¯ä¼ªæ ‡è®°ï¼Œå…¶ä»…ä»£è¡¨ä¸€ä¸ªæŠ½è±¡çš„tokenï¼Œå¹¶æ²¡æœ‰å®é™…çš„å«ä¹‰ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‘é‡ã€‚</p></blockquote><p>â€ƒâ€ƒåŸºäºè¿ç»­æç¤ºçš„Prompt-Tuningçš„å®ç°æ–¹æ³•ï¼Œä»¥ä¸‹åˆ—ä¸‰ç¯‡è®ºæ–‡ä¸ºä»£è¡¨ï¼Œåˆ†åˆ«ä½œç®€è¦ä»‹ç»ï¼š</p><ul><li><a href="https://aclanthology.org/2021.emnlp-main.243.pdf">ã€ŠThe Power of Scale for Parameter-Efficient Prompt Tuningã€‹</a>ï¼šä»£è¡¨æ–¹æ³•ä¸ºPrompt Tuning</li><li><a href="https://arxiv.org/pdf/2103.10385">ã€ŠGPT Understands, Tooã€‹</a>ï¼šä»£è¡¨æ–¹æ³•ä¸ºP-tuning</li><li><a href="https://aclanthology.org/2022.acl-long.576.pdf">ã€ŠPPT: Pre-trained Prompt Tuning for Few-shot Learningã€‹</a>ï¼šä»£è¡¨æ–¹æ³•PPT</li></ul><p><strong>Prompt Tuning</strong><br>â€ƒâ€ƒè¯¥æ–¹æ³•ç‡å…ˆæå‡ºäº†ä¼ªæ ‡è®°å’Œè¿ç»­æç¤ºçš„æ¦‚å¿µï¼Œä»¥è®©æ¨¡å‹åœ¨èƒ½è¿‡åŠ¨æ€åœ°å¯¹æ¨¡æ¿åœ¨è¯­ä¹‰ç©ºé—´å†…è¿›è¡Œè°ƒæ•´ï¼Œä½¿å¾—æ¨¡æ¿æ˜¯å¯çº¦çš„ï¼ˆdifferentiateï¼‰ã€‚å½¢å¼åŒ–çš„æè¿°å¦‚ä¸‹ï¼š</p><blockquote><p>ç»™å®š n n n ä¸ªtokensï¼Œè®°ä½œ x 1 , . . . , x n {x_1, â€¦, x_n} x1,â€¦,xnï¼Œä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹å¯¹åº”çš„embedding tableï¼Œé€šè¿‡è¿™ä¸ªtableï¼Œå¯ä»¥å°†æ¯ä¸ªtokenè¡¨ç¤ºä¸ºä¸€ä¸ªembeddingï¼ˆ x i âˆˆ R n Ã— h \mathbf{x}_i\in\mathbb{R}^{n\times h} xiâˆˆRnÃ—hï¼‰ï¼Œå…¶ä¸­ h h h æ˜¯å‘é‡çš„ç»´åº¦ï¼ˆå…¶ä¸é¢„è®­ç»ƒæ¨¡å‹çš„é…ç½®æœ‰å…³ï¼Œä¾‹å¦‚BERT-baseæ˜¯768ï¼‰ã€‚è¿ç»­æ¨¡æ¿ä¸­çš„æ¯ä¸ªä¼ªæ ‡è®° v i v_i vi å¯ä»¥è§†ä¸ºå‚æ•°ï¼Œä¹Ÿå¯ä»¥è§†ä¸ºä¸€ä¸ªtokenï¼Œå› æ­¤ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªembedding tableè·å¾—æ¯ä¸ªä¼ªæ ‡è®°çš„å‘é‡ v i \mathbf{v}_i viï¼Œç„¶åå–‚å…¥ä¸€ä¸ªMLPè·å¾—æ–°çš„è¡¨å¾ã€‚æœ€åï¼Œå¯¹äºé¢„è®­ç»ƒæ¨¡å‹çš„è¾“å…¥åˆ™æ˜¯åŒæ—¶åŒ…å« x i \mathbf{x}_i xi å’Œ v i \mathbf{v}_i viã€‚</p></blockquote><p>â€ƒâ€ƒæ¯ä¸ªä¼ªæ ‡è®°çš„åˆå§‹åŒ–å¯ä»¥æœ‰ä¸‹åˆ—å‡ ç§æƒ…å†µï¼š</p><ul><li>æœ€ç®€å•çš„æ˜¯éšæœºåˆå§‹åŒ–ï¼šå³éšæœºåˆå§‹åŒ–ä¸€ä¸ªé¢å‘æ‰€æœ‰ä¼ªæ ‡è®°çš„embedding tableï¼Œå¯é‡‡ç”¨æ­£æ€åˆ†å¸ƒæˆ–è€…å‡åŒ€åˆ†å¸ƒç­‰ï¼›</li><li>æ¯ä¸ªtokenä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹å·²æœ‰çš„embedding tableè¿›è¡Œåˆå§‹åŒ–ï¼Œæ­¤æ—¶ï¼Œæ¯ä¸€ä¸ªä¼ªæ ‡è®°å…ˆéšæœºæŒ‡å®šè¯è¡¨ä¸­çš„ä¸€ä¸ªè¯ï¼Œå¹¶å–å¯¹åº”è¯çš„embeddingä½œä¸ºè¿™ä¸ªä¼ªæ ‡è®°çš„åˆå§‹åŒ–ï¼›</li><li>åœ¨åˆ†ç±»ä»»åŠ¡ä¸Šï¼Œä½¿ç”¨label wordï¼ˆverbalizerï¼‰å¯¹åº”çš„embeddingä½œä¸ºåˆå§‹åŒ–ï¼Œå¯ä»¥æœ‰æ•ˆé™åˆ¶æ¨¡å‹è¾“å‡ºçš„æ˜¯é¢„è®¾çš„è¾“å‡ºç±»å¯¹åº”çš„wordã€‚</li></ul><p>â€ƒâ€ƒå› æ­¤ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªä¼ªæ ‡è®°ä»¥åŠå¯¹åº”çš„MLPå‚æ•°éƒ½å¯ä»¥å¾—åˆ°è®­ç»ƒï¼Œå¯¹äºä¸åŒçš„è¾“å…¥å¥å­ x x x ï¼Œè¿™äº›ä¼ªæ ‡è®°å¯¹åº”çš„embeddingä¹Ÿå„ä¸ç›¸åŒï¼Œè¾¾åˆ°äº†é¢„æœŸçš„ç›®çš„ã€‚</p><p><strong>P-tuning</strong></p><blockquote><p>P-tuningçš„è¯¦ç»†å†…å®¹è¯·å‚è€ƒåšä¸»çš„è®ºæ–‡è§£è¯»ï¼š<a href="https://wjn1996.blog.csdn.net/article/details/120802305">è®ºæ–‡è§£è¯»ï¼šGPT Understands, Too</a>ã€‚</p></blockquote><p>â€ƒâ€ƒP-tuningæ˜¯å¦ä¸€ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„è¿ç»­æç¤ºæ–¹æ³•ï¼Œæ–¹æ³•å›¾å¦‚ä¸‹æ‰€ç¤ºï¼ˆå›¾ä¸­çš„ [ p i ] [p_i] [pi] ç­‰ä»·äºä¸Šæ–‡çš„ [ v i ] [v_i] [vi]ï¼Œè¡¨ç¤ºä¼ªæ ‡è®°ï¼‰ã€‚</p><p><img src="https://img-blog.csdnimg.cn/9444b6ec31344f88aea3e90977e3db7f.png" alt></p><p>â€ƒâ€ƒå…¶åœ¨Prompt Tuningæ–¹æ³•ä¸Šä¸»è¦åšå‡ºä¸‰ä¸ªæ”¹è¿›ï¼š</p><ul><li><strong>è€ƒè™‘åˆ°è¿™äº›ä¼ªæ ‡è®°çš„ç›¸äº’ä¾èµ–å…³ç³»</strong>ï¼šè®¤ä¸º [ v 1 ] [v_1] [v1] ä¸ [ v 2 ] [v_2] [v2] æ˜¯æœ‰å…ˆåå…³ç³»çš„ï¼Œè€Œtransformeræ— æ³•æ˜¾å¼åœ°åˆ»ç”»è¿™å±‚å…³ç³»ï¼Œå› æ­¤å¼•å…¥Prompt Encoderï¼Œå®é™…è¿‡ç¨‹ä¸­é‡‡ç”¨ä¸€å±‚RNNï¼›</li><li><strong>æŒ‡å®šä¸Šä¸‹æ–‡è¯</strong>ï¼šå¦‚æœæ¨¡æ¿å…¨éƒ¨æ˜¯ä¼ªæ ‡è®°ï¼Œåœ¨è®­ç»ƒæ—¶æ— æ³•å¾ˆå¥½åœ°æ§åˆ¶è¿™äº›æ¨¡æ¿æœç€ä¸å¯¹åº”å¥å­ç›¸ä¼¼çš„è¯­ä¹‰ä¸Šä¼˜åŒ–ï¼Œå› æ­¤é€‰å®šéƒ¨åˆ†å…·æœ‰ä¸å½“å‰å¥å­è¯­ä¹‰ä»£è¡¨æ€§çš„ä¸€äº›è¯ä½œä¸ºä¸€äº›ä¼ªæ ‡è®°çš„åˆå§‹åŒ–ï¼ˆä¾‹å¦‚ä¸Šå›¾ä¸­â€œcapitalâ€ã€â€œBritainâ€ç­‰ï¼‰ï¼›</li><li><strong>é‡å‚æ•°ï¼ˆReparameterizationï¼‰</strong>ï¼šå…·ä½“åˆ°ä»£ç å®ç°ä¸Šï¼ŒP-tuningå…ˆé€šè¿‡ä¸€ä¸ªPrompt Encoderè¡¨å¾è¿™äº›ä¼ªæ ‡è®°åï¼Œç›´æ¥å°†è¿™äº›æ–°çš„è¡¨å¾è¦†ç›–åˆ°å¯¹åº”çš„embedding tableä¸Šï¼Œæ¢å¥è¯è¯´ï¼ŒPrompt Encoderåªåœ¨è®­ç»ƒæ—¶å€™ä¼šä½¿ç”¨åˆ°ï¼Œè€Œåœ¨æ¨ç†é˜¶æ®µåˆ™ä¸å†ä½¿ç”¨ã€‚</li><li><strong>æ··åˆæç¤ºï¼ˆHydride Promptï¼‰</strong>ï¼šå°†è¿ç»­æç¤ºä¸ç¦»æ•£tokenè¿›è¡Œæ··åˆï¼Œä¾‹å¦‚ [ x ] [ it ] [ v 1 ] [ mask ] . [x] [\text{it}] [v_1] [\text{mask}]. [x][it][v1][mask].</li></ul><p><strong>PPTï¼ˆPre-trained Prompt Tuningï¼‰</strong><br>â€ƒâ€ƒPrompt-Tuningé€šå¸¸é€‚ç”¨äºä½èµ„æºåœºæ™¯ï¼Œä½†æ˜¯ç”±äºè¿ç»­çš„æ¨¡æ¿æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œå³å…¶å­˜åœ¨æ–°çš„å‚æ•°ï¼Œå°‘é‡æ ·æœ¬å¯èƒ½ä¾ç„¶å¾ˆéš¾ç¡®ä¿è¿™äº›æ¨¡æ¿è¢«å¾ˆå¥½åœ°ä¼˜åŒ–ã€‚å› æ­¤ç®€å•çš„æ–¹æ³•å°±æ˜¯å¯¹è¿™äº›è¿ç»­çš„æ¨¡æ¿è¿›è¡Œé¢„è®­ç»ƒã€‚PPTæ—¨åœ¨é€šè¿‡å…ˆè®©è¿™äº›è¿ç»­æç¤ºåœ¨å¤§é‡æ— æ ‡æ³¨çš„é¢„è®­ç»ƒè¯­æ–™è¿›è¡Œé¢„è®­ç»ƒï¼Œç„¶åå°†å…¶åŠ è½½åˆ°å¯¹åº”ä¸‹æ¸¸ä»»åŠ¡çš„PLMä¸Šè¿›è¡Œè®­ç»ƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå›¾ä¸­çš„ P P P å³è¿ç»­çš„æç¤ºæ¨¡æ¿ï¼Œ &lt; x &gt; <x> <x\> å¹¶è¡¨ç¤ºä¸ºmask tokenï¼‰ï¼š</x\></x></p><p><img src="https://img-blog.csdnimg.cn/4f7ed53824b3433c99d01a6f7baec0c8.png" alt></p><ul><li>é¦–å…ˆåœ¨å¤§é‡æ— æ ‡æ³¨è¯­æ–™ä¸Šè¿›è¡Œé¢„è®­ç»ƒï¼Œè·å¾—è®­ç»ƒå¥½çš„è¿ç»­æç¤ºï¼›</li><li>å¯¹ä¸‹æ¸¸ä»»åŠ¡ï¼ˆæ˜¯éé—®ç­”ã€NLIã€æ–‡æœ¬åŒ¹é…ç­‰ï¼‰ï¼ŒåŠ è½½è¿™äº›è®­ç»ƒå¥½çš„æç¤ºä¹‹åï¼Œè¿›è¡Œå¾®è°ƒï¼Œæˆ–è€…ç›´æ¥è¿›è¡Œzero-shoté¢„æµ‹ã€‚</li></ul><p>â€ƒâ€ƒä¸‹å›¾å¯¹å‡ ç§templateä¼˜åŒ–è¿›è¡Œçš„å¯¹æ¯”ã€‚<br><img src="https://img-blog.csdnimg.cn/2ab3feb1484a4e2c8403ce07240546cf.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="ï¼ˆ4ï¼‰Templateä¼˜åŒ–è¿›é˜¶"><a href="#ï¼ˆ4ï¼‰Templateä¼˜åŒ–è¿›é˜¶" class="headerlink" title="ï¼ˆ4ï¼‰Templateä¼˜åŒ–è¿›é˜¶"></a>ï¼ˆ4ï¼‰Templateä¼˜åŒ–è¿›é˜¶</h4><p>â€ƒâ€ƒæˆ‘ä»¬ä¸ºä»»åŠ¡è®¾è®¡çš„æ¨¡æ¿éƒ½æ˜¯å»ºç«‹åœ¨ä¸€ä¸ªå‡è®¾ä¸Šï¼šå³æ¨¡æ¿éƒ½æ˜¯å°½å¯èƒ½æ˜¯å¯è¯»çš„ï¼Œå³æ»¡è¶³äººç±»è¯­è¨€çš„è¯­æ³•å½¢æ€ã€‚ç„¶è€Œæœ€è¿‘ä¹Ÿæœ‰å·¥ä½œè®¤ä¸ºï¼Œæœ€ä¼˜çš„æ¨¡æ¿å¯èƒ½æ˜¯ä¸ç¬¦åˆè¯­æ³•çš„ä¹±è¯­ (Ungrammatical Gibberish Text)ï¼Œå³äººç±»å¯è¯»çš„æ¨¡æ¿ï¼Œæ¨¡å‹ä¹Ÿè®¸ä¸å¯è¯»ã€‚è™½ç„¶è¿™å¾ˆåç›´è§‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½å¦è®¤è¿™ç§æƒ…å†µçš„å­˜åœ¨ã€‚è®ºæ–‡<a href="https://arxiv.org/pdf/2205.12548.pdf">ã€ŠRLPROMPT: Optimizing Discrete Text Prompts with Reinforcement Learningã€‹</a>ç»™å‡ºäº†ç›¸åº”çš„å‘ç°ï¼Œå¹¶æå‡ºäº†ä¸€ç§åŸºäºå¼ºåŒ–å­¦ä¹ çš„æ–¹æ³•RLPROMPTæ¥å¯»æ‰¾æœ€ä¼˜çš„æ¨¡æ¿ã€‚<br><img src="https://img-blog.csdnimg.cn/8f9e6ec111e045529da3564676ed106e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>â€ƒâ€ƒä¸Šå›¾ä¸ºRLPROMPTæ¡†æ¶ï¼Œå·¦ä¾§ä¸ºç­–ç•¥ç½‘ç»œï¼Œå³ä¾§åˆ†åˆ«ä¸ºåŒå‘é¢„è®­ç»ƒæ¨¡å‹ï¼ˆMasked LMï¼‰å’Œç”Ÿæˆå¼é¢„è®­ç»ƒæ¨¡å‹ï¼ˆLeft-to-Right LMï¼‰ï¼Œåˆ†åˆ«å¯¹åº”äºåˆ†ç±»ä»»åŠ¡å’Œç”Ÿæˆä»»åŠ¡ã€‚RLPROMPTçš„åŸç†å¦‚ä¸‹ï¼š</p><blockquote><p><strong>Step1</strong>ï¼šç»™å®šä¸€ä¸ªå¥å­ï¼ˆä¾‹å¦‚â€œI have â€¦â€ï¼‰ï¼Œä¸€ä¸ª [mask] tokenï¼Œä»¥åŠä¸€ä¸ªç”¨äºå¾…ç”Ÿæˆçš„æ¨¡æ¿å ä½ç¬¦ [Prompt]ã€‚<br><strong>Step2</strong>ï¼šå¦‚æœæ˜¯åˆ†ç±»ä»»åŠ¡ï¼Œåˆ™å°†è¾“å…¥å¥å­å–‚å…¥ä¸€ä¸ªåŒå‘è¯­è¨€æ¨¡å‹ä¸­è·å¾— [mask] ä½ç½®çš„é¢„æµ‹tokenï¼Œå¹¶é€šè¿‡verbalizeræ˜ å°„åˆ°å¯¹åº”ç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå¦‚æœæ˜¯åœ¨è®­ç»ƒé˜¶æ®µï¼ŒçœŸå®æ ‡ç­¾æ˜¯å·²çŸ¥çš„ï¼Œå…¶æ¦‚ç‡å¯ä»¥ä½œä¸ºå½“å‰æ¨¡æ¿çš„åé¦ˆï¼ˆrewardï¼‰ã€‚å¦‚æœæ˜¯ç”Ÿæˆä»»åŠ¡ï¼Œåˆ™å–‚å…¥ç”Ÿæˆæ¨¡å‹ä¸­ï¼Œè·å¾—ç”Ÿæˆtokençš„é¢„æµ‹æ¦‚ç‡ï¼ˆæˆ–è€…å…¶ä»–æ–‡æœ¬ç”Ÿæˆçš„æŒ‡æ ‡ï¼‰å¹¶ä½œä¸ºåé¦ˆã€‚<br><strong>Step3</strong>ï¼šæ ¹æ®å½“å‰çš„åé¦ˆï¼Œä½¿ç”¨å¼ºåŒ–å­¦ä¹ çš„policy gradientæ–¹æ³•è®­ç»ƒä¸€ä¸ªå†³ç­–å‡½æ•°ã€‚åŸºäºè¿™ä¸ªå†³ç­–å‡½æ•°å¯ä»¥å¯¹[Prompt]ç”Ÿæˆä¸€ä¸ªç¦»æ•£çš„æ¨¡æ¿è¯ã€‚å†³ç­–å‡½æ•°æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Œé€šè¿‡LM headæ¥ç”Ÿæˆä¸€ä¸ªtokenã€‚<br><strong>Step4</strong>ï¼šç”Ÿæˆä¸€ä¸ªæ¨¡æ¿è¯ä¹‹åï¼Œé‡å¤Step2ï½Step3ï¼Œç›´åˆ°ç”Ÿæˆè¶³å¤Ÿçš„æ¨¡æ¿è¯ã€‚</p></blockquote><p>â€ƒâ€ƒåŸºäºRLPROMPTï¼Œæœ€ç»ˆå¯ä»¥å¾—åˆ°ä¸€äº›ç¦»æ•£çš„æ¨¡æ¿ï¼Œç›¸æ¯”è¿ç»­çš„æç¤ºæ›´åŠ æœ‰è§£é‡Šæ€§ã€‚å–å‡ ä¸ªå¸¸ç”¨çš„è¯„æµ‹ä»»åŠ¡ï¼Œå¯¹æ¯”ä¸åŒæ–¹æ³•ç”Ÿæˆçš„æ¨¡æ¿çš„åŒºåˆ«ï¼š<br><img src="https://img-blog.csdnimg.cn/33bb2054600345adb6698c7a8c5bdd43.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h3 id="3-3-å¦‚ä½•æŒ‘é€‰åˆé€‚çš„Verbalizerï¼Ÿ"><a href="#3-3-å¦‚ä½•æŒ‘é€‰åˆé€‚çš„Verbalizerï¼Ÿ" class="headerlink" title="3.3 å¦‚ä½•æŒ‘é€‰åˆé€‚çš„Verbalizerï¼Ÿ"></a>3.3 å¦‚ä½•æŒ‘é€‰åˆé€‚çš„Verbalizerï¼Ÿ</h3><p>â€ƒâ€ƒé™¤äº†Templateä»¥å¤–ï¼ŒVerbalizeræ˜¯ç›´æ¥å…³ç³»åˆ°é¢„æµ‹çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Œä¸åŒçš„Verbalizerä¼šå¯¹æœ€ç»ˆé¢„æµ‹æ•ˆæœäº§ç”Ÿè¾ƒå¤§çš„å½±å“ï¼Œä¸åŒçš„ä»»åŠ¡ä¼šæœ‰ä¸åŒçš„åˆé€‚çš„label wordã€‚ä¾‹å¦‚åœ¨ç”µå½±è¯„è®ºä»»åŠ¡ä¸­ï¼Œpositiveç±»åˆ«çš„label wordæ¯”è¾ƒåˆé€‚çš„æ˜¯wonderfulï¼Œè€Œåœ¨ç¾é£Ÿç‚¹è¯„ä»»åŠ¡ä¸­ï¼Œpositiveæ¯”è¾ƒåˆé€‚çš„æ˜¯testyã€‚å› æ­¤label wordçš„é€‰æ‹©ä¹Ÿæ˜¯Prompt-Tuningä¸­å…³é”®çš„éƒ¨åˆ†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»¥SST-2ä¸ºä¾‹ï¼Œç›¸åŒçš„æ¨¡æ¿æ¡ä»¶ä¸‹ï¼Œä¸åŒçš„label wordå¯¹åº”çš„æŒ‡æ ‡å·®å¼‚å¾ˆå¤§ã€‚</p><p><img src="https://img-blog.csdnimg.cn/502ae6a085e84a78ad8482351222c72c.png" alt></p><p>â€ƒâ€ƒä¼ ç»Ÿçš„æ–¹æ³•æ˜¯äººå·¥è®¾è®¡ï¼ˆManual Designï¼‰ï¼Œå³å¯ä»¥æ ¹æ®å¯¹æ¯ä¸ªä»»åŠ¡çš„ç»éªŒæ¥äººå·¥æŒ‡å®šè¿™äº›label wordã€‚ä½†æ˜¯äººå·¥è®¾è®¡éœ€è¦ä¾èµ–å¤§é‡çš„äººåŠ›ï¼Œä¸”å¯¹äºä¸€äº›å…·æœ‰ä¸“ä¸šæ€§çš„ä»»åŠ¡è¿˜éœ€è¦ä¾èµ–äºä¸“å®¶ï¼Œä½¿å¾—Prompt-Tuningçš„æ•ˆç‡å¾ˆä½ã€‚ä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œä¸€äº›å·¥ä½œå¼€å§‹ç ”ç©¶å¦‚ä½•æ ¹æ®ä¸åŒçš„ä»»åŠ¡è‡ªåŠ¨åœ°é€‰æ‹©åˆé€‚çš„label wordã€‚å—åˆ°Templateçš„ç¦»æ•£å’Œè¿ç»­ä¸¤ç§ç±»å‹ä¼˜åŒ–çš„å¯ç¤ºï¼ŒVerbalizerä¹Ÿå¯ä»¥åˆ†ä¸ºç¦»æ•£å’Œè¿ç»­ä¸¤ç§ç±»å‹ã€‚æœ¬æ–‡åˆ†åˆ«ä»‹ç»ä¸¤ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„å·¥ä½œï¼š</p><ul><li>é¢†åŸŸçŸ¥è¯†æŒ‡å¯¼æœç´¢ç¦»æ•£çš„label wordï¼š<a href="https://aclanthology.org/2022.acl-long.158.pdf">ã€ŠKnowledgeable Prompt-tuning:<br>Incorporating Knowledge into Prompt Verbalizer for Text Classificationã€‹</a>ï¼Œä»£è¡¨æ–¹æ³•ä¸ºKPTï¼›</li><li>åŸå‹ç½‘ç»œåŠ¨æ€ç”Ÿæˆlabel representationsï¼š<a href="https://aclanthology.org/2022.acl-long.483.pdf">ã€ŠPrototypical Verbalizer for Prompt-based Few-shot Tuningã€‹</a>ï¼Œä»£è¡¨æ–¹æ³•ä¸ºProtoVerbã€‚</li></ul><p><strong>KPTï¼ˆKnowledgeable Prompt Tuningï¼‰</strong></p><blockquote><p>KPTçš„è¯¦ç»†å†…å®¹è¯·å‚è€ƒåšä¸»çš„è®ºæ–‡è§£è¯»ï¼š<a href="https://wjn1996.blog.csdn.net/article/details/120790512">è®ºæ–‡è§£è¯»ï¼šKnowledgeable Prompt-tuning: Incorporation Knowledge into Prompt Verbalizer for Text Classification</a>ã€‚</p></blockquote><p>â€ƒâ€ƒé’ˆå¯¹ä¸åŒçš„ä»»åŠ¡ï¼Œéƒ½æœ‰å…¶ç›¸åº”çš„é¢†åŸŸçŸ¥è¯†ï¼Œä¸ºäº†é¿å…äººå·¥é€‰æ‹©label wordï¼Œè¯¥æ–¹æ³•æå‡ºåŸºäº<a href="https://so.csdn.net/so/search?q=%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1&amp;spm=1001.2101.3001.7020">çŸ¥è¯†å›¾è°±</a>å¢å¼ºçš„æ–¹æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/374f14232d494d1491b3c218f0b85f66.png" alt></p><p>â€ƒâ€ƒå…·ä½“æ€è·¯å¦‚ä¸‹ï¼š</p><ul><li>é¦–å…ˆé€šè¿‡ä¸€äº›å·²æœ‰çš„å­—å…¸å·¥å…·ï¼Œä»è¯è¡¨ä¸­è·å¾—ä¸ç»™å®šlabelç›¸å…³çš„è¯ã€‚å¦‚ä½•å»ºæ¨¡è¿™ç§ç›¸å…³æ€§å‘¢ï¼Œè¯¥æ–¹æ³•å¼•å…¥çŸ¥è¯†åº“ï¼Œä¾èµ–äºçŸ¥è¯†åº“ä¸­çš„ä¸‰å…ƒç»„æ¥è¡¡é‡ã€‚ä¾‹å¦‚SCIENCEåœ¨çŸ¥è¯†åº“ä¸­æ˜¯ä¸€ä¸ªå®ä½“ï¼Œä¸è¯¥å®ä½“å­˜åœ¨å¤šæŒ‘å…³ç³»çš„è¯å¯èƒ½æœ‰scienceã€mathematicsç­‰ç­‰ï¼›</li><li>ç¬¬ä¸€æ­¥å¯ä»¥è·å¾—å¤§é‡çš„è¯ï¼Œä½†æ˜¯ä¹Ÿå®¹æ˜“å¼•å…¥å™ªå£°ï¼Œå› æ­¤éœ€è¦è¿›è¡Œæç‚¼ï¼ˆRefineï¼‰ï¼Œå¯ä»¥è®¾è®¡ä¸€ç³»åˆ—çš„å¯å‘å¼æ–¹æ³•æ¥åº¦é‡æ¯ä¸ªè¯ä¸labelçš„ç›¸å…³åº¦ï¼Œæœ€åè·å¾—æŒ‡å®šæ•°é‡çš„è‹¥å¹²ä¸ªåˆé€‚çš„label wordï¼›</li><li>å¯¹äºé€‰å®šçš„label wordï¼Œé‡‡ç”¨Verbalizaeré›†æˆçš„æ–¹æ³•è·å¾—æœ€ç»ˆçš„é¢„æµ‹ç»“æœã€‚</li></ul><p><strong>ProtoVerb</strong><br>â€ƒâ€ƒå›é¡¾åœ¨Templateçš„æ„å»ºä¸­ï¼Œç¦»æ•£çš„æ¨¡æ¿æ˜¯æ— æ³•åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¢«ä¼˜åŒ–çš„ï¼Œä»è€Œå¼•å…¥äº†è¿ç»­çš„æ¨¡æ¿ã€‚åŒç†ï¼Œç¦»æ•£label wordä¹Ÿæ˜¯åªèƒ½åœ¨è®­ç»ƒä¹‹å‰è¢«æŒ‡å®šï¼Œè€Œåœ¨åç»­è®­ç»ƒä¸­æ— æ³•è¢«æ”¹å˜ã€‚å› æ­¤ï¼Œä¸ºäº†è®©label wordä¹Ÿå¯ä»¥è‡ªé€‚åº”çš„å˜åŒ–ï¼Œæå‡ºè¿ç»­çš„label wordã€‚</p><p>â€ƒâ€ƒProtoVerbå·§å¦™çš„è¿ç”¨äº†åŸå‹ç½‘ç»œï¼ˆPrototypical Networkï¼‰çš„æ€è·¯ï¼Œå°†æ¯ä¸ªç±»åˆ«çš„æ‰€æœ‰æ ·æœ¬çš„è¡¨å¾çš„æœŸæœ›ä½œä¸ºè¯¥ç±»çš„åŸå‹å‘é‡ï¼Œå¹¶ä½¿ç”¨è¯¥åŸå‹å‘é‡ä»£æ›¿è¿ç»­çš„label wordã€‚</p><p><img src="https://img-blog.csdnimg.cn/39e4a8127eb2432d9ae455c203f83d7f.png" alt></p><p>â€ƒâ€ƒå¦‚ä¸Šå›¾ï¼Œä»¥æ–°é—»åˆ†ç±»ä¸ºä¾‹ï¼Œé¦–å…ˆå®šä¹‰å›ºå®šçš„æ¨¡æ¿â€œA [mask] news.â€ï¼Œå¹¶æ‹¼æ¥åˆ°åŸå§‹çš„è¾“å…¥å¥å­ä¸Šã€‚å–‚å…¥BERTæ¨¡å‹ä¸­ï¼Œè·å¾— [mask] ä½ç½®çš„è¡¨å¾å‘é‡ä»£è¡¨å¥å­å‘é‡ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­çš„labelæ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥å¯ä»¥æ±‚å¾—åŒä¸€labelå¯¹åº”æ‰€æœ‰å¥å­å‘é‡çš„å‡å€¼æ¥è¡¨ç¤ºè¿™ä¸ªlabelçš„è¡¨å¾ï¼ˆå›¾ä¸­çš„äº”è§’æ˜Ÿï¼‰ã€‚</p><p>â€ƒâ€ƒåœ¨æµ‹è¯•é˜¶æ®µï¼Œåˆ™åªéœ€è¦è®¡ç®—æµ‹è¯•å¥å­çš„è¡¨å¾ä¸å„ä¸ªç±»åˆ«çš„åŸå‹å‘é‡çš„ç›¸ä¼¼åº¦ï¼Œå¹¶å–æœ€å¤§ç›¸ä¼¼åº¦å¯¹åº”çš„labelä½œä¸ºé¢„æµ‹ç»“æœã€‚</p><p>â€ƒâ€ƒé€šè¿‡è¿™ç§è¿ç»­çš„label wordï¼ŒåŸºæœ¬é¿å…äº†æ˜¾å¼è·å–label wordçš„è¿‡ç¨‹ï¼Œä½¿å¾—æ¨¡å‹çš„è®­ç»ƒä¸€æ°”å‘µæˆã€‚ç›¸ä¼¼çš„åšæ³•ä¹Ÿåœ¨<a href="https://arxiv.org/pdf/2201.04337">ã€ŠPromptBERT: Improving BERT Sentence Embeddings with Promptsã€‹</a>ä¸­è¢«æåŠã€‚</p><hr><h2 id="-3"><a href="#-3" class="headerlink" title=" "></a> </h2><p>ç¬¬å››ç« ï¼šPrompt-Tuningçš„æœ¬è´¨</p><hr><blockquote><p>æ¶‰åŠçŸ¥è¯†ç‚¹ï¼š</p><ul><li>å…ƒå­¦ä¹ ä¸promptï¼›</li><li>åŸºäºPromptçš„NLPä»»åŠ¡çš„ç»Ÿä¸€èŒƒå¼ï¼›</li><li>åŸºäºç”Ÿæˆæ¨¡å‹çš„Promptï¼›</li><li>Promptä¸å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ ï¼›</li></ul></blockquote><p>â€ƒâ€ƒå‰é¢ç« èŠ‚ä»‹ç»äº†å¤§é‡ä¸Promptç›¸å…³çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæœ€åˆçš„Prompt Tuningæ˜¯æ—¨åœ¨è®¾è®¡Templateå’ŒVerbalizerï¼ˆå³Pattern-Verbalizer Pairï¼‰æ¥è§£å†³åŸºäºé¢„è®­ç»ƒæ¨¡å‹çš„å°æ ·æœ¬æ–‡æœ¬åˆ†ç±»ï¼Œç„¶è€Œäº‹å®ä¸Šï¼ŒNLPé¢†åŸŸæ¶‰åŠåˆ°å¾ˆå¤šé™¤äº†åˆ†ç±»ä»¥å¤–å…¶ä»–å¤§é‡å¤æ‚çš„ä»»åŠ¡ï¼Œä¾‹å¦‚æŠ½å–ã€é—®ç­”ã€ç”Ÿæˆã€ç¿»è¯‘ç­‰ã€‚è¿™äº›ä»»åŠ¡éƒ½æœ‰ç‹¬ç‰¹çš„ä»»åŠ¡ç‰¹æ€§ï¼Œå¹¶ä¸æ˜¯ç®€å•çš„PVPå°±å¯ä»¥è§£å†³çš„ï¼Œå› è€Œï¼Œ<strong>æˆ‘ä»¬éœ€è¦æç‚¼å‡ºPrompt Tuningçš„æœ¬è´¨ï¼Œå°†Prompt Tuningå‡ååˆ°ä¸€ç§æ›´åŠ é€šç”¨çš„èŒƒå¼ä¸Š</strong>ã€‚</p><p>åšä¸»æ ¹æ®å¯¹Prompt-Tuningä¸¤å¹´å¤šçš„ç ”ç©¶ç»éªŒï¼Œæ€»ç»“äº†ä¸‰ä¸ªå…³äºPromptçš„æœ¬è´¨ï¼Œå¦‚ä¸‹ï¼š</p><ul><li>Promptçš„æœ¬è´¨æ˜¯ä¸€ç§å¯¹ä»»åŠ¡çš„æŒ‡ä»¤ï¼›</li><li>Promptçš„æœ¬è´¨æ˜¯ä¸€ç§å¯¹é¢„è®­ç»ƒä»»åŠ¡çš„å¤ç”¨ï¼›</li><li>Promptçš„æœ¬è´¨æ˜¯ä¸€ç§å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ ï¼›</li></ul><h3 id="4-1-Promptæ˜¯ä¸€ç§é’ˆå¯¹ä»»åŠ¡çš„æŒ‡ä»¤"><a href="#4-1-Promptæ˜¯ä¸€ç§é’ˆå¯¹ä»»åŠ¡çš„æŒ‡ä»¤" class="headerlink" title="4.1 Promptæ˜¯ä¸€ç§é’ˆå¯¹ä»»åŠ¡çš„æŒ‡ä»¤"></a>4.1 Promptæ˜¯ä¸€ç§é’ˆå¯¹ä»»åŠ¡çš„æŒ‡ä»¤</h3><p>â€ƒâ€ƒ<strong>Promptæœ¬è´¨ä¸Šæ˜¯å¯¹ä¸‹æ¸¸ä»»åŠ¡çš„æŒ‡ä»¤ï¼Œå¯ä»¥ä½œä¸ºä¸€ç§ä¿¡æ¯å¢å¼º</strong>ã€‚ç®€å•çš„æ¥è¯´ï¼Œå°±æ˜¯å‘Šè¯‰æ¨¡å‹éœ€è¦åšä»€ä¹ˆä»»åŠ¡ï¼Œè¾“å‡ºä»€ä¹ˆå†…å®¹ã€‚ä¸Šæ–‡æˆ‘ä»¬æåŠåˆ°çš„ç¦»æ•£æˆ–è¿ç»­çš„æ¨¡æ¿ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§å¯¹ä»»åŠ¡çš„æç¤ºã€‚å½“æ•°æ®é›†ä¸åŒï¼ˆä¹ƒè‡³æ ·æœ¬ä¸åŒï¼‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœŸæœ›æ¨¡å‹èƒ½å¤Ÿè‡ªé€‚åº”çš„é€‰æ‹©ä¸åŒçš„æ¨¡æ¿ï¼Œè¿™ä¹Ÿç›¸å½“äºè¯´ä¸åŒçš„ä»»åŠ¡ä¼šæœ‰å…¶å¯¹åº”çš„æç¤ºä¿¡æ¯ã€‚ä¾‹å¦‚åœ¨å¯¹ç”µå½±è¯„è®ºè¿›è¡ŒäºŒåˆ†ç±»çš„æ—¶å€™ï¼Œæœ€ç®€å•çš„æç¤ºæ¨¡æ¿æ˜¯â€œ [ x ] [x] [x]. It was [mask].â€ï¼Œä½†æ˜¯å…¶å¹¶æ²¡æœ‰çªå‡ºè¯¥ä»»åŠ¡çš„å…·ä½“ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºå…¶è®¾è®¡ä¸€ä¸ªèƒ½å¤Ÿçªå‡ºè¯¥ä»»åŠ¡ç‰¹æ€§çš„æ¨¡æ¿ï¼Œä¾‹å¦‚â€œThe movie review is [ x ] [x] [x]. It was [mask].â€ï¼Œç„¶åæ ¹æ®maskä½ç½®çš„è¾“å‡ºç»“æœé€šè¿‡Verbalizeræ˜ å°„åˆ°å…·ä½“çš„æ ‡ç­¾ä¸Šã€‚è¿™ä¸€ç±»å…·å¤‡ä»»åŠ¡ç‰¹æ€§çš„æ¨¡æ¿å¯ä»¥ç§°ä¹‹ä¸º<strong>æŒ‡ä»¤ï¼ˆInstructionï¼‰</strong>ã€‚ä¸‹é¢å±•ç¤ºå‡ ä¸ªä»»åŠ¡è®¾è®¡çš„æŒ‡ä»¤æ¨¡æ¿ï¼š</p><div class="table-container"><table><thead><tr><th>ä»»åŠ¡ç‰¹æ€§</th><th>æ¨¡æ¿</th></tr></thead><tbody><tr><td>ç”µå½±è¯„è®ºæƒ…æ„Ÿåˆ†æï¼ˆäºŒåˆ†ç±»ï¼‰</td><td>The movie review is [ x ] [x] [x]. It was [mask].</td></tr><tr><td>æ–°é—»åˆ†ç±»</td><td>A [mask] News: [ x ] [x] [x].</td></tr><tr><td>å®ä½“è¯†åˆ«</td><td>Shanghai is in the west of China. The entity Shanghai is [mask].</td></tr><tr><td>å¤šé¡¹é€‰æ‹©</td><td>Question: [ q ] [q] [q], Options: A. [ x 1 ] [x_1] [x1], B. [ x 1 ] [x_1] [x1], C. [ x 1 ] [x_1] [x1], D. [ x 1 ] [x_1] [x1]. The result is [mask].</td></tr><tr><td>æ–‡æœ¬æ‘˜è¦</td><td>Context: [ x ] [x] [x]. Abstract: [mask] [mask] [mask] â€¦</td></tr></tbody></table></div><p>â€ƒâ€ƒçœ‹ä¼¼è®¾è®¡æŒ‡ä»¤æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…ï¼Œä½†æ˜¯åœ¨çœŸå®ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œé¢„è®­ç»ƒæ¨¡å‹å¾ˆéš¾â€œç†è§£â€è¿™äº›æŒ‡ä»¤ï¼Œæ ¹æ®æœ€è¿‘ç ”ç©¶å·¥ä½œå‘ç°ï¼Œä¸»è¦æ€»ç»“å¦‚ä¸‹å‡ ä¸ªåŸå› ï¼š</p><ul><li><strong>é¢„è®­ç»ƒæ¨¡å‹ä¸å¤Ÿå¤§</strong>ï¼šæˆ‘ä»¬å¸¸ä½¿ç”¨çš„BERT-baseã€BERT-largeã€RoBERTa-baseå’ŒRoBERTa-largeåªæœ‰ä¸åˆ°10äº¿å‚æ•°ï¼Œç›¸æ¯”äºç°å¦‚ä»ŠGPT-3ã€OPTç­‰åªèƒ½ç®—ä½œå°æ¨¡å‹ï¼Œæœ‰å·¥ä½œå‘ç°ï¼Œå°æ¨¡å‹åœ¨è¿›è¡ŒPrompt Tuningçš„æ—¶å€™ä¼šæ¯”Fine-tuningæ•ˆæœå·®ï¼Œæ˜¯å› ä¸ºå°æ¨¡å‹å¾ˆå®¹æ˜“å—åˆ°æ¨¡æ¿çš„å½±å“</li></ul><blockquote><p>â€ƒâ€ƒå¯¹æ¯”ä¸€ä¸‹ä¼ ç»Ÿçš„Fine-tuningï¼Œæ¯ä¸ªæ ·æœ¬çš„è¾“å…¥å‡ ä¹éƒ½æ˜¯ä¸åŒçš„ï¼Œç„¶è€ŒåŸºäºPromptçš„æ–¹æ³•ä¸­ï¼Œæ‰€æœ‰çš„æ ·æœ¬è¾“å…¥éƒ½ä¼šåŒ…å«ç›¸åŒçš„æŒ‡ä»¤ï¼Œè¿™å°±å¯¼è‡´å°æ¨¡å‹å¾ˆå®¹æ˜“å—åˆ°è¿™äº›æŒ‡ä»¤å¸¦æ¥çš„å¹²æ‰°ã€‚</p></blockquote><ul><li><strong>ç¼ºä¹æŒ‡ä»¤ç›¸å…³çš„è®­ç»ƒ</strong>ï¼šè¿™äº›å°æ¨¡å‹åœ¨é¢„è®­ç»ƒé˜¶æ®µæ²¡æœ‰ä¸“é—¨å­¦ä¹ è¿‡å¦‚ä½•ç†è§£ä¸€äº›ç‰¹æ®Šçš„æŒ‡ä»¤ã€‚</li></ul><blockquote><p>â€ƒâ€ƒæˆ‘ä»¬å›é¡¾ä¸€ä¸‹ä¸Šé¢ç« èŠ‚ï¼Œä¸è®ºæ˜¯ç”Ÿæˆç¦»æ•£çš„æ¨¡æ¿è¿˜æ˜¯è¿ç»­çš„æ¨¡æ¿ï¼Œéƒ½æ˜¯åœ¨å‘ç°æœ‰çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹è¿›è¡Œâ€œå¦¥åâ€ï¼Œå³æ‰¾åˆ°èƒ½å¤Ÿè®©å½“å‰é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åœ¨å°æ ·æœ¬ä¸Šæ•ˆæœæœ€å¥½çš„æ¨¡æ¿ï¼Œæˆ–è€…è¯´æ˜¯ç«™åœ¨å·²æœ‰é¢„è®­ç»ƒæ¨¡å‹çš„åŸºç¡€ä¸Šå¯»æ‰¾æ¨¡æ¿ã€‚ç„¶è€Œè¿™ç§å¯»æ‰¾åˆ°çš„æ¨¡æ¿ä¸å¯è¯»ä¹Ÿä¸å¯è§£é‡Šï¼Œæˆ–è€…è¿‡äºé€šç”¨ï¼Œä¸å…·å¤‡ä»»åŠ¡ç‰¹æ€§ï¼Œæ— æ³•å¾ˆå¥½åœ°åœ¨çœŸå®åœºæ™¯ä¸‹ä½¿ç”¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å…ˆè®¾è®¡å¥½ä»»åŠ¡ç›¸å…³çš„æŒ‡ä»¤ï¼Œä½¿å¾—è¿™äº›æŒ‡ä»¤æ˜¯å¯è¯»çš„ï¼Œå¯åœ¨çœŸå®åœºæ™¯ä¸‹ä½¿ç”¨çš„ã€‚ä¸è¿‡ç”±äºé¢„è®­ç»ƒæ¨¡å‹æ²¡è§è¿‡è¿™äº›æŒ‡ä»¤ï¼Œæ‰€ä»¥å¾ˆéš¾åœ¨å°æ ·æœ¬ä¸Šå¿«é€Ÿç†è§£å®ƒä»¬ã€‚</p></blockquote><p>â€ƒâ€ƒä¹Ÿè®¸è¯»è€…æƒ³åˆ°äº†å‰é¢æ‰€è®²åˆ°çš„Pre-trained Prompt Tuningï¼ˆPPTï¼‰ï¼Œå³å†æ¬¡å¯¹é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹è¿›è¡Œä¸€æ¬¡Continual Pre-trainingã€‚ç„¶è€Œæˆ‘ä»¬å¿½ç•¥äº†ä¸€ç‚¹ï¼Œå³<strong>æˆ‘ä»¬æœŸæœ›é¢„è®­ç»ƒæ¨¡å‹ä¸æ­¢æ˜¯åœ¨æˆ‘ä»¬å·²ç»è®¾è®¡å¥½çš„æŒ‡ä»¤ä¸Šè¿›è¡Œå­¦ä¹ ï¼Œè¿˜åº”è¯¥åœ¨æœªçŸ¥çš„æŒ‡ä»¤ä¸Šå…·å¤‡ä¸€å®šçš„æ³›åŒ–æ€§èƒ½</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªå®Œå…¨æ–°çš„ä»»åŠ¡ä¸Šï¼Œåªéœ€è¦å°‘é‡æ ·æœ¬ï¼ˆç”šè‡³æ˜¯é›¶æ ·æœ¬ï¼‰ï¼Œä¹Ÿèƒ½è¿‡å¾ˆå¥½åœ°ç†è§£è¿™ä¸ªæŒ‡ä»¤ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯<strong>å…ƒå­¦ä¹ ï¼ˆMeta Learningï¼‰</strong>ï¼Œæˆ‘ä»¬ä»‹ç»å‡ ä¸ªä»£è¡¨æ€§çš„å·¥ä½œï¼š</p><ul><li><a href="https://aclanthology.org/2021.emnlp-main.221.pdf">ã€ŠTransPrompt: Towards an Automatic Transferable Prompting Framework for Few-shot Text Classificationã€‹</a>ï¼šä»£è¡¨æ–¹æ³•TransPromptï¼Œåˆ©ç”¨è¿ç§»å­¦ä¹ æå‡é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åœ¨ä¸åŒç±»å‹ä»»åŠ¡ä¸Šçš„æ³›åŒ–æ€§èƒ½ï¼›</li><li><a href="https://aclanthology.org/2021.findings-emnlp.244.pdf">ã€ŠAdapting Language Models for Zero-shot Learning by Meta-tuning on Dataset and Prompt Collectionsã€‹</a>ï¼šä»£è¡¨æ–¹æ³•ï¼šMPTï¼Œç»Ÿä¸€åˆ†ç±»ä»»åŠ¡èŒƒå¼ï¼Œå¹¶é‡‡ç”¨å…ƒå­¦ä¹ è¿›è¡Œè®­ç»ƒï¼›</li></ul><p><strong>TransPrompt</strong><br>â€ƒâ€ƒè¯¥æ–¹æ³•æ˜¯é¢å‘è¿ç»­æç¤ºæ¨¡æ¿çš„ï¼Œå…¶å¯¹P-tuningåšäº†å¦‚ä¸‹å‡ ä¸ªæ”¹è¿›ï¼š</p><ul><li><strong>å¼•å…¥Cross-task Learning</strong>ï¼šåŸæ¥P-tuningåªå¯¹å•ä¸€ä»»åŠ¡è¿›è¡ŒPrompt Tuningï¼Œè€ŒTransPromptåˆ™å¯¹åŒä¸€ç±»åˆ«å¤šä¸ªä»»åŠ¡è¿›è¡ŒCross-task Learningã€‚ä¾‹å¦‚æƒ…æ„Ÿåˆ†ææœ‰SST-2ã€MRå’ŒCRä¸‰ä¸ªä»»åŠ¡ï¼Œåˆ™ä¸ºæ¯ä¸€ä¸ªä»»åŠ¡è®¾è®¡ä¸€ä¸ªTask-specific Prompt Encoderã€‚ä¸ºäº†æ•æ‰ä»»åŠ¡ä¹‹é—´çš„å…±åŒçŸ¥è¯†ï¼Œä¹Ÿé¢å¤–è®¾è®¡ä»¥æ¶æUniversal Prompt Encoderã€‚</li></ul><blockquote><p>â€ƒâ€ƒåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰ä»»åŠ¡çš„æ•°æ®é›†æ ·æœ¬ç›´æ¥æ··åˆèµ·æ¥ï¼Œæ¯ä¸€ä¸ªæ ·æœ¬éƒ½ä¼šå¯¹åº”ä¸€ä¸ªä»»åŠ¡çš„æ ‡è®°ã€‚åœ¨å–‚å…¥æ¨¡å‹æ—¶ï¼Œä¸€ä¸ªbatchå†…ä¼šæœ‰æ¥è‡ªå¤šä¸ªä»»åŠ¡çš„æ ·æœ¬ï¼Œæ ¹æ®ä»»åŠ¡ç±»å‹çš„æ ‡è®°ï¼Œåˆ†åˆ«ä½¿ç”¨å¯¹åº”çš„Task-specific Prompt Encoderæ¥è¡¨å¾è¿ç»­çš„æ¨¡æ¿ï¼Œæ‰€æœ‰çš„æ ·æœ¬éƒ½å–‚å…¥Universal Prompt Encoderä»¥è·å¾—é€šç”¨çš„è¿ç»­æ¨¡æ¿ã€‚</p></blockquote><ul><li><strong>å¼•å…¥å»åï¼ˆDe-basingï¼‰æŠ€æœ¯</strong>ï¼šä¸è®ºæ˜¯å°æ ·æœ¬è¿˜æ˜¯å…¨é‡æ•°æ®ï¼Œå³ä¾¿æ˜¯ç»Ÿè®¡åˆ†å¸ƒä¸Šå®Œå…¨ä¸€è‡´ï¼Œä¸åŒçš„ä»»åŠ¡çš„éš¾æ˜“ç¨‹åº¦æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤æ¨¡å‹åœ¨è®­ç»ƒçš„æ—¶å€™å¯èƒ½ææ˜“åå‘äºä¸€äº›ç®€å•ä»»åŠ¡ã€‚ä¸ºäº†ç¡®ä¿ä»»åŠ¡ä¹‹é—´è®­ç»ƒçš„å¹³è¡¡æ€§ï¼Œå¼•å…¥ä¸¤ä¸ªå»åæŠ€æœ¯ï¼Œåˆ†åˆ«æ˜¯Prototypical-based Debiasingå’ŒEntropy-based Debiasingï¼Œå…·ä½“çš„åšæ³•è¯¦è§åŸæ–‡ã€‚</li></ul><p><strong>Meta Prompt Tuningï¼ˆMPTï¼‰</strong><br>â€ƒâ€ƒè¯¥æ–¹æ³•æ˜¯é¢å‘ç¦»æ•£çš„æç¤ºï¼Œå…¶ä¸»è¦å…³æ³¨äºæ–‡æœ¬åˆ†ç±»ä»»åŠ¡ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œå…¶å¯¹åˆ†ç±»çš„èŒƒå¼è¿›è¡Œäº†ä¸€äº›è½¬æ¢ï¼Œå°†æ‰€æœ‰åˆ†ç±»ä»»åŠ¡å®šä¹‰ä¸ºâ€œYes/Noâ€é—®é¢˜ï¼Œä¸‹é¢å¯¹æ¯”ä¸€ä¸‹ä¸¤ç§ä¸åŒçš„èŒƒå¼ï¼š</p><blockquote><p><strong>ä¼ ç»Ÿçš„å¤šç±»åˆ†ç±»èŒƒå¼</strong>ï¼šå‡è®¾ä¸€ä¸ªåˆ†ç±»ä»»åŠ¡æœ‰ N N N ä¸ªç±»åˆ«ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå¥å­ x x x å°†ä¼šå¯¹åº”ä¸€ä¸ªæ ·æœ¬ ( x , y ) (x, y) (x,y)ï¼Œå…¶ä¸­ y y y æ˜¯ N N N ç±»ä¸­çš„ä¸€ä¸ªï¼›<br><strong>Yes/Noåˆ†ç±»èŒƒå¼</strong>ï¼šå‡è®¾ä¸€ä¸ªåˆ†ç±»ä»»åŠ¡æœ‰ N N N ä¸ªç±»åˆ«ï¼Œå°†æ¯ä¸€ä¸ªå¥å­å’Œç±»åˆ«ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œæ¥åˆ¤æ–­å®ƒä»¬ä¹‹é—´æ˜¯å¦åŒ¹é…ï¼Œå³ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æ ·æœ¬ ( x , y , Yes/No ) (x, y, \text{Yes/No}) (x,y,Yes/No)ã€‚è¿™æ ·çš„è¯ï¼Œä¸€ä¸ªå¥å­ x x x å°†ä¼šå¯¹åº” N N N ä¸ªæ ·æœ¬ã€‚åŸºäºYes/NoèŒƒå¼ï¼Œä¸è®ºç±»åˆ«æœ‰å¤šå°‘ï¼Œéƒ½å¯ä»¥è½¬æ¢ä¸ºç»Ÿä¸€çš„Yes/Noåˆ†ç±»ï¼Œä»è€Œä¸åŒç±»åˆ«çš„åˆ†ç±»ä»»åŠ¡ä¹Ÿå¯ä»¥æ··åˆèµ·æ¥è¿›è¡Œè®­ç»ƒã€‚</p></blockquote><p>â€ƒâ€ƒåœ¨è½¬æ¢èŒƒå¼çš„æ—¶å€™ï¼Œä¼šå‘ç°è¾“å…¥çš„å¥å­éœ€è¦èåˆæ ‡ç­¾ï¼Œå› æ­¤éœ€è¦æ¶‰åŠåˆ°ä¸ºä¸åŒæ ‡ç­¾è®¾è®¡å¯¹åº”çš„æŒ‡ä»¤ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯¹äºæƒ…æ„Ÿåˆ†æä»»åŠ¡ï¼Œè¾“å…¥çš„å¥å­æ˜¯â€œ x x x\=A total waste of timeâ€ï¼Œç»™å®šä¸€ä¸ªæ ‡ç­¾â€œPositiveâ€ï¼Œå¯¹åº”çš„æŒ‡ä»¤åˆ™æ˜¯â€œIs the review positive?â€ã€‚æ•´ä½“çš„è¾“å…¥æ˜¯ â€œ [ x ] [x] [x]. Is the review positive? Answer: [mask].â€ã€‚æ­¤æ—¶æˆ‘ä»¬åªéœ€è¦çº¦æŸmaskä½ç½®çš„è¾“å‡ºæ˜¯Yeså’ŒNoå³å¯ï¼Œä¾‹å¦‚æ¦‚ä¾‹å­ä¸­Noçš„æ¦‚ç‡æœ€å¤§</p><p><img src="https://img-blog.csdnimg.cn/3edca6f3e3cc4169875d6bea0335842f.png" alt></p><p>â€ƒâ€ƒç”±äºè¿›è¡Œäº†èŒƒå¼è½¬æ¢ï¼Œä¸è®ºæ˜¯æƒ…æ„Ÿåˆ†æï¼Œè¿˜æ˜¯é—®é¢˜åˆ†ç±»ã€ä¸»é¢˜åˆ†ç±»ï¼Œæ‰€æœ‰åˆ†ç±»ä»»åŠ¡éƒ½å¯ä»¥â€œä¸€è§†åŒä»â€ã€‚å› æ­¤å¯ä»¥é‡‡ç”¨å…ƒå­¦ä¹ çš„æ–¹æ³•ï¼Œå¦‚ä¸Šå›¾ï¼Œè®©æ¨¡å‹åœ¨å››ä¸ªä»»åŠ¡ä¸Šè¿›è¡ŒMulti-task Trainingï¼Œç„¶ååˆ©ç”¨å…ƒå­¦ä¹ æŠ€æœ¯ï¼ˆä¾‹å¦‚MAMLï¼‰å°†çŸ¥è¯†è¿ç§»åˆ°æ–°çš„ä»»åŠ¡ä¸Šï¼Œæœ€ååœ¨è¿™ä¸ªæ–°çš„ä»»åŠ¡ä¸Šè¿›è¡ŒéªŒè¯ã€‚</p><p>â€ƒâ€ƒMPTçš„ä¼˜ç‚¹æ˜¯å¯ä»¥å®ç°èŒƒå¼ç»Ÿä¸€ï¼Œè¿™å¯¹åç»­åŸºäºPromptçš„è¶…å¤§è§„æ¨¡å¤šä»»åŠ¡è®­ç»ƒå¥ å®šåŸºç¡€ï¼Œä½†æ˜¯å…¶ç¼ºç‚¹ä¹Ÿå¾ˆçªå‡ºï¼Œå³éœ€è¦ä¸ºä¸åŒä»»åŠ¡ä¸åŒç±»åˆ«è®¾è®¡å¯¹åº”çš„æŒ‡ä»¤ã€‚</p><h3 id="4-2-å¤ç”¨é¢„è®­ç»ƒç›®æ ‡â€”â€”å®ç°åŸºäºPromptçš„ç»Ÿä¸€èŒƒå¼"><a href="#4-2-å¤ç”¨é¢„è®­ç»ƒç›®æ ‡â€”â€”å®ç°åŸºäºPromptçš„ç»Ÿä¸€èŒƒå¼" class="headerlink" title="4.2 å¤ç”¨é¢„è®­ç»ƒç›®æ ‡â€”â€”å®ç°åŸºäºPromptçš„ç»Ÿä¸€èŒƒå¼"></a>4.2 å¤ç”¨é¢„è®­ç»ƒç›®æ ‡â€”â€”å®ç°åŸºäºPromptçš„ç»Ÿä¸€èŒƒå¼</h3><p>â€ƒâ€ƒæˆ‘ä»¬éœ€è¦æ€è€ƒï¼Œä¸Šè¿°æ‰€è®²çš„å†…å®¹ä¸ºä»€ä¹ˆè¦è®¾è®¡Templateï¼ˆå’ŒVerbalizerï¼‰ï¼Ÿä¸ºä»€ä¹ˆéƒ½è¦åŒ…å«mask tokenï¼Ÿå›é¡¾ç¬¬ä¸€èŠ‚æˆ‘ä»¬ä»‹ç»çš„å‡ ä¸ªé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Œæˆ‘ä»¬å‘ç°ç›®å‰ç»å¤§å¤šæ•°çš„åŒå‘é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹éƒ½åŒ…å«Masked Language Modelingï¼ˆMLMï¼‰ï¼Œå•å‘é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹éƒ½åŒ…å«Autoregressive Language Modelingï¼ˆALMï¼‰ï¼Œè¿™äº›ä»»åŠ¡æ˜¯é¢„è®­ç»ƒç›®æ ‡ï¼Œæœ¬è´¨ä¸Šæ˜¯é¢„æµ‹è¢«maskçš„ä½ç½®çš„è¯ï¼Œåœ¨è®­ç»ƒæ—¶è®©æ¨¡å‹ç†è§£è¯­è¨€çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ä¹‹æ‰€ä»¥è®¾è®¡Templateå’ŒæŒ‡ä»¤ï¼Œå°±æ˜¯å¸Œæœ›åœ¨ä¸‹æ¸¸ä»»åŠ¡æ—¶èƒ½å¤Ÿå¤ç”¨è¿™äº›é¢„è®­ç»ƒçš„ç›®æ ‡ï¼Œé¿å…å¼•å…¥æ–°çš„å‚æ•°è€Œå¯¼è‡´è¿‡æ‹Ÿåˆã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°†Promptå‡ååˆ°ä¸€ä¸ªæ–°çš„é«˜åº¦ï¼Œå³<strong>Prompt Tuningçš„æœ¬è´¨æ˜¯å¤ç”¨é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åœ¨é¢„è®­ç»ƒé˜¶æ®µæ‰€ä½¿ç”¨çš„ç›®æ ‡å’Œå‚æ•°</strong>ã€‚</p><blockquote><p>â€ƒâ€ƒåŸºäºHuggingfaceçš„é¢„è®­ç»ƒæ¨¡å‹ä»“åº“ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºLMheadï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªMLPï¼Œè¾“å…¥ä¸ºä¸€ä¸ªå¤§å°ä¸º[batch_size, sequence_length, hidden_size]çš„å¼ é‡ï¼Œè¾“å‡ºä¸º[batch_size, sequence_length, vocab_size]çš„æ¦‚ç‡åˆ†å¸ƒã€‚</p></blockquote><p>â€ƒâ€ƒç”±äºç»å¤§å¤šæ•°çš„è¯­è¨€æ¨¡å‹éƒ½é‡‡ç”¨MLMæˆ–ALMè¿›è¡Œè®­ç»ƒï¼Œæ‰€ä»¥æˆ‘ä»¬ç°å¦‚ä»Šæ‰€çœ‹åˆ°çš„å¤§å¤šæ•°åŸºäºPromptçš„åˆ†ç±»éƒ½è¦è®¾è®¡Templateå’ŒVerbalizerã€‚é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥æå¤§åŒ–åœ°åˆ©ç”¨MLMå’ŒALMçš„å…ˆéªŒçŸ¥è¯†åœ¨ä¸åŒçš„ä¸‹æ¸¸ä»»åŠ¡ä¸Šè·å¾—æ›´å¥½çš„è¡¨ç°ï¼Ÿæ˜¯å¦å¯ä»¥è®¾è®¡ä¸€ä¸ªå…¨æ–°çš„é¢„è®­ç»ƒä»»åŠ¡æ¥æ»¡è¶³ä¸€äº›ä¸‹æ¸¸ä»»åŠ¡çš„éœ€æ±‚å‘¢ï¼Ÿ</p><p>â€ƒâ€ƒæˆ‘ä»¬ä»‹ç»ä¸¤ä¸ªå……åˆ†åˆ©ç”¨è¿™ä¸ªæ€æƒ³çš„æ–¹æ³•ï¼š</p><ul><li><strong>ä¸‡ç‰©çš†å¯ç”Ÿæˆ</strong>ï¼šå°†æ‰€æœ‰ä»»åŠ¡ç»Ÿä¸€ä¸ºæ–‡æœ¬ç”Ÿæˆï¼Œæå¤§åŒ–åˆ©ç”¨å•å‘è¯­è¨€æ¨¡å‹ç›®æ ‡ï¼›</li><li><strong>ä¸‡ç‰©çš†å¯æŠ½å–</strong>ï¼šå°†æ‰€æœ‰ä»»åŠ¡ç»Ÿä¸€ä¸ºæŠ½å–å¼é˜…è¯»ç†è§£ï¼Œå¹¶è®¾è®¡æŠ½å–å¼é¢„è®­ç»ƒç›®æ ‡ï¼›</li><li><strong>ä¸‡ç‰©çš†å¯æ¨ç†</strong>ï¼šå°†æ‰€æœ‰ä»»åŠ¡å»ºæ¨¡ä¸ºè‡ªç„¶è¯­è¨€æ¨æ–­ï¼ˆNatural Language Inferenceï¼‰æˆ–ç›¸ä¼¼åº¦åŒ¹é…ä»»åŠ¡ã€‚</li></ul><h4 id="ï¼ˆ1ï¼‰ä¸‡ç‰©çš†å¯ç”Ÿæˆâ€”â€”åŸºäºç”Ÿæˆçš„PromptèŒƒå¼ç»Ÿä¸€"><a href="#ï¼ˆ1ï¼‰ä¸‡ç‰©çš†å¯ç”Ÿæˆâ€”â€”åŸºäºç”Ÿæˆçš„PromptèŒƒå¼ç»Ÿä¸€" class="headerlink" title="ï¼ˆ1ï¼‰ä¸‡ç‰©çš†å¯ç”Ÿæˆâ€”â€”åŸºäºç”Ÿæˆçš„PromptèŒƒå¼ç»Ÿä¸€"></a>ï¼ˆ1ï¼‰ä¸‡ç‰©çš†å¯ç”Ÿæˆâ€”â€”åŸºäºç”Ÿæˆçš„PromptèŒƒå¼ç»Ÿä¸€</h4><p>â€ƒâ€ƒåœ¨å«æœ‰å•å‘Transformerçš„è¯­è¨€æ¨¡å‹ä¸­ï¼ˆä¾‹å¦‚GPTã€BARTï¼‰ï¼Œéƒ½åŒ…å«è‡ªå›å½’è®­ç»ƒç›®æ ‡ï¼Œå³åŸºäºä¸Šä¸€ä¸ªtokenæ¥é¢„æµ‹å½“å‰çš„tokenï¼Œè€ŒåŒå‘è¯­è¨€æ¨¡å‹ä¸­çš„MLMå¯ä»¥è§†ä¸ºåªç”Ÿæˆä¸€ä¸ªtokençš„è‡ªå›å½’æ¨¡å‹ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥å°†åˆ†ç±»ä»»åŠ¡è§†ä¸ºä¸€ç§ç‰¹æ®Šçš„æ–‡æœ¬ç”Ÿæˆï¼Œå¹¶é…ä¸ŠVerbalizerï¼Œè¿™æ ·ï¼Œæ‰€æœ‰çš„NLPä»»åŠ¡éƒ½å¯ä»¥ç»Ÿä¸€ä¸ºç”Ÿæˆä»»åŠ¡ã€‚é’ˆå¯¹ä¸åŒçš„ä»»åŠ¡ï¼Œåªéœ€è¦æä¾›å¯¹åº”çš„æŒ‡ä»¤å’Œæ¨¡æ¿å³å¯ï¼ˆç”±äºæ˜¯ä½¿ç”¨å•å‘è¯­è¨€æ¨¡å‹ï¼Œå› æ­¤æ²¡æœ‰mask tokenï¼Œéœ€è¦ç”Ÿæˆçš„éƒ¨åˆ†ç½®äºæ–‡æœ¬æœ«å°¾ï¼‰ã€‚ä¸‹é¢ç»™å‡ºå‡ ä¸ªäº‹ä¾‹ï¼š</p><div class="table-container"><table><thead><tr><th>ä»»åŠ¡</th><th>æŒ‡ä»¤å’Œæ¨¡æ¿</th><th>æœŸæœ›ç”Ÿæˆå†…å®¹æ ·ä¾‹</th></tr></thead><tbody><tr><td>æƒ…æ„Ÿåˆ†æ</td><td>The movie review is [ x ] [x] [x]. It was</td><td>positive</td></tr><tr><td>ä¸»é¢˜åˆ†ç±»</td><td>Context: [ x ] [x] [x]. The topic is</td><td>sports</td></tr><tr><td>é˜…è¯»ç†è§£</td><td>Question: [ q ] [q] [q]. Passage: [ p ] [p] [p]. Answer:</td><td>last year</td></tr><tr><td>æ–‡æœ¬æ‘˜è¦</td><td>Context: [ x ] [x] [x]. Abstract:</td><td>The book has been published in two years.</td></tr></tbody></table></div><p>â€ƒâ€ƒåˆ©ç”¨æ­¤æ€æƒ³ï¼Œæœ‰å¾ˆå¤šå·¥ä½œè‡´åŠ›äºé€šè¿‡Promptä¸ç”Ÿæˆçš„æ€æƒ³å°†å„ç±»ä»»åŠ¡è¿›è¡Œç»Ÿä¸€ã€‚ä»¥é—®ç­”é¢†åŸŸä¸ºä¾‹ï¼Œé—®ç­”åŒ…æ‹¬ç”Ÿæˆå¼é—®ç­”ã€æŠ½å–å¼é—®ç­”ã€å¤šé¡¹é€‰æ‹©ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†å„ç§ç±»å‹çš„é—®ç­”å»ºæ¨¡ä¸ºç”Ÿæˆä»»åŠ¡ã€‚å…¸å‹çš„æ–¹æ³•ä¾‹å¦‚ï¼šã€Š<a href="https://aclanthology.org/2020.findings-emnlp.171.pdf">UNIFIEDQA: Crossing format boundaries with a single QA system</a>ã€‹ã€ã€Š<a href="https://aclanthology.org/2022.naacl-main.313.pdf">ProQA- Structural Prompt-based Pre-training for Unified Question Answering</a>ã€‹ï¼Œå…¶é‡‡ç”¨ç«¯åˆ°ç«¯çš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼ˆä¾‹å¦‚BARTã€T5ï¼‰ï¼Œå¹¶å¤ç”¨é¢„è®­ç»ƒé˜¶æ®µçš„è®­ç»ƒç›®æ ‡ã€‚</p><p><img src="https://img-blog.csdnimg.cn/2dfd55e209e64d828ccf4fed43c0166e.png" alt></p><p>â€ƒâ€ƒæœ€è¿‘å¤§ç«çš„ChatGPTåˆ™æ˜¯åŸºäºâ€œä¸‡ç‰©çš†å¯ç”Ÿæˆâ€çš„æ€æƒ³ï¼Œå°†å•å‘è¯­è¨€æ¨¡å‹çš„ALMå‘æŒ¥åˆ°æè‡´ï¼Œå®ç°å¯¹æ‰€æœ‰ä»»åŠ¡çš„å¤§ä¸€ç»Ÿï¼Œä¸ä¹‹ä¸ºä»£è¡¨çš„è¿˜æœ‰In-Context Learningã€Instruction-Tuningå’ŒChain-of-Thoughtï¼Œå°†åœ¨ç¬¬5ç« èŠ‚ä»‹ç»ã€‚</p><h4 id="ï¼ˆ2ï¼‰ä¸‡ç‰©çš†å¯æŠ½å–â€”â€”åŸºäºæŠ½å–å¼é˜…è¯»ç†è§£çš„PromptèŒƒå¼ç»Ÿä¸€"><a href="#ï¼ˆ2ï¼‰ä¸‡ç‰©çš†å¯æŠ½å–â€”â€”åŸºäºæŠ½å–å¼é˜…è¯»ç†è§£çš„PromptèŒƒå¼ç»Ÿä¸€" class="headerlink" title="ï¼ˆ2ï¼‰ä¸‡ç‰©çš†å¯æŠ½å–â€”â€”åŸºäºæŠ½å–å¼é˜…è¯»ç†è§£çš„PromptèŒƒå¼ç»Ÿä¸€"></a>ï¼ˆ2ï¼‰ä¸‡ç‰©çš†å¯æŠ½å–â€”â€”åŸºäºæŠ½å–å¼é˜…è¯»ç†è§£çš„PromptèŒƒå¼ç»Ÿä¸€</h4><p>â€ƒâ€ƒåŸºäºç”Ÿæˆçš„æ–¹æ³•å­˜åœ¨ä¸¤ä¸ªç¼ºç‚¹ï¼š</p><ul><li>å¿…é¡»è®©å¾…ç”Ÿæˆçš„éƒ¨åˆ†ç½®äºæ–‡æœ¬æœ«å°¾ï¼Œæ­¤æ—¶ä¼šçº¦æŸæŒ‡ä»¤å’Œæ¨¡æ¿çš„è®¾è®¡ï¼Œä¸åˆ©äºçµæ´»è¿ç”¨ï¼›</li><li>ç”±äºæ˜¯å¼€æ”¾å¼ç”Ÿæˆï¼Œç”Ÿæˆçš„å†…å®¹æ— æ³•æ§åˆ¶ï¼Œä¸”ä¾èµ–äºæ–‡æœ¬çš„é•¿åº¦ç­‰ï¼›</li><li>å¯¹äºä¸€äº›å…·æœ‰æ¡ä»¶é™åˆ¶çš„ä»»åŠ¡ï¼Œä¾‹å¦‚å¤šé¡¹é€‰æ‹©ã€ä¿¡æ¯æŠ½å–ç­‰ï¼Œç”Ÿæˆçš„å†…å®¹æˆ–è®¸ä¸ç¬¦åˆè¿™äº›æ¡ä»¶ã€‚ä¾‹å¦‚åœ¨åšå®ä½“æŠ½å–çš„æ—¶å€™ï¼Œéœ€è¦ç¡®ä¿ç”Ÿæˆçš„å®ä½“æ˜¯åœ¨æ–‡æœ¬ä¸­å‡ºç°çš„ã€‚</li></ul><p>â€ƒâ€ƒä¸ºæ­¤ï¼Œâ€œä¸‡ç‰©çš†å¯æŠ½å–â€çš„æ€æƒ³å¯ä»¥è§£å†³æ­¤ç±»é—®é¢˜ï¼Œå…¶æ€æƒ³æŒ‡å°†æ‰€æœ‰è‡ªç„¶è¯­è¨€ç†è§£ä»»åŠ¡è½¬æ¢ä¸ºæŠ½å–å¼é˜…è¯»ç†è§£çš„å½¢å¼ï¼Œä¸‹é¢ç»™å‡ºå½¢å¼åŒ–çš„å®šä¹‰ï¼š</p><blockquote><p><strong>æŠ½å–å¼é˜…è¯»ç†è§£ï¼ˆExtractive MRCï¼‰</strong>ï¼šç»™å®šä¸€ä¸ªé—®é¢˜ï¼ˆQuestionï¼‰ q = { q 1 , q 2 , â‹¯ â€‰ , q l q } q=\{q_1, q_2, \cdots, q_{l_q}\} q\={q1,q2,â‹¯,qlq}ï¼Œä¸€ç¯‡æ–‡ç« æˆ–æ–‡æœ¬ï¼ˆPassageï¼‰ p = { p 1 , p 2 , â‹¯ â€‰ , p l p } p=\{p_1, p_2, \cdots, p_{l_p}\} p\={p1,p2,â‹¯,plp}ï¼Œå…¶ä¸­ q i , p i q_i, p_i qi,pi åˆ†åˆ«è¡¨ç¤ºQuestionå’ŒPassageçš„tokenï¼Œ l q , l p l_q, l_p lq,lp åˆ†åˆ«è¡¨ç¤ºQuestionå’ŒPassageçš„é•¿åº¦ã€‚ä»»åŠ¡çš„ç›®æ ‡æ˜¯æ ¹æ®Questionï¼Œåœ¨Passageä¸­å¯»æ‰¾ä¸€ä¸ªåŒºé—´ [ s t a r t : e n d ] [start: end] [start:end] ä½œä¸ºç­”æ¡ˆ a = { p s t a r t , â‹¯ â€‰ , p e n d } a=\{p_{start}, \cdots, p_{end}\} a\={pstart,â‹¯,pend}ï¼Œ 1 â‰¤ s t a r t â‰¤ e n d â‰¤ l p 1\leq start\leq end\leq l_p 1â‰¤startâ‰¤endâ‰¤lpã€‚</p></blockquote><p>â€ƒâ€ƒé™¤äº†æŠ½å–å¼é˜…è¯»ç†è§£ä»»åŠ¡å¤–ï¼Œå…¶ä»–NLPä»»åŠ¡å¦‚ä½•è½¬æ¢ä¸ºè¿™ä¸ªå½¢å¼å‘¢ï¼Ÿæœ¬è´¨ä¸Šè¿˜æ˜¯åœ¨å¦‚ä½•è®¾è®¡æ¨¡æ¿å’ŒæŒ‡ä»¤ã€‚ä¸‹é¢ç»™å‡ºå‡ ä¸ªäº‹ä¾‹ï¼š</p><div class="table-container"><table><thead><tr><th>ä»»åŠ¡</th><th>æŒ‡ä»¤æ¨¡æ¿</th><th>æœŸæœ›è¾“å‡º</th></tr></thead><tbody><tr><td>æƒ…æ„Ÿåˆ†æ</td><td>The task aims to classify the orientation of moive review. Review: A waste of the time. Options: Positive, Negative.</td><td>start=90, end=98ï¼ˆâ€œNegativeâ€ï¼‰</td></tr><tr><td>ä¸»é¢˜åˆ†ç±»</td><td>ä¸‹é¢çš„æ–‡æœ¬å±äºä»€ä¹ˆæ–°é—»ï¼Ÿé‡‘èï¼Ÿä½“è‚²ï¼Ÿä¿é™©ï¼ŸåŒ»è¯ï¼Ÿç§‘æ•™ï¼Ÿæˆ‘å¸‚å°†å¯¹ä¸­å°å­¦æ•™æè¿›è¡Œé‡æ–°ä¿®è®¢å·¥ä½œã€‚</td><td>start=25, end=27ï¼ˆâ€œç§‘æ•™â€ï¼‰</td></tr><tr><td>å®ä½“è¯†åˆ«</td><td>å¯»æ‰¾æ–‡æœ¬ä¸­æ‰€æœ‰â€œåŸå¸‚â€ç±»å‹çš„å®ä½“ã€‚æ–‡æœ¬ï¼šå—äº¬å¸‚ä½äºæ±Ÿè‹çœè¥¿å—è§’ï¼Œå±äºæˆ‘å›½å»ºè®¾çš„ä¸­å¿ƒåŸå¸‚ä¹‹ä¸€ï¼Œå·²ç»å½¢æˆå—äº¬éƒ½å¸‚åœˆï¼ŒæœåŠ¡äºå‘¨è¾¹åŒ…æ‹¬æ»å·ã€é©¬éå±±ã€èŠœæ¹–ã€é•‡æ±Ÿã€æ‰¬å·ç­‰å¸‚ã€‚</td><td>start=21, end=23ï¼ˆâ€œå—äº¬â€ï¼‰ï¼›start=64, end=66ï¼ˆâ€œæ»å·â€ï¼‰ï¼›start=67, end=70ï¼ˆâ€œé©¬éå±±â€ï¼‰ï¼›â€¦</td></tr><tr><td>å¤šé¡¹é€‰æ‹©</td><td>è®¡ç®—åŠ å‡æ³•ï¼š35+14=ï¼Ÿé€‰é¡¹ï¼šA. 80, B. 49, C. 38, D.59.</td><td>start=22, end=26ï¼ˆâ€œB. 49â€ï¼‰</td></tr></tbody></table></div><p>â€ƒâ€ƒå¯ä»¥å‘ç°ï¼Œå¦‚æœæ˜¯åˆ†ç±»å‹çš„ä»»åŠ¡ï¼Œåªéœ€è¦é€šè¿‡æŒ‡ä»¤å’Œæ¨¡æ¿çš„å½¢å¼å°†æ‰€æœ‰ç±»åˆ«ç½—åˆ—èµ·æ¥å³å¯ã€‚åœ¨è®­ç»ƒæ—¶ï¼Œå¯ä»¥é‡‡ç”¨ä¸¤ç§æ–¹æ³•ï¼š</p><ul><li>è®¾è®¡æŠ½å–å¼é¢„è®­ç»ƒç›®æ ‡ï¼Œåœ¨æ— æ ‡æ³¨è¯­æ–™ä¸Šè¿›è¡Œè‡ªç›‘ç£è®­ç»ƒï¼›</li><li>æŒ‰ç…§é˜…è¯»ç†è§£çš„å½¢å¼ç»Ÿä¸€æ‰€æœ‰ä»»åŠ¡èŒƒå¼ï¼Œå¹¶æ··åˆæ‰€æœ‰ä»»åŠ¡è¿›è¡ŒCross-task Learningï¼Œå†åœ¨æ–°çš„ä»»åŠ¡ä¸Šè¿›è¡Œæµ‹è¯•ã€‚</li></ul><p>â€ƒâ€ƒç»å…¸çš„æ–¹æ³•æ¯”å¦‚<a href="https://arxiv.org/pdf/1904.09286">ã€ŠUnifying Question Answering, Text Classification, and Regression via Span Extractionã€‹</a>ï¼Œè‹å‰‘æ—æå‡ºçš„<a href="https://spaces.ac.cn/archives/8373">Global Pointer</a>ã€‚åšä¸»ä¹Ÿè¿ç”¨è¯¥æ€æƒ³åœ¨2022å¹´AIWINæ˜¥å­£èµ›â€œä¸­æ–‡ä¿é™©å°æ ·æœ¬â€ä¸­è·å¾—ç¬¬äºŒåæˆç»©ã€‚</p><p>â€ƒâ€ƒåŸºäºMRCçš„èŒƒå¼ç»Ÿä¸€æ–¹æ³•åˆ™æ˜¯æå‡ºæ–°çš„é¢„è®­ç»ƒç›®æ ‡â€”â€”åŒºé—´æŠ½å–ï¼Œå¹¶å·§å¦™çš„é›†æˆäº†ä¸€äº›æ¯”è¾ƒå¤æ‚çš„ä»»åŠ¡ï¼Œä¾‹å¦‚å®ä½“è¯†åˆ«ï¼ŒåŒæ—¶æŠ½å–å¼æ–¹æ³•ä¹Ÿå¯ä»¥å¾ˆå¥½åœ°è¿ç”¨åœ¨å¤šæ ‡ç­¾åˆ†ç±»é—®é¢˜ä¸Šï¼ŒåŒç†ï¼Œå®ä½“è¯†åˆ«å’Œå¤šåŒºé—´æŠ½å–QAä¹Ÿå±äºç±»ä¼¼å¤šæ ‡ç­¾é—®é¢˜ï¼Œå³éœ€è¦æŠ½å–å‡ºæ•°é‡ä¸ç­‰çš„åŒºé—´ã€‚ä½†æ˜¯ç¼ºç‚¹æ˜¯æ— æ³•è¿ç”¨åˆ°ç”Ÿæˆé—®é¢˜ä¸Šï¼Œä¸”ä¾èµ–äºå€™é€‰é¡¹ã€‚</p><h4 id="ï¼ˆ3ï¼‰ä¸‡ç‰©çš†å¯æ¨ç†â€”â€”åŸºäºNLIçš„PromptèŒƒå¼ç»Ÿä¸€"><a href="#ï¼ˆ3ï¼‰ä¸‡ç‰©çš†å¯æ¨ç†â€”â€”åŸºäºNLIçš„PromptèŒƒå¼ç»Ÿä¸€" class="headerlink" title="ï¼ˆ3ï¼‰ä¸‡ç‰©çš†å¯æ¨ç†â€”â€”åŸºäºNLIçš„PromptèŒƒå¼ç»Ÿä¸€"></a>ï¼ˆ3ï¼‰ä¸‡ç‰©çš†å¯æ¨ç†â€”â€”åŸºäºNLIçš„PromptèŒƒå¼ç»Ÿä¸€</h4><p>â€ƒâ€ƒå¦å¤–ä¸€ä¸ªæ–¹æ³•åˆ™æ˜¯å°†æ‰€æœ‰ä»»åŠ¡å»ºæ¨¡ä¸ºNLIå½¢å¼ï¼Œå…¶ä¸ä¸Šæ–‡ä»‹ç»çš„MPTæ¯”è¾ƒç±»ä¼¼ï¼Œé™¤äº†MPTä»¥å¤–ï¼Œ<a href="https://arxiv.org/pdf/2104.14690.pdf">ã€ŠEntailment as Few-Shot Learnerã€‹ï¼ˆEFLï¼‰</a>å’Œ<a href="https://blog.csdn.net/qq_36426650/article/details/122255324">NSP-BERT</a>ä¹Ÿæ˜¯ç±»ä¼¼çš„æ–¹æ³•ï¼Œå…¶æ€æƒ³æ˜¯å¤ç”¨BERTä¸­çš„Next Sentence Predictionï¼ˆNSPï¼‰çš„é¢„è®­ç»ƒç›®æ ‡ã€‚ä¸‹é¢ç»™å‡ºå‡ ä¸ªäº‹ä¾‹ï¼š</p><p><img src="https://img-blog.csdnimg.cn/93a04de22249498f8e9c45a622d25a1a.png" alt></p><p>â€ƒâ€ƒé€šå¸¸å¯ä»¥ç›´æ¥ä½¿ç”¨NSPå¯¹åº”çš„LMheadè¿›è¡Œå¾®è°ƒï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¿˜éœ€è¦è€ƒè™‘å¦‚ä½•è¿›è¡Œè´Ÿé‡‡æ ·ï¼Œä¸€èˆ¬æ–¹æ³•æ˜¯ç›´æ¥é€‰æ‹©å…¶ä»–ç±»åˆ«ä½œä¸ºè´Ÿæ ·æœ¬ã€‚</p><blockquote><p>â€ƒâ€ƒä¾‹å¦‚ä¸€ä¸ªåˆ†ç±»é—®é¢˜ä¸­æœ‰ N N N ä¸ªç±»åˆ«ã€‚ç»™å®šä¸€ä¸ªå¥å­æœ‰å¯¹åº” k k k ä¸ªæ­£ç¡®çš„ç±»åˆ«ï¼ˆground truthï¼‰ï¼Œå½“ k = 1 k=1 k\=1 æ—¶å°±æ˜¯å•æ ‡ç­¾çš„åˆ†ç±»ï¼Œ k &gt; 1 k&gt;1 k>1 åˆ™æ˜¯å¤šæ ‡ç­¾åˆ†ç±»ã€‚é‚£ä¹ˆæ¯ä¸ªå¥å­å°±å¯ä»¥å¾—åˆ° k k k ä¸ªæ­£æ ·æœ¬ï¼ˆå³è¾“å…¥å¥å­ä¸å¯¹åº”æ ‡ç­¾æ˜¯è•´å«å…³ç³»çš„ï¼‰å’Œ N âˆ’ k N-k Nâˆ’k ä¸ªè´Ÿæ ·æœ¬ã€‚åœ¨è®­ç»ƒçš„æ—¶å€™ï¼Œåˆ™å¯ä»¥æ„å»ºä¸€ä¸ªå¥å­-ç±»åˆ«çŸ©é˜µ M M Mï¼Œå…¶ä¸­ M i j âˆˆ { 0 , 1 } M_{ij}\in\{0, 1\} Mijâˆˆ{0,1} è¡¨ç¤ºç¬¬ i i i ä¸ªå¥å­ä¸ç¬¬ j j j ä¸ªç±»åˆ«æ˜¯å¦å­˜åœ¨è•´å«å…³ç³»ã€‚</p></blockquote><p>â€ƒâ€ƒä¸‹å›¾ç»™å‡ºä¼ ç»ŸFine-tuningï¼ˆå›¾ï¼ˆaï¼‰ï¼‰ã€åŸºäºMLMçš„Prompt-Tuningï¼ˆå›¾ï¼ˆbï¼‰ï¼‰å’ŒåŸºäºNLIçš„Prompt-Tuningï¼ˆå›¾ï¼ˆcï¼‰ï¼‰çš„å¯¹æ¯”ï¼š</p><p><img src="https://img-blog.csdnimg.cn/df482ce55f1c499f9c58cf586884e1c2.png" alt></p><p>å¯ä»¥å‘ç°ï¼Œä¸¤ç§Prompt-Tuningæ–¹æ³•çš„å…±åŒç‚¹æ˜¯éƒ½æ˜¯å¤ç”¨äº†é¢„è®­ç»ƒé˜¶æ®µæ‰€ä½¿ç”¨çš„ç›®æ ‡å’Œå‚æ•°ï¼Œä¸åŒç‚¹æ˜¯å¯¹ä»»åŠ¡å»ºæ¨¡çš„æ–¹å¼å’ŒæŒ‡ä»¤æ¨¡æ¿çš„è®¾è®¡æœ‰æ‰€ä¸åŒã€‚åœ¨å¤ç”¨NSPæ—¶ï¼Œåˆ™éœ€è¦ç½—åˆ—æ‰€æœ‰çš„ç±»åˆ«å¹¶ä¸è¾“å…¥æ ·æœ¬åšæ‹¼æ¥ï¼Œä»è€Œå°†å¤šç±»åˆ†ç±»é—®é¢˜è½¬æ¢ä¸ºåˆ¤æ–­è¾“å…¥ä¸æ ‡ç­¾æ˜¯å¦å­˜åœ¨è•´å«å…³ç³»ï¼ˆEntailmentï¼‰ã€‚</p><p>â€ƒâ€ƒå¦å¤–ï¼Œè¯¥æ€æƒ³ä¹Ÿåœ¨æœ€è¿‘å¤§ç«çš„å¤šæ¨¡æ€æ¨¡å‹<a href="https://zhuanlan.zhihu.com/p/512546830">CLIP</a>æ¨¡å‹ä¸­åº”ç”¨ï¼Œé€šè¿‡è®¾è®¡Promptçš„å½¢å¼å¯¹æ–‡æœ¬å’Œå›¾åƒè¿›è¡ŒåŒ¹é…ï¼Œå¹¶è®¾è®¡å¯¹æ¯”å­¦ä¹ ç›®æ ‡è¿›è¡Œé¢„è®­ç»ƒã€‚</p><h3 id="4-3-Promptçš„æœ¬è´¨æ˜¯å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ "><a href="#4-3-Promptçš„æœ¬è´¨æ˜¯å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ " class="headerlink" title="4.3 Promptçš„æœ¬è´¨æ˜¯å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ "></a>4.3 Promptçš„æœ¬è´¨æ˜¯å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ </h3><p>â€ƒâ€ƒæ ¹æ®å‰æ–‡çš„è®²è§£ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå®ç°Prompt-Tuningåªéœ€è¦è€ƒè™‘å¦‚ä½•è®¾è®¡æ¨¡æ¿æˆ–æŒ‡ä»¤ï¼Œè€Œæ¨¡å‹å’Œè®­ç»ƒç›®æ ‡åˆ™éƒ½æ˜¯å¤ç”¨é¢„è®­ç»ƒé˜¶æ®µçš„ï¼Œå³åœ¨æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ— é¡»æ·»åŠ ä»»ä½•å‚æ•°ï¼ˆæˆ–åªéœ€è¦æ·»åŠ éå¸¸å°‘é‡çš„ä¸æ¨¡æ¿æœ‰å…³çš„å‚æ•°ï¼‰ï¼Œè€Œå…¶ä»–å‚æ•°éƒ½æ˜¯è®­ç»ƒå¥½çš„ã€‚åŸºäºè¿™ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬å†ä¸€æ¬¡å°†Promptå‡ååˆ°æ›´é«˜çš„å±‚é¢â€”â€”<strong>Promptçš„æœ¬è´¨æ˜¯å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ ï¼ˆParameter-Efficient Learningï¼ŒPELï¼‰</strong>ã€‚</p><blockquote><p><strong>å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ çš„èƒŒæ™¯</strong>ï¼šåœ¨ä¸€èˆ¬çš„è®¡ç®—èµ„æºæ¡ä»¶ä¸‹ï¼Œå¤§è§„æ¨¡çš„æ¨¡å‹ï¼ˆä¾‹å¦‚GPT-3ï¼‰å¾ˆéš¾å†è¿›è¡Œå¾®è°ƒï¼Œå› ä¸ºæ‰€æœ‰çš„å‚æ•°éƒ½éœ€è¦è®¡ç®—æ¢¯åº¦å¹¶è¿›è¡Œæ›´æ–°ï¼Œæ¶ˆè€—æ—¶é—´å’Œç©ºé—´èµ„æºã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ è¢«æå‡ºï¼Œå…¶æ—¨åœ¨ç¡®ä¿æ¨¡å‹æ•ˆæœä¸å—å¤ªå¤§å½±å“çš„æ¡ä»¶ä¸‹å°½å¯èƒ½åœ°æé«˜è®­ç»ƒçš„æ—¶é—´å’Œç©ºé—´æ•ˆç‡ã€‚<br><strong>å‚æ•°æœ‰æ•ˆæ€§è®­ç»ƒ</strong>ï¼šåœ¨å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œå¤§æ¨¡å‹ä¸­åªéœ€è¦æŒ‡å®šæˆ–é¢å¤–æ·»åŠ å°‘é‡çš„å¯è®­ç»ƒå‚æ•°ï¼Œè€Œå…¶ä½™çš„å‚æ•°å…¨éƒ¨å†»ç»“ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜æ¨¡å‹çš„è®­ç»ƒæ•ˆç‡çš„åŒæ—¶ï¼Œç¡®ä¿æŒ‡æ ‡ä¸ä¼šå—åˆ°å¤ªå¤§å½±å“ã€‚</p></blockquote><p>â€ƒâ€ƒå¸¸è§ç»å…¸çš„å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ æœ‰<a href="http://proceedings.mlr.press/v97/houlsby19a.html">Adapter-Tuning</a>ã€<a href="https://aclanthology.org/2021.acl-long.353.pdf">Prefix-Tuning</a>ã€<a href="https://aclanthology.org/2022.acl-short.1.pdf">BitFit</a>ã€‚ä¸‹é¢è¿›è¡Œç®€å•çš„ä»‹ç»ã€‚</p><h4 id="ï¼ˆ1ï¼‰Adapter-Tuning"><a href="#ï¼ˆ1ï¼‰Adapter-Tuning" class="headerlink" title="ï¼ˆ1ï¼‰Adapter-Tuning"></a>ï¼ˆ1ï¼‰Adapter-Tuning</h4><p>â€ƒâ€ƒAdapter-Tuningåœ¨2019å¹´æå‡ºï¼Œå…¶é¢å‘é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ ã€‚åœ¨å¤šå±‚Transformeræ¨¡å‹ä¸­ï¼Œåœ¨å¾®è°ƒè¿‡ç¨‹ä¸­æ‰€æœ‰çš„å‚æ•°éƒ½éœ€è¦æ›´æ–°ï¼Œæ˜¾ç„¶å¹¶ä¸æ˜¯æœ‰æ•ˆçš„ã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè¯¥æ–¹æ³•æå‡ºå›ºå®šTransformerçš„å…¨éƒ¨å‚æ•°ï¼Œç„¶ååœ¨Transformerçš„æ¯ä¸€ä¸ªBlocké‡ŒåµŒå…¥ä¸€äº›æ–°åˆå§‹åŒ–çš„Adapter Networkã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/41f2ac65394c4e819629f1debeaf6a96.png" alt></p><p>â€ƒâ€ƒAdapterä½äºFeed-Forward Layerä¹‹åã€æ®‹å·®è¿æ¥ä¹‹å‰ã€‚Adapteræœ¬è´¨ä¸Šå°±æ˜¯ä¸¤å±‚MLPï¼Œåˆ†åˆ«è´Ÿè´£å°†Transformerçš„è¡¨å¾é™ç»´å’Œå‡ç»´ï¼ˆå³å›¾ï¼‰ã€‚åŸºäºAdapterçš„æ–¹æ³•ï¼Œ<strong>åªéœ€è¦æ·»åŠ ä¸åˆ°5%çš„å¯è®­ç»ƒå‚æ•°ï¼Œå³å¯ä»¥å‡ ä¹è¾¾åˆ°å…¨å‚æ•°è®­ç»ƒçš„æ•ˆæœ</strong>ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¤§å¤§èŠ‚çœäº†è®­ç»ƒæ—¶é—´ï¼Œåšåˆ°æ—¶é—´æœ‰æ•ˆæ€§ã€‚å› æ­¤åœ¨çœŸå®åœºæ™¯åº”ç”¨æ—¶ï¼Œ<strong>ä¸åŒçš„ä»»åŠ¡æˆ‘ä»¬ä¸éœ€è¦é‡æ–°å¯¹æ•´ä¸ªé¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œæˆ‘ä»¬åªéœ€è¦ä¿å­˜Adapterå³å¯</strong>ï¼Œè€Œé¢„è®­ç»ƒæ¨¡å‹çš„å…¶ä»–å‚æ•°éƒ½æ˜¯åŸå§‹é¢„è®­ç»ƒçš„ï¼Œè¿™æ ·å°±åšåˆ°äº†ç©ºé—´çš„æœ‰æ•ˆæ€§ã€‚</p><h4 id="ï¼ˆ2ï¼‰Prefix-Tuning"><a href="#ï¼ˆ2ï¼‰Prefix-Tuning" class="headerlink" title="ï¼ˆ2ï¼‰Prefix-Tuning"></a>ï¼ˆ2ï¼‰Prefix-Tuning</h4><p>â€ƒâ€ƒPrefix-Tuningä¹Ÿæ˜¯å¾ˆç»å…¸çš„å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ ï¼Œå…¶æ˜¯å—åˆ°Prompt-Tuningçš„å¯å‘ã€‚æˆ‘ä»¬è¯´Prompt-Tuningçš„æœ¬è´¨æ˜¯å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ ï¼Œæ˜¯å› ä¸ºæ•´ä¸ªé¢„è®­ç»ƒæ¨¡å‹å‚æ•°å¯ä»¥å…¨éƒ¨å›ºå®šï¼Œåªéœ€è¦å¯¹Templateå¯¹åº”çš„å°‘é‡å‚æ•°ï¼ˆä¾‹å¦‚è¿ç»­æ¨¡æ¿çš„Prompt Encoderã€ä¼ªæ ‡è®°å¯¹åº”çš„Embeddingç­‰ï¼‰è¿›è¡Œè®­ç»ƒã€‚åœ¨Prefix-Tuningä¸­ï¼Œåˆ™æ˜¯é™¤äº†å¯¹è¾“å…¥å±‚æ·»åŠ æ¨¡æ¿å¤–ï¼Œè¿˜å¯¹Transformerçš„æ¯ä¸€å±‚æ·»åŠ â€œæ¨¡æ¿â€ã€‚Prefix-Tuningä¸ä¼ ç»ŸFine-tuningçš„å¯¹æ¯”å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/b55d1a89cff34c4181c44103a47e86bf.png" alt></p><p>å¯ä»¥çœ‹åˆ°ï¼ŒTransformerçš„å‚æ•°å®Œå…¨å›ºå®šï¼Œè€Œæˆ‘ä»¬åªéœ€è¦å¯¹Prefixéƒ¨åˆ†è¿›è¡Œè®­ç»ƒå³å¯ï¼Œå¯¹äºä¸åŒçš„ä»»åŠ¡è®­ç»ƒä¸åŒçš„Prefixï¼Œåœ¨å®é™…ä½¿ç”¨æ—¶ï¼ŒæŒ‘é€‰ä»»åŠ¡ç›¸å…³çš„Prefixå’ŒTransformerè¿›è¡Œç»„è£…ï¼Œå®ç°å¯æ’æ‹”å¼çš„åº”ç”¨ã€‚</p><p>â€ƒâ€ƒä¸Prefix-Tuningç±»ä¼¼çš„æ–¹æ³•è¿˜æœ‰<a href="https://blog.csdn.net/qq_36426650/article/details/120806554">P-tuning V2</a>ï¼Œä¸åŒä¹‹å¤„åœ¨äºPrefix-Tuningæ˜¯é¢å‘æ–‡æœ¬ç”Ÿæˆé¢†åŸŸçš„ï¼ŒP-tuning V2é¢å‘è‡ªç„¶è¯­è¨€ç†è§£ã€‚ä½†æœ¬è´¨ä¸Šå®Œå…¨ç›¸åŒã€‚ä¸‹å›¾é’ˆå¯¹Prefix-tuningï¼ˆP-tuning V2ï¼‰ä¸Prompt-Tuningå¯¹æ¯”ï¼ˆé»„è‰²éƒ¨åˆ†è¡¨ç¤ºå¯è®­ç»ƒçš„å‚æ•°ï¼Œè“è‰²è¡¨ç¤ºè¢«å†»ç»“çš„å‚æ•°ï¼‰ï¼š<br><img src="https://img-blog.csdnimg.cn/4240913533d3411a91a099396e1a89da.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å·¦å›¾è¡¨ç¤ºçš„æ˜¯åŸºäºè¿ç»­æç¤ºçš„Prompt-Tuningï¼ˆä¾‹å¦‚P-tuningï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°åªæœ‰è¾“å…¥å±‚å¯¹åº”æ¨¡æ¿éƒ¨åˆ†çš„Embeddingå’ŒMLPå‚æ•°æ˜¯å¯è®­ç»ƒçš„ï¼Œå³å›¾éƒ¨åˆ†è¡¨ç¤ºPrefix-Tuningï¼ˆP-tuning V2ï¼‰ï¼ŒTransformerçš„æ¯ä¸€å±‚çš„å‰ç¼€éƒ¨åˆ†ä¹Ÿæ˜¯å¯è®­ç»ƒçš„ï¼Œå¯ä»¥æŠ½è±¡çš„è®¤ä¸ºæ˜¯åœ¨æ¯ä¸€å±‚æ·»åŠ äº†è¿ç»­çš„æ¨¡æ¿ã€‚ä½†æ˜¯å®é™…ä¸Šï¼ŒPrefix-Tuningï¼ˆP-tuning V2ï¼‰å¹¶ä¸æ˜¯çœŸæ­£çš„åœ¨æ¯ä¸€å±‚æ·»åŠ æ¨¡æ¿ï¼Œè€Œæ˜¯é€šè¿‡HuggingFaceæ¡†æ¶å†…ç½®çš„past_key_valueå‚æ•°æ§åˆ¶ã€‚å…¶æœ¬è´¨ä¸Šä¸Adapterç±»ä¼¼ï¼Œæ˜¯åœ¨Transformerå†…éƒ¨å¯¹Keyå’ŒValueæ’å…¥å¯è®­ç»ƒçš„ä¸¤ä¸ªMLPã€‚</p><p>â€ƒâ€ƒæœ‰ç›¸å…³å·¥ä½œå¯¹Adapterã€Prefix-Tuningã€LoRAç­‰å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ è¿›è¡Œäº†é›†æˆï¼Œå› ä¸º<strong>è¿™äº›å‚æ•°æœ‰æ•ˆæ€§å­¦ä¹ æ–¹æ³•æœ¬è´¨ä¸Šéƒ½æ˜¯æ’å…¥å°‘é‡çš„æ–°çš„å‚æ•°ï¼Œè¿™äº›æ–°çš„å‚æ•°å¯ä»¥å¯¹é¢„è®­ç»ƒæ¨¡å‹èµ·åˆ°æç¤ºä½œç”¨ï¼Œåªä¸è¿‡å¹¶ä¸æ˜¯ä»¥äººç±»å¯è¯»çš„ç¦»æ•£çš„æ¨¡æ¿å½¢å¼ä½“ç°è€Œå·²</strong>ã€‚ä¸‹å›¾æ˜¯<a href="https://aclanthology.org/2022.acl-long.433.pdf">ã€ŠUniPELT: A Unified Framework for Parameter-Efficient Language Model Tuningã€‹</a>æå‡ºå°†è¿™äº›å‚æ•°æœ‰æ•ˆæ€§æ–¹æ³•è¿›è¡Œç»Ÿä¸€ï¼Œæå‡ºUniPELTæ¡†æ¶ï¼š</p><p><img src="https://img-blog.csdnimg.cn/f1211d0e55f64e7b92714d3692efa290.png" alt></p><h4 id="ï¼ˆ3ï¼‰BitFit"><a href="#ï¼ˆ3ï¼‰BitFit" class="headerlink" title="ï¼ˆ3ï¼‰BitFit"></a>ï¼ˆ3ï¼‰BitFit</h4><p>â€ƒâ€ƒBitFitçš„æ€æƒ³æ›´ç®€å•ï¼Œå…¶ä¸éœ€è¦å¯¹é¢„è®­ç»ƒæ¨¡å‹åšä»»ä½•æ”¹åŠ¨ï¼Œåªéœ€è¦æŒ‡å®šç¥ç»ç½‘ç»œä¸­çš„åå‘ï¼ˆBiasï¼‰ä¸ºå¯è®­ç»ƒå‚æ•°å³å¯ï¼ŒBitFitçš„å‚æ•°é‡åªæœ‰ä¸åˆ°2%ï¼Œä½†æ˜¯å®éªŒæ•ˆæœå¯ä»¥æ¥è¿‘å…¨é‡å‚æ•°ã€‚</p><p>â€ƒâ€ƒä»‹ç»äº†ä¸Šè¿°çš„ä¸€äº›å‚æ•°æœ‰æ•ˆæ€§æ–¹æ³•ï¼Œæˆ‘ä»¬å‘ç°ï¼ŒPrompt-Tuningä¹Ÿç¬¦åˆå…¶ä¸»æ—¨ã€‚åŸºäºå‚æ•°æœ‰æ•ˆæ€§çš„æ€æƒ³ï¼Œä¹Ÿæœ‰è®¸å¤šå·¥ä½œè‡´åŠ›äºPromptä¸å‚æ•°æœ‰æ•ˆæ€§çš„ç»“åˆï¼Œä¾‹å¦‚<a href="https://aclanthology.org/2022.acl-long.433.pdf">ã€ŠDelta Tuning: A Comprehensive Study of Parameter Efficient Methods for Pre-trained Language Modelsã€‹</a>ã€<a href="https://aclanthology.org/2022.findings-naacl.174.pdf">ã€ŠLiST: Lite Prompted Self-training Makes Parameter-efficient Few-shot Learnersã€‹</a>ã€<a href="https://aclanthology.org/2022.findings-naacl.174.pdf">ã€ŠMaking Parameter-efficient Tuning More Efficient: A Unified Framework for Classification Tasksã€‹</a>ã€<a href="https://openreview.net/forum?id=DhzIU48OcZh">ã€ŠP-Adapters- Robustly Extracting Factual Information from Language Models with Diverse Promptsã€‹</a>ã€<a href="https://aclanthology.org/2022.coling-1.552.pdf">ã€ŠContext-Tuning: Learning Contextualized Prompts for Natural Language Generationã€‹</a>ï¼Œç”±äºç›¸å…³å·¥ä½œéå¸¸å¤šè€Œä¸”æ›´æ–°é¢‘ç¹ï¼Œè¿™é‡Œä¸ä¸€ä¸€ä»‹ç»ã€‚</p><hr><h2 id="-4"><a href="#-4" class="headerlink" title=" "></a> </h2><p>ç¬¬äº”ç« ï¼šé¢å‘è¶…å¤§è§„æ¨¡æ¨¡å‹çš„Prompt-Tuning</p><hr><p>â€ƒâ€ƒPrompt-Tuningå‘å±•çš„ä¸¤å¹´æ¥ï¼Œæœ‰è¯¸å¤šå·¥ä½œå‘ç°ï¼Œå¯¹äºè¶…è¿‡10äº¿å‚æ•°é‡çš„æ¨¡å‹æ¥è¯´ï¼ŒPrompt-Tuningæ‰€å¸¦æ¥çš„å¢ç›Šè¿œè¿œé«˜äºæ ‡å‡†çš„Fine-tuningï¼Œå°æ ·æœ¬ç”šè‡³æ˜¯é›¶æ ·æœ¬çš„æ€§èƒ½ä¹Ÿèƒ½å¤Ÿæå¤§åœ°è¢«æ¿€å‘å‡ºæ¥ï¼Œå¾—ç›Šäºè¿™äº›æ¨¡å‹çš„<strong>å‚æ•°é‡è¶³å¤Ÿå¤§</strong>ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨äº†<strong>è¶³å¤Ÿå¤šçš„è¯­æ–™</strong>ï¼ŒåŒæ—¶è®¾è®¡çš„<strong>é¢„è®­ç»ƒä»»åŠ¡è¶³å¤Ÿæœ‰æ•ˆ</strong>ã€‚æœ€ä¸ºç»å…¸çš„å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹åˆ™æ˜¯2020å¹´æå‡ºçš„GPT-3ï¼Œå…¶æ‹¥æœ‰å¤§çº¦1750äº¿çš„å‚æ•°ï¼Œä¸”å‘ç°åªéœ€è¦è®¾è®¡åˆé€‚çš„æ¨¡æ¿æˆ–æŒ‡ä»¤å³å¯ä»¥<strong>å®ç°å…å‚æ•°è®­ç»ƒçš„é›¶æ ·æœ¬å­¦ä¹ </strong>ã€‚</p><p>â€ƒâ€ƒ2022å¹´åº•åˆ°2023å¹´åˆï¼Œå›½å†…å¤–ä¹Ÿæ€èµ·äº†AIGCçš„æµªæ½®ï¼Œå…¸å‹ä»£è¡¨æ˜¯OpenAIå‘å¸ƒçš„ChatGPTã€GPT-4å¤§æ¨¡å‹ï¼ŒGoogleå‘å¸ƒçš„Bardä»¥åŠç™¾åº¦å…¬å¸å‘å¸ƒçš„æ–‡å¿ƒä¸€è¨€ç­‰ã€‚è¶…å¤§è§„æ¨¡æ¨¡å‹è¿›å…¥æ–°çš„çºªå…ƒï¼Œè€Œè¿™äº›è½°åŠ¨ä¸–ç•Œçš„äº§ç‰©ï¼Œç¦»ä¸å¼€å¼ºå¤§çš„Prompt-TuningæŠ€æœ¯ã€‚æœ¬æ–‡é»˜è®¤ä»¥GPT-3ä¸ºä¾‹ï¼Œä»‹ç»å‡ ä¸ªé¢å‘è¶…å¤§è§„æ¨¡çš„Prompt-Tuningæ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºï¼š</p><ul><li><strong>ä¸Šä¸‹æ–‡å­¦ä¹  In-Context Learningï¼ˆICLï¼‰</strong>ï¼šç›´æ¥æŒ‘é€‰å°‘é‡çš„è®­ç»ƒæ ·æœ¬ä½œä¸ºè¯¥ä»»åŠ¡çš„æç¤ºï¼›</li><li><strong>æŒ‡ä»¤å­¦ä¹  Instruction-tuning</strong>ï¼šæ„å»ºä»»åŠ¡æŒ‡ä»¤é›†ï¼Œä¿ƒä½¿æ¨¡å‹æ ¹æ®ä»»åŠ¡æŒ‡ä»¤åšå‡ºåé¦ˆï¼›</li><li><strong>æ€ç»´é“¾ Chain-of-Thoughtï¼ˆCoTï¼‰</strong>ï¼šç»™äºˆæˆ–æ¿€å‘æ¨¡å‹å…·æœ‰æ¨ç†å’Œè§£é‡Šçš„ä¿¡æ¯ï¼Œé€šè¿‡çº¿æ€§é“¾å¼çš„æ¨¡å¼æŒ‡å¯¼æ¨¡å‹ç”Ÿæˆåˆç†çš„ç»“æœã€‚</li></ul><h3 id="5-1-In-Context-Learningï¼ˆä¸Šä¸‹æ–‡å­¦ä¹ ï¼‰"><a href="#5-1-In-Context-Learningï¼ˆä¸Šä¸‹æ–‡å­¦ä¹ ï¼‰" class="headerlink" title="5.1 In-Context Learningï¼ˆä¸Šä¸‹æ–‡å­¦ä¹ ï¼‰"></a>5.1 In-Context Learningï¼ˆä¸Šä¸‹æ–‡å­¦ä¹ ï¼‰</h3><p>â€ƒâ€ƒIn-Context learningï¼ˆICLï¼‰æœ€æ—©åœ¨GPT-3ä¸­æå‡ºï¼Œ<strong>æ—¨åœ¨ä»è®­ç»ƒé›†ä¸­æŒ‘é€‰å°‘é‡çš„æ ‡æ³¨æ ·æœ¬ï¼Œè®¾è®¡ä»»åŠ¡ç›¸å…³çš„æŒ‡ä»¤å½¢æˆæç¤ºæ¨¡æ¿ï¼Œç”¨äºæŒ‡å¯¼æµ‹è¯•æ ·æœ¬ç”Ÿæˆç›¸åº”çš„ç»“æœ</strong>ã€‚ICTçš„å·¥ä½œåŸç†å¦‚ä¸‹æ‰€ç¤ºï¼š</p><blockquote><p>â€ƒâ€ƒ<strong>In-Context Learningå½¢å¼åŒ–å®šä¹‰</strong>ï¼šç»™å®šä¸€ä¸ªè®­ç»ƒé›† D t r a i n \mathcal{D}_{train} Dtrain å’Œä¸€ä¸ªæµ‹è¯•é›† D t e s t \mathcal{D}_{test} Dtest ï¼ˆå› ä¸ºICTä¸æ¶‰åŠå‚æ•°æ›´æ–°ï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹æ— éœ€éªŒè¯é›†ï¼‰ï¼Œç»™å®šè¯¥ä»»åŠ¡çš„æŒ‡ä»¤æ¨¡æ¿ T \mathcal{T} Tï¼Œç»™å®šä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹è®°ä½œ F \mathcal{F} Fã€‚ä»»åŠ¡çš„ç›®æ ‡æ˜¯ä»è®­ç»ƒé›† D t r a i n \mathcal{D}_{train} Dtrain ä¸­é‡‡æ · K K K ä¸ªè®­ç»ƒæ ·æœ¬ { ( X k , Y k ) } k = 0 K âˆˆ D t r a i n \{(X_k, Y_k)\}_{k=0}^K\in\mathcal{D}_{train} {(Xk,Yk)}k\=0KâˆˆDtrainï¼ˆç§°ä½œ<strong>In-Context Examples</strong>ï¼‰ï¼Œæ ¹æ®æŒ‡ä»¤æ¨¡æ¿ T \mathcal{T} Tï¼Œå°†è¿™ K K K ä¸ªè®­ç»ƒæ ·æœ¬è¿›è¡Œçº¿æ€§æ‹¼æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªä¸Šä¸‹æ–‡æ¨¡æ¿ï¼ˆ<strong>ç§°ä½œDemonstration</strong>ï¼‰ï¼Œè®°ä½œ T ( ( X 1 , Y 1 ) , â‹¯ â€‰ , ( X k , Y k ) ) \mathcal{T}((X_1, Y_1), \cdots, (X_k, Y_k)) T((X1,Y1),â‹¯,(Xk,Yk))ã€‚ç»™å®šçš„ä¸€ä¸ªæµ‹è¯•æ ·æœ¬ ( X ~ ) âˆˆ D t e s t (\tilde{X})\in\mathcal{D}_{test} (X~)âˆˆDtestï¼Œå°†å…¶ä¸æ¨¡æ¿æ‹¼æ¥å–‚å…¥æ¨¡å‹ä¸­è¿›è¡Œé¢„æµ‹ã€‚<br>â€ƒâ€ƒ<strong>ICTçš„ç”Ÿæˆæ¨¡å¼</strong>ï¼šå› ä¸ºGPT-3æ˜¯è‡ªå›å½’æ¨¡å‹ï¼Œå› æ­¤é€šå¸¸æƒ…å†µä¸‹ç”Ÿæˆçš„ç»“æœåœ¨åºåˆ—çš„æœ€æœ«ä½å¤„ã€‚å½“æ‰§è¡Œåˆ†ç±»æ—¶ï¼Œæ­¤æ—¶éœ€è¦å¯¹ç”Ÿæˆçš„ç»“æœè¿›è¡Œæ˜ å°„ï¼Œä¾‹å¦‚é€šè¿‡Verbalizerçš„æ–¹æ³•ï¼Œè·å¾—Label Wordç”Ÿæˆçš„æ¦‚ç‡ã€‚</p><p>â€ƒâ€ƒ<strong>ICTå·¥ä½œåŸç†</strong>ï¼šä¸‹å›¾ç»™äº†ICTçš„å·¥ä½œåŸç†ï¼ŒæŒ‘é€‰äº† K = 3 K=3 K\=3 ä¸ªè®­ç»ƒæ ·æœ¬ä½œä¸ºDemonstrationï¼ˆé»„è‰²éƒ¨åˆ†ï¼‰ï¼ŒæŒ‡ä»¤æ¨¡æ¿åˆ™æ˜¯æ¢è¡Œç¬¦â€œ\nâ€ï¼Œæ—¨åœ¨åŒºåˆ†æ ·æœ¬çš„å¥å­å’Œæ ‡ç­¾ã€‚åœ¨é¢„æµ‹æ—¶ï¼Œä¸æ–­åœ°æ›´æ¢æµ‹è¯•æ ·æœ¬ï¼ˆç»¿è‰²éƒ¨åˆ†ï¼‰ï¼Œå¹¶åœ¨æœ«å°¾ç•™å‡ºç©ºé—´è®©æ¨¡å‹ç”Ÿæˆã€‚</p><p><img src="https://img-blog.csdnimg.cn/9e5a8b0b964e4e92a14b3200476506df.png" alt></p></blockquote><p>â€ƒâ€ƒä¸è¿‡æˆ‘ä»¬å‘ç°ï¼ŒICTåœ¨é¢„æµ‹è¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨<strong>æ–¹å·®å¤§</strong>ã€<strong>ä¸ç¨³</strong>å®šçš„é—®é¢˜ï¼Œæ ¹æ®ICTçš„å®šä¹‰å’Œæ€§è´¨ï¼Œæˆ‘ä»¬ç½—åˆ—äº†å‡ å¤„æ½œåœ¨çš„å› ç´ å’Œé—®é¢˜ï¼š</p><ul><li>å¦‚ä½•æŒ‘é€‰è®­ç»ƒæ ·æœ¬ï¼Ÿå³è¿™ K K K ä¸ªæ ·æœ¬çš„æŒ‡å®šæœ‰ä»€ä¹ˆé“ç†ï¼Ÿ</li><li>æ ‡æ³¨æ ·æœ¬è‡ªèº«çš„æ­£ç¡®ä¸å¦æ˜¯å¦é‡è¦ï¼Ÿ</li><li>æ¨¡æ¿æŒ‡ä»¤å¯¹é¢„æµ‹æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ</li><li>æ ·æœ¬æ•°é‡ K K K å¯¹é¢„æµ‹æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ</li><li>K K K ä¸ªè¢«é€‰ä¸­çš„æ ·æœ¬çš„æ’åºæœ‰ä»€ä¹ˆå½±å“ï¼Ÿ</li><li>è®­ç»ƒæ ·æœ¬çš„åˆ†å¸ƒæ˜¯å¦ä¼šå¯¹é¢„æµ‹ç»“æœäº§ç”Ÿå½±å“ï¼Ÿ</li></ul><p>â€ƒâ€ƒæ ¹æ®æœ€è¿‘çš„ç ”ç©¶å·¥ä½œï¼Œæˆ‘ä»¬è¿›è¡Œä¸€äº›è®¨è®ºã€‚</p><h4 id="ï¼ˆ1ï¼‰æ ·æœ¬çš„Input-Output-Mappingçš„æ­£ç¡®æ€§æ˜¯å¦å¯¹ICLæœ‰ä½•å½±å“ï¼Ÿ"><a href="#ï¼ˆ1ï¼‰æ ·æœ¬çš„Input-Output-Mappingçš„æ­£ç¡®æ€§æ˜¯å¦å¯¹ICLæœ‰ä½•å½±å“ï¼Ÿ" class="headerlink" title="ï¼ˆ1ï¼‰æ ·æœ¬çš„Input-Output Mappingçš„æ­£ç¡®æ€§æ˜¯å¦å¯¹ICLæœ‰ä½•å½±å“ï¼Ÿ"></a>ï¼ˆ1ï¼‰æ ·æœ¬çš„Input-Output Mappingçš„æ­£ç¡®æ€§æ˜¯å¦å¯¹ICLæœ‰ä½•å½±å“ï¼Ÿ</h4><p>â€ƒâ€ƒIn-Context Exampleä¸»è¦æ˜¯ç”±è®­ç»ƒæ ·æœ¬ç»„æˆçš„ï¼Œé€šå¸¸åŒ…å«Inputå’ŒOutputä¸¤ä¸ªéƒ¨åˆ†ã€‚å…¶ä¸­Inputï¼ˆInput Textï¼‰è¡¨ç¤ºè¾“å…¥çš„æ–‡æœ¬ï¼ŒOutputè¡¨ç¤ºè¾“å‡ºçš„æ–‡æœ¬æˆ–è€…æ ‡ç­¾ï¼ˆLabelï¼‰ã€‚é‚£ä¹ˆInput-Outputçš„å½¢å¼æ˜¯å¦ä¼šå¯¹ICLäº§ç”Ÿå½±å“å‘¢ï¼Œä¸‹é¢ä»‹ç»ä¸¤ä¸ªæ¥è‡ªEMNLP2022é’ˆå¯¹æ ·æœ¬æŒ‘é€‰çš„åˆ†æå‹å·¥ä½œï¼š</p><ul><li><a href="https://aclanthology.org/2022.emnlp-main.759.pdf">ã€ŠRethinking the Role of Demonstrations: What Makes In-Context Learning Work?ã€‹</a>ï¼ˆç®€ç§°<strong>Rethinking</strong>ï¼‰</li><li><a href="https://aclanthology.org/2022.emnlp-main.155.pdf">ã€ŠGround-Truth Labels Matter: A Deeper Look into Input-Label Demonstrationsã€‹</a>ï¼ˆç®€ç§°<strong>Ground-Truth</strong>ï¼‰</li></ul><p><strong>Rethinking</strong><br>â€ƒâ€ƒè¯¥å·¥ä½œä½¿ç”¨GPT-3å’ŒGPT-Jç­‰å¤§æ¨¡å‹ï¼Œæ ¹æ®APIçš„å¤šæ¬¡è°ƒç”¨è¿›è¡Œå®éªŒã€‚<br>é¦–å…ˆæ¢ç´¢äº†<strong>è¿™äº›æŒ‘é€‰æ ·æœ¬çš„è¾“å…¥å¥å­ä¸æ ‡ç­¾ï¼ˆInput-Output Mappingï¼‰æ˜¯å¦æ­£ç¡®å¯¹é¢„æµ‹å­˜åœ¨å½±å“</strong>ï¼Œå…¶å®šä¹‰ä¸‰ä¸ªBaselineï¼Œæ‰€æœ‰æ ·æœ¬å‡ä¸ºéšæœºé‡‡æ ·ï¼š</p><ul><li><strong>No Demonstration</strong>ï¼šæ²¡æœ‰ä»»ä½•è®­ç»ƒæ ·æœ¬ï¼Œç›¸å½“äºé›¶æ ·æœ¬åœºæ™¯ï¼›</li><li><strong>Demonstration w/ glod labels</strong>ï¼šæ ‡å‡†çš„in-context learningï¼Œæ¯ä¸ªæ ‡æ³¨æ ·æœ¬å’Œæ ‡ç­¾æ˜¯æ­£ç¡®å¯¹åº”çš„</li><li><strong>Demonstration w/ random labels</strong>ï¼šIn-context Exampleçš„æ ‡ç­¾è¢«éšæœºæ›¿æ¢ä¸ºé”™è¯¯çš„æ ‡ç­¾ï¼›</li></ul><p><img src="https://img-blog.csdnimg.cn/72584ed8f13f4d4e928876acd604f275.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é€šè¿‡å®éªŒå‘ç°ï¼š</p><ul><li><strong>ä½¿ç”¨Demonstrationæ¯”ä¸ä½¿ç”¨çš„æ•ˆæœå¥½</strong>ï¼Œè¯´æ˜demonstration exampleç¡®å®å¯ä»¥æå‡æ€§èƒ½ï¼›</li><li><strong>random labelå¯¹æ¨¡å‹æ€§èƒ½çš„ç ´åå¹¶ä¸æ˜¯å¾ˆå¤§</strong>ï¼Œè¯´æ˜in-context learningæ›´å¤šçš„æ˜¯å»å­¦ä¹ Task-specificçš„Formatï¼Œè€Œä¸æ˜¯Input-Output Mapping</li><li>MetaICLæ˜¯åŒ…å«å¯¹ICLè¿›è¡Œmeta-trainingçš„æ–¹æ³•ï¼Œä½†å®éªŒç»“æœä¹Ÿè¡¨æ˜random labelå¯¹æ•ˆæœå½±å“å¾ˆå°ã€‚è¯´æ˜åœ¨meta-trainingæ—¶ï¼Œæ¨¡å‹ä¹Ÿä¸ä¼šè¿‡å¤šå…³æ³¨Demonstration exampleçš„Input-Output Mappingï¼Œè€Œæ˜¯å…³æ³¨å…¶ä»–æ–¹é¢ã€‚</li></ul><blockquote><p>â€ƒâ€ƒMetaICLæ˜¯ä¸€ç§é€šè¿‡ä»»åŠ¡ç»Ÿä¸€èŒƒå¼å¹¶ä½¿ç”¨å…ƒå­¦ä¹ è¿›è¡Œè®­ç»ƒçš„æ–¹æ³•ï¼Œå…¶é‡è¦å¢åŠ äº†å¤šä»»åŠ¡çš„è®­ç»ƒæ¥æ”¹è¿›ICLåœ¨ä¸‹æ¸¸ä»»åŠ¡é›¶æ ·æœ¬æ¨ç†æ—¶çš„æ³›åŒ–æ€§èƒ½ï¼Œè¯¥ç®—æ³•å°†åœ¨ä¸‹æ–‡è®²è§£ã€‚</p></blockquote><p>â€ƒâ€ƒå¦å¤–è¿›ä¸€æ­¥æ¢ç´¢è¢«æŒ‘é€‰çš„ K K K ä¸ªè®­ç»ƒæ ·æœ¬ä¸­ï¼Œ<strong>æ­£ç¡®çš„Input-Output Mappingçš„æ¯”ä¾‹</strong>æ˜¯å¦ä¹Ÿæœ‰å½±å“ã€‚å®éªŒç»“æœå‘ç°å½±å“è¾ƒå°ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="https://img-blog.csdnimg.cn/de646e6a3ad541abb87137dd8959fa82.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>â€ƒâ€ƒä¸‹é¢æ¢ç´¢<strong>ä¿®æ”¹Demonstrationçš„æ¨¡å¼æ˜¯å¦ä¼šæœ‰å½±å“</strong>ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>åªæœ‰Input Textï¼ˆ X i X_i Xiï¼‰æ²¡æœ‰labelï¼ˆ Y i Y_i Yiï¼‰ï¼šæ­¤æ—¶æ‰€æœ‰input textè¿›è¡Œæ‹¼æ¥ï¼›</li><li>åªæœ‰Labelï¼ˆ Y i Y_i Yiï¼‰æ²¡æœ‰Input Textï¼ˆ X i X_i Xiï¼‰ï¼šæ­¤æ—¶æ‰€æœ‰labelè¿›è¡Œæ‹¼æ¥ï¼›</li></ul><p>å®éªŒç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="https://img-blog.csdnimg.cn/c78ddad1565e4adb98d6a2dd6e1bac14.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>å½“å»æ‰Input Textæˆ–Labelåï¼Œå‘ç°ä¸No Demonstrateçš„ç»“æœç›¸æ¯”æ²¡æœ‰æ˜æ˜¾çš„æå‡ï¼Œè¯´æ˜Demonstrationçš„æŒ‡ä»¤å½¢å¼æ˜¯å¾ˆé‡è¦çš„ï¼ˆå³Labelå’ŒInput Text ç¼ºä¸€ä¸å¯ï¼‰ï¼›</li><li>å¯¹æ¯”ä¹‹å‰çš„ç»“è®ºï¼Œå¯ä»¥æ¨è®ºå‡ºï¼Œå®æ„¿Labelæ˜¯é”™è¯¯çš„ï¼Œä¹Ÿä¸èƒ½æ²¡æœ‰ã€‚</li></ul><p>â€ƒâ€ƒç´§æ¥ç€<strong>æ¢ç´¢è¾“å…¥å¥å­ï¼ˆInput Textï¼‰ä¸ä»»åŠ¡çš„åˆ†å¸ƒå·®å¼‚æ˜¯å¦æœ‰å½±å“</strong>ï¼Œå³å¦‚æœå°†è¾“å…¥å¥å­æ¢æˆå…¶ä»–ä»»åŠ¡çš„å¥å­ï¼Œæ˜¯å¦ä¼šå½±å“æ¨¡å‹åšå‡ºå†³ç­–ã€‚</p><blockquote><p>ç»™å®š K K K ä¸ªå¥å­ï¼Œè¿™ K K K ä¸ªå¥å­æ˜¯ä»å…¶ä»–ä»»åŠ¡çš„è®­ç»ƒé›†ï¼ˆä¸åŒäºå½“å‰ä»»åŠ¡ï¼‰ éšæœºé‡‡æ ·å¾—åˆ°çš„ã€‚Labelä¾ç„¶æ¥è‡ªäºå½“å‰ä»»åŠ¡ç©ºé—´ï¼ŒDemonstrationçš„æŒ‡ä»¤æ¨¡å¼ä¿æŒä¸å˜ã€‚å› æ­¤ï¼Œè¾“å…¥å¥å­çš„åˆ†å¸ƒæ˜¯ä¸å½“å‰taskä¸åŒçš„ã€‚</p></blockquote><p><img src="https://img-blog.csdnimg.cn/0ae8e3ea4a56420ea6d7fedbc6c67c74.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>â€ƒâ€ƒä»å®éªŒç»“æœæ¥çœ‹ï¼Œéƒ¨åˆ†æƒ…å†µä¸‹å½±å“è¿˜æ˜¯æœ‰çš„ï¼Œè¯´æ˜è¾“å…¥æ ·æœ¬åœ¨è¯­ä¹‰ç©ºé—´å†…çš„åˆ†å¸ƒæ˜¯ä¼šå½±å“ICLçš„ç»“æœã€‚</p><blockquote><p>æ›´å¤šåˆ†æå¯é˜…è¯»åšä¸»çš„åšæ–‡ï¼š<a href="https://blog.csdn.net/qq_36426650/article/details/129818361?spm=1001.2014.3001.5501">ã€In-Context Learningã€‘Rethinking the Role of Demonstrations: What Makes In-Context Learning Work?</a></p></blockquote><h4 id="Ground-Truth"><a href="#Ground-Truth" class="headerlink" title="Ground-Truth"></a>Ground-Truth</h4><p>â€ƒâ€ƒè¯¥å·¥ä½œæ˜¯å¯¹Rethinkingå·¥ä½œçš„è¿›ä¸€æ­¥è®¨è®ºï¼Œå…¶åœ¨éƒ¨åˆ†å±‚é¢ä¸Šå¯¹Rethinkingå·¥ä½œè¿›è¡Œäº†æ”¹è¿›ï¼Œä¸»è¦è®¤ä¸ºInput-Output Mappingæ˜¯æœ‰å½±å“çš„ã€‚å…·ä½“åœ°è¯´ï¼Œå…¶æå‡ºäº†ä¸€ä¸ªæ–°çš„æŒ‡æ ‡æ¥åº¦é‡Input-Output Mappingçš„å½±å“ã€‚é¦–å…ˆç»™å‡ºå‡ ä¸ªå˜é‡ï¼š</p><ul><li>å‡è®¾æ‰€æœ‰çš„In-Context Exampleä¸­ï¼Œæœ‰ a % a\% a% çš„æ ‡ç­¾æ˜¯æ­£ç¡®çš„ï¼Œæ­¤æ—¶å¯¹åº”çš„æ¨¡å‹æ•ˆæœè®°ä½œ y a % y_{a\%} ya%ã€‚å› æ­¤ï¼Œå¦‚æœæ‰€æœ‰In-Context Exampleçš„æ ‡ç­¾éƒ½æ˜¯é”™è¯¯çš„ï¼Œåˆ™è®°ä½œ y 0 % y_{0\%} y0%ã€‚</li><li>y p r y_{pr} yprï¼ˆPseudo-Random-Correctï¼‰è¡¨ç¤ºå¯¹åº”æ›¿æ¢çš„Labelæ˜¯æ¥è‡ªäºåŒä¸€ä¸ªLabel Spaceï¼ˆå³æ›¿æ¢å…¶ä»–çš„æ ‡ç­¾ï¼‰ï¼›</li><li>y z s y_{zs} yzsï¼ˆZero-shot or No-demoï¼‰è¡¨ç¤ºæ²¡æœ‰Labelï¼ˆåªæœ‰è¾“å…¥çš„Input Textï¼‰</li></ul><p>ä½œè€…æå‡ºäº†ä¸€ä¸ªæ–°çš„é‡åŒ–æŒ‡æ ‡ <strong>Ground-turth Label Effect Ratioï¼ˆGLERï¼‰</strong>ï¼Œå®šä¹‰ä¸ºï¼š<br>G L E R = y 100 % âˆ’ y p r y 100 % âˆ’ y z s GLER=\frac{y_{100\%} - y_{pr}}{y_{100\%} - y_{zs}} GLER\=y100%âˆ’yzsy100%âˆ’ypr</p><blockquote><p>è¡¨é¢æ„æ€æ˜¯æŒ‡<strong>æ‰€æœ‰Labeléƒ½æ˜¯æ­£ç¡®æ—¶å¯¹åº”çš„æ¨¡å‹æ•ˆæœä¸éšæœºRandom Labelçš„å·®ï¼Œä¸ï¼Œæ‰€æœ‰Labeléƒ½æ˜¯æ­£ç¡®æ—¶å¯¹åº”çš„æ¨¡å‹æ•ˆæœä¸æ²¡æœ‰Labelçš„å·®ï¼Œ å€¼çš„æ¯”å€¼</strong>ã€‚<br>åˆ†å­è¡¨ç¤ºDemo-gainï¼Œå³æ²¡æœ‰Labelæ—¶æ¨¡å‹æ•ˆæœçš„ä¸‹é™ç¨‹åº¦ï¼Œä¸€èˆ¬å¯¹äºä¸€ä¸ªç‰¹å®šçš„æ•°æ®é›†æ¥è¯´ï¼Œå¯ä»¥å‡è®¾ä¸ºå®šå€¼ï¼Œå› æ­¤ï¼Œ<strong>GLERè¿™ä¸ªæŒ‡æ ‡å¦‚æœè¶Šå¤§ï¼Œåˆ™è¯´æ˜ y p r y_{pr} yprä¸‹é™çš„å¾ˆå¤š</strong>ã€‚å› æ­¤æ¢å¥è¯è¯´ï¼Œ<strong>å¦‚æœGLERå€¼è¶Šå¤§ï¼Œåˆ™è¯´æ˜Random Labelå¯¹æ¨¡å‹çš„å½±å“å¾ˆå¤§</strong>ã€‚</p></blockquote><p>â€ƒâ€ƒä½œè€…éµå¾ªä¸Rethinkingç›¸åŒçš„å®éªŒè®¾ç½®è¿›è¡Œäº†æ›´ä¸ºè¯¦ç»†çš„å®éªŒï¼Œå¹¶è·å¾—äº†GLERæŒ‡æ ‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/b31a82ea0b4f412089a16bce5adc2230.png" alt></p><p>â€ƒâ€ƒä½œè€…è®¤ä¸ºï¼Œä¸åŒçš„å®éªŒè®¾ç½®ï¼ˆä¾‹å¦‚Templateçš„ä¸åŒã€æ•°æ®é›†çš„ä¸åŒç­‰ï¼‰ï¼ŒRandom Labelä¸No Labelæ‰€äº§ç”Ÿçš„æ•ˆæœå·®å¼‚æ˜¯ä¸åŒçš„ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥åšå‡ºâ€œIn-context example mapping does not affect in-context learning performance muchâ€ç‰‡é¢çš„åˆ¤å®šã€‚</p><p>â€ƒâ€ƒç»¼åˆRethinkingå’ŒGround-Truthä¸¤ä¸ªå·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œå¯¹åç»­ICLçš„ç ”ç©¶å’Œåº”ç”¨éƒ½å…·æœ‰ä¸€å®šçš„å¯å‘ä½œç”¨ï¼š</p><ul><li><strong>Input-Output Mappingå¯¹ICLæ˜¯æœ‰å½±å“çš„</strong>ï¼Œä¸»è¦ä½“ç°åœ¨Input Textçš„åˆ†å¸ƒã€Labelçš„å‡†ç¡®æ€§ç­‰ï¼›</li><li><strong>ä¸è®ºæ˜¯ç¼ºå°‘Input Textè¿˜æ˜¯ç¼ºå°‘Labelï¼Œéƒ½ä¼šå¯¹ICLçš„æ•ˆæœäº§ç”Ÿå½±å“</strong>ï¼Œè¯´æ˜ICLä¼šå¾—åˆ°Demonstrationçš„å½¢å¼çš„æŒ‡å¯¼ï¼Œå¯¹åé¢çš„é¢„æµ‹èµ·åˆ°å¼•å¯¼ä½œç”¨ï¼›</li></ul><h4 id="ï¼ˆ2ï¼‰In-Context-Exampleçš„é€‰æ‹©ä¸é¡ºåºå¯¹ICLæœ‰ä»€ä¹ˆå½±å“"><a href="#ï¼ˆ2ï¼‰In-Context-Exampleçš„é€‰æ‹©ä¸é¡ºåºå¯¹ICLæœ‰ä»€ä¹ˆå½±å“" class="headerlink" title="ï¼ˆ2ï¼‰In-Context Exampleçš„é€‰æ‹©ä¸é¡ºåºå¯¹ICLæœ‰ä»€ä¹ˆå½±å“"></a>ï¼ˆ2ï¼‰In-Context Exampleçš„é€‰æ‹©ä¸é¡ºåºå¯¹ICLæœ‰ä»€ä¹ˆå½±å“</h4><p>â€ƒâ€ƒIn-Context Exampleçš„é€‰æ‹©æ–¹æ³•æœ€ç®€å•çš„ä¾¿æ˜¯éšæœºé‡‡æ ·ï¼Œå³å°†æ¯ä¸ªæ ·æœ¬è§†ä¸ºç‹¬ç«‹ä¸”ç­‰æ¦‚ç‡çš„ï¼Œå› æ­¤æ¯ä¸ªè®­ç»ƒæ ·æœ¬éƒ½æœ‰ä¸€å®šæ¦‚ç‡è¢«é€‰ä¸­ã€‚åŒæ—¶ï¼Œè¢«é€‰ä¸­çš„è¿™äº›æ ·æœ¬å¦‚ä½•æ’åºï¼Œä¹Ÿä¼šå¯¹ICLçš„é¢„æµ‹äº§ç”Ÿä¸€äº›å½±å“ï¼ˆå› ä¸ºDemonstrationçš„æ„å»ºæ˜¯å°†è¿™äº›Input-Output PairæŒ‰ç…§ä¸€å®šé¡ºåºçº¿æ€§æ‹¼æ¥è€Œæˆï¼‰ã€‚ç„¶è€Œæœ‰å·¥ä½œå‘ç°ï¼Œéšæœºé‡‡æ ·çš„æ–¹æ³•ä¼šé¢ä¸´æ–¹å·®å¤§çš„é£é™©ã€‚å…ˆé€šè¿‡ä¸€ä¸ªç®€å•çš„é¢„å®éªŒæ¥è¯´æ˜è¿™ä¸€ç‚¹ã€‚</p><blockquote><p>â€ƒâ€ƒ<strong>é¢„å®éªŒ</strong>ï¼šé€‰æ‹©SST-2ï¼ˆæ–¯å¦ç¦æƒ…æ„Ÿåˆ†ææ•°æ®é›†ï¼‰ä»»åŠ¡ï¼Œä»è®­ç»ƒé›†ä¸­é‡‡æ · K = 4 K=4 K\=4 ä¸ªè®­ç»ƒæ ·æœ¬ä½œä¸ºIn-Context Exampleé›†åˆï¼Œé‡å¤é‡‡æ ·10æ¬¡ï¼Œå¾—åˆ°10ä¸ªä¸åŒçš„é›†åˆã€‚å› ä¸º4ä¸ªæ ·æœ¬çš„æ’åˆ—ç»„åˆä¸€å…±æœ‰ 4 Ã— 3 Ã— 2 Ã— 1 = 24 4\times3\times2\times1=24 4Ã—3Ã—2Ã—1\=24 ç§ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç©·ä¸¾æ‰€æœ‰çš„é¡ºåºã€‚å› æ­¤æˆ‘ä»¬ä¸€å…±éœ€è¦å®Œæˆ240æ¬¡å®éªŒã€‚å®éªŒç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/e7ed1f72b8cf4272878bd97701a47cef.png" alt></p><p>â€ƒâ€ƒæ¨ªåæ ‡ï¼ˆTraining Set IDï¼‰è¡¨ç¤º10ä¸ªä¸åŒçš„In-Context Exampleé›†åˆï¼Œç”¨æ¥è§‚å¯Ÿä¸åŒçš„æ ·æœ¬æŒ‘é€‰å¯¹ICLçš„å½±å“æƒ…å†µï¼›å¯¹äºæ¯ä¸€ä¸ªé›†åˆï¼Œ4ä¸ªæ ·æœ¬å¯ä»¥æœ‰24ç§æ’åˆ—ï¼Œæ¯ä¸€ä¸ªæ’åˆ—è¿›è¡Œä¸€æ¬¡å®éªŒï¼Œå¯¹åº”å›¾ä¸­çš„ä¸€ä¸ªç‚¹ï¼Œå› æ­¤æ¯ä¸€ä¸ªé›†åˆéƒ½å¯¹åº”ä¸€å…±æœ‰24ä¸ªç‚¹ï¼Œé‡‡ç”¨ç®±å¼å›¾æ¥è§‚å¯Ÿä¸åŒçš„æ’åˆ—å¯¹ICLçš„å½±å“æƒ…å†µã€‚çºµåæ ‡ä¸ºå‡†ç¡®ç‡ã€‚</p></blockquote><p>â€ƒâ€ƒå®éªŒç»“æœè¡¨æ˜ï¼Œ<strong>æŒ‘é€‰ä¸åŒçš„æ ·æœ¬å¯¹ICLçš„æ€§èƒ½å½±å“ä¸åŒï¼Œè€ŒåŒæ ·çš„æ ·æœ¬ä¸åŒçš„æ’åˆ—ä¹Ÿä¼šäº§ç”Ÿå¾ˆå¤§çš„å·®å¼‚</strong>ï¼Œæœ€å¤§å‡†ç¡®ç‡çš„å·®å¼‚è¶…è¿‡äº†40%ï¼ŒéªŒè¯äº†ICLçš„æ€§èƒ½å¯¹æ ·æœ¬çš„é€‰æ‹©å’Œæ’åˆ—å¾ˆæ•æ„Ÿï¼Œå®Œå…¨éšæœºçš„æ ·æœ¬æŒ‘é€‰å’Œæ’åˆ—ä½¿å¾—ICLæ€§èƒ½ä¸ç¨³å®šã€æ–¹å·®å¤§ã€‚æ‰€ä»¥ï¼Œåœ¨çœŸå®åº”ç”¨æ—¶ï¼Œå¦‚æœä½¿ç”¨å®Œå…¨éšæœºçš„æ–¹æ³•ï¼Œå¯¹é¢„æµ‹çš„ç»“æœæ˜¯æ— æ³•ä¿è¯çš„ã€‚é‚£ä¹ˆå¦‚ä½•å¼¥è¡¥è¿™ä¸€ç‚¹å‘¢ï¼Œä¸‹é¢ä»‹ç»æ¥è‡ªACL2022çš„ä¸¤ä¸ªç»å…¸å·¥ä½œï¼š</p><ul><li><a href="https://aclanthology.org/2022.deelio-1.10.pdf">ã€ŠWhat Makes Good In-Context Examples for GPT-3?ã€‹</a>ï¼šä»£è¡¨æ–¹æ³•KATEï¼›</li><li><a href="https://aclanthology.org/2022.acl-long.556.pdf">ã€ŠFantastically Ordered Prompts and Where to Find Them: Overcoming Few-Shot Prompt Order Sensitivityã€‹</a>ï¼šç®€ç§°Fantastically</li></ul><p><strong>KATE</strong><br>â€ƒâ€ƒè¯¥å·¥ä½œä¹Ÿåœ¨SST-2çš„é¢„å®éªŒä¸­å‘ç°ä¸åŒçš„In-Context Exampleä¼šå¾—åˆ°ä¸åŒçš„å‡†ç¡®ç‡ï¼Œè¯´æ˜æ ·æœ¬çš„æŒ‘é€‰å¾ˆé‡è¦ã€‚å¦å¤–ä½œè€…åœ¨Natural Questionæ•°æ®é›†ä¸Šè¿›è¡Œæµ‹è¯•ï¼Œå‘ç°å½“æŒ‘é€‰çš„In-Context Exampleå¦‚æœåœ¨Embeddingç©ºé—´ä¸­ä¸Test Exampleæ›´è¿‘ï¼Œå°†ä¼šå¸¦æ¥æ›´å¥½çš„æ•ˆæœã€‚å› æ­¤æå‡ºKATEï¼ˆKnn-Augmented in-conText Example selectionï¼‰ï¼Œå³åŸºäºè¿‘é‚»åŸåˆ™æŒ‘é€‰In-Context Exampleã€‚</p><blockquote><p>å…³äºKATEæ›´è¯¦ç»†çš„è§£è¯»å¯å‚è€ƒåšä¸»çš„åšæ–‡ï¼š<a href="https://wjn1996.blog.csdn.net/article/details/129816707?spm=1001.2014.3001.5502">ã€In-Context Learningã€‘What Makes Good In-Context Examples for GPT-3?</a></p></blockquote><p>â€ƒâ€ƒé¦–å…ˆç»™å‡ºå®šä¹‰ï¼šåŸºäºGPT-3çš„ICLå¯ä»¥è§†ä¸ºæ¡ä»¶ç”Ÿæˆé—®é¢˜ï¼Œç»™å®š k k k ä¸ªæ ·æœ¬ï¼Œå¹¶å°†å…¶æ‹¼æ¥èµ·æ¥ä½œä¸ºContext C C Cï¼Œä»»åŠ¡ç›®æ ‡æ˜¯æ ¹æ®Contextå’Œæ–°çš„æµ‹è¯•æ ·æœ¬è¾“å…¥ x x xï¼Œé¢„æµ‹å¯¹åº”çš„æ ‡ç­¾ï¼š<br>p ( y âˆ£ C , x ) = âˆ t = 1 T p ( y t âˆ£ C , x , y &lt; t ) p(y|C, x)=\prod_{t=1}^Tp(y_t|C, x, y_{&lt;t}) p(yâˆ£C,x)\=t\=1âˆTp(ytâˆ£C,x,y&lt;t)</p><p>å…¶ä¸­ t t t è¡¨ç¤ºå½“å‰ç¬¬ t t t ä¸ªé¢„æµ‹çš„tokenï¼Œ y &lt; t y_{&lt;t} y&lt;t è¡¨ç¤ºå‰ t t t ä¸ªç”Ÿæˆçš„tokenã€‚</p><p>â€ƒâ€ƒæå‡ºçš„æ–¹æ³•æ¡†æ¶å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="https://img-blog.csdnimg.cn/68f78b1d0c4d4a5d80be5127b2bd313e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>é¦–å…ˆå¯¹è®­ç»ƒé›† D T \mathcal{D}_T DT å’Œæµ‹è¯•é›†ä¸Šæ‰€æœ‰æ ·æœ¬ä½¿ç”¨Encoder Î¼ Î¸ \mu_{\theta} Î¼Î¸ è¿›è¡Œè¡¨å¾ï¼Œè·å¾—å¥å­Embeddingï¼›</li><li>ç»™å®šä¸€ä¸ªæµ‹è¯•æ ·æœ¬ x t e s t x_{test} xtest åŠå…¶å¯¹åº”çš„Embedding v t e s t \mathbf{v}_{test} vtestï¼Œä»è®­ç»ƒé›†ä¸­æ ¹æ®æ¬§æ°è·ç¦»æˆ–ç›¸ä¼¼åº¦è¿›è¡Œæ’åºï¼Œè·å¾—Top k k k è®­ç»ƒæ ·æœ¬ï¼Œä½œä¸ºIn-context Exampleã€‚ç®—æ³•å¦‚ä¸‹å›¾ï¼š</li></ul><p><img src="https://img-blog.csdnimg.cn/d76a4a24f32d49ba97088d50586cffad.png" alt></p><p>â€ƒâ€ƒEncoderçš„é€‰æ‹©å¯ä»¥æ˜¯é¢„è®­ç»ƒçš„BERTã€RoBERTaï¼Œä¹Ÿå¯ä»¥æ˜¯åœ¨ç›®æ ‡ä»»åŠ¡æ•°æ®ä¸Šè¿›è¡Œè‡ªç›‘ç£çš„æ¨¡å‹ï¼Œä¾‹å¦‚Sentence-BERTã€SimCSEç­‰ã€‚</p><p>â€ƒâ€ƒå®éªŒå‘ç°ï¼ŒåŸºäºKATEçš„æ ·æœ¬æŒ‘é€‰ç®—æ³•å¯ä»¥æå‡ICLçš„æ€§èƒ½ï¼Œå¹¶ä¸”é™ä½æ–¹å·®ã€‚</p><p><strong>Fantastically</strong><br>â€ƒâ€ƒè¯¥å·¥ä½œå‘ç°æ ·æœ¬çš„æ’åˆ—å¯¹ICLå½±å“å¾ˆå¤§ï¼Œè€Œä¸”æ¨¡å‹è¶Šå°æ–¹å·®è¶Šå¤§ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/e473e03b2c66424684ce71ec4830932f.png" alt></p><p>â€ƒâ€ƒå› æ­¤ï¼Œè¯¥å·¥ä½œæå‡ºæ—¨åœ¨ä»ä¼—å¤šçš„æ’åˆ—ä¸­æŒ‘é€‰åˆé€‚çš„æ’åˆ—ï¼Œæå‡ºä¸‰é˜¶æ®µçš„æ–¹æ³•ï¼š<br>ï¼ˆ1ï¼‰ç¬¬ä¸€é˜¶æ®µï¼šéšæœºé‡‡æ ·è‹¥å¹²è®­ç»ƒæ ·æœ¬<br>â€ƒâ€ƒç»™å®šä¸€ä¸ªè®­ç»ƒé›† S = { ( x i , y i ) } i = 1 n S=\{(x_i, y_i)\}_{i=1}^n S\={(xi,yi)}i\=1n ï¼Œå¯¹äºæ¯ä¸€ä¸ªæ ·æœ¬ ( x i , y i ) (x_i, y_i) (xi,yi) ï¼Œé€šè¿‡æ˜ å°„ T \mathcal{T} T ï¼Œæ·»åŠ Templateå½¢æˆè¾“å…¥æ–‡æœ¬ t i = T ( x i , y i ) = â€œinput:â€ x i  â€œoutput:â€ y i t_i=\mathcal{T}(x_i, y_i)=\text{``input:â€™â€™}x_i\space\text{``output:â€™â€™}y_i ti\=T(xi,yi)\=â€œinput:â€xi â€œoutput:â€yi ã€‚æœ€ç»ˆé€šè¿‡çº¿æ€§æ‹¼æ¥æ–¹æ³•å½¢æˆä¸€ä¸ªè¾“å…¥åºåˆ— S â€² = { t i } i = 1 n Sâ€™=\{t_i\}_{i=1}^n Sâ€²\={ti}i\=1n<br>ï¼ˆ2ï¼‰ç¬¬äºŒé˜¶æ®µï¼šå…¨æ’åˆ—<br>â€ƒâ€ƒå®šä¹‰ä¸€ä¸ªå…¨æ’åˆ—ï¼Œåˆ—å‡ºæ‰€æœ‰å¯èƒ½çš„æ’åˆ—ã€‚ä¾‹å¦‚å¦‚ä¸‹å›¾ï¼Œå½“åªæœ‰ 4 4 4 ä¸ªæ ·æœ¬æ—¶ï¼Œåˆ™æœ‰ N = 24 N=24 N\=24ä¸ªæ’åˆ—ã€‚</p><p><img src="https://img-blog.csdnimg.cn/cd373a066aa64b53840bb2045e819ee9.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>â€ƒâ€ƒå¯¹äºæ¯ä¸€ä¸ªæ’åˆ— c m c_m cmï¼Œè®©é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ç”Ÿæˆç¬¦åˆå½“å‰æ’åˆ—åˆ†å¸ƒçš„æ ·æœ¬ï¼ˆProbing Sequence g m g_m gmï¼‰ã€‚å› æ­¤ N N N ä¸ªæ’åˆ—ä¼šç”Ÿæˆ N N N ä¸ªProbing Sequenceã€‚å°†è¿™ N N N ä¸ªProbing Sequenceæ‹¼æ¥èµ·æ¥ï¼Œä½œä¸ºProbing Setï¼š</p><blockquote><p>â€ƒâ€ƒè¿™äº›Probing Sequenceéƒ½æ˜¯è®©GPTæ¨¡å‹ç”Ÿæˆçš„ï¼Œæ‰€ä»¥æ—¢å¯ä»¥ç”ŸæˆInput Textï¼Œä¹Ÿä¼šç”ŸæˆLabel<br>ç»è¿‡æµ‹è¯•ï¼ŒGPTç³»åˆ—çš„æ¨¡å‹ï¼Œå¦‚æœå‰é¢ç»™å®šå›ºå®šçš„æ¨¡å¼ï¼ˆä¾‹å¦‚Inputï¼šxxxï¼ŒOutputï¼šxxxï¼‰ï¼Œæ¨¡å‹å¯ä»¥è‡ªåŠ¨æŒ‰ç…§è¿™ä¸ªæ¨¡å¼ç”Ÿæˆä¸€äº›æ–°çš„æ ·æœ¬ã€‚</p></blockquote><p>ï¼ˆ3ï¼‰ç¬¬ä¸‰é˜¶æ®µï¼šæ‰“åˆ†<br>â€ƒâ€ƒå¾—åˆ°çš„ N N N ä¸ªProbing Sequenceï¼Œéœ€è¦ä»ä¸­æŒ‘é€‰æœ€ä¼˜çš„åºåˆ—ä½œä¸ºPromptï¼Œä½œè€…å®šä¹‰äº†ä¸¤ä¸ªåŸºäºä¿¡æ¯ç†µçš„æ‰“åˆ†æ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºGlobal Entropy (GlobalE)å’ŒLocal Entropyï¼ˆLocalIEï¼‰ï¼Œå¹¶æŒ‘é€‰å¾—åˆ†æœ€é«˜çš„ï¼Œè¿™é‡Œä¸åšè¯¦ç»†ä»‹ç»ã€‚</p><p>â€ƒâ€ƒICLçš„å½±å“å› ç´ å¾ˆå¤šï¼Œä¸Šè¿°å·¥ä½œå¯¹å…¶åšäº†ä¸€äº›æ¯”è¾ƒå…¨é¢çš„æ¢ç´¢ï¼Œé™¤äº†æ¢ç´¢ICLçš„å½±å“å› ç´ å¤–ï¼Œä¹Ÿæœ‰å·¥ä½œå°è¯•è¿›ä¸€æ­¥æ”¹è¿›å’Œæå‡ICLçš„å®é™…æ•ˆæœï¼Œä¸‹é¢ä»‹ç»ä¸‰ä¸ªæ–¹é¢çš„æå‡æ–¹æ³•ã€‚</p><h4 id="ï¼ˆ1ï¼‰ICLçš„æå‡â€”â€”å¼•å…¥è‡ªç›‘ç£ï¼ˆSelf-supervised-ICLï¼‰"><a href="#ï¼ˆ1ï¼‰ICLçš„æå‡â€”â€”å¼•å…¥è‡ªç›‘ç£ï¼ˆSelf-supervised-ICLï¼‰" class="headerlink" title="ï¼ˆ1ï¼‰ICLçš„æå‡â€”â€”å¼•å…¥è‡ªç›‘ç£ï¼ˆSelf-supervised ICLï¼‰"></a>ï¼ˆ1ï¼‰ICLçš„æå‡â€”â€”å¼•å…¥è‡ªç›‘ç£ï¼ˆSelf-supervised ICLï¼‰</h4><p>â€ƒâ€ƒä¸è®ºæ˜¯å¤§æ¨¡å‹è¿˜æ˜¯å°æ¨¡å‹ï¼Œå¦‚æœç›´æ¥ç”¨ICLçš„ç›®æ ‡æ¥è®­ç»ƒæ¨¡å‹ä¼šæ€ä¹ˆæ ·ï¼Ÿä¸‹é¢è¿™ä¸€ç¯‡å·¥ä½œå°è¯•è®²ICLåŠ å…¥åˆ°è‡ªç›‘ç£è®­ç»ƒè¿‡ç¨‹ä¸­ã€‚</p><ul><li><a href="https://aclanthology.org/2022.naacl-main.260.pdf">ã€ŠImproving In-Context Few-Shot Learning via Self-Supervised Trainingã€‹</a></li></ul><p>â€ƒâ€ƒé¦–å…ˆå¼•å…¥ä¸¤ä¸ªå®šä¹‰ï¼š<br><strong>exampleå®šä¹‰</strong>ï¼šè¡¨ç¤ºä¸€ä¸ªinput-output pairã€‚inputå’Œoutput textå‰é¢åˆ†åˆ«æ·»åŠ â€œInputâ€å’Œâ€œOutputâ€æ ‡è®°ï¼Œæ¯ä¸ªexampleä¹‹é—´é€šè¿‡newlineåˆ†éš”ã€‚<br><strong>instanceå®šä¹‰</strong>ï¼šè¡¨ç¤ºè‹¥å¹²exampleçš„çº¿æ€§æ‹¼æ¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://img-blog.csdnimg.cn/cfbde89b241748618f916b0428d9464e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><blockquote><p>â€ƒâ€ƒæŒ‰ç…§ICLçš„æ¨¡å¼ï¼Œæ‹¼æ¥è‹¥å¹²ä¸ªæ ·æœ¬ã€‚å¯¹äºæ¯ä¸ªæ ·æœ¬æ·»åŠ æ¨¡æ¿ï¼Œä¾‹å¦‚Inputã€Outputã€‚çº¢è‰²éƒ¨åˆ†åˆ™ä¸ºLabelã€‚</p></blockquote><p>â€ƒâ€ƒæŒ‰ç…§è¿™ä¸€æ¨¡å¼ï¼Œå®šä¹‰ä¸åŒçš„é¢„è®­ç»ƒä»»åŠ¡ï¼š<br><img src="https://img-blog.csdnimg.cn/54ba64b25ae2414eb0fb5c88e9607811.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>Next Sentence Generationï¼ˆNSGï¼‰</strong><br>â€ƒâ€ƒç»™å®šä¸€ä¸ªoriginal textï¼Œåˆ’åˆ†ä¸ºä¸¤ä¸ªå­å¥ã€‚å‰é¢çš„å¥å­ä½œä¸ºinputè¾“å…¥æ¨¡å‹ï¼Œåé¢çš„å¥å­ä½œä¸ºoutputï¼Œæ—¨åœ¨æ¨¡å‹æ ¹æ®inputæ¥ç”Ÿæˆoutputã€‚</p><p><strong>Masked Word Predictionï¼ˆMWPï¼‰</strong><br>â€ƒâ€ƒç±»ä¼¼äºMLMï¼Œå¯¹è¾“å…¥çš„æ–‡æœ¬éšæœºæŒ‘é€‰1ï½20ä¸ªè¯ï¼Œå¹¶åˆ†åˆ«éšæœºæ›¿æ¢å¦‚ä¸‹å‡ ä¸ªä¹‹ä¸€çš„special tokenï¼ˆ___, âŸ¨âŸ¨âŸ©âŸ©, @@@, (()), $$$, %%%, ###, ***, and +++.ï¼‰ã€‚ä»»åŠ¡æ—¨åœ¨é¢„æµ‹è¢«è¦†ç›–çš„è¯ã€‚</p><p><strong>Last Phrase Predictionï¼ˆLPPï¼‰</strong><br>â€ƒâ€ƒç»™å®šä¸€ä¸ªæ–‡æœ¬ï¼ˆç¼ºä¹æœ«å°¾è¯ï¼‰ä»¥åŠè‹¥å¹²passage textï¼Œä»»åŠ¡æ—¨åœ¨ç”Ÿæˆ/åˆ†ç±»æœ«å°¾è¯ã€‚è¯¥ä»»åŠ¡å¯ä»¥å»ºæ¨¡ä¸ºç”Ÿæˆå¼ä»»åŠ¡æˆ–åˆ†ç±»ä»»åŠ¡ï¼š</p><ul><li>ç”Ÿæˆä»»åŠ¡ï¼šè®©æ¨¡å‹ç”Ÿæˆlast phrase</li><li>åˆ†ç±»ä»»åŠ¡ï¼šç»™å®šä¸€ä¸ªç­”æ¡ˆï¼Œè®©æ¨¡å‹åˆ¤æ–­ç­”æ¡ˆæ˜¯å¦æ­£ç¡®ï¼ˆç”ŸæˆTrue/Falseï¼‰</li></ul><p><strong>Classification</strong><br>â€ƒâ€ƒä¸Next sentence predictionå’ŒSentence orddering predictionç±»ä¼¼ï¼Œè€ƒè™‘å››ç§ç±»å‹çš„è¾“å…¥ï¼ˆå¦‚ä¸‹å›¾ï¼‰<br><img src="https://img-blog.csdnimg.cn/f6df87c107d0423491a33665168fae18.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li>Original Sentenceï¼šåŸå§‹æ–‡æœ¬ä¸åšæ”¹åŠ¨ï¼Œæ­¤æ—¶ä¸ºTrue</li><li>Multiple Documentsï¼šéšæœºå¯¹50%çš„å¥å­ä»å…¶ä»–documentä¸­æŒ‘é€‰å¹¶æ›¿æ¢ï¼›æ­¤æ—¶æ¯ä¸ªå¥å­ä¹‹é—´è¯­ä¹‰ä¸åŒï¼Œä¸ºFalse</li><li>Shuffled Sentenceï¼šæ‰“ä¹±å¥å­é¡ºåºï¼Œä½†ä¸æ”¹å˜æ•´ä¸ªæ–‡æ¡£è¯­ä¹‰ï¼Œä¸ºTrueã€‚</li></ul><p>â€ƒâ€ƒè®­ç»ƒé˜¶æ®µä½¿ç”¨MOEè¿›è¡Œé¢„è®­ç»ƒã€‚é¢„è®­ç»ƒè¯­æ–™ï¼šBOOK-CORPUS plus Wikipedia, CC-NEWS, OPENWEB- TEXT, and STORIESã€‚åˆ†åˆ«å¯¹æ¯ä¸ªè¯­æ–™æŠ½å–100kå¥å­ï¼ˆSTORIESåªæŠ½å–10kï¼‰ã€‚æœ€ç»ˆå¤§çº¦æœ‰100wä¸ªå¥å­ï¼Œæ¯ä¸ªç±»å‹çš„self-supervised taskå¹³å‡25wä¸ªæ ·æœ¬ã€‚</p><p>â€ƒâ€ƒä½œè€…åœ¨å¾ˆå¤šä»»åŠ¡ä¸Šè¿›è¡Œäº†å®éªŒï¼Œè¿™é‡Œåªå±•ç¤ºSuperGLUEä¸Šçš„æ•ˆæœï¼Œå¯ä»¥å‘ç°å¼•å…¥ICLè‡ªç›‘ç£è®­ç»ƒæ˜¯å¯ä»¥å¤§å¤§æå‡æ•ˆæœçš„ã€‚<br><img src="https://img-blog.csdnimg.cn/0749f3b7e74b4a2aa4f89059caf2b3fd.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="ï¼ˆ2ï¼‰ICLçš„æå‡â€”â€”ç»Ÿä¸€èŒƒå¼-å…ƒå­¦ä¹ ï¼ˆMetaICLï¼‰"><a href="#ï¼ˆ2ï¼‰ICLçš„æå‡â€”â€”ç»Ÿä¸€èŒƒå¼-å…ƒå­¦ä¹ ï¼ˆMetaICLï¼‰" class="headerlink" title="ï¼ˆ2ï¼‰ICLçš„æå‡â€”â€”ç»Ÿä¸€èŒƒå¼+å…ƒå­¦ä¹ ï¼ˆMetaICLï¼‰"></a>ï¼ˆ2ï¼‰ICLçš„æå‡â€”â€”ç»Ÿä¸€èŒƒå¼+å…ƒå­¦ä¹ ï¼ˆMetaICLï¼‰</h4><p>â€ƒâ€ƒé™¤äº†å°†ICLçš„æ¨¡æ¿ä¸è‡ªç›‘ç£è®­ç»ƒç»“åˆå¤–ï¼Œæ˜¯å¦å¯ä»¥ç›´æ¥ä½¿ç”¨ICLæ¥è®­ç»ƒä¸€ä¸ªå…·ä½“çš„ä»»åŠ¡å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œä¸‹é¢ä¸¤ç¯‡å·¥ä½œå°†ICLçš„æ¨¡æ¿ä¸ä¸‹æ¸¸ä»»åŠ¡ç›¸ç»“åˆï¼Œå¹¶æå‡ºåŸºäºå…ƒå­¦ä¹ çš„ICLè®­ç»ƒæ–¹æ³•ï¼š</p><ul><li><a href="https://doi.org/10.18653/v1/2022.acl-long.53">ã€ŠMeta-learning via Language Model In-context Tuningã€‹</a>ï¼šæå‡ºIn-Context Tuningæ–¹æ³•ï¼›</li><li><a href="https://github.com/facebookresearch/MetaICL">ã€ŠMetaICL: Learning to Learn In Contextã€‹</a>ï¼šæå‡ºMetaICLæ–¹æ³•ã€‚</li></ul><p><strong>In-Context Tuning</strong></p><p>â€ƒâ€ƒç›®å‰ï¼Œå‘è¯­è¨€æ¨¡å‹é€šè¿‡promptingå¯ä»¥åœ¨å°æ ·æœ¬åœºæ™¯ä¸‹å¾—åˆ°å¾ˆå¤§çš„æˆåŠŸï¼Œä¾‹å¦‚GPT-3ã€‚ç„¶è€ŒåŸå§‹çš„è¯­è¨€æ¨¡å‹åœ¨é¢„è®­ç»ƒæ—¶å¹¶æ²¡æœ‰é’ˆå¯¹in-contextè¿›è¡Œä¼˜åŒ–ã€‚å…ˆå‰å·¥ä½œå‘ç°promptingä¼šè¿‡åº¦å—åˆ°ï¼ˆoversensitiveï¼‰æ ·æœ¬é€‰å–ä»¥åŠinstructionæœ¬èº«å½±å“ã€‚å› æ­¤è¯¥å·¥ä½œæå‡ºIn-Context Tuningï¼Œæ—¨åœ¨é€šè¿‡å¤šä»»åŠ¡è®­ç»ƒçš„æ–¹å¼ç›´æ¥å¯¹é¢„è®­ç»ƒæ¨¡å‹å¾®è°ƒICLä»»åŠ¡ç›®æ ‡ã€‚</p><p>â€ƒâ€ƒåœ¨è®­ç»ƒï¼ˆfine-tuningï¼‰é˜¶æ®µï¼Œç»™å®šä¸€ç³»åˆ—çš„è®­ç»ƒtaskï¼Œæ¯ä¸€ä¸ªtaskéƒ½æœ‰ç›¸åº”çš„instructionï¼Œä»¥åŠè¯¥taskå¯¹åº”çš„å°‘é‡æ ·æœ¬ï¼ˆè¾“å…¥/è¾“å‡ºå¯¹ï¼‰ã€‚åœ¨æµ‹è¯•é˜¶æ®µï¼Œç»™å®šä¸€ä¸ªæ–°çš„unseen taskï¼Œä»¥åŠè¯¥taskå¯¹åº”çš„instructionå’Œå°‘é‡æ ·æœ¬ï¼ˆè¾“å…¥/è¾“å‡ºå¯¹ï¼‰ï¼Œæ—¨åœ¨è®©æ¨¡å‹èƒ½å¤Ÿå¯¹æµ‹è¯•æ ·æœ¬é¢„æµ‹å…¶ç±»åˆ«ã€‚</p><p>â€ƒâ€ƒå¦‚ä¸‹å›¾ï¼Œç»™å®šä¸€ä¸ªæƒ…æ„Ÿåˆ†ætaskï¼š</p><p><img src="https://img-blog.csdnimg.cn/d52fbbfac58f40d8bc6e8f38a22096d6.png" alt></p><p>â€ƒâ€ƒåœ¨è®­ç»ƒæ—¶ï¼Œç›´æ¥å¯¹instruction I T I_T ITã€è‹¥å¹²å°‘é‡æ ‡æ³¨æ•°æ® S T S_T ST ä»¥åŠtargetæ ·æœ¬ x T t g t x_T^{tgt} xTtgt è¿›è¡Œæ‹¼æ¥ï¼Œå¹¶åŸºäºin-context learningè®­ç»ƒç›®æ ‡è¿›è¡Œä¼˜åŒ–ï¼Œé¢„æµ‹å¯¹åº”ç±»åˆ« y T t g t y_T^{tgt} yTtgtï¼š</p><p>L T ( Î¸ ) : = âˆ‘ ( s T t g t , y T t g t ) âˆˆ D T [ âˆ’ log â¡ p Î¸ ( y T t g t âˆ£ x T t g t , S T , I T ) ] \mathcal{L}_T(\theta):=\sum_{(s_{T}^{tgt}, y_T^{tgt})\in D_T}[-\log p_{\theta}(y_T^{tgt}|x_{T}^{tgt}, S_T, I_T)] LT(Î¸):=(sTtgt,yTtgt)âˆˆDTâˆ‘[âˆ’logpÎ¸(yTtgtâˆ£xTtgt,ST,IT)]</p><p><strong>MetaICL</strong></p><p>â€ƒâ€ƒå¤§è§„æ¨¡çš„è¯­è¨€æ¨¡å‹å¯ä»¥è¢«ç”¨äºin-context learningï¼ˆä¾‹å¦‚GPT-3ï¼‰ã€‚åªéœ€è¦ç»™å®šç›®æ ‡ä»»åŠ¡çš„å°‘é‡æ ‡æ³¨æ ·æœ¬ä½œä¸ºæç¤ºï¼Œå³å¯å®ç°æ— å‚æ•°è®­ç»ƒåœ°å¯¹å…¶ä»–æ ·æœ¬è¿›è¡Œé¢„æµ‹ã€‚ç„¶è€Œç›®å‰in-context learningä¾ç„¶ä¸æ™®é€šçš„fine-tuningæœ‰ä¸€å®šå·®è·ï¼Œä¸”é¢„æµ‹çš„ç»“æœæ–¹å·®å¾ˆå¤§ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦èŠ±è´¹æ—¶é—´è€ƒè™‘templateçš„æ„å»ºã€‚ä¼ ç»Ÿçš„In-context learningå¯èƒ½æ•ˆæœå¹¶ä¸ç†æƒ³ï¼Œå¯èƒ½å› ä¸ºtarget taskä¸é¢„è®­ç»ƒçš„é˜¶æ®µçš„è®­ç»ƒç›®æ ‡å·®å¼‚å¤ªå¤§ï¼Œæˆ–æ¨¡å‹å¤ªå°ã€‚ä¸ºäº†æ”¹è¿›ä¸Šè¿°é—®é¢˜ï¼Œè¯¥å·¥ä½œæå‡ºMetaICLæ–¹æ³•ï¼Œå…ˆåœ¨è‹¥å¹²taskçš„è®­ç»ƒé›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œè¯•å›¾è®©æ¨¡å‹å­¦ä¹ åˆ°å¦‚ä½•æ ¹æ®in-contextçš„è¯­ä¹‰æ¥é¢„æµ‹ã€‚</p><p>â€ƒâ€ƒæ–¹æ³•å¾ˆç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="https://img-blog.csdnimg.cn/29f3471ab7e14c64a797d3f44420680e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">â€ƒâ€ƒä¸GPT-3ä¸€æ ·ï¼Œåœ¨è®­ç»ƒæ—¶ï¼Œæ¨¡å‹çš„è¾“å…¥åŒ…å«å½“å‰taskçš„ K K K ä¸ªæ ·æœ¬ï¼Œä»¥åŠç¬¬ K + 1 K+1 K+1 ä¸ªæ ·æœ¬è¾“å…¥ï¼Œä½¿ç”¨äº¤å‰ç†µæ›´æ–°æ¨¡å‹ã€‚åœ¨æµ‹è¯•é˜¶æ®µï¼Œç»™å®šunseen target taskï¼Œæ— éœ€å†æ¬¡æ›´æ–°æ¨¡å‹ï¼Œåªéœ€è¦å°†å¯¹åº”çš„ K K K ä¸ªæ ·æœ¬æ‹¼æ¥è¾“å…¥æ¨¡å‹å³å¯å¯¹å…¶ä»–æ ·æœ¬é¢„æµ‹ã€‚</p><h4 id="ï¼ˆ3ï¼‰ICLçš„æå‡â€”â€”å¯¹é¢„æµ‹è¿›è¡ŒçŸ«æ­£ï¼ˆCalibrate-Before-Useï¼‰"><a href="#ï¼ˆ3ï¼‰ICLçš„æå‡â€”â€”å¯¹é¢„æµ‹è¿›è¡ŒçŸ«æ­£ï¼ˆCalibrate-Before-Useï¼‰" class="headerlink" title="ï¼ˆ3ï¼‰ICLçš„æå‡â€”â€”å¯¹é¢„æµ‹è¿›è¡ŒçŸ«æ­£ï¼ˆCalibrate Before Useï¼‰"></a>ï¼ˆ3ï¼‰ICLçš„æå‡â€”â€”å¯¹é¢„æµ‹è¿›è¡ŒçŸ«æ­£ï¼ˆCalibrate Before Useï¼‰</h4><p>â€ƒâ€ƒé™¤äº†ç›´æ¥å¯¹ICLè®­ç»ƒç›®æ ‡è¿›è¡Œè®­ç»ƒæ¥æ‹‰è¿‘ä¸‹æ¸¸ä»»åŠ¡ä¸é¢„è®­ç»ƒå­˜åœ¨çš„Gapå¤–ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å¯¹é¢„æµ‹çš„éƒ¨åˆ†è¿›è¡Œ<strong>æ ¡å‡†ï¼ˆCalibrationï¼‰</strong>ï¼Œè¿™ç§æ€æƒ³çš„ä½¿ç”¨åœ¨è®¸å¤šä»»åŠ¡ä¸­éƒ½å¾ˆå¹¿æ³›ã€‚</p><p>â€ƒâ€ƒæˆ‘ä»¬å°è¯•å°†æ¨¡å‹è¾“å‡ºçš„æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œæ ¡å‡†ã€‚å¯¹äºåŸå§‹çš„è¾“å‡ºæ¦‚ç‡åˆ†å¸ƒï¼ˆå‘é‡ï¼‰ p ^ \mathbf{\hat{p}} p^ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªaffine transformationè¿›è¡Œè½¬æ¢ q ^ = s o f t m a x ( W p ^ + b ) \mathbf{\hat{q}}=softmax(\mathbf{W\hat{p}} + b) q^\=softmax(Wp^+b) ï¼Œå…¶ä¸­ W \mathbf{W} W å’Œ b b b åˆ†åˆ«ä¸ºå˜æ¢çš„å‚æ•°çŸ©é˜µå’Œåç½®ã€‚ç”±äºICLåœ¨æ¨ç†è¿‡ç¨‹ä¸­æ˜¯ä¸æ¶‰åŠåˆ°å‚æ•°è®­ç»ƒçš„ï¼Œå› æ­¤ W \mathbf{W} W å’Œ b b b å¦‚ä½•è¿›è¡Œæ›´æ–°å‘¢ï¼Ÿè¯¥å·¥ä½œæå‡ºä¸€ä¸ªå¾ˆå·§å¦™çš„ç­–ç•¥ï¼Œå³å¼•å…¥ä¸€ä¸ªæ–°çš„æ ·æœ¬å«åšContext-freeã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/b880a3a28051461097e4150e356e08df.png" alt></p><p>â€ƒâ€ƒIn-Context Exampleä¸å…¶ä½™çš„æµ‹è¯•æ ·æœ¬éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æ·»åŠ äº†ä¸€ä¸ªContent-freeæµ‹è¯•çš„æ ·æœ¬ï¼Œä¾‹å¦‚â€œN/Aâ€ï¼ˆä¹Ÿå¯ä»¥è®¾ç½®ä¸ºç©ºæ ¼ã€â€œ[MASK]â€ç­‰æ˜æ˜¾æ— æå‘çš„æ–‡æœ¬ï¼‰ã€‚</p><blockquote><p>ä¾‹å¦‚SST-2ï¼Œæ­£å¸¸æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›â€œN/Aâ€å¯¹åº”çš„æ•°æ®æ¦‚ç‡åº”è¯¥ä¸º[0.5%ï¼Œ0.5%]ï¼Œå› ä¸ºå¯¹äºæƒ…æ„Ÿåˆ†æä»»åŠ¡æ¥è¯´ï¼Œâ€œN/Aâ€è‚¯å®šæ²¡æœ‰ä»»ä½•æå‘ã€‚ä½†æ˜¯å®é™…å¤§æ¨¡å‹é¢„æµ‹çš„ç»“æœå¯èƒ½å¹¶éæ˜¯è¿™ä¸ªå€¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°è¯•æ›´æ–°Wå’Œbå‚æ•°æ¥çº æ­£è¿™ä¸ªæ¦‚ç‡åˆ†å¸ƒä½¿å…¶å˜å¾—æ›´åŠ å‡åŒ€ï¼ˆiniformï¼‰ã€‚</p></blockquote><p>â€ƒâ€ƒæ›´æ–°å‚æ•°æ—¶ï¼Œé€šè¿‡å¯å‘å¼çš„æ–¹æ³•å®Œæˆã€‚é¦–å…ˆè·å¾—Content-freeæ ·æœ¬çš„é¢„æµ‹æ¦‚ç‡ p ^ c f \mathbf{\hat{p}}_{cf} p^cfï¼Œé‚£ä¹ˆå‚æ•° W \mathbf{W} W è®¾ç½®ä¸º d i a g ( p ^ c f ) âˆ’ 1 diag(\mathbf{\hat{p}}_{cf})^{-1} diag(p^cf)âˆ’1ï¼Œ b b b è®¾ç½®ä¸ºé›¶å‘é‡ã€‚</p><p>â€ƒâ€ƒä¸€ä¸ªæ¯”è¾ƒç›´è§‚çš„ä¾‹å­å¦‚ä¸‹æ‰€ç¤ºã€‚æ‰€æŒ‘é€‰çš„æ ·æœ¬å¯èƒ½å­˜åœ¨biasï¼Œå¯¼è‡´é¢„æµ‹çš„ç½®ä¿¡åº¦åªæœ‰è¶…è¿‡0.7çš„æ—¶å€™æ‰æ˜¯Positiveç±»ã€‚ç„¶è€Œé»˜è®¤çš„é˜ˆå€¼ä¸€èˆ¬è®¾ç½®ä¸º0.5ï¼Œæ‰€ä»¥å¯¼è‡´ä¸€éƒ¨åˆ†æ ·æœ¬ç”±äºè¿™ç§biasè€Œé¢„æµ‹é”™è¯¯ã€‚Calibrationåˆ™æ—¨åœ¨çŸ«æ­£è¿™ç§biasï¼Œé€šè¿‡ä¸€ä¸ªContent-freeæ ·æœ¬å‘ç°æ­£ç¡®çš„é˜ˆå€¼åº”è¯¥æ˜¯0.7ã€‚å› æ­¤å®ç°äº†åˆ†å¸ƒçš„æ ¡å‡†ï¼Œå¤§å¤§æé«˜é¢„æµ‹çš„å‡†ç¡®æ€§ã€‚</p><p><img src="https://img-blog.csdnimg.cn/cd2a5cf1a7bd4933aefdd39ba4592223.png" alt></p><h3 id="5-2-Instruction-tuningï¼ˆæŒ‡ä»¤å­¦ä¹ ï¼‰"><a href="#5-2-Instruction-tuningï¼ˆæŒ‡ä»¤å­¦ä¹ ï¼‰" class="headerlink" title="5.2 Instruction-tuningï¼ˆæŒ‡ä»¤å­¦ä¹ ï¼‰"></a>5.2 Instruction-tuningï¼ˆæŒ‡ä»¤å­¦ä¹ ï¼‰</h3><p>â€ƒâ€ƒé¢å‘è¶…å¤§è§„æ¨¡æ¨¡å‹ç¬¬äºŒä¸ªPromptæŠ€æœ¯æ˜¯æŒ‡ä»¤å­¦ä¹ ã€‚åœ¨ä¸Šæ–‡æˆ‘ä»¬ä»‹ç»è¿‡ï¼ŒPromptçš„æœ¬è´¨ä¹‹ä¸€æ˜¯ä»»åŠ¡çš„ä¸€ç§æŒ‡ä»¤ï¼Œå› æ­¤ï¼Œåœ¨å¯¹å¤§è§„æ¨¡æ¨¡å‹è¿›è¡Œå¾®è°ƒæ—¶ï¼Œå¯ä»¥ä¸ºå„ç§ç±»å‹çš„ä»»åŠ¡å®šä¹‰æŒ‡ä»¤ï¼Œå¹¶è¿›è¡Œè®­ç»ƒï¼Œæ¥æé«˜æ¨¡å‹å¯¹ä¸åŒä»»åŠ¡çš„æ³›åŒ–èƒ½åŠ›ã€‚</p><p>â€ƒâ€ƒä»€ä¹ˆæ˜¯æŒ‡ä»¤å‘¢ï¼Ÿå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/775536dafad74e14b91f5ec5b2d8a79e.png" alt></p><p>å‡è®¾æ˜¯ä¸€ä¸ªQuestion Generationä»»åŠ¡ï¼Œé‚£ä¹ˆå¯ä»¥ä¸ºè¿™ä¸ªä»»åŠ¡å®šä¹‰ä¸€äº›æŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼š</p><ul><li>Titleï¼šä»»åŠ¡çš„åç§°ï¼›</li><li>Definitionï¼šä»»åŠ¡çš„å®šä¹‰ï¼Œè¯´æ˜è¿™ä¸ªä»»åŠ¡çš„æœ¬è´¨å’Œç›®çš„ï¼›</li><li>Things to avoidï¼šè¯´æ˜è¿™ä¸ªä»»åŠ¡çš„æ³¨æ„äº‹é¡¹ï¼Œä¾‹å¦‚éœ€è¦é¿å…ä»€ä¹ˆç­‰ç­‰ï¼›</li><li>Positive / Negative Examplesï¼šç»™å‡ºæ­£ç¡®å’Œé”™è¯¯çš„ä¾‹å­ï¼Œä½œä¸ºæç¤ºï¼›</li><li>Promptï¼šå½“å‰ä»»åŠ¡çš„æç¤ºä¿¡æ¯ï¼›</li></ul><p>â€ƒâ€ƒå½“è®¸å¤šä»»åŠ¡éƒ½æŒ‰ç…§è¿™ç§æ¨¡å¼å®šä¹‰å¥½æ¨¡æ¿ï¼Œè®©æ¨¡å‹åœ¨æŒ‡ä»¤åŒ–åçš„æ•°æ®ä¸Šè¿›è¡Œå¾®è°ƒï¼Œæ¨¡å‹å°†å¯ä»¥å­¦ä¼šå¦‚ä½•çœ‹åˆ°æŒ‡ä»¤åšé¢„æµ‹ã€‚</p><p>â€ƒâ€ƒä¸‹é¢ä»‹ç»ä¸€äº›å…¸å‹çš„åŸºäºInstructionçš„æ–¹æ³•ï¼ŒåŒ…æ‹¬FLANã€LaMDAå’ŒInstructionGPTï¼Œå®ƒä»¬éƒ½æ˜¯éµå¾ªInstruction-tuningå®ç°ç»Ÿä¸€èŒƒå¼ã€‚</p><h4 id="FLAN"><a href="#FLAN" class="headerlink" title="FLAN"></a>FLAN</h4><p>â€ƒâ€ƒä¾‹å¦‚åŸºäºInstruction-Tuningè®­ç»ƒçš„<strong>FLANæ¨¡å‹</strong>ï¼Œå…¶åœ¨62ä¸ªä»»åŠ¡ä¸Šè¿›è¡Œå¤šä»»åŠ¡è®­ç»ƒï¼Œæ¯ä¸ªä»»åŠ¡éƒ½è®¾è®¡äº†Instructionï¼Œæœ€åå¾—åˆ°137Bçš„å¤§æ¨¡å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://img-blog.csdnimg.cn/fbb22d180eec45f590a84d6674ac71cd.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/d2401c77aec74a5b9a14738a24d6dc77.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="LaMDA"><a href="#LaMDA" class="headerlink" title="LaMDA"></a>LaMDA</h4><p>â€ƒâ€ƒè°·æ­Œæå‡ºçš„LaMDAæ¨¡å‹ï¼Œå…¶å®Œå…¨é‡‡ç”¨è‡ªå›å½’ç”Ÿæˆå¼æ¨¡å‹ï¼Œå¹¶åœ¨å¤§é‡çš„å¯¹è¯è¯­æ–™ä¸Šè¿›è¡Œé¢„è®­ç»ƒï¼Œå¾—åˆ°137Bçš„å¤§æ¨¡å‹ã€‚ä¸ºäº†æé«˜æ¨¡å‹çš„å®‰å…¨æ€§å’Œäº‹å®æ€§ï¼ŒLaMDAæ¶‰åŠåˆ°ä¸¤ä¸ªå¾®è°ƒç­–ç•¥ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡äººå·¥æ ‡æ³¨å½¢å¼æ ‡æ³¨ä¸€äº›å­˜åœ¨å®‰å…¨éšæ‚£çš„æ•°æ®ã€‚æœŸæœ›æ¨¡å‹ç”Ÿæˆè¿‡ç¨‹ä¸­è€ƒè™‘å››ç§å› ç´ ï¼š<br><img src="https://img-blog.csdnimg.cn/f5bda8836f7e4745be81c20c1d1ba75b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>â€ƒâ€ƒå¦ä¸€ç§å¾®è°ƒç­–ç•¥åˆ™æ˜¯å¼•å…¥äº’è”ç½‘æœç´¢æœºåˆ¶ï¼Œæé«˜æ¨¡å‹ç”Ÿæˆç»“æœçš„äº‹å®æ€§ï¼š<br><img src="https://img-blog.csdnimg.cn/2518ee4eb0e4462b8bf7adbcad922311.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>â€ƒâ€ƒæœ€è¿‘ä¸ChatGPTç±»ä¼¼çš„Bardå¤§æ¨¡å‹åˆ™æ˜¯åŸºäºLaMDAå¾®è°ƒçš„æ¨¡å‹ã€‚</p><h4 id="InstructionGPT"><a href="#InstructionGPT" class="headerlink" title="InstructionGPT"></a>InstructionGPT</h4><p>â€ƒâ€ƒå¦å¤–ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯OpenAIçš„InstructionGPTï¼Œå…¶ä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/1e84e47869ac42eab1ee56fc39b7fba0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><ul><li><strong>Step1</strong>ï¼šå…ˆé‡‡æ ·ä¸€äº›demonstrationæ•°æ®ï¼Œå…¶åŒ…æ‹¬promptå’Œlabeled answerã€‚åŸºäºè¿™äº›æ ‡æ³¨çš„æ•°æ®ï¼Œå¯¹GPT-3è¿›è¡Œfine-tuningï¼Œå¾—åˆ°SFTï¼ˆSupervised Fine-tuningï¼‰ï¼›</li></ul><blockquote><p>â€ƒâ€ƒé›‡ä½£40åæ ‡æ³¨äººå‘˜å®Œæˆpromptçš„æ ‡æ³¨ã€‚<br>æ­¤æ—¶çš„SFTæ¨¡å‹åœ¨éµå¾ªæŒ‡ä»¤/å¯¹è¯æ–¹é¢å·²ç»ä¼˜äº GPT-3ï¼Œä½†ä¸ä¸€å®šç¬¦åˆäººç±»åå¥½ã€‚</p></blockquote><ul><li><strong>Step2</strong>ï¼šFine-tuningå®Œä¹‹åï¼Œå†ç»™ä¸€ä¸ªpromptè®©SFTæ¨¡å‹ç”Ÿæˆå‡ºè‹¥å¹²ç»“æœï¼ˆå¯ä»¥é€šè¿‡beam searchç­‰æ–¹æ³•ï¼‰ï¼Œä¾‹å¦‚ç”ŸæˆABCDå››ç§ç»“æœï¼Œé€šè¿‡äººå·¥ä¸ºå…¶æ’åºï¼Œä¾‹å¦‚D&gt;C&gt;A=Bï¼Œå¯ä»¥å¾—åˆ°æ ‡æ³¨çš„æ’åºpairï¼›åŸºäºæ ‡æ³¨çš„æ’åºç»“æœï¼Œè®­ç»ƒä¸€ä¸ªReward Modelï¼›</li></ul><blockquote><p>â€ƒâ€ƒå¯¹å¤šä¸ªæ’åºç»“æœï¼Œä¸¤ä¸¤ç»„åˆï¼Œå½¢æˆå¤šä¸ªè®­ç»ƒæ•°æ®å¯¹ã€‚RMæ¨¡å‹æ¥å—ä¸€ä¸ªè¾“å…¥ï¼Œç»™å‡ºè¯„ä»·å›ç­”è´¨é‡çš„åˆ†æ•°ã€‚è¿™æ ·ï¼Œå¯¹äºä¸€å¯¹è®­ç»ƒæ•°æ®ï¼Œè°ƒèŠ‚å‚æ•°ä½¿å¾—é«˜è´¨é‡å›ç­”çš„æ‰“åˆ†æ¯”ä½è´¨é‡çš„æ‰“åˆ†è¦é«˜ã€‚</p></blockquote><ul><li><strong>Step3</strong>ï¼šç»§ç»­ç”¨ç”Ÿæˆå‡ºæ¥çš„ç»“æœè®­ç»ƒSFTï¼Œå¹¶é€šè¿‡å¼ºåŒ–å­¦ä¹ çš„PPOæ–¹æ³•ï¼Œæœ€å¤§åŒ–SFTç”Ÿæˆå‡ºæ’åºé å‰çš„answerã€‚</li></ul><blockquote><p>è®­ç»ƒç›®æ ‡å¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/576f061292a24b50be892e0d89553869.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åˆå§‹åŒ–æ—¶ Ï€ Ï• R L = Ï€ S F T \pi_{\phi}^{RL}=\pi^{SFT} Ï€Ï•RL\=Ï€SFT<br>PPOç®—æ³•åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç¯å¢ƒä¼šå‘ç”Ÿå˜æ¢ã€‚<br>é¦–å…ˆï¼Œæ ¹æ®è‡ªåŠ¨æ ‡æ³¨çš„æ•°æ®ï¼ˆä¸‹é¢çš„æ¥æº3ï¼‰ï¼Œå–‚å…¥ Ï€ Ï• R L \pi_{\phi}^{RL} Ï€Ï•RLä¸­ï¼Œå¾—åˆ°è¾“å‡ºç»“æœ y y yï¼Œå…¶ä¼šæ ¹æ® r Î¸ r_{\theta} rÎ¸å¾—åˆ°ä¸€ä¸ªå¾—åˆ†ï¼ŒæœŸæœ›åœ¨è®­ç»ƒ Ï€ Ï• R L \pi_{\phi}^{RL} Ï€Ï•RLæ—¶èƒ½å¤Ÿæœ€å¤§åŒ–rewardçš„å¾—åˆ†ï¼›<br>ç¬¬äºŒé¡¹lossè¡¨ç¤ºKLæ•£åº¦ï¼Œåœ¨è¿­ä»£è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé¿å…RLæ¨¡å‹ Ï€ Ï• R L \pi_{\phi}^{RL} Ï€Ï•RLä¸åŸå§‹çš„ç›‘ç£è®­ç»ƒçš„SFTæ¨¡å‹å·®çš„å¤ªè¿œï¼›<br>ç¬¬ä¸‰é¡¹åˆ™æ˜¯ä¸€ä¸ªé¢„è®­ç»ƒç›®æ ‡ï¼Œå¯ä»¥ç†è§£ä¸ºé¿å…ç¾éš¾é—å¿˜ã€‚å½“ Î³ = 0 \gamma=0 Î³\=0æ—¶åˆ™ä¸ºæ ‡å‡†çš„PPOæ¨¡å‹ï¼Œå¦åˆ™ä¸ºPPO-ptxæ¨¡å‹<br>1.3B å‚æ•° InstructGPT æ¨¡å‹çš„è¾“å‡ºä¼˜äº 175B GPT-3 çš„è¾“å‡ºï¼Œå°½ç®¡å‚æ•°å°‘äº† 100 å¤šå€ã€‚</p></blockquote><h3 id="5-3-Chain-of-Thoughtï¼ˆæ€ç»´é“¾ï¼‰"><a href="#5-3-Chain-of-Thoughtï¼ˆæ€ç»´é“¾ï¼‰" class="headerlink" title="5.3 Chain-of-Thoughtï¼ˆæ€ç»´é“¾ï¼‰"></a>5.3 Chain-of-Thoughtï¼ˆæ€ç»´é“¾ï¼‰</h3><p>â€ƒâ€ƒæ€ç»´é“¾åœ¨2022å¹´åˆç”±è°·æ­Œå›¢é˜Ÿæå‡ºï¼Œå…¶æ—¨åœ¨è¿›ä¸€æ­¥æé«˜è¶…å¤§è§„æ¨¡æ¨¡å‹åœ¨ä¸€äº›å¤æ‚ä»»åŠ¡ä¸Šçš„æ¨ç†èƒ½åŠ›ã€‚å…¶è®¤ä¸ºç°æœ‰çš„è¶…å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹å¯èƒ½å­˜åœ¨ä¸‹é¢æ½œåœ¨çš„é—®é¢˜ï¼š</p><ul><li>å¢å¤§æ¨¡å‹å‚æ•°è§„æ¨¡å¯¹äºä¸€äº›å…·æœ‰æŒ‘æˆ˜çš„ä»»åŠ¡ï¼ˆä¾‹å¦‚ç®—æœ¯ã€å¸¸è¯†æ¨ç†å’Œç¬¦å·æ¨ç†ï¼‰çš„æ•ˆæœå¹¶æœªè¯æ˜æœ‰æ•ˆï¼›</li></ul><blockquote><p>Scaling up model size alone has not proved sufficient for achieving high performance on challenging tasks such as arithmetic, commonsense, and symbolic reasoning.</p></blockquote><ul><li>æœŸæœ›æ¢ç´¢å¦‚ä½•å¯¹å¤§æ¨¡å‹è¿›è¡Œæ¨ç†çš„ç®€å•æ–¹æ³•ï¼š</li></ul><blockquote><p>â—‹ å¯¹äºç®—æœ¯ç±»æ¨ç†ä»»åŠ¡ï¼ŒæœŸæœ›ç”Ÿæˆè‡ªç„¶è¯­è¨€é€»è¾‘ä¾æ®æ¥æŒ‡å¯¼å¹¶ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆï¼›ä½†æ˜¯è·å¾—é€»è¾‘ä¾æ®æ˜¯æ¯”è¾ƒå¤æ‚æ˜‚è´µçš„ã€‚ It is costly to create a large set of high quality rationales, which is much more complicated than simple inputâ€“output pairs used in normal machine learning<br>â—‹ å¯¹æŸä¸ªtaskï¼Œä¸ºå¤§æ¨¡å‹æä¾›ä¸€äº›ä¸Šä¸‹æ–‡in-context exampleä½œä¸ºpromptï¼›ç®€å•çš„ç¤ºä¾‹å¯èƒ½å¹¶éèƒ½å¤Ÿæå‡æ¨ç†èƒ½åŠ›ã€‚It works poorly on tasks that require reasoning abilities, and often does not improve substantially with increasing language model scale</p></blockquote><p>å› æ­¤ï¼Œæå‡º<strong>æ€ç»´é“¾ï¼ˆChain-of-Thoughtï¼‰</strong>ã€‚æ€ç»´é“¾çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><p><strong>A chain of thought is a series of intermediate natural language reasoning steps that lead to the final output, and we refer to this approach as chain-of-thought prompting.</strong></p><p>â€ƒâ€ƒç›´è§‚ç†è§£å¾ˆç®€å•ï¼Œæ€ç»´é“¾æ˜¯ä¸€ç§ç‰¹æ®Šçš„In-Context Learningï¼Œå¯¹äºæ¯ä¸ªæŒ‘é€‰çš„In-Context Exampleï¼Œé™¤äº†ç»™å‡ºInput-Output Mappingå¤–ï¼Œè¿˜éœ€è¦ç»™å‡ºä¸€ä¸ªæ¨ç†è¿‡ç¨‹ï¼Œç§°ä¸ºRelationaleæˆ–Reasoning Pathï¼Œå…¶æ˜¯ä¸€ä¸ªå…·æœ‰é€»è¾‘æ¨ç†è¿‡ç¨‹çš„çŸ­æ–‡æœ¬ï¼Œå¦‚ä¸‹å›¾è“è‰²éƒ¨åˆ†ã€‚</p><p><img src="https://img-blog.csdnimg.cn/0a0f61b54125475c938e591055387c10.png" alt></p><p>â€ƒâ€ƒé€šè¿‡å¼•å…¥æ¨ç†è·¯å¾„ä½œä¸ºæç¤ºï¼Œå¯ä»¥æ¿€å‘å¤§æ¨¡å‹æŒ‰ç…§è¿™ç§æ¨ç†çš„æ¨¡å¼ç”Ÿæˆå‡ºåˆç†çš„ç»“æœï¼Œå¼•å¯¼å¤§æ¨¡å‹å¦‚ä½•æ€è€ƒã€å¦‚ä½•æ¨ç†ã€‚</p><p>â€ƒâ€ƒä¸‹é¢ä»‹ç»å‡ ä¸ªç»å…¸çš„CoTæ–¹æ³•ï¼š</p><h4 id="ï¼ˆ1ï¼‰Self-consistency-Improves-Chain-Of-Thought-Reasoning-in-Language-Models"><a href="#ï¼ˆ1ï¼‰Self-consistency-Improves-Chain-Of-Thought-Reasoning-in-Language-Models" class="headerlink" title="ï¼ˆ1ï¼‰Self-consistency Improves Chain Of Thought Reasoning in Language Models"></a>ï¼ˆ1ï¼‰<a href="https://arxiv.org/abs/2203.11171">Self-consistency Improves Chain Of Thought Reasoning in Language Models</a></h4><p>â€ƒâ€ƒ<strong>Self-consistencyï¼ˆè‡ªæˆ‘ä¸€è‡´æ€§ï¼‰</strong> å»ºç«‹åœ¨ä¸€ä¸ªç›´è§‰åŸºç¡€ä¸Šï¼šå³<strong>ä¸€ä¸ªå¤æ‚çš„æ¨ç†ä»»åŠ¡ï¼Œå…¶å¯ä»¥æœ‰å¤šç§æ¨ç†è·¯å¾„ï¼ˆå³è§£é¢˜æ€è·¯ï¼‰ï¼Œæœ€ç»ˆéƒ½èƒ½å¤Ÿå¾—åˆ°æ­£ç¡®çš„ç­”æ¡ˆ</strong>ã€‚å³æ‰€è°“<strong>æ¡æ¡å¤§è·¯é€šç½—é©¬</strong>ã€‚ä¸€ä¸ªé—®é¢˜è¶Šéœ€è¦æ·±æ€ç†Ÿè™‘çš„æ€è€ƒå’Œåˆ†æï¼Œé‚£ä¹ˆä¸ƒå¯ä»¥å¾—å‡ºç­”æ¡ˆçš„æ¨ç†è·¯å¾„å°±è¶Šå¤šæ ·åŒ–ã€‚</p><p>â€ƒâ€ƒå…·ä½“æ–¹æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å…ˆä»å¤§æ¨¡å‹çš„decoderä¸­é‡‡æ ·å‡ºä¸€ç³»åˆ—ä¸ªreasoning pathï¼Œæ¯ä¸€ä¸ªpathéƒ½èƒ½å¤Ÿå¯¹åº”ä¸€ä¸ªæœ€ç»ˆçš„ç­”æ¡ˆï¼Œæˆ‘ä»¬<strong>å¯ä»¥æŒ‘é€‰é‚£äº›èƒ½å¤Ÿå¾—åˆ°ä¸€è‡´ç­”æ¡ˆçš„è¾ƒå¤šçš„path</strong>ï¼Œä½œä¸ºæˆ‘ä»¬çš„é‡‡æ ·å¾—åˆ°çš„reasoning pathã€‚åŸºäºè¿™ç§ç›´æ¥æŠ•ç¥¨ç­–ç•¥ï¼Œæ¯”è¾ƒç¬¦åˆäººç±»çš„ç›´è§‰ï¼Œå³å¦‚æœå¾ˆå¤šreasoning pathéƒ½èƒ½å¾—åˆ°å¯¹åº”çš„ä¸€ä¸ªç­”æ¡ˆï¼Œé‚£ä¹ˆè¿™ä¸ªç­”æ¡ˆçš„ç½®ä¿¡åº¦ä¼šæ¯”è¾ƒå¤§ã€‚<br><img src="https://img-blog.csdnimg.cn/23b4da9753e541c19850f53f137b9cf8.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>â€ƒâ€ƒä½œè€…ä¹Ÿæ¢ç´¢äº†ä¸€äº›å…¶ä»–çš„æŠ•ç¥¨ç­–ç•¥ï¼Œä¾‹å¦‚æ ¹æ®logitè¿›è¡ŒåŠ æƒç­‰ï¼Œå‘ç°ç›´æ¥æŠ•ç¥¨æ›´åˆé€‚ï¼š<br><img src="https://img-blog.csdnimg.cn/fa12931f8fba44d891a0afdd22e5d874.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h4 id="ï¼ˆ2ï¼‰Large-Language-Models-are-Zero-Shot-Reasoners"><a href="#ï¼ˆ2ï¼‰Large-Language-Models-are-Zero-Shot-Reasoners" class="headerlink" title="ï¼ˆ2ï¼‰Large Language Models are Zero-Shot Reasoners"></a>ï¼ˆ2ï¼‰<a href="https://arxiv.org/abs/2205.11916">Large Language Models are Zero-Shot Reasoners</a></h4><p>â€ƒâ€ƒCoTéœ€è¦æ¶‰åŠåˆ°äººå·¥æ ‡æ³¨promptã€‚è¯¥å·¥ä½œåˆ™å‘ç°åªéœ€è¦æ·»åŠ ä¸€ä¸ªå›ºå®šçš„promptï¼šâ€œLets think step by stepâ€ å³å¯ä»¥ä¿ƒä½¿å¤§æ¨¡å‹ä¸€æ­¥æ­¥æ¨ç†æ¥ç”Ÿæˆç»“æœã€‚</p><p><img src="https://img-blog.csdnimg.cn/ea9aaa97835c41819ee8e3e7662ce1ba.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>â€ƒâ€ƒä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªæ ¸å¿ƒæ­¥éª¤ï¼š</p><ul><li><strong>1st promptï¼šreasoning extraction</strong>ï¼šå…ˆæ„å»ºæ¨¡æ¿ï¼Œå¾—åˆ° x â€² = Q : [ x ] . A : [ T ] xâ€™= Q: [x]. A: [T] xâ€²\=Q:[x].A:[T]ï¼Œç„¶åå–‚å…¥å¤§æ¨¡å‹ä¸­ç”Ÿå­˜ç»“æœ z z zï¼›</li><li><strong>2nd promptï¼šanswer extraction</strong>ï¼šå°† [ z â€² ] [ z ] [ A ] [zâ€™] [z] [A] [zâ€²][z][A]æ‹¼æ¥èµ·æ¥ï¼Œå†æ¬¡å–‚å…¥å¤§æ¨¡å‹ä¸­ï¼Œç›´æ¥ç”Ÿæˆç»“æœã€‚</li></ul><h4 id="ï¼ˆ3ï¼‰Automatic-Chain-of-Thought-Prompting-in-Large-Language-Models"><a href="#ï¼ˆ3ï¼‰Automatic-Chain-of-Thought-Prompting-in-Large-Language-Models" class="headerlink" title="ï¼ˆ3ï¼‰Automatic Chain of Thought Prompting in Large Language Models"></a>ï¼ˆ3ï¼‰<a href="http://arxiv.org/abs/2210.03493">Automatic Chain of Thought Prompting in Large Language Models</a></h4><p>â€ƒâ€ƒå…ˆå‰çš„chain-of-thoughtåŒ…æ‹¬ä¸¤ç§ï¼Œä¸€ç§æ˜¯Zero-shot CoTï¼ˆletâ€™s think step by stepï¼‰ï¼Œå¦ä¸€ç§æ˜¯Manual-CoTï¼ˆæ‹¼æ¥è‹¥å¹²æ ·æœ¬ä½œä¸ºdemonstrationï¼‰ã€‚æˆ‘ä»¬å‘ç°ä¸è®ºæ˜¯ä½•ç§promptæ¨¡å¼ï¼Œå¤§æ¨¡å‹éƒ½ä¼šç”Ÿæˆé”™è¯¯çš„chainsã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è€ƒè™‘æå‡ºä¸€ç§è‡ªåŠ¨åŒ–æ„å»ºdemonstrationçš„æ–¹æ³•â€”â€”Auto-CoTã€‚</p><p><img src="https://img-blog.csdnimg.cn/1de3bdc20bf146498e8ebecb9d7ef5c8.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>â€ƒâ€ƒä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªæ­¥éª¤ï¼š<br><strong>ï¼ˆ1ï¼‰Queston Clusteringï¼š</strong><br>â€ƒâ€ƒä½¿ç”¨sentence-BERTå¯¹æ¯ä¸ªquestionè·å¾—è¡¨å¾ï¼Œç„¶åé€šè¿‡K-meansè·å¾—è‹¥å¹²ç°‡ã€‚å¯¹äºæ¯ä¸ªç°‡ï¼ŒæŒ‰ç…§å…¶è·ç¦»ç°‡ä¸­å¿ƒè·ç¦»çš„å¤§å°å‡åºæ’åˆ—ã€‚ç®—æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/3c8879781c7c445c94d9841ae244c6f3.png" alt></p><p><strong>ï¼ˆ2ï¼‰Demonstration Samplingï¼š</strong><br>â€ƒâ€ƒæ ¹æ®Clusterçš„ç»“æœï¼Œé‡‡æ ·å¾—åˆ°åˆé€‚çš„promptã€‚å¯¹äºæ¯ä¸ªç°‡ï¼Œé‡‡æ ·ä¸€ä¸ªquestionï¼Œå¹¶ä¸Letâ€™s think step-by-stepæ‹¼æ¥èµ·æ¥ï¼Œå–‚å…¥å¤§æ¨¡å‹ä¸­ç”Ÿå­˜relationaleã€‚æœ€åå°† K K Kä¸ªrelationaleä¸å¯¹åº”çš„questionã€answeræ‹¼æ¥ï¼Œå¹¶æ‹¼æ¥ç›®æ ‡æµ‹è¯•æ ·æœ¬ï¼Œä¿ƒä½¿å¤§æ¨¡å‹ç”Ÿæˆæµ‹è¯•æ ·æœ¬çš„relationaleã€‚</p><p><img src="https://img-blog.csdnimg.cn/2fdd13b09a414940a5b3a864ab25d87a.png" alt></p><p>â€ƒâ€ƒAuto-CoTæ—¨åœ¨è‡ªåŠ¨é€‰æ‹©æ ·æœ¬ï¼Œç„¶åè®©å¤§æ¨¡å‹ä¾æ¬¡ç”Ÿæˆå‡ºrelationaleï¼Œç„¶åæœ€åæ‹¼æ¥æ‰€æœ‰relationaleä½œä¸ºæµ‹è¯•æ ·æœ¬çš„æç¤ºã€‚</p><h4 id="ï¼ˆ4ï¼‰Least-to-Most-Prompting-Enables-Complex-Reasoning-in-Large-Language-Models"><a href="#ï¼ˆ4ï¼‰Least-to-Most-Prompting-Enables-Complex-Reasoning-in-Large-Language-Models" class="headerlink" title="ï¼ˆ4ï¼‰Least-to-Most Prompting Enables Complex Reasoning in Large Language Models"></a>ï¼ˆ4ï¼‰<a href="https://arxiv.org/abs/2205.10625">Least-to-Most Prompting Enables Complex Reasoning in Large Language Models</a></h4><p>â€ƒâ€ƒæœ€è¿‘CoTçš„æå‡ºè¿›ä¸€æ­¥æ‹‰è¿‘äº†äººç±»ä¸æœºå™¨æ™ºèƒ½çš„è·ç¦»ï¼Œé€šè¿‡natural language rationaleså’Œself-consistencyæ¥æå‡å¤§æ¨¡å‹åœ¨æ¨ç†ä»»åŠ¡ä¸Šçš„æ€§èƒ½ã€‚ç„¶è€ŒCoTä¾ç„¶å­˜åœ¨ä¸€äº›ä¸è¶³ï¼šå³å…¶å¾ˆéš¾å¯¹è¶…å‡ºdemonstration exampleéš¾åº¦ç¨‹åº¦çš„é—®é¢˜è¿›è¡Œè§£ç­”ã€‚ä¸ºæ­¤ï¼Œè¯¥å·¥ä½œå°è¯•å°†ä¸€ä¸ªå¤æ‚çš„ä»»åŠ¡åˆ†è§£ä¸ºè‹¥å¹²ç®€å•çš„å­ä»»åŠ¡ã€‚</p><p><img src="https://img-blog.csdnimg.cn/6bd57be88dbb4da78f31624ff7c0fc2c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>â€ƒâ€ƒåœ¨å¯¹æ¯ä¸ªå­é—®é¢˜è¿›è¡Œé¢„æµ‹æ—¶ï¼Œæ˜¯ä¸€ä¸ªæ¸è¿‘çš„è¿‡ç¨‹ã€‚</p><ul><li>ç¬¬ä¸€ä¸ªå­é—®é¢˜æ˜¯æœ€ç®€å•çš„ï¼›</li><li>è§£å†³ç¬¬äºŒä¸ªå­é—®é¢˜æ—¶ï¼Œä¼šå°†ä¸Šä¸€ä¸ªå­é—®é¢˜ä»¥åŠç­”æ¡ˆé™„åŠ åœ¨å½“å‰å­é—®é¢˜çš„å‰é¢ï¼Œè€Œä¸”ç¬¬äºŒä¸ªå­é—®é¢˜ä¼šæ¯”ç¬¬ä¸€ä¸ªå­é—®é¢˜éš¾ï¼›</li><li>æœ€åä¸€ä¸ªå­é—®é¢˜å°±æ˜¯åŸå§‹çš„é—®é¢˜ï¼Œæ­¤æ—¶å…¶ä¼šæœ‰å‰é¢æ‰€æœ‰å­é—®é¢˜çš„è§£ç­”ä½œä¸ºæç¤ºã€‚<br>æœ€ç®€å•çš„æƒ…å†µï¼Œå°±æ˜¯å°†ä¸€ä¸ªé—®é¢˜åˆ†è§£ä¸ºä¸¤ä¸ªå­é—®é¢˜ï¼Œå‰é¢æ‰€æœ‰çš„å­é—®é¢˜å¯ä»¥ä½œä¸ºåé¢å­é—®é¢˜çš„in-context demonstrationã€‚</li></ul><p>æœªå®Œå¾…ç»­</p><hr><h2 id="-5"><a href="#-5" class="headerlink" title=" "></a> </h2><p>ç¬¬å…­ç« ï¼šChatGPTä¸Prompt-Tuning</p><hr><h3 id="6-1-ChatGPTæ ¸å¿ƒæŠ€æœ¯"><a href="#6-1-ChatGPTæ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="6.1 ChatGPTæ ¸å¿ƒæŠ€æœ¯"></a>6.1 ChatGPTæ ¸å¿ƒæŠ€æœ¯</h3><h3 id="6-2-AICGæŠ€æœ¯"><a href="#6-2-AICGæŠ€æœ¯" class="headerlink" title="6.2 AICGæŠ€æœ¯"></a>6.2 AICGæŠ€æœ¯</h3><h3 id="6-3-Prompt-Tuningåœ¨ChatGPTé‡Œçš„åº”ç”¨"><a href="#6-3-Prompt-Tuningåœ¨ChatGPTé‡Œçš„åº”ç”¨" class="headerlink" title="6.3 Prompt-Tuningåœ¨ChatGPTé‡Œçš„åº”ç”¨"></a>6.3 Prompt-Tuningåœ¨ChatGPTé‡Œçš„åº”ç”¨</h3><hr><h2 id="-6"><a href="#-6" class="headerlink" title=" "></a> </h2><p>ç¬¬ä¸ƒç« ï¼šPrompt-TuningæŠ€æœ¯çš„åº”ç”¨</p><hr><h3 id="7-1-é»‘ç›’æ¨ç†"><a href="#7-1-é»‘ç›’æ¨ç†" class="headerlink" title="7.1 é»‘ç›’æ¨ç†"></a>7.1 é»‘ç›’æ¨ç†</h3><p>æ ¸å¿ƒè¦ç‚¹ï¼š</p><ul><li>Large Language Model as a Serviceï¼šè¶…å¤§è§„æ¨¡æ¨¡å‹ä½œä¸ºé»‘ç›’ï¼Œå¦‚ä½•è¿›è¡Œä¼˜åŒ–ï¼Ÿ</li><li>å¦‚ä½•æé«˜é»‘ç›’å¤§æ¨¡å‹çš„æ€§èƒ½ï¼Ÿ</li></ul><h3 id="7-2-æ–‡æœ¬åˆ†ç±»"><a href="#7-2-æ–‡æœ¬åˆ†ç±»" class="headerlink" title="7.2 æ–‡æœ¬åˆ†ç±»"></a>7.2 æ–‡æœ¬åˆ†ç±»</h3><p>æ ¸å¿ƒè¦ç‚¹ï¼š</p><ul><li>é’ˆå¯¹ä¸åŒçš„åˆ†ç±»ä»»åŠ¡ï¼Œå¦‚ä½•è®¾è®¡å’Œä¼˜åŒ–Promptï¼Ÿ</li></ul><h3 id="7-3-ä¿¡æ¯æŠ½å–"><a href="#7-3-ä¿¡æ¯æŠ½å–" class="headerlink" title="7.3 ä¿¡æ¯æŠ½å–"></a>7.3 ä¿¡æ¯æŠ½å–</h3><p>æ ¸å¿ƒè¦ç‚¹ï¼š</p><ul><li>å¦‚ä½•åˆ©ç”¨Prompt-TuningæŠ€æœ¯å®ç°ä¿¡æ¯æŠ½å–ï¼Ÿ</li><li>å¦‚ä½•æé«˜ä¿¡æ¯æŠ½å–çš„æ³›åŒ–æ€§èƒ½ï¼Ÿ</li></ul><h3 id="7-4-é—®ç­”"><a href="#7-4-é—®ç­”" class="headerlink" title="7.4 é—®ç­”"></a>7.4 é—®ç­”</h3><p>æ ¸å¿ƒè¦ç‚¹ï¼š</p><ul><li>å¦‚ä½•åˆ©ç”¨Promptå®ç°é—®ç­”ï¼Ÿ</li></ul><h3 id="7-5-æ–‡æœ¬ç”Ÿæˆ"><a href="#7-5-æ–‡æœ¬ç”Ÿæˆ" class="headerlink" title="7.5 æ–‡æœ¬ç”Ÿæˆ"></a>7.5 æ–‡æœ¬ç”Ÿæˆ</h3><p>æ ¸å¿ƒè¦ç‚¹ï¼š</p><ul><li>å¦‚ä½•åˆ©ç”¨Promptå®ç°æ–‡æœ¬ç”Ÿæˆï¼Ÿ</li></ul><hr><h2 id="-7"><a href="#-7" class="headerlink" title=" "></a> </h2><p>ç¬¬å…«ç« ï¼šPrompt-Tuningçš„æœªæ¥å‘å±•</p><hr>]]></content>
      
      
      <categories>
          
          <category> NLP </category>
          
          <category> LLM </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>000 å¤§æ¨¡å‹å­¦ä¹ ä¹‹è·¯æŒ‡åŒ—</title>
      <link href="/post/nlp000.html"/>
      <url>/post/nlp000.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://michealxie94.github.io/post/nlp001.html">001 é˜¿é‡Œäº‘æ­å»ºlangchain-ChatGLMçŸ¥è¯†åº“é—®ç­”-ç¯å¢ƒæ­å»º</a><br><a href="https://michealxie94.github.io/post/nlp002.html">002 å¤§æ¨¡å‹LLM-å¾®è°ƒç»éªŒåˆ†äº«&amp;æ€»ç»“-çŸ¥ä¹-åˆ˜èªNLP</a><br><a href="https://michealxie94.github.io/post/nlp003.html">003ã€LLMã€‘ä»é›¶å¼€å§‹è®­ç»ƒå¤§æ¨¡å‹-çŸ¥ä¹-ä½•æ</a><br><a href="https://michealxie94.github.io/post/nlp004.html">004 å¤§æ¨¡å‹å¾®è°ƒæ€»ç»“-çŸ¥ä¹-ç»å¯†ä¼å‡»</a><br><a href="https://michealxie94.github.io/post/nlp005.html">005 å¤§è¯­è¨€æ¨¡å‹ç»¼è¿°[æŒç»­æ›´æ–°]-csdn-ç‹å˜‰å®</a><br><a href="https://michealxie94.github.io/post/nlp006.html">006 è®ºæ–‡æ³›è¯»</a></p>]]></content>
      
      
      <categories>
          
          <category> NLP </category>
          
          <category> LLM </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>004 å¤§æ¨¡å‹å¾®è°ƒæ€»ç»“-çŸ¥ä¹-ç»å¯†ä¼å‡»</title>
      <link href="/post/nlp004.html"/>
      <url>/post/nlp004.html</url>
      
        <content type="html"><![CDATA[<h2 id="è½¬è½½"><a href="#è½¬è½½" class="headerlink" title="è½¬è½½"></a><strong>è½¬è½½</strong></h2><p>æœ¬æ–‡è½¬è½½äºï¼š<a href="https://zhuanlan.zhihu.com/p/627642632">@çŸ¥ä¹-ç»å¯†ä¼å‡»</a></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><font size="0.5"><div class="table-container"><table><thead><tr><th style="text-align:left">å¹´ä»½</th><th style="text-align:left">inc</th><th style="text-align:left">method</th><th style="text-align:left">åˆ›æ–°ä¹‹å¤„</th><th style="text-align:center">å‚æ•°</th><th style="text-align:left">å“ªä¸€å±‚</th><th style="text-align:left">ä½ç½®</th><th>åˆå§‹åŒ–æ–¹å¼</th><th>å‰è¾ˆ</th><th>è®ºæ–‡</th></tr></thead><tbody><tr><td style="text-align:left">2019</td><td style="text-align:left">è°·æ­Œ</td><td style="text-align:left"><code>Adapter Tuning</code></td><td style="text-align:left">1ã€è®¾è®¡<code>Adapter</code>ç»“æ„(å³<code>MLP</code>)ï¼ŒåµŒå…¥ Transformer çš„ç»“æ„<br>2ã€Adapter ç»“æ„ï¼š<br>-   down-projectå±‚ï¼šå°†é«˜ç»´åº¦ç‰¹å¾æ˜ å°„åˆ°ä½ç»´ç‰¹å¾ã€‚<br>-  éçº¿æ€§å±‚<code>ReLU</code>ï¼šå¯¹ä½ç»´ç‰¹å¾è¿›è¡Œå¤„ç†ï¼Œä»¥æ›´å¥½åœ°è¡¨è¾¾ç‰¹å¾ä¿¡æ¯ã€‚<br>-  up-projectç»“æ„ï¼šå°†ä½ç»´ç‰¹å¾æ˜ å°„å›åŸæ¥çš„é«˜ç»´ç‰¹å¾ã€‚<br>-  skip-connectionç»“æ„ï¼šç¡®ä¿å³ä½¿åœ¨æœ€å·®çš„æƒ…å†µä¸‹ï¼Œæ¨¡å‹ä»èƒ½æ­£ç¡®å¤„ç†è¾“å…¥ç‰¹å¾ï¼Œç±»ä¼¼äºæ®‹å·®ç»“æ„ã€‚</td><td style="text-align:center">+3.6%</td><td style="text-align:left"><code>Transformer ffnå’ŒlayerNormä¹‹é—´</code></td><td style="text-align:left"></td><td></td><td></td><td><a href="https://arxiv.org/pdf/1902.00751.pdf">ã€ŠParameter-Efficient Transfer Learning for NLPã€‹</a></td></tr><tr><td style="text-align:left">å¹´ä»½</td><td style="text-align:left">inc</td><td style="text-align:left">method</td><td style="text-align:left">åˆ›æ–°ä¹‹å¤„</td><td style="text-align:center">å‚æ•°</td><td style="text-align:left">å“ªä¸€å±‚</td><td style="text-align:left">ä½ç½®</td><td>åˆå§‹åŒ–æ–¹å¼</td><td>å‰è¾ˆ</td><td>è®ºæ–‡</td></tr><tr><td style="text-align:left">2021</td><td style="text-align:left">æ–¯å¦ç¦</td><td style="text-align:left"><code>Prefix Tuning</code></td><td style="text-align:left">1ã€åœ¨æ¯ä¸ª<code>Attention</code> å±‚<code> è¾“å…¥token </code>ä¹‹å‰æ„é€ ä¸€æ®µä»»åŠ¡ç›¸å…³çš„<code> virtual tokens </code>ä½œä¸º<code> Prefix</code><br>2ã€å›ºå®šé¢„è®­ç»ƒå‚æ•°ï¼Œè®­ç»ƒåªæ›´æ–°<code> Prefix </code> éƒ¨åˆ†çš„å‚æ•°ã€‚è¯¥æ–¹æ³•å…¶å®å’Œæ„é€  <code>Prompt</code> ç±»ä¼¼ï¼Œåªæ˜¯ <code>Prompt</code> æ˜¯äººä¸ºæ„é€ çš„â€œæ˜¾å¼â€çš„æç¤ºï¼Œå¹¶ä¸”æ— æ³•æ›´æ–°å‚æ•°ï¼Œè€Œ <code>Prefix</code> åˆ™æ˜¯å¯ä»¥å­¦ä¹ çš„â€œéšå¼â€çš„æç¤ºã€‚<br>3ã€é˜²æ­¢ç›´æ¥æ›´æ–°<code> Prefix </code> çš„å‚æ•°å¯¼è‡´è®­ç»ƒä¸ç¨³å®šçš„æƒ…å†µï¼Œåœ¨<code> Prefix </code> å±‚å‰é¢åŠ äº†<code> MLP </code>ç»“æ„(ç›¸å½“äºå°†<code> Prefix </code> åˆ†è§£ä¸ºæ›´å°ç»´åº¦çš„<code> Input</code>ä¸<code> MLP </code>çš„ç»„åˆåè¾“å‡ºçš„ç»“æœ)ï¼Œè®­ç»ƒå®Œæˆåï¼Œåªä¿ç•™<code> Prefix </code> çš„å‚æ•°ã€‚</td><td style="text-align:center">+0.1%</td><td style="text-align:left"><code>Attention head</code></td><td style="text-align:left"><code> è¾“å…¥token </code>ä¹‹å‰</td><td><code> MLP </code></td><td></td><td><a href="https://arxiv.org/pdf/2101.00190.pdf">ã€ŠPrefix-Tuning: Optimizing Continuous Prompts for Generationã€‹</a></td></tr><tr><td style="text-align:left">å¹´ä»½</td><td style="text-align:left">inc</td><td style="text-align:left">method</td><td style="text-align:left">åˆ›æ–°ä¹‹å¤„</td><td style="text-align:center">å‚æ•°</td><td style="text-align:left">å“ªä¸€å±‚</td><td style="text-align:left">ä½ç½®</td><td>åˆå§‹åŒ–æ–¹å¼</td><td>å‰è¾ˆ</td><td>è®ºæ–‡</td></tr><tr><td style="text-align:left">2021</td><td style="text-align:left">è°·æ­Œ</td><td style="text-align:left"><code>Prompt Tuning</code></td><td style="text-align:left">1ã€<code>Prefix Tuning</code> çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œåªåœ¨è¾“å…¥å±‚åŠ å…¥ <code>prompt tokens</code>ï¼Œå¹¶ä¸éœ€è¦åŠ å…¥<code> MLP </code>è¿›è¡Œè°ƒæ•´æ¥è§£å†³éš¾è®­ç»ƒçš„é—®é¢˜<br>2ã€å›ºå®šé¢„è®­ç»ƒå‚æ•°ï¼Œä¸ºæ¯ä¸€ä¸ªä»»åŠ¡é¢å¤–æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ª<code>embedding</code>ï¼Œä¹‹åæ‹¼æ¥ <code>query</code> æ­£å¸¸è¾“å…¥ <code>LLM</code>ï¼Œå¹¶åªè®­ç»ƒè¿™äº› <code>embedding</code>ã€‚</td><td style="text-align:center">æœªçŸ¥</td><td style="text-align:left">è¾“å…¥å±‚</td><td style="text-align:left"><code> è¾“å…¥token </code>ä¹‹å‰</td><td>æ— </td><td><code>Prefix Tuning</code></td><td><a href="https://arxiv.org/pdf/2104.08691.pdf">ã€ŠThe Power of Scale for Parameter-Efficient Prompt Tuningã€‹</a></td></tr><tr><td style="text-align:left">å¹´ä»½</td><td style="text-align:left">inc</td><td style="text-align:left">method</td><td style="text-align:left">åˆ›æ–°ä¹‹å¤„</td><td style="text-align:center">å‚æ•°</td><td style="text-align:left">å“ªä¸€å±‚</td><td style="text-align:left">ä½ç½®</td><td>åˆå§‹åŒ–æ–¹å¼</td><td>å‰è¾ˆ</td><td>è®ºæ–‡</td></tr><tr><td style="text-align:left">2022</td><td style="text-align:left">æ¸…å</td><td style="text-align:left"><code>P-Tuning</code></td><td style="text-align:left">1ã€èƒŒæ™¯ï¼šå¤§æ¨¡å‹çš„<code>æ˜¾å¼Prompt</code>æ„é€ æ–¹å¼ä¸¥é‡å½±å“ä¸‹æ¸¸ä»»åŠ¡çš„æ•ˆæœ<br>2ã€å°†<code>Prompt</code> è½¬æ¢ä¸ºå¯ä»¥å­¦ä¹ çš„ <code>Embedding</code> å±‚<br>3ã€æå‡ºç”¨<code> MLP + LSTM</code> çš„æ–¹å¼æ¥å¯¹ <code>prompt embedding</code> è¿›è¡Œä¸€å±‚å¤„ç†<br>4ã€å›ºå®šé¢„è®­ç»ƒå‚æ•°ï¼Œåˆ©ç”¨<code>MLP+LSTM</code> å¯¹ <code>Prompt</code> è¿›è¡Œç¼–ç ï¼Œç¼–ç ä¹‹åä¸å…¶ä»–å‘é‡è¿›è¡Œæ‹¼æ¥ä¹‹åæ­£å¸¸è¾“å…¥ <code>LLM</code>ã€‚è®­ç»ƒä¹‹ååªä¿ç•™ <code>Prompt</code> ç¼–ç ä¹‹åçš„å‘é‡ï¼Œä¸ä¿ç•™ç¼–ç å™¨ã€‚<br>5ã€è¾“å…¥çš„æ—¶å€™åŠ å…¥<code>Embedding</code>ï¼Œ<code>Embedding</code>ä½ç½®åˆ™ä¸å›ºå®š</td><td style="text-align:center"><a href="https://michealxie94.github.io/post/nlp002.html">0.0586%</a></td><td style="text-align:left">è¾“å…¥å±‚</td><td style="text-align:left">ä¸å›ºå®š</td><td><code> MLP + LSTM</code></td><td><code>æ˜¾å¼Prompt</code></td><td><a href="https://arxiv.org/pdf/2103.10385.pdf">ã€ŠGPT Understands, Tooã€‹</a></td></tr><tr><td style="text-align:left">å¹´ä»½</td><td style="text-align:left">inc</td><td style="text-align:left">method</td><td style="text-align:left">åˆ›æ–°ä¹‹å¤„</td><td style="text-align:center">å‚æ•°</td><td style="text-align:left">å“ªä¸€å±‚</td><td style="text-align:left">ä½ç½®</td><td>åˆå§‹åŒ–æ–¹å¼</td><td>å‰è¾ˆ</td><td>è®ºæ–‡</td></tr><tr><td style="text-align:left">2022</td><td style="text-align:left">æ¸…å</td><td style="text-align:left"><code>P-Tuning v2</code></td><td style="text-align:left">1ã€èƒŒæ™¯ï¼š<code>Prompt Tuningã€P-Tuning</code>åœ¨å°å‚æ•°é‡æ¨¡å‹(<10B)ä¸Šè¡¨ç°å·®ï¼Œåœ¨sequence taggingä»»åŠ¡ä¸Šè¡¨ç°éƒ½å¾ˆå·® <br>2ã€ç›®æ ‡ï¼šè®© <code>Prompt Tuning</code> èƒ½å¤Ÿåœ¨ä¸åŒå‚æ•°è§„æ¨¡çš„é¢„è®­ç»ƒæ¨¡å‹ã€é’ˆå¯¹ä¸åŒä¸‹æ¸¸ä»»åŠ¡çš„ç»“æœä¸Šéƒ½è¾¾åˆ°æ•Œ<code>Fine-tuning</code> çš„ç»“æœ<br>3ã€åœ¨å¤šå±‚åŠ å…¥äº† <code>Prompts tokens</code> ä½œä¸ºè¾“å…¥ï¼ŒåŠ æ·±å‚æ•°æ•°é‡å’Œæ·±åº¦</10B)ä¸Šè¡¨ç°å·®ï¼Œåœ¨sequence></td><td style="text-align:center"><a href="https://michealxie94.github.io/post/nlp002.html">13.26%</a></td><td style="text-align:left">æ¯ä¸€å±‚</td><td style="text-align:left"><code> è¾“å…¥token </code>ä¹‹å‰</td><td>æœªçŸ¥</td><td><code>Prompt Tuningã€P-Tuning</code></td><td><a href="https://arxiv.org/pdf/2110.07602.pdf">ã€ŠP-Tuning v2: Prompt Tuning Can Be Comparable to Fine-tuning Universally Across Scales and Tasksã€‹</a></td></tr><tr><td style="text-align:left">å¹´ä»½</td><td style="text-align:left">inc</td><td style="text-align:left">method</td><td style="text-align:left">åˆ›æ–°ä¹‹å¤„</td><td style="text-align:center">å‚æ•°</td><td style="text-align:left">å“ªä¸€å±‚</td><td style="text-align:left">ä½ç½®</td><td>åˆå§‹åŒ–æ–¹å¼</td><td>å‰è¾ˆ</td><td>è®ºæ–‡</td></tr><tr><td style="text-align:left">2021</td><td style="text-align:left">å¾®è½¯</td><td style="text-align:left"><code>LoRA</code></td><td style="text-align:left">åœ¨å¤§å‹è¯­è¨€æ¨¡å‹ä¸Šå¯¹æŒ‡å®šå‚æ•°å¢åŠ é¢å¤–çš„<code>ä½ç§©çŸ©é˜µ</code>ï¼Œå¹¶åœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä»…è®­ç»ƒè€Œå¤–å¢åŠ çš„å‚æ•°</td><td style="text-align:center"><a href="https://michealxie94.github.io/post/nlp002.html">0.0586%</a></td><td style="text-align:left"><code>attn key/val</code></td><td style="text-align:left"></td><td></td><td></td><td><a href="https://arxiv.org/pdf/2106.09685.pdf">ã€ŠLoRA: Low-Rank Adaptation of Large Language Modelsã€‹</a></td></tr><tr><td style="text-align:left">å¹´ä»½</td><td style="text-align:left">inc</td><td style="text-align:left">method</td><td style="text-align:left">åˆ›æ–°ä¹‹å¤„</td><td style="text-align:center">å‚æ•°</td><td style="text-align:left">å“ªä¸€å±‚</td><td style="text-align:left">ä½ç½®</td><td>åˆå§‹åŒ–æ–¹å¼</td><td>å‰è¾ˆ</td><td>è®ºæ–‡</td></tr><tr><td style="text-align:left">2023</td><td style="text-align:left">å¾®è½¯</td><td style="text-align:left"><code>AdaLORA</code></td><td style="text-align:left">1ã€èƒŒ æ™¯:é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ä¸­çš„æƒé‡å‚æ•°å¯¹ä¸‹æ¸¸ä»»åŠ¡çš„è´¡çŒ®æ˜¯ä¸åŒçš„ï¼Œéœ€è¦æ›´åŠ <code>æ™ºèƒ½åˆ†é…å‚æ•°</code>é¢„ç®—ï¼Œä»¥åœ¨å¾®è°ƒè¿‡ç¨‹ä¸­æ›´é«˜æ•ˆåœ°æ›´æ–°è´¡çŒ®è¾ƒå¤§çš„å‚æ•°ã€‚<br>2ã€ä¸»è¦è´¡çŒ®:ä½¿ç”¨<code>å¥‡å¼‚å€¼åˆ†è§£å°†æƒé‡çŸ©é˜µåˆ†è§£ä¸ºå¢é‡çŸ©é˜µï¼Œå¹¶æ ¹æ®é‡è¦æ€§åº¦é‡åŠ¨æ€è°ƒæ•´å¢é‡çŸ©é˜µä¸­å¥‡å¼‚å€¼çš„å¤§å°ã€‚</code></td><td style="text-align:center">æœªçŸ¥</td><td style="text-align:left"></td><td style="text-align:left"></td><td></td><td><code>LoRA</code></td><td><a href="https://arxiv.org/pdf/2303.10512.pdf">ã€Šadaptive budget allocation for parameterefficient fine-tuningã€‹</a></td></tr></tbody></table></div><p><font></font></p><h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a><strong>å¼•è¨€</strong></h2><p>æœ€è¿‘ï¼Œæ·±åº¦å­¦ä¹ çš„ç ”ç©¶ä¸­å‡ºç°äº†è®¸å¤šå¤§å‹é¢„è®­ç»ƒæ¨¡å‹ï¼Œä¾‹å¦‚ <code>GPT-3</code>ã€<code>ChatGPT</code>ã€<code>GPT4</code>ã€<code>ChatGLM-130B</code> ç­‰ï¼Œè¿™äº›æ¨¡å‹å¯ä»¥åœ¨å¤šç§è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¸­å–å¾—ä¼˜å¼‚çš„æ€§èƒ½è¡¨ç°ã€‚è€Œå…¶ä¸­ï¼Œ<code>ChatGPT</code> æ¨¡å‹å› ä¸ºåœ¨å¯¹è¯ç”Ÿæˆæ–¹é¢çš„è¡¨ç°è€Œå¤‡å—ç©ç›®ï¼Œæˆä¸ºäº†è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸçš„çƒ­é—¨ç ”ç©¶æ–¹å‘ã€‚</p><p><img src="https://pic4.zhimg.com/v2-44afc37628e890e92c3af5bbe7c77457_b.jpg" alt></p><p>ç„¶è€Œï¼Œè¿™äº›å¤§å‹é¢„è®­ç»ƒæ¨¡å‹çš„è®­ç»ƒæˆæœ¬éå¸¸é«˜æ˜‚ï¼Œéœ€è¦åºå¤§çš„è®¡ç®—èµ„æºå’Œå¤§é‡çš„æ•°æ®ï¼Œä¸€èˆ¬äººéš¾ä»¥æ‰¿å—ã€‚è¿™ä¹Ÿå¯¼è‡´äº†ä¸€äº›ç ”ç©¶äººå‘˜éš¾ä»¥é‡å¤å’ŒéªŒè¯å…ˆå‰çš„ç ”ç©¶æˆæœã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç ”ç©¶äººå‘˜å¼€å§‹ç ”ç©¶ <code>Parameter-Efficient Fine-Tuning (PEFT)</code> æŠ€æœ¯ã€‚<code>PEFT</code> æŠ€æœ¯æ—¨åœ¨<code>é€šè¿‡æœ€å°åŒ–å¾®è°ƒå‚æ•°çš„æ•°é‡å’Œè®¡ç®—å¤æ‚åº¦ï¼Œæ¥æé«˜é¢„è®­ç»ƒæ¨¡å‹åœ¨æ–°ä»»åŠ¡ä¸Šçš„æ€§èƒ½ï¼Œä»è€Œç¼“è§£å¤§å‹é¢„è®­ç»ƒæ¨¡å‹çš„è®­ç»ƒæˆæœ¬</code>ã€‚è¿™æ ·ä¸€æ¥ï¼Œå³ä½¿è®¡ç®—èµ„æºå—é™ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨é¢„è®­ç»ƒæ¨¡å‹çš„çŸ¥è¯†æ¥è¿…é€Ÿé€‚åº”æ–°ä»»åŠ¡ï¼Œå®ç°é«˜æ•ˆçš„è¿ç§»å­¦ä¹ ã€‚å› æ­¤ï¼Œ<code>PEFT</code> æŠ€æœ¯å¯ä»¥åœ¨æé«˜æ¨¡å‹æ•ˆæœçš„åŒæ—¶ï¼Œå¤§å¤§ç¼©çŸ­æ¨¡å‹è®­ç»ƒæ—¶é—´å’Œè®¡ç®—æˆæœ¬ï¼Œè®©æ›´å¤šäººèƒ½å¤Ÿå‚ä¸åˆ°æ·±åº¦å­¦ä¹ ç ”ç©¶ä¸­æ¥ã€‚</p><p><img src="https://pic2.zhimg.com/v2-27bce88b6e16ea8d5dcf266c845e18e1_b.jpg" alt></p><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œä»‹ç»äº† <code>PEFT</code> æŠ€æœ¯ä¸­çš„å¸¸ç”¨æ–¹æ³• <code>LORA</code>ï¼Œä½¿å¾—ç™¾äº¿ï¼ˆ10Bï¼‰å‚æ•°çš„å¤§æ¨¡å‹å¯ä»¥åœ¨å•å¡ä¸Šè®­ç»ƒï¼ˆæ˜¾å­˜å¤§å°&gt;=40Gï¼‰ã€‚</p><p>ä»Šå¤©ä»‹ç»ä¸‹å¦å¤–å‡ ç§å¸¸ç”¨çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ <code>Adapter Tuning</code>ã€<code>Prompt Tuning</code>ã€<code>Prefix Tuning</code>ã€<code>P-Tuning</code>ã€<code>P-Tuning v2</code> å’Œ <code>AdaLORA</code>ã€‚</p><p><img src="https://pic3.zhimg.com/v2-889a9bf357273815ef84a44fd016b7da_b.jpg" alt></p><h2 id="Adapter-Tuning"><a href="#Adapter-Tuning" class="headerlink" title="Adapter Tuning"></a><code>Adapter Tuning</code></h2><p>2019å¹´è°·æ­Œçš„ç ”ç©¶äººå‘˜é¦–æ¬¡åœ¨è®ºæ–‡<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/1902.00751.pdf">ã€ŠParameter-Efficient Transfer Learning for NLPã€‹</a>æå‡ºé’ˆå¯¹ <code>BERT</code> çš„ <code>PEFT</code>å¾®è°ƒæ–¹å¼ï¼Œæ‹‰å¼€äº† <code>PEFT</code> ç ”ç©¶çš„åºå¹•ã€‚ä»–ä»¬æŒ‡å‡ºï¼Œåœ¨é¢å¯¹ç‰¹å®šçš„ä¸‹æ¸¸ä»»åŠ¡æ—¶ï¼Œå¦‚æœè¿›è¡Œ <code>Full-Fintuning</code>ï¼ˆå³é¢„è®­ç»ƒæ¨¡å‹ä¸­çš„æ‰€æœ‰å‚æ•°éƒ½è¿›è¡Œå¾®è°ƒï¼‰ï¼Œå¤ªè¿‡ä½æ•ˆï¼›è€Œå¦‚æœé‡‡ç”¨å›ºå®šé¢„è®­ç»ƒæ¨¡å‹çš„æŸäº›å±‚ï¼Œåªå¾®è°ƒæ¥è¿‘ä¸‹æ¸¸ä»»åŠ¡çš„é‚£å‡ å±‚å‚æ•°ï¼Œåˆéš¾ä»¥è¾¾åˆ°è¾ƒå¥½çš„æ•ˆæœã€‚</p><p>äºæ˜¯ä»–ä»¬è®¾è®¡äº†å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ <code>Adapter ç»“æ„</code>ï¼Œå°†å…¶åµŒå…¥ <code>Transformer</code> çš„ç»“æ„é‡Œé¢ï¼Œåœ¨è®­ç»ƒæ—¶ï¼Œå›ºå®šä½åŸæ¥é¢„è®­ç»ƒæ¨¡å‹çš„å‚æ•°ä¸å˜ï¼Œåªå¯¹æ–°å¢çš„<code>Adapter</code>ç»“æ„è¿›è¡Œå¾®è°ƒã€‚åŒæ—¶ä¸ºäº†ä¿è¯è®­ç»ƒçš„é«˜æ•ˆæ€§ï¼ˆä¹Ÿå°±æ˜¯å°½å¯èƒ½å°‘çš„å¼•å…¥æ›´å¤šå‚æ•°ï¼‰ï¼Œä»–ä»¬å°†<code>Adapter</code>è®¾è®¡ä¸ºè¿™æ ·çš„ç»“æ„ï¼š</p><ul><li>é¦–å…ˆæ˜¯ä¸€ä¸ª<code> down-project</code> å±‚å°†é«˜ç»´åº¦ç‰¹å¾æ˜ å°„åˆ°ä½ç»´ç‰¹å¾</li><li>ç„¶åè¿‡ä¸€ä¸ªéçº¿å½¢å±‚ä¹‹åï¼Œå†ç”¨ä¸€ä¸ª <code> up-project</code> ç»“æ„å°†ä½ç»´ç‰¹å¾æ˜ å°„å›åŸæ¥çš„é«˜ç»´ç‰¹å¾</li><li>åŒæ—¶ä¹Ÿè®¾è®¡äº† <code> skip-connection </code> ç»“æ„ï¼Œç¡®ä¿äº†åœ¨æœ€å·®çš„æƒ…å†µä¸‹èƒ½å¤Ÿé€€åŒ–ä¸º<code>identity</code>ï¼ˆç±»ä¼¼æ®‹å·®ç»“æ„ï¼‰ã€‚</li></ul><p><img src="https://pic1.zhimg.com/v2-7c0aed5ceccdbc33ed50750bcea36778_b.jpg" alt></p><p>ä»å®éªŒç»“æœæ¥çœ‹ï¼Œè¯¥æ–¹æ³•èƒ½å¤Ÿåœ¨åªé¢å¤–å¯¹å¢åŠ çš„ 3.6% å‚æ•°è§„æ¨¡ï¼ˆç›¸æ¯”åŸæ¥é¢„è®­ç»ƒæ¨¡å‹çš„å‚æ•°é‡ï¼‰çš„æƒ…å†µä¸‹å–å¾—å’Œ<code>Full-Finetuning</code> æ¥è¿‘çš„æ•ˆæœï¼ˆGLUEæŒ‡æ ‡åœ¨0.4%ä»¥å†…ï¼‰ã€‚</p><p><img src="https://pic3.zhimg.com/v2-eddc8bfc2c06bb396708eced10db9246_b.jpg" alt></p><h2 id="Prefix-Tuning"><a href="#Prefix-Tuning" class="headerlink" title="Prefix Tuning"></a><code>Prefix Tuning</code></h2><p>2021å¹´æ–¯å¦ç¦çš„ç ”ç©¶äººå‘˜åœ¨è®ºæ–‡ã€Š<a href="https://link.zhihu.com/?target=https%3A//aclanthology.org/2021.acl-long.353.pdf">Prefix-Tuning: Optimizing Continuous Prompts for Generation</a>ã€‹ä¸­æå‡ºäº† <code>Prefix Tuning</code> æ–¹æ³•ã€‚ä¸<code>Full-Finetuning</code> æ›´æ–°æ‰€æœ‰å‚æ•°çš„æ–¹å¼ä¸åŒï¼Œè¯¥æ–¹æ³•æ˜¯åœ¨<code> è¾“å…¥token </code>ä¹‹å‰æ„é€ ä¸€æ®µä»»åŠ¡ç›¸å…³çš„<code> virtual tokens </code>ä½œä¸º<code> Prefix </code>ï¼Œç„¶åè®­ç»ƒçš„æ—¶å€™åªæ›´æ–°<code> Prefix </code> éƒ¨åˆ†çš„å‚æ•°ï¼Œè€Œ <code>Transformer</code> ä¸­çš„å…¶ä»–éƒ¨åˆ†å‚æ•°å›ºå®šã€‚è¯¥æ–¹æ³•å…¶å®å’Œæ„é€  <code>Prompt</code> ç±»ä¼¼ï¼Œåªæ˜¯ <code>Prompt</code> æ˜¯äººä¸ºæ„é€ çš„â€œæ˜¾å¼â€çš„æç¤ºï¼Œå¹¶ä¸”æ— æ³•æ›´æ–°å‚æ•°ï¼Œè€Œ <code>Prefix</code> åˆ™æ˜¯å¯ä»¥å­¦ä¹ çš„â€œéšå¼â€çš„æç¤ºã€‚</p><p><img src="https://pic3.zhimg.com/v2-1732a1f9faa50fdae99d3fb12cb41392_b.jpg" alt></p><p>åŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢ç›´æ¥æ›´æ–°<code> Prefix </code> çš„å‚æ•°å¯¼è‡´è®­ç»ƒä¸ç¨³å®šçš„æƒ…å†µï¼Œä»–ä»¬åœ¨<code> Prefix </code> å±‚å‰é¢åŠ äº†<code> MLP </code>ç»“æ„(ç›¸å½“äºå°†<code> Prefix </code> åˆ†è§£ä¸ºæ›´å°ç»´åº¦çš„<code> Input</code>ä¸<code> MLP </code>çš„ç»„åˆåè¾“å‡ºçš„ç»“æœ)ï¼Œè®­ç»ƒå®Œæˆåï¼Œåªä¿ç•™<code> Prefix </code> çš„å‚æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">embedding = torch.nn.Embedding(num_virtual_tokens, token_dim)</span><br><span class="line">transform = torch.nn.Sequential(</span><br><span class="line">    torch.nn.Linear(token_dim, encoder_hidden_size),</span><br><span class="line">    torch.nn.Tanh(),</span><br><span class="line">    torch.nn.Linear(encoder_hidden_size, num_layers * <span class="number">2</span> * token_dim),</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="Prompt-Tuning"><a href="#Prompt-Tuning" class="headerlink" title="Prompt Tuning"></a><code>Prompt Tuning</code></h2><p><code>Prompt Tuning</code> æ˜¯2021å¹´è°·æ­Œåœ¨è®ºæ–‡ã€Š<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2104.08691.pdf">The Power of Scale for Parameter-Efficient Prompt Tuning</a>ã€‹ä¸­æå‡ºçš„å¾®è°ƒæ–¹æ³•ã€‚</p><p>è¯¥æ–¹æ³•å¯ä»¥çœ‹ä½œæ˜¯ <code>Prefix Tuning</code> çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œåªåœ¨è¾“å…¥å±‚åŠ å…¥ <code>prompt tokens</code>ï¼Œå¹¶ä¸éœ€è¦åŠ å…¥<code> MLP </code>è¿›è¡Œè°ƒæ•´æ¥è§£å†³éš¾è®­ç»ƒçš„é—®é¢˜ï¼Œä¸»è¦åœ¨ <code>T5</code> é¢„è®­ç»ƒæ¨¡å‹ä¸Šåšå®éªŒã€‚ä¼¼ä¹åªè¦é¢„è®­ç»ƒæ¨¡å‹è¶³å¤Ÿå¼ºå¤§ï¼Œå…¶ä»–çš„ä¸€åˆ‡éƒ½ä¸æ˜¯é—®é¢˜ã€‚ä½œè€…ä¹Ÿåšå®éªŒè¯´æ˜éšç€é¢„è®­ç»ƒæ¨¡å‹å‚æ•°é‡çš„å¢åŠ ï¼Œ<code>Prompt Tuning</code>çš„æ–¹æ³•ä¼šé€¼è¿‘ <code>Fine-tune<code> çš„ç»“æœã€‚</code></code></p><p>å›ºå®šé¢„è®­ç»ƒå‚æ•°ï¼Œä¸ºæ¯ä¸€ä¸ªä»»åŠ¡é¢å¤–æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ª<code>embedding</code>ï¼Œä¹‹åæ‹¼æ¥ <code>query</code> æ­£å¸¸è¾“å…¥ <code>LLM</code>ï¼Œå¹¶åªè®­ç»ƒè¿™äº› <code>embedding</code>ã€‚å·¦å›¾ä¸ºå•ä»»åŠ¡å…¨å‚æ•°å¾®è°ƒï¼Œå³å›¾ä¸º <code>Prompt Tuning</code>ã€‚</p><p><img src="https://pic2.zhimg.com/v2-4b9fe13839b33e75bed82dbf4d948329_b.jpg" alt></p><p><img src="https://pic1.zhimg.com/v2-980bbb55d986f1b0df2c5aae8b515e2c_b.jpg" alt></p><p>ä½œè€…åšäº†ä¸€ç³»åˆ—å¯¹æ¯”å®éªŒï¼Œéƒ½åœ¨è¯´æ˜ï¼šéšç€é¢„è®­ç»ƒæ¨¡å‹å‚æ•°çš„å¢åŠ ï¼Œä¸€åˆ‡çš„é—®é¢˜éƒ½ä¸æ˜¯é—®é¢˜ï¼Œæœ€ç®€å•çš„è®¾ç½®ä¹Ÿèƒ½è¾¾åˆ°æå¥½çš„æ•ˆæœã€‚</p><ul><li><code>Prompt</code> é•¿åº¦å½±å“ï¼šæ¨¡å‹å‚æ•°è¾¾åˆ°ä¸€å®šé‡çº§æ—¶ï¼Œ<code>Prompt</code> é•¿åº¦ä¸º1ä¹Ÿèƒ½è¾¾åˆ°ä¸é”™çš„æ•ˆæœï¼Œ<code>Prompt</code> é•¿åº¦ä¸º20å°±èƒ½è¾¾åˆ°æå¥½æ•ˆæœã€‚</li><li><code>Prompt</code>åˆå§‹åŒ–æ–¹å¼å½±å“ï¼š<code>Random Uniform</code> æ–¹å¼æ˜æ˜¾å¼±äºå…¶ä»–ä¸¤ç§ï¼Œä½†æ˜¯å½“æ¨¡å‹å‚æ•°è¾¾åˆ°ä¸€å®šé‡çº§ï¼Œè¿™ç§å·®å¼‚ä¹Ÿä¸å¤å­˜åœ¨ã€‚</li><li>é¢„è®­ç»ƒçš„æ–¹å¼ï¼š<code>LM Adaptation</code> çš„æ–¹å¼æ•ˆæœå¥½ï¼Œä½†æ˜¯å½“æ¨¡å‹è¾¾åˆ°ä¸€å®šè§„æ¨¡ï¼Œå·®å¼‚åˆå‡ ä¹æ²¡æœ‰äº†ã€‚</li><li>å¾®è°ƒæ­¥æ•°å½±å“ï¼šæ¨¡å‹å‚æ•°è¾ƒå°æ—¶ï¼Œæ­¥æ•°è¶Šå¤šï¼Œæ•ˆæœè¶Šå¥½ã€‚åŒæ ·éšç€æ¨¡å‹å‚æ•°è¾¾åˆ°ä¸€å®šè§„æ¨¡ï¼Œ<code>zero shot</code> ä¹Ÿèƒ½å–å¾—ä¸é”™æ•ˆæœã€‚</li><li>å½“å‚æ•°è¾¾åˆ°100äº¿è§„æ¨¡ä¸å…¨å‚æ•°å¾®è°ƒæ–¹å¼æ•ˆæœæ— å¼‚ã€‚</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PEFT <span class="keyword">import</span> PromptTuningConfig, get_PEFT_model</span><br><span class="line">PEFT_config = PromptTuningConfig(task_type=<span class="string">&quot;SEQ_CLS&quot;</span>, num_virtual_tokens=<span class="number">10</span>)</span><br><span class="line">model = AutoModelForCausalLM.from_pretrained(model_name_or_path, return_dict=<span class="literal">True</span>)</span><br><span class="line">model = get_PEFT_model(model, PEFT_config)</span><br></pre></td></tr></table></figure><h2 id="P-Tuning-v1"><a href="#P-Tuning-v1" class="headerlink" title="P-Tuning v1"></a><code>P-Tuning v1</code></h2><p><img src="https://pic1.zhimg.com/v2-fe3c213a4207c54d151af2f74838c6a0_b.jpg" alt></p><p><code>P-Tuning</code> æ–¹æ³•çš„æå‡ºä¸»è¦æ˜¯ä¸ºäº†è§£å†³è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šå¤§æ¨¡å‹çš„ Prompt æ„é€ æ–¹å¼ä¸¥é‡å½±å“ä¸‹æ¸¸ä»»åŠ¡çš„æ•ˆæœã€‚</p><p><img src="https://pic1.zhimg.com/v2-6e6e65e58fff50d38df4bb49bd3dc288_b.jpg" alt></p><p><code>P-Tuning</code> æå‡ºå°† <code>Prompt</code> è½¬æ¢ä¸ºå¯ä»¥å­¦ä¹ çš„ <code>Embedding</code> å±‚ï¼Œåªæ˜¯è€ƒè™‘åˆ°ç›´æ¥å¯¹ <code>Embedding</code> å‚æ•°è¿›è¡Œä¼˜åŒ–ä¼šå­˜åœ¨è¿™æ ·ä¸¤ä¸ªæŒ‘æˆ˜ï¼š</p><ul><li><code>Discretenes</code>ï¼š å¯¹è¾“å…¥æ­£å¸¸è¯­æ–™çš„ <code>Embedding</code> å±‚å·²ç»ç»è¿‡é¢„è®­ç»ƒï¼Œè€Œå¦‚æœç›´æ¥å¯¹è¾“å…¥çš„ <code>prompt embedding</code>è¿›è¡Œéšæœºåˆå§‹åŒ–è®­ç»ƒï¼Œå®¹æ˜“é™·å…¥å±€éƒ¨æœ€ä¼˜ã€‚</li><li><code>Association</code>ï¼šæ²¡æ³•æ•æ‰åˆ° <code>prompt embedding</code> ä¹‹é—´çš„ç›¸å…³å…³ç³»ã€‚</li></ul><p>ä½œè€…åœ¨è¿™é‡Œæå‡ºç”¨<code> MLP + LSTM</code> çš„æ–¹å¼æ¥å¯¹ <code>prompt embedding</code> è¿›è¡Œä¸€å±‚å¤„ç†ï¼š</p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -3.619ex;" xmlns="http://www.w3.org/2000/svg" width="39.585ex" height="8.369ex" role="img" focusable="false" viewbox="0 -2099.5 17496.5 3699" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-I-210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"/><path id="MJX-1-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"/><path id="MJX-1-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/><path id="MJX-1-TEX-N-4D" d="M132 622Q125 629 121 631T105 634T62 637H29V683H135Q221 683 232 682T249 675Q250 674 354 398L458 124L562 398Q666 674 668 675Q671 681 683 682T781 683H887V637H854Q814 636 803 634T785 622V61Q791 51 802 49T854 46H887V0H876Q855 3 736 3Q605 3 596 0H585V46H618Q660 47 669 49T688 61V347Q688 424 688 461T688 546T688 613L687 632Q454 14 450 7Q446 1 430 1T410 7Q409 9 292 316L176 624V606Q175 588 175 543T175 463T175 356L176 86Q187 50 261 46H278V0H269Q254 3 154 3Q52 3 37 0H29V46H46Q78 48 98 56T122 69T132 86V622Z"/><path id="MJX-1-TEX-N-4C" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q48 680 182 680Q324 680 348 683H360V637H333Q273 637 258 635T233 622L232 342V129Q232 57 237 52Q243 47 313 47Q384 47 410 53Q470 70 498 110T536 221Q536 226 537 238T540 261T542 272T562 273H582V268Q580 265 568 137T554 5V0H25V46H58Q100 47 109 49T128 61V622Z"/><path id="MJX-1-TEX-N-50" d="M130 622Q123 629 119 631T103 634T60 637H27V683H214Q237 683 276 683T331 684Q419 684 471 671T567 616Q624 563 624 489Q624 421 573 372T451 307Q429 302 328 301H234V181Q234 62 237 58Q245 47 304 46H337V0H326Q305 3 182 3Q47 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM507 488Q507 514 506 528T500 564T483 597T450 620T397 635Q385 637 307 637H286Q237 637 234 628Q231 624 231 483V342H302H339Q390 342 423 349T481 382Q507 411 507 488Z"/><path id="MJX-1-TEX-S3-28" d="M701 -940Q701 -943 695 -949H664Q662 -947 636 -922T591 -879T537 -818T475 -737T412 -636T350 -511T295 -362T250 -186T221 17T209 251Q209 962 573 1361Q596 1386 616 1405T649 1437T664 1450H695Q701 1444 701 1441Q701 1436 681 1415T629 1356T557 1261T476 1118T400 927T340 675T308 359Q306 321 306 250Q306 -139 400 -430T690 -924Q701 -936 701 -940Z"/><path id="MJX-1-TEX-S3-5B" d="M247 -949V1450H516V1388H309V-887H516V-949H247Z"/><path id="MJX-1-TEX-N-20D7" d="M377 694Q377 702 382 708T397 714Q404 714 409 709Q414 705 419 690Q429 653 460 633Q471 626 471 615Q471 606 468 603T454 594Q411 572 379 531Q377 529 374 525T369 519T364 517T357 516Q350 516 344 521T337 536Q337 555 384 595H213L42 596Q29 605 29 615Q29 622 42 635H401Q377 673 377 694Z"/><path id="MJX-1-TEX-N-3A" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"/><path id="MJX-1-TEX-N-2190" d="M944 261T944 250T929 230H165Q167 228 182 216T211 189T244 152T277 96T303 25Q308 7 308 0Q308 -11 288 -11Q281 -11 278 -11T272 -7T267 2T263 21Q245 94 195 151T73 236Q58 242 55 247Q55 254 59 257T73 264Q121 283 158 314T215 375T247 434T264 480L267 497Q269 503 270 505T275 509T288 511Q308 511 308 500Q308 493 303 475Q293 438 278 406T246 352T215 315T185 287T165 270H929Q944 261 944 250Z"/><path id="MJX-1-TEX-S3-5D" d="M11 1388V1450H280V-949H11V-887H218V1388H11Z"/><path id="MJX-1-TEX-S3-29" d="M34 1438Q34 1446 37 1448T50 1450H56H71Q73 1448 99 1423T144 1380T198 1319T260 1238T323 1137T385 1013T440 864T485 688T514 485T526 251Q526 134 519 53Q472 -519 162 -860Q139 -885 119 -904T86 -936T71 -949H56Q43 -949 39 -947T34 -937Q88 -883 140 -813Q428 -430 428 251Q428 453 402 628T338 922T245 1146T145 1309T46 1425Q44 1427 42 1429T39 1433T36 1436L34 1438Z"/><path id="MJX-1-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/><path id="MJX-1-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"/><path id="MJX-1-TEX-N-53" d="M55 507Q55 590 112 647T243 704H257Q342 704 405 641L426 672Q431 679 436 687T446 700L449 704Q450 704 453 704T459 705H463Q466 705 472 699V462L466 456H448Q437 456 435 459T430 479Q413 605 329 646Q292 662 254 662Q201 662 168 626T135 542Q135 508 152 480T200 435Q210 431 286 412T370 389Q427 367 463 314T500 191Q500 110 448 45T301 -21Q245 -21 201 -4T140 27L122 41Q118 36 107 21T87 -7T78 -21Q76 -22 68 -22H64Q61 -22 55 -16V101Q55 220 56 222Q58 227 76 227H89Q95 221 95 214Q95 182 105 151T139 90T205 42T305 24Q352 24 386 62T420 155Q420 198 398 233T340 281Q284 295 266 300Q261 301 239 306T206 314T174 325T141 343T112 367T85 402Q55 451 55 507Z"/><path id="MJX-1-TEX-N-54" d="M36 443Q37 448 46 558T55 671V677H666V671Q667 666 676 556T685 443V437H645V443Q645 445 642 478T631 544T610 593Q593 614 555 625Q534 630 478 630H451H443Q417 630 414 618Q413 616 413 339V63Q420 53 439 50T528 46H558V0H545L361 3Q186 1 177 0H164V46H194Q264 46 283 49T309 63V339V550Q309 620 304 625T271 630H244H224Q154 630 119 601Q101 585 93 554T81 486T76 443V437H36V443Z"/><path id="MJX-1-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"/><path id="MJX-1-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/><path id="MJX-1-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/><path id="MJX-1-TEX-N-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mtable"><g data-mml-node="mtr" transform="translate(0,650)"><g data-mml-node="mtd"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="210E" xlink:href="#MJX-1-TEX-I-210E"/></g><g data-mml-node="mi" transform="translate(609,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-1-TEX-I-1D456"/></g></g></g><g data-mml-node="mtd" transform="translate(903,0)"><g data-mml-node="mi"/><g data-mml-node="mo" transform="translate(277.8,0)"><use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"/></g><g data-mml-node="mtext" transform="translate(1333.6,0)"><use data-c="4D" xlink:href="#MJX-1-TEX-N-4D"/><use data-c="4C" xlink:href="#MJX-1-TEX-N-4C" transform="translate(917,0)"/><use data-c="50" xlink:href="#MJX-1-TEX-N-50" transform="translate(1542,0)"/></g><g data-mml-node="mrow" transform="translate(3723.2,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><use data-c="28" xlink:href="#MJX-1-TEX-S3-28"/></g><g data-mml-node="mrow" transform="translate(736,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><use data-c="5B" xlink:href="#MJX-1-TEX-S3-5B"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(528,0)"><g data-mml-node="mover"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="210E" xlink:href="#MJX-1-TEX-I-210E"/></g><g data-mml-node="mi" transform="translate(609,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-1-TEX-I-1D456"/></g></g><g data-mml-node="mo" transform="translate(451.5,283) translate(-250 0)"><use data-c="20D7" xlink:href="#MJX-1-TEX-N-20D7"/></g></g></g><g data-mml-node="mo" transform="translate(1708.7,0)"><use data-c="3A" xlink:href="#MJX-1-TEX-N-3A"/></g><g data-mml-node="mover" transform="translate(2264.5,0)"><g data-mml-node="msub" transform="translate(48.5,0)"><g data-mml-node="mi"><use data-c="210E" xlink:href="#MJX-1-TEX-I-210E"/></g><g data-mml-node="mi" transform="translate(609,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-1-TEX-I-1D456"/></g></g><g data-mml-node="mo" transform="translate(0,810)"><use data-c="2190" xlink:href="#MJX-1-TEX-N-2190"/></g></g><g data-mml-node="mo" transform="translate(3264.5,0) translate(0 -0.5)"><use data-c="5D" xlink:href="#MJX-1-TEX-S3-5D"/></g></g><g data-mml-node="mo" transform="translate(4528.5,0) translate(0 -0.5)"><use data-c="29" xlink:href="#MJX-1-TEX-S3-29"/></g></g></g></g><g data-mml-node="mtr" transform="translate(0,-1349.5)"><g data-mml-node="mtd" transform="translate(903,0)"/><g data-mml-node="mtd" transform="translate(903,0)"><g data-mml-node="mi"/><g data-mml-node="mo" transform="translate(277.8,0)"><use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"/></g><g data-mml-node="mtext" transform="translate(1333.6,0)"><use data-c="4D" xlink:href="#MJX-1-TEX-N-4D"/><use data-c="4C" xlink:href="#MJX-1-TEX-N-4C" transform="translate(917,0)"/><use data-c="50" xlink:href="#MJX-1-TEX-N-50" transform="translate(1542,0)"/></g><g data-mml-node="mrow" transform="translate(3723.2,0)"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-1-TEX-N-28"/></g><g data-mml-node="mrow" transform="translate(389,0)"><g data-mml-node="mo"><use data-c="5B" xlink:href="#MJX-1-TEX-N-5B"/></g><g data-mml-node="mtext" transform="translate(278,0)"><use data-c="4C" xlink:href="#MJX-1-TEX-N-4C"/><use data-c="53" xlink:href="#MJX-1-TEX-N-53" transform="translate(625,0)"/><use data-c="54" xlink:href="#MJX-1-TEX-N-54" transform="translate(1181,0)"/><use data-c="4D" xlink:href="#MJX-1-TEX-N-4D" transform="translate(1903,0)"/></g><g data-mml-node="mrow" transform="translate(3264.7,0)"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-1-TEX-N-28"/></g><g data-mml-node="msub" transform="translate(389,0)"><g data-mml-node="mi"><use data-c="210E" xlink:href="#MJX-1-TEX-I-210E"/></g><g data-mml-node="TeXAtom" transform="translate(609,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="30" xlink:href="#MJX-1-TEX-N-30"/></g><g data-mml-node="mo" transform="translate(500,0)"><use data-c="3A" xlink:href="#MJX-1-TEX-N-3A"/></g><g data-mml-node="mi" transform="translate(778,0)"><use data-c="1D456" xlink:href="#MJX-1-TEX-I-1D456"/></g></g></g><g data-mml-node="mo" transform="translate(1842.1,0)"><use data-c="29" xlink:href="#MJX-1-TEX-N-29"/></g></g><g data-mml-node="mo" transform="translate(5773.5,0)"><use data-c="3A" xlink:href="#MJX-1-TEX-N-3A"/></g><g data-mml-node="mtext" transform="translate(6329.3,0)"><use data-c="4C" xlink:href="#MJX-1-TEX-N-4C"/><use data-c="53" xlink:href="#MJX-1-TEX-N-53" transform="translate(625,0)"/><use data-c="54" xlink:href="#MJX-1-TEX-N-54" transform="translate(1181,0)"/><use data-c="4D" xlink:href="#MJX-1-TEX-N-4D" transform="translate(1903,0)"/></g><g data-mml-node="mrow" transform="translate(9316,0)"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-1-TEX-N-28"/></g><g data-mml-node="msub" transform="translate(389,0)"><g data-mml-node="mi"><use data-c="210E" xlink:href="#MJX-1-TEX-I-210E"/></g><g data-mml-node="TeXAtom" transform="translate(609,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-1-TEX-I-1D456"/></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="3A" xlink:href="#MJX-1-TEX-N-3A"/></g><g data-mml-node="mi" transform="translate(623,0)"><use data-c="1D45A" xlink:href="#MJX-1-TEX-I-1D45A"/></g></g></g><g data-mml-node="mo" transform="translate(2109.4,0)"><use data-c="29" xlink:href="#MJX-1-TEX-N-29"/></g></g><g data-mml-node="mo" transform="translate(11814.3,0)"><use data-c="5D" xlink:href="#MJX-1-TEX-N-5D"/></g></g><g data-mml-node="mo" transform="translate(12481.3,0)"><use data-c="29" xlink:href="#MJX-1-TEX-N-29"/></g></g></g></g></g></g></g></g></svg></mjx-container><p> <code>P-Tuning</code> ä¾ç„¶æ˜¯å›ºå®š <code>LLM&lt;ã€code&gt; å‚æ•°ï¼Œåˆ©ç”¨<code>MLP+LSTM</code> å¯¹ <code>Prompt</code> è¿›è¡Œç¼–ç ï¼Œç¼–ç ä¹‹åä¸å…¶ä»–å‘é‡è¿›è¡Œæ‹¼æ¥ä¹‹åæ­£å¸¸è¾“å…¥ <code>LLM</code>ã€‚æ³¨æ„ï¼Œè®­ç»ƒä¹‹ååªä¿ç•™ <code>Prompt</code> ç¼–ç ä¹‹åçš„å‘é‡å³å¯ï¼Œæ— éœ€ä¿ç•™ç¼–ç å™¨ã€‚</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">self.lstm_head = torch.nn.LSTM(</span><br><span class="line">                    input_size=self.input_size,</span><br><span class="line">                    hidden_size=self.hidden_size,</span><br><span class="line">                    num_layers=num_layers,</span><br><span class="line">                    dropout=lstm_dropout,</span><br><span class="line">                    bidirectional=<span class="literal">True</span>,</span><br><span class="line">                    batch_first=<span class="literal">True</span>,</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">self.mlp_head = torch.nn.Sequential(</span><br><span class="line">    torch.nn.Linear(self.hidden_size * <span class="number">2</span>, self.hidden_size * <span class="number">2</span>),</span><br><span class="line">    torch.nn.ReLU(),</span><br><span class="line">    torch.nn.Linear(self.hidden_size * <span class="number">2</span>, self.output_size),</span><br><span class="line">)</span><br><span class="line">self.mlp_head(self.lstm_head(input_embeds)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><h3 id="ä¸Prefix-Tuningçš„åŒºåˆ«"><a href="#ä¸Prefix-Tuningçš„åŒºåˆ«" class="headerlink" title="ä¸Prefix-Tuningçš„åŒºåˆ«"></a><code>ä¸Prefix-Tuningçš„åŒºåˆ«</code></h3><p><code>P-Tuning</code> å’Œ<code> Prefix Tuning</code> å·®ä¸å¤šåŒæ—¶æå‡ºï¼Œåšæ³•å…¶å®ä¹Ÿæœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œä¸»è¦åŒºåˆ«åœ¨ï¼š</p><ul><li><code>Prefix Tuning</code> æ˜¯å°†é¢å¤–çš„ <code>embedding</code> åŠ åœ¨å¼€å¤´ï¼Œçœ‹èµ·æ¥æ›´åƒæ˜¯æ¨¡ä»¿ <code>Instruction</code> æŒ‡ä»¤ï¼›è€Œ <code>P-Tuning</code> çš„ä½ç½®åˆ™ä¸å›ºå®šã€‚</li><li><code>Prefix Tuning</code> é€šè¿‡åœ¨æ¯ä¸ª <code>Attention</code> å±‚éƒ½åŠ å…¥<code> Prefix Embedding</code>  æ¥å¢åŠ é¢å¤–çš„å‚æ•°ï¼Œé€šè¿‡<code> MLP </code>æ¥åˆå§‹åŒ–ï¼›è€Œ <code>P-Tuning</code> åªæ˜¯åœ¨è¾“å…¥çš„æ—¶å€™åŠ å…¥ <code>Embedding</code>ï¼Œå¹¶é€šè¿‡ <code>LSTM+MLP</code>æ¥åˆå§‹åŒ–ã€‚</li></ul><h2 id="P-Tuning-v2"><a href="#P-Tuning-v2" class="headerlink" title="P-Tuning v2"></a><code>P-Tuning v2</code></h2><p><code>P-Tuning</code> çš„é—®é¢˜æ˜¯åœ¨å°å‚æ•°é‡æ¨¡å‹ä¸Šè¡¨ç°å·®ï¼ˆå¦‚ä¸Šå›¾æ‰€ç¤ºï¼‰ã€‚</p><p><img src="https://pic3.zhimg.com/v2-9e401a134f408434b5d03404d552e786_b.jpg" alt></p><p>äºæ˜¯å°±æœ‰äº†v2ç‰ˆæœ¬ï¼šã€Š<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2110.07602.pdf">P-Tuning v2: Prompt Tuning Can Be Comparable to Fine-tuning Universally Across Scales and Tasks</a>ã€‹ã€‚</p><p>ä»æ ‡é¢˜å°±å¯ä»¥çœ‹å‡ºï¼Œ<code>P-Tuning v2</code> çš„ç›®æ ‡å°±æ˜¯è¦è®© <code>Prompt Tuning</code> èƒ½å¤Ÿåœ¨ä¸åŒå‚æ•°è§„æ¨¡çš„é¢„è®­ç»ƒæ¨¡å‹ã€é’ˆå¯¹ä¸åŒä¸‹æ¸¸ä»»åŠ¡çš„ç»“æœä¸Šéƒ½è¾¾åˆ°åŒ¹æ•Œ<code>Fine-tuning</code> çš„ç»“æœã€‚</p><p>é‚£ä¹Ÿå°±æ˜¯è¯´å½“å‰ <code>Prompt Tuning</code> æ–¹æ³•åœ¨è¿™ä¸¤ä¸ªæ–¹é¢éƒ½å­˜åœ¨å±€é™æ€§ã€‚</p><ul><li>ä¸åŒæ¨¡å‹è§„æ¨¡ï¼š<code>Prompt Tuning</code> å’Œ <code>P-Tuning</code> è¿™ä¸¤ç§æ–¹æ³•éƒ½æ˜¯åœ¨é¢„è®­ç»ƒæ¨¡å‹å‚æ•°è§„æ¨¡å¤Ÿè¶³å¤Ÿå¤§æ—¶ï¼Œæ‰èƒ½è¾¾åˆ°å’ŒFine-tuning ç±»ä¼¼çš„æ•ˆæœï¼Œè€Œå‚æ•°è§„æ¨¡è¾ƒå°æ—¶æ•ˆæœåˆ™å¾ˆå·®ã€‚</li><li>ä¸åŒä»»åŠ¡ç±»å‹ï¼š<code>Prompt Tuning</code> å’Œ <code>P-Tuning</code> è¿™ä¸¤ç§æ–¹æ³•åœ¨<code>sequence tagging</code>ä»»åŠ¡ä¸Šè¡¨ç°éƒ½å¾ˆå·®ã€‚</li></ul><h3 id="ä¸»è¦ç»“æ„"><a href="#ä¸»è¦ç»“æ„" class="headerlink" title="ä¸»è¦ç»“æ„"></a>ä¸»è¦ç»“æ„</h3><p>ç›¸æ¯” <code>Prompt Tuning</code> å’Œ <code>P-Tuning</code> çš„æ–¹æ³•ï¼Œ <code>P-Tuning v2</code> æ–¹æ³•åœ¨å¤šå±‚åŠ å…¥äº† <code>Prompts tokens</code> ä½œä¸ºè¾“å…¥ï¼Œå¸¦æ¥ä¸¤ä¸ªæ–¹é¢çš„å¥½å¤„ï¼š</p><ol><li>å¸¦æ¥æ›´å¤šå¯å­¦ä¹ çš„å‚æ•°ï¼ˆä» <code>P-Tuning</code> å’Œ <code>Prompt Tuning</code> çš„0.1%å¢åŠ åˆ°0.1%-3%ï¼‰ï¼ŒåŒæ—¶ä¹Ÿè¶³å¤Ÿ <code>parameter-efficient</code>ã€‚</li><li>åŠ å…¥åˆ°æ›´æ·±å±‚ç»“æ„ä¸­çš„ <code>Prompt</code> èƒ½ç»™æ¨¡å‹é¢„æµ‹å¸¦æ¥æ›´ç›´æ¥çš„å½±å“ã€‚</li></ol><p>v1 åˆ° v2 çš„å¯è§†åŒ–ï¼šè“è‰²éƒ¨åˆ†ä¸ºå‚æ•°å†»ç»“ï¼Œæ©™è‰²éƒ¨åˆ†ä¸ºå¯è®­ç»ƒéƒ¨åˆ†ã€‚</p><p><img src="https://pic3.zhimg.com/v2-c249aa0962e2eba1b6499a69559bd27e_b.jpg" alt></p><h3 id="å‡ ä¸ªå…³é”®è®¾è®¡å› ç´ "><a href="#å‡ ä¸ªå…³é”®è®¾è®¡å› ç´ " class="headerlink" title="å‡ ä¸ªå…³é”®è®¾è®¡å› ç´ "></a>å‡ ä¸ªå…³é”®è®¾è®¡å› ç´ </h3><ul><li><strong>Reparameterization</strong>ï¼š<code>Prefix Tuning</code> å’Œ <code>P-Tuning</code> ä¸­éƒ½æœ‰<code> MLP </code>æ¥æ„é€ å¯è®­ç»ƒçš„ embeddingã€‚æœ¬æ–‡å‘ç°åœ¨è‡ªç„¶è¯­è¨€ç†è§£é¢†åŸŸï¼Œé¢å¯¹ä¸åŒçš„ä»»åŠ¡ä»¥åŠä¸åŒçš„æ•°æ®é›†ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½å¸¦æ¥å®Œå…¨ç›¸åçš„ç»“è®ºã€‚</li><li><strong>Prompt Lengthï¼š</strong> ä¸åŒçš„ä»»åŠ¡å¯¹åº”çš„æœ€åˆé€‚çš„ Prompt Length ä¸ä¸€æ ·ï¼Œæ¯”å¦‚ç®€å•åˆ†ç±»ä»»åŠ¡ä¸‹ length=20 æœ€å¥½ï¼Œè€Œå¤æ‚çš„ä»»åŠ¡éœ€è¦æ›´é•¿çš„ Prompt Lengthã€‚</li><li><strong>Multi-task Learning</strong> å¤šä»»åŠ¡å¯¹äº <code>P-Tuning v2</code> æ˜¯å¯é€‰çš„ï¼Œä½†å¯ä»¥åˆ©ç”¨å®ƒæä¾›æ›´å¥½çš„åˆå§‹åŒ–æ¥è¿›ä¸€æ­¥æé«˜æ€§èƒ½ã€‚</li><li><strong>Classification Head</strong> ä½¿ç”¨ LM head æ¥é¢„æµ‹åŠ¨è¯æ˜¯ <code>Prompt Tuning</code> çš„æ ¸å¿ƒï¼Œä½†æˆ‘ä»¬å‘ç°åœ¨å®Œæ•´çš„æ•°æ®è®¾ç½®ä¸­æ²¡æœ‰å¿…è¦è¿™æ ·åšï¼Œå¹¶ä¸”è¿™æ ·åšä¸åºåˆ—æ ‡è®°ä¸å…¼å®¹ã€‚<code><code>P-Tuning</code> v2&lt;/code&gt; é‡‡ç”¨å’Œ <code>BERT</code> ä¸€æ ·çš„æ–¹å¼ï¼Œåœ¨ç¬¬ä¸€ä¸ª<code> token </code>å¤„åº”ç”¨éšæœºåˆå§‹åŒ–çš„åˆ†ç±»å¤´ã€‚</code></li></ul><h3 id="å®éªŒç»“æœ"><a href="#å®éªŒç»“æœ" class="headerlink" title="å®éªŒç»“æœ"></a>å®éªŒç»“æœ</h3><ul><li>ä¸åŒé¢„è®­ç»ƒæ¨¡å‹å¤§å°ä¸‹çš„è¡¨ç°ï¼Œåœ¨å°æ¨¡å‹ä¸‹å–å¾—ä¸ <code>Full-Finetuning</code> ç›¸è¿‘çš„ç»“æœï¼Œå¹¶è¿œè¿œä¼˜äº <code>P-Tuning</code>ã€‚</li><li>ä¸åŒä»»åŠ¡ä¸‹çš„ <code>P-Tuning v2</code> æ•ˆæœéƒ½å¾ˆå¥½ï¼Œè€Œ <code>P-Tuning</code> å’Œ <code>Prompt Learning</code> æ•ˆæœä¸å¥½ï¼›åŒæ—¶ï¼Œé‡‡ç”¨å¤šä»»åŠ¡å­¦ä¹ çš„æ–¹å¼èƒ½åœ¨å¤šæ•°ä»»åŠ¡ä¸Šå–å¾—æœ€å¥½çš„ç»“æœã€‚</li></ul><h2 id="AdaLORA"><a href="#AdaLORA" class="headerlink" title="AdaLORA"></a><code>AdaLORA</code></h2><p><code>èƒŒ    æ™¯</code>: é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ä¸­çš„æƒé‡å‚æ•°å¯¹ä¸‹æ¸¸ä»»åŠ¡çš„è´¡çŒ®æ˜¯ä¸åŒçš„ï¼Œéœ€è¦æ›´åŠ æ™ºèƒ½åœ°åˆ†é…å‚æ•°é¢„ç®—ï¼Œä»¥åœ¨å¾®è°ƒè¿‡ç¨‹ä¸­æ›´é«˜æ•ˆåœ°æ›´æ–°è´¡çŒ®è¾ƒå¤§çš„å‚æ•°ã€‚<br><code>ä¸»è¦è´¡çŒ®</code>: æå‡ºäº†ä¸€ç§é€šè¿‡å¥‡å¼‚å€¼åˆ†è§£å°†æƒé‡çŸ©é˜µåˆ†è§£ä¸ºå¢é‡çŸ©é˜µï¼Œå¹¶æ ¹æ®é‡è¦æ€§åº¦é‡åŠ¨æ€è°ƒæ•´å¢é‡çŸ©é˜µä¸­å¥‡å¼‚å€¼çš„å¤§å°çš„æ–¹æ³•ï¼Œä»¥æé«˜æ¨¡å‹æ€§èƒ½å’Œå‚æ•°æ•ˆç‡ã€‚<br><code>å…·ä½“åšæ³•</code>: ä½¿ç”¨<code>å¥‡å¼‚å€¼åˆ†è§£å°†æƒé‡çŸ©é˜µåˆ†è§£ä¸ºå¢é‡çŸ©é˜µï¼Œå¹¶æ ¹æ®é‡è¦æ€§åº¦é‡åŠ¨æ€è°ƒæ•´å¢é‡çŸ©é˜µä¸­å¥‡å¼‚å€¼çš„å¤§å°</code>ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œåªæ›´æ–°å¯¹æ¨¡å‹æ€§èƒ½è´¡çŒ®è¾ƒå¤§æˆ–å¿…è¦çš„å‚æ•°ã€‚<br><code>ç›®    çš„</code>: æé«˜é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åœ¨å¾®è°ƒè¿‡ç¨‹ä¸­çš„å‚æ•°æ•ˆç‡ï¼Œä½¿å…¶èƒ½æ›´é«˜æ•ˆåœ°æ›´æ–°å¯¹æ¨¡å‹æ€§èƒ½è´¡çŒ®è¾ƒå¤§çš„å‚æ•°ï¼Œä»è€Œæå‡æ¨¡å‹æ€§èƒ½ã€‚<br><img src="https://pic2.zhimg.com/v2-fe068accda3f17dac3e34696b6e81101_b.jpg" alt></p><h2 id="Towards-a-Unified-View-of-PETL"><a href="#Towards-a-Unified-View-of-PETL" class="headerlink" title="Towards a Unified View of PETL"></a>Towards a Unified View of PETL</h2><p>è¿™ç¯‡ ICLR2022 çš„æ–‡ç« ç ”ç©¶äº†å…¸å‹çš„ <code>PEFT</code> æ–¹æ³•ï¼Œè¯•å›¾å°† <code>PEFT</code> ç»Ÿä¸€åˆ°ä¸€ä¸ªæ¡†æ¶ä¸‹ï¼Œæ‰¾å‡ºå®ƒä»¬èµ·ä½œç”¨çš„å…·ä½“åŸå› ï¼Œå¹¶è¿›è¡Œæ”¹è¿›ã€‚ä¸»è¦ç ”ç©¶äº†ä¸‰ä¸ªé—®é¢˜ï¼š</p><ul><li>å…¸å‹çš„ <code>PEFT</code> æ–¹æ³•æœ‰ä»€ä¹ˆè”ç³»ï¼Ÿ</li><li>å…¸å‹çš„ <code>PEFT</code> æ–¹æ³•ä¸­æ˜¯å“ªäº›å…³é”®æ¨¡å—åœ¨èµ·ä½œç”¨ï¼Ÿ</li><li>èƒ½å¦å¯¹è¿™äº›å…³é”®æ¨¡å—è¿›è¡Œæ’åˆ—ç»„åˆï¼Œæ‰¾å‡ºæ›´æœ‰ç”¨çš„ <code>PEFT</code> æ–¹æ³•ï¼Ÿ</li></ul><h3 id="é€šç”¨å½¢å¼"><a href="#é€šç”¨å½¢å¼" class="headerlink" title="é€šç”¨å½¢å¼"></a>é€šç”¨å½¢å¼</h3><p>é€šè¿‡å¯¹ <code>Prefix Tuning</code> çš„æ¨å¯¼ï¼Œå¾—å‡ºäº†å’Œ <code>Adapter Tuning</code> ä»¥åŠ <code>LORA</code> å½¢å¼ä¸€è‡´çš„å½¢å¼ã€‚</p><p>é€šè¿‡å¯¹<code>Prefix Tuning</code>çš„æ¨å¯¼ï¼Œå¾—å‡ºäº†å’Œ<code>Adapter Tuning</code>ä»¥åŠ<code>LORA</code>å½¢å¼ä¸€è‡´çš„å½¢å¼ã€‚</p><p><img src="https://pic1.zhimg.com/v2-55e884a24a54eae7acf05df441647078_b.jpg" alt></p><p><img src="https://pic1.zhimg.com/v2-6da87dc77ec8b7efd0913b80c981c588_b.jpg" alt></p><p><img src="https://pic2.zhimg.com/v2-f9350f69d103feb441a9f81e1c2a8169_b.jpg" alt></p><p>åŒ…æ‹¬è¿™å‡ å¤§è¦ç´ ï¼š</p><ul><li><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="3.188ex" height="1.645ex" role="img" focusable="false" viewbox="0 -716 1409 727" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-N-394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"/><path id="MJX-1-TEX-I-210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="394" xlink:href="#MJX-1-TEX-N-394"/></g><g data-mml-node="mi" transform="translate(833,0)"><use data-c="210E" xlink:href="#MJX-1-TEX-I-210E"/></g></g></g></g></svg></mjx-container> çš„å½¢å¼</li><li>åµŒå…¥ <code>Transformer</code> ç»“æ„çš„æ–¹å¼ï¼ˆåˆ†ä¸º <code>Parrell</code> å’Œ <code>Sequential</code> ä¸¤ç§ã€‚</li><li><code>Parallel</code> æŒ‡çš„æ˜¯åœ¨è¾“å…¥å±‚åµŒå…¥ï¼Œè¿™æ ·ä¸åŸæœ‰ç»“æ„å¯ä»¥å¹¶è¡Œè®¡ç®—</li><li><code>Sequential</code>æŒ‡çš„æ˜¯åœ¨è¾“å‡ºå±‚åµŒå…¥ï¼Œç›¸å½“äºå¢åŠ äº†ç½‘è·¯çš„æ·±åº¦ï¼Œä¸åŸæœ‰ç»“æ„å­˜åœ¨ä¾èµ–å…³ç³»ï¼‰</li><li>ä¿®æ”¹è¡¨ç¤ºå±‚ï¼ˆä¸»è¦æŒ‡å¯¹ <code>attention</code> å±‚çš„ä¿®æ”¹è¿˜æ˜¯å¯¹ <code>ffn</code> å±‚çš„ä¿®æ”¹ï¼‰</li><li>ç»„åˆæ–¹å¼ã€‚æ€ä¹ˆä¸åŸæœ‰çš„å‚æ•°ç»„åˆï¼ŒåŒ…æ‹¬ç®€å•ç›¸åŠ ï¼ˆ<code>Adapter</code>ï¼‰ã€é—¨æ§å¼ï¼ˆ<code>Prefix Tuning</code>ï¼‰ã€ç¼©æ”¾å¼ï¼ˆ<code>LORA</code>ï¼‰ä¸‰ç§ï¼‰</li></ul><p>æ ¹æ®è¿™ä¸ªç»Ÿä¸€çš„æ¡†æ¶ï¼Œè¿˜å¦å¤–è®¾è®¡äº†ä¸‰ç§å˜ä½“ <code>Parallel Adapter</code>ã€<code>Multi-head Parallel Adapter</code>ã€<code>Scaled Parallel Adapter</code>ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><a href="https://link.zhihu.com/?target=https%3A//kexue.fm/archives/9138">Ladder Side-Tuningï¼šé¢„è®­ç»ƒæ¨¡å‹çš„â€œè¿‡å¢™æ¢¯â€</a></li><li><a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2012.13255.pdf">INTRINSIC DIMENSIONALITY EXPLAINS THE EFFECTIVENESS OF LANGUAGE MODEL FINE-TUNING</a></li><li><a href="https://link.zhihu.com/?target=https%3A//blog.csdn.net/qq_36426650/article/details/120607050">Prompt-Tuningâ€”â€”æ·±åº¦è§£è¯»ä¸€ç§æ–°çš„å¾®è°ƒèŒƒå¼</a></li><li><a href="https://link.zhihu.com/?target=https%3A//kexue.fm/archives/8295">P-Tuningï¼šè‡ªåŠ¨æ„å»ºæ¨¡ç‰ˆï¼Œé‡Šæ”¾è¯­è¨€æ¨¡å‹æ½œèƒ½</a></li><li><a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2110.07602.pdf">P-Tuning v2: Prompt Tuning Can Be Comparable to Fine-tuning Universally Across Scales and Tasks</a></li><li><a href="https://link.zhihu.com/?target=https%3A//aclanthology.org/2022.acl-short.8.pdf">https://aclanthology.org/2022.acl-short.8.pdf</a></li><li><a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2110.07602.pdf">https://arxiv.org/pdf/2110.07602.pdf</a></li><li><a href="https://link.zhihu.com/?target=https%3A//www.yuque.com/meta95/hmc3l4/ozgy13dx4akv7v17%3FsingleDoc%23">https://www.yuque.com/meta95/hmc3l4/ozgy13dx4akv7v17?singleDoc#</a></li><li><a href="https://zhuanlan.zhihu.com/p/625896377">æ— æ•°æ®ä¸æ™ºèƒ½ï¼šå¤§æ¨¡å‹è®­ç»ƒä¹‹å¾®è°ƒç¯‡</a></li><li><a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2303.10512.pdf">https://arxiv.org/pdf/2303.10512.pdf</a></li><li><a href="https://link.zhihu.com/?target=https%3A//github.com/huggingface/PEFT">GitHub - huggingface/PEFT: PEFT: State-of-the-art Parameter-Efficient Fine-Tuning.</a></li><li><a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2110.04366.pdf">https://arxiv.org/pdf/2110.04366.pdf</a></li></ol></font>]]></content>
      
      
      <categories>
          
          <category> NLP </category>
          
          <category> LLM </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>003ã€LLMã€‘ä»é›¶å¼€å§‹è®­ç»ƒå¤§æ¨¡å‹-çŸ¥ä¹-ä½•æ</title>
      <link href="/post/nlp003.html"/>
      <url>/post/nlp003.html</url>
      
        <content type="html"><![CDATA[<h2 id="è½¬è½½"><a href="#è½¬è½½" class="headerlink" title="è½¬è½½"></a><strong>è½¬è½½</strong></h2><p>æœ¬æ–‡è½¬è½½äºï¼š<a href="https://zhuanlan.zhihu.com/p/636270877">@çŸ¥ä¹-ä½•æ</a></p><blockquote><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å°½å¯èƒ½è¯¦ç»†åœ°æ¢³ç†ä¸€ä¸ªå®Œæ•´çš„<code>LLM</code>è®­ç»ƒæµç¨‹ã€‚åŒ…æ‹¬<code>æ¨¡å‹é¢„è®­ç»ƒPretrain</code>ã€<code>tokenizerè®­ç»ƒ</code> ã€<code>æŒ‡ä»¤å¾®è°ƒInstruction Tuning</code>ã€<code>å¥–åŠ±æ¨¡å‹Reward Mod</code>å’Œ <code>å¼ºåŒ–å­¦ä¹ RLHF</code>ç­‰ç¯èŠ‚ã€‚ç”±äºå†…å®¹æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬å°†é€æ­¥æ•´ç†å¹¶å®Œå–„è¿™ä¸ªæ–‡æ¡£ã€‚</p></blockquote><h2 id="é¢„è®­ç»ƒé˜¶æ®µPretraining-Stage"><a href="#é¢„è®­ç»ƒé˜¶æ®µPretraining-Stage" class="headerlink" title="é¢„è®­ç»ƒé˜¶æ®µPretraining Stage"></a><code>é¢„è®­ç»ƒé˜¶æ®µPretraining Stage</code></h2><p>å½“å‰ï¼Œä¸å°‘å·¥ä½œé€‰æ‹©åœ¨ä¸€ä¸ªè¾ƒå¼ºçš„åŸºåº§æ¨¡å‹ä¸Šè¿›è¡Œå¾®è°ƒï¼Œä¸”é€šå¸¸æ•ˆæœä¸é”™ï¼ˆå¦‚ï¼š[<a href="https://link.zhihu.com/?target=https%3A//github.com/tatsu-lab/stanford_alpaca">alpaca</a>]ã€[<a href="https://link.zhihu.com/?target=https%3A//lmsys.org/blog/2023-03-30-vicuna/">vicuna</a>] ç­‰ï¼‰ã€‚</p><p>è¿™ç§æˆåŠŸçš„å‰æåœ¨äºï¼šé¢„è®­ç»ƒæ¨¡å‹å’Œä¸‹æ¸¸ä»»åŠ¡çš„å·®è·ä¸å¤§ï¼Œé¢„è®­ç»ƒæ¨¡å‹ä¸­é€šå¸¸å·²ç»åŒ…å«å¾®è°ƒä»»åŠ¡ä¸­æ‰€éœ€è¦çš„çŸ¥è¯†ã€‚</p><p>ä½†åœ¨å®é™…æƒ…å†µä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œä½¿å¾—æˆ‘ä»¬æ— æ³•ç›´æ¥ä½¿ç”¨ä¸€äº›å¼€æº backboneï¼š</p><ol><li><strong>è¯­è¨€ä¸åŒ¹é…ï¼š</strong>å¤§å¤šæ•°å¼€æºåŸºåº§å¯¹ä¸­æ–‡çš„æ”¯æŒéƒ½ä¸å¤ªå‹å¥½ï¼Œä¾‹å¦‚ï¼š[<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/decapoda-research/llama-7b-hf">Llama</a>]ã€[<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/mosaicml/mpt-7b">mpt</a>]ã€[<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/tiiuae/falcon-7b">falcon</a>] ç­‰ï¼Œè¿™äº›æ¨¡å‹åœ¨è‹±æ–‡ä¸Šæ•ˆæœéƒ½å¾ˆä¼˜ç§€ï¼Œä½†åœ¨ä¸­æ–‡ä¸Šå´å·®å¼ºäººæ„ã€‚</li></ol><div class="table-container"><table><thead><tr><th>ç»­å†™ä»»åŠ¡æµ‹è¯•</th><th>LLaMA</th><th>MPT</th></tr></thead><tbody><tr><td>æ­å·è¥¿æ¹–æ˜¯</td><td>æ­å·è¥¿æ¹–æ˜¯æ­å·çš„ä¸€ä¸ªé™é™çš„ä¸€ä¸ªæ¸¸æ³³æ± ï¼Œæ¸¸æ³³æ± æ˜¯æ­å·è¥¿æ¹–çš„ä¸€ä¸ªæ¸¸æ³³æ± ï¼Œæ¸¸æ³³æ± æ˜¯æ­å·è¥¿æ¹–çš„ä¸€ä¸ªæ¸¸æ³³æ± ï¼Œæ¸¸æ³³æ± æ˜¯æ­å·è¥¿æ¹–çš„ä¸€ä¸ªæ¸¸æ³³æ± ï¼Œï¿½</td><td>æ­å·è¥¿æ¹–æ˜¯ä¸­å›½æœ€å¤§çš„æ¹–æ³Šï¼Œæ˜¯ä¸­å›½æœ€å¤§çš„æ¹–æ³Šï¼Œæ˜¯ä¸­å›½æœ€å¤§çš„æ¹–æ³Šï¼Œæ˜¯ä¸­å›½æœ€å¤§çš„æ¹–æ³Šï¼Œæ˜¯ä¸­å›½æœ€å¤§çš„æ¹–æ³Šï¼Œæ˜¯ä¸­å›½æœ€å¤§çš„æ¹–æ³Šï¼Œæ˜¯ä¸­å›½æœ€å¤§çš„æ¹–æ³Šï¼Œ</td></tr><tr><td>ç…çŠæ¦œçš„å¯¼æ¼”æ˜¯</td><td>ç…çŠæ¦œçš„å¯¼æ¼”æ˜¯å¾ˆå¤šçš„äººéƒ½ä¸çŸ¥é“ï¼Œå› ä¸ºä»–çš„çˆ¶äº²æ˜¯ä¸€ä½æ°ä½œå®¶ï¼Œä»–çš„çˆ¶äº²çš„æ°ä½œå®¶æ˜¯ä¸€ä½æ°ä½œå®¶ï¼Œ</td><td>ç…çŠæ¦œçš„å¯¼æ¼”æ˜¯è°ï¼ŸWho are the directors of the Rolling Stone?ç…çŠæ¦œçš„å¯¼æ¼”æ˜¯è°ï¼ŸWho are the</td></tr></tbody></table></div><ol><li><strong>ä¸“ä¸šçŸ¥è¯†ä¸è¶³ï¼š</strong>å½“æˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸“ä¸šé¢†åŸŸçš„<code>LLM</code>æ—¶ï¼Œé¢„è®­ç»ƒæ¨¡å‹ä¸­çš„çŸ¥è¯†å°±å°¤ä¸ºé‡è¦ã€‚ç”±äºå¤§å¤šæ•°é¢„è®­ç»ƒæ¨¡å‹éƒ½æ˜¯åœ¨é€šç”¨è®­ç»ƒè¯­æ–™ä¸Šè¿›è¡Œå­¦ä¹ ï¼Œå¯¹äºä¸€äº›ç‰¹æ®Šé¢†åŸŸï¼ˆé‡‘èã€æ³•å¾‹ç­‰ï¼‰ä¸­çš„æ¦‚å¿µå’Œåè¯æ— æ³•å…·å¤‡å¾ˆå¥½çš„ç†è§£ã€‚æˆ‘ä»¬é€šå¸¸éœ€è¦åœ¨è®­ç»ƒè¯­æ–™ä¸­åŠ å…¥ä¸€äº›é¢†åŸŸæ•°æ®ï¼ˆå¦‚ï¼š[<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2305.12002.pdf">xuanyuan 2.0</a>]ï¼‰ï¼Œä»¥å¸®åŠ©æ¨¡å‹åœ¨æŒ‡å®šé¢†åŸŸå†…è·å¾—æ›´å¥½çš„æ•ˆæœã€‚</li></ol><p><img src="https://pic3.zhimg.com/v2-3d5561661832b05a7f0fe52055ba7ea2_b.jpg" alt></p><p>åŸºäºä¸Šè¿°åŸå› ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œ <a href="#ä¸“æœ‰åè¯è§£é‡Š"><code>SFT[1]</code></a>æ­¥éª¤ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹é¢„è®­ç»ƒä»»åŠ¡æ˜¯å¦‚ä½•åšçš„ã€‚</p><h3 id="tokenizer-Trainingè¯è¡¨æ‰©å……"><a href="#tokenizer-Trainingè¯è¡¨æ‰©å……" class="headerlink" title="tokenizer Trainingè¯è¡¨æ‰©å……"></a><code>tokenizer Trainingè¯è¡¨æ‰©å……</code></h3><p>åœ¨è¿›è¡Œé¢„è®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆé€‰æ‹©ä¸€ä¸ªé¢„è®­ç»ƒçš„æ¨¡å‹åŸºåº§ã€‚</p><p>ä¸€ä¸ªè¾ƒä¸ºæ™®éçš„é—®é¢˜æ˜¯ï¼šå¤§éƒ¨åˆ†ä¼˜ç§€çš„è¯­è¨€æ¨¡å‹éƒ½æ²¡æœ‰è¿›è¡Œå……åˆ†çš„ä¸­æ–‡é¢„è®­ç»ƒï¼Œ</p><p>å› æ­¤ï¼Œè®¸å¤šå·¥ä½œéƒ½å°è¯•å°†åœ¨è‹±è¯­ä¸Šè¡¨ç°æ¯”è¾ƒä¼˜ç§€çš„æ¨¡å‹ç”¨ä¸­æ–‡è¯­æ–™è¿›è¡ŒäºŒæ¬¡é¢„è®­ç»ƒï¼ŒæœŸæœ›å…¶èƒ½å¤Ÿå°†è‹±è¯­ä¸Šçš„ä¼˜ç§€èƒ½åŠ›è¿ç§»åˆ°ä¸­æ–‡ä»»åŠ¡ä¸­æ¥ã€‚</p><blockquote><p>å·²ç»æœ‰è®¸å¤šä¼˜ç§€çš„ä»“åº“åšè¿‡è¿™ä»¶äº‹æƒ…ï¼Œæ¯”å¦‚ï¼š[<a href="https://link.zhihu.com/?target=https%3A//github.com/ymcui/Chinese-LLaMA-Alpaca">Chinese-LLaMA-Alpaca</a>]ã€‚</p></blockquote><p>ä½†åœ¨è¿›è¡Œæ­£å¼çš„è®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€æ­¥å¾ˆé‡è¦çš„äº‹æƒ…å»åšï¼š<code>è¯è¡¨æ‰©å……</code>ã€‚</p><p>é€šä¿—æ¥è®²ï¼Œ<code>tokenizer</code> çš„ç›®çš„å°±æ˜¯å°†ä¸€å¥è¯è¿›è¡Œåˆ‡è¯ï¼Œå¹¶å°†åˆ‡å¥½è¯çš„åˆ—è¡¨å–‚ç»™æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥å¥å­ &gt;&gt;&gt; ä½ å¥½ä¸–ç•Œ</span><br><span class="line">åˆ‡è¯ç»“æœ &gt;&gt;&gt; [&#x27;ä½ &#x27;, &#x27;å¥½&#x27;, &#x27;ä¸–&#x27;, &#x27;ç•Œ&#x27;]</span><br></pre></td></tr></table></figure><p>é€šå¸¸ï¼Œ<code>tokenizer</code> æœ‰ 2 ç§å¸¸ç”¨å½¢å¼ï¼š<code>WordPiece</code> å’Œ <code>BPE</code>ã€‚</p><h4 id="WordPiece"><a href="#WordPiece" class="headerlink" title="WordPiece"></a><strong><code>WordPiece</code></strong></h4><p><code>WordPiece</code> å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯å°†æ‰€æœ‰çš„ã€Œå¸¸ç”¨å­—ã€å’Œã€Œå¸¸ç”¨è¯ã€éƒ½å­˜åˆ°è¯è¡¨ä¸­ï¼Œ</p><p>å½“éœ€è¦åˆ‡è¯çš„æ—¶å€™å°±ä»è¯è¡¨é‡Œé¢æŸ¥æ‰¾å³å¯ã€‚</p><p><img src="https://pic1.zhimg.com/v2-819c6c3e9b4c10c88e06eee58a11ebf8_b.jpg" alt></p><blockquote><p>ä¸Šè¿°å›¾ç‰‡æ¥è‡ªå¯è§†åŒ–å·¥å…· [<a href="https://link.zhihu.com/?target=https%3A//github.com/HarderThenHarder/transformers_tasks/blob/main/tools/&lt;code&gt;tokenizer&lt;/code&gt;_viewer/readme.md">tokenizer_viewer</a>]ã€‚</p></blockquote><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¤§åé¼é¼çš„ <code>BERT</code> å°±ä½¿ç”¨çš„è¿™ç§åˆ‡è¯æ³•ã€‚</p><p>å½“æˆ‘ä»¬è¾“å…¥å¥å­ï¼šä½ å¥½ä¸–ç•Œï¼Œ</p><p><code>BERT</code> å°±ä¼šä¾æ¬¡æŸ¥æ‰¾è¯è¡¨ä¸­å¯¹åº”çš„å­—ï¼Œå¹¶å°†å¥å­åˆ‡æˆè¯çš„ç»„åˆã€‚</p><p><img src="https://pic3.zhimg.com/v2-daa04afee73491b2465f0c29149dcffa_b.jpg" alt></p><p>å½“é‡åˆ°è¯è¡¨ä¸­ä¸å­˜åœ¨çš„å­—è¯æ—¶ï¼Œ<code>tokenizer</code> ä¼šå°†å…¶æ ‡è®°ä¸ºç‰¹æ®Šçš„å­—ç¬¦ [UNK]ï¼š</p><p><img src="https://pic1.zhimg.com/v2-4a79c57436e4c5ec4b5525b9fd547e7c_b.jpg" alt></p><h4 id="Byte-Pair-Encoderï¼ˆBPEï¼‰"><a href="#Byte-Pair-Encoderï¼ˆBPEï¼‰" class="headerlink" title="Byte Pair Encoderï¼ˆBPEï¼‰"></a><strong>Byte Pair Encoderï¼ˆ<code>BPE</code>ï¼‰</strong></h4><p><code>WordPiece</code> çš„æ–¹å¼å¾ˆæœ‰æ•ˆï¼Œä½†å½“å­—è¯æ•°ç›®è¿‡äºåºå¤§æ—¶è¿™ä¸ªæ–¹å¼å°±æœ‰ç‚¹éš¾ä»¥å®ç°äº†ã€‚</p><p>å¯¹äºä¸€äº›å¤šè¯­è¨€æ¨¡å‹æ¥è®²ï¼Œè¦æƒ³ç©·ä¸¾æ‰€æœ‰è¯­è¨€ä¸­çš„å¸¸ç”¨è¯ï¼ˆç©·ä¸¾ä¸å…¨ä¼šé€ æˆ OOVï¼‰ï¼Œ</p><p>æ—¢è´¹äººåŠ›åˆè´¹è¯è¡¨å¤§å°ï¼Œä¸ºæ­¤ï¼Œäººä»¬å¼•å…¥å¦ä¸€ç§æ–¹æ³•ï¼š<code>BPE</code>ã€‚</p><p><code>BPE</code> ä¸æ˜¯æŒ‰ç…§ä¸­æ–‡å­—è¯ä¸ºæœ€å°å•ä½ï¼Œè€Œæ˜¯æŒ‰ç…§ unicode ç¼–ç  ä½œä¸ºæœ€å°ç²’åº¦ã€‚</p><p>å¯¹äºä¸­æ–‡æ¥è®²ï¼Œä¸€ä¸ªæ±‰å­—æ˜¯ç”± 3 ä¸ª unicode ç¼–ç ç»„æˆçš„ï¼Œ</p><p>å› ä¸ºå¹³æ—¶æˆ‘ä»¬ä¸ä¼šæ‹†å¼€æ¥çœ‹ï¼ˆæ¯•ç«Ÿä¸­æ–‡æ±‰å­—æ˜¯ä¸å¯æ‹†åˆ†çš„ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä¸€å¼€å§‹å¯¹è¿™ä¸ªæ¦‚å¿µä¹Ÿä¸å¤ªç†Ÿæ‚‰ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹ LLaMA çš„ <code>tokenizer</code>ï¼ˆ<code>BPE</code>ï¼‰å¯¹ä¸­æ–‡æ˜¯å¦‚ä½•è¿›è¡Œ encode çš„ï¼š</p><p><img src="https://pic2.zhimg.com/v2-4cd433a354233d03bc2aad15745a7285_b.jpg" alt></p><blockquote><p>ä¸Šè¿°å›¾ç‰‡æ¥è‡ªå¯è§†åŒ–å·¥å…· [<a href="https://link.zhihu.com/?target=https%3A//github.com/HarderThenHarder/transformers_tasks/blob/main/tools/&lt;code&gt;tokenizer&lt;/code&gt;_viewer/readme.md">tokenizer_viewer</a>]ã€‚</p></blockquote><p>å¯ä»¥çœ‹åˆ°ï¼Œã€Œç¼–ç ã€ä¸¤ä¸ªå­—èƒ½å¤Ÿè¢«æ­£å¸¸åˆ‡æˆ 2 ä¸ªå­—ï¼Œ</p><p>ä½†ã€Œå¾…ã€å´è¢«åˆ‡æˆäº† 3 ä¸ª <code>token</code>ï¼Œè¿™é‡Œçš„æ¯ä¸ª <code>token</code> å°±æ˜¯ 1 ä¸ª unicode ç¼–ç ã€‚</p><p><img src="https://pic1.zhimg.com/v2-66a59222fb083b240eac861eb026c73c_b.jpg" alt></p><p>é€šè¿‡ <code>token</code> æŸ¥æ‰¾åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ã€Œç¼–ã€ã€Œç ã€åœ¨è¯è¡¨ä¸­ï¼Œä½†ã€Œå¾…ã€ä¸åœ¨è¯è¡¨ä¸­ã€‚</p><p>ä½†ä»»ä½• 1 ä¸ªæ±‰å­—éƒ½æ˜¯å¯ä»¥ç”± unicode è¡¨ç¤ºï¼ˆåªæ˜¯ç»„åˆé¡ºåºä¸åŒï¼‰ï¼Œå› æ­¤ã€Œå¾…ã€å°±è¢«åˆ‡æˆäº† 3 ä¸ª <code>token</code>ã€‚</p><table data-draft-node="block" data-draft-type="table" data-size="normal" data-row-style="normal"><tbody><tr><td><code>BPE</code> çš„ä¼˜åŠ¿</td><td>ä¸ä¼šå‡ºç° OOV çš„æƒ…å†µã€‚ä¸ç®¡æ˜¯æ€æ ·çš„æ±‰å­—ï¼Œåªè¦å¯ä»¥ç”¨ unicode è¡¨ç¤ºï¼Œå°±éƒ½ä¼šå­˜åœ¨äºè¯è¡¨ä¸­ã€‚</td></tr><tr><td><code>BPE</code> çš„åŠ£åŠ¿</td><td>æ¨¡å‹è®­ç»ƒèµ·æ¥å°†ä¼šæ›´åƒåŠ›ä¸€äº›ã€‚æ¯•ç«Ÿåƒã€Œå¾…ã€è¿™æ ·çš„æ±‰å­—ç‰¹å®š unicode ç»„åˆå…¶å®æ˜¯ä¸éœ€è¦æ¨¡å‹å­¦ä¹ çš„ï¼Œä½†æ¨¡å‹å´éœ€è¦é€šè¿‡å­¦ä¹ æ¥çŸ¥é“åˆæ³•çš„ unicode åºåˆ—ã€‚</td></tr></tbody></table><p>é€šå¸¸åœ¨æ¨¡å‹è®­ç»ƒä¸å¤Ÿå……è¶³çš„æ—¶å€™ï¼Œæ¨¡å‹ä¼šè¾“å‡ºä¸€äº›ä¹±ç ï¼ˆä¸åˆæ³•çš„ unicode åºåˆ—ï¼‰ï¼š</p><h4 id="è¯è¡¨æ‰©å……"><a href="#è¯è¡¨æ‰©å……" class="headerlink" title="è¯è¡¨æ‰©å……"></a><strong>è¯è¡¨æ‰©å……</strong></h4><p>ä¸ºäº†é™ä½æ¨¡å‹çš„è®­ç»ƒéš¾åº¦ï¼Œäººä»¬é€šå¸¸ä¼šè€ƒè™‘åœ¨åŸæ¥çš„è¯è¡¨ä¸Šè¿›è¡Œã€Œè¯è¡¨æ‰©å……ã€ï¼Œ</p><p>ä¹Ÿå°±æ˜¯å°†ä¸€äº›å¸¸è§çš„æ±‰å­— <code>token</code> æ‰‹åŠ¨æ·»åŠ åˆ°åŸæ¥çš„ <code>tokenizer</code> ä¸­ï¼Œä»è€Œé™ä½æ¨¡å‹çš„è®­ç»ƒéš¾åº¦ã€‚</p><p>æˆ‘ä»¬å¯¹æ¯” [<a href="https://link.zhihu.com/?target=https%3A//github.com/ymcui/Chinese-LLaMA-Alpaca">Chinese-LLaMA</a>] å’Œ [<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/decapoda-research/llama-7b-hf">LLaMA</a>] ä¹‹é—´çš„ <code>tokenizer</code> çš„åŒºåˆ«ï¼š</p><p><img src="https://pic3.zhimg.com/v2-c4937d17cf9aef19f1fc161b6d923cd6_b.jpg" alt></p><blockquote><p>ä¸Šè¿°å›¾ç‰‡æ¥è‡ªå¯è§†åŒ–å·¥å…· [<a href="https://link.zhihu.com/?target=https%3A//github.com/HarderThenHarder/transformers_tasks/blob/main/tools/&lt;code&gt;tokenizer&lt;/code&gt;_viewer/readme.md">tokenizer_viewer</a>]ã€‚</p></blockquote><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼šChinese LLaMA åœ¨åŸå§‹ <code>tokenizer</code> ä¸Šæ–°å¢äº†17953 ä¸ª tokensï¼Œä¸”åŠ å…¥ <code>token</code> çš„å¤§éƒ¨åˆ†ä¸ºæ±‰å­—ã€‚</p><p>è€Œåœ¨ [<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2304.07854.pdf">BELLE</a>] ä¸­ä¹Ÿæœ‰åŒæ ·çš„åšæ³•ï¼š</p><p>åœ¨ 120w è¡Œä¸­æ–‡æ–‡æœ¬ä¸Šè®­ç»ƒå‡ºä¸€ä¸ª 5w è§„æ¨¡çš„ <code>token</code> é›†åˆï¼Œ</p><p>å¹¶å°†è¿™éƒ¨åˆ† <code>token</code> é›†åˆä¸åŸæ¥çš„ LLaMA è¯è¡¨åšåˆå¹¶ï¼Œ</p><p>æœ€åå†åœ¨ 3.2B çš„ä¸­æ–‡è¯­æ–™ä¸Šå¯¹è¿™éƒ¨åˆ†æ–°æ‰©å±•çš„ <code>token</code> embedding åšäºŒæ¬¡é¢„è®­ç»ƒã€‚</p><p><img src="https://pic2.zhimg.com/v2-cbae3dc2dc39804b3cb6d5ff547e7625_b.jpg" alt></p><h3 id="Language-Model-Pretraining"><a href="#Language-Model-Pretraining" class="headerlink" title="Language Model Pretraining"></a><code>Language Model Pretraining</code></h3><p>åœ¨æ‰©å……å®Œ <code>tokenizer</code> åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ­£å¼è¿›è¡Œæ¨¡å‹çš„é¢„è®­ç»ƒæ­¥éª¤äº†ã€‚</p><p><code>Pretraining</code> çš„æ€è·¯å¾ˆç®€å•ï¼Œå°±æ˜¯è¾“å…¥ä¸€å †æ–‡æœ¬ï¼Œè®©æ¨¡å‹åš <code>Next token Prediction</code> çš„ä»»åŠ¡ï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£ã€‚</p><p>æˆ‘ä»¬ä¸»è¦æ¥è®¨è®ºå‡ ç§é¢„è®­ç»ƒè¿‡ç¨‹ä¸­æ‰€ç”¨åˆ°çš„æ–¹æ³•ï¼šæ•°æ®æºé‡‡æ ·ã€æ•°æ®é¢„å¤„ç†ã€æ¨¡å‹ç»“æ„ã€‚</p><h4 id="æ•°æ®æºé‡‡æ ·"><a href="#æ•°æ®æºé‡‡æ ·" class="headerlink" title="æ•°æ®æºé‡‡æ ·"></a><strong>æ•°æ®æºé‡‡æ ·</strong></h4><p>åœ¨ [<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2005.14165.pdf">gpt3</a>] çš„è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå­˜åœ¨å¤šä¸ªè®­ç»ƒæ•°æ®æºï¼Œè®ºæ–‡ä¸­æåˆ°ï¼šå¯¹ä¸åŒçš„æ•°æ®æºä¼šé€‰æ‹©ä¸åŒé‡‡æ ·æ¯”ä¾‹ï¼š</p><p><img src="https://pic2.zhimg.com/v2-8280f19219e9a4ec73a7cec4c4175ced_b.jpg" alt></p><p>é€šè¿‡ã€Œæ•°æ®æºã€é‡‡æ ·çš„æ–¹å¼ï¼Œèƒ½å¤Ÿç¼“è§£æ¨¡å‹åœ¨è®­ç»ƒçš„æ—¶å€™å—åˆ°ã€Œæ•°æ®é›†è§„æ¨¡å¤§å°ã€çš„å½±å“ã€‚</p><p>ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œç›¸å¯¹è¾ƒå¤§çš„æ•°æ®é›†ï¼ˆCommon Crawlï¼‰ä¼šä½¿ç”¨ç›¸å¯¹è¾ƒå¤§çš„é‡‡æ ·æ¯”ä¾‹ï¼ˆ60%ï¼‰ï¼Œ</p><p>è¿™ä¸ªæ¯”ä¾‹è¿œè¿œå°äºè¯¥æ•°æ®é›†åœ¨æ•´ä½“æ•°æ®é›†ä¸­æ‰€å çš„è§„æ¨¡ï¼ˆ410 / 499 = 82.1%ï¼‰ï¼Œ</p><p>å› æ­¤ï¼ŒCC æ•°æ®é›†æœ€ç»ˆå®é™…ä¸Šåªè¢«è®­ç»ƒäº† 0.44ï¼ˆ0.6 / 0.82 * (300 / 499ï¼‰ï¼‰ä¸ª epochã€‚</p><p>è€Œå¯¹äºè§„æ¨¡æ¯”è¾ƒå°çš„æ•°æ®é›†ï¼ˆWikipediaï¼‰ï¼Œåˆ™å°†å¤šè¢«è®­ç»ƒå‡ æ¬¡ï¼ˆ3.4 ä¸ª epochï¼‰ã€‚</p><p>è¿™æ ·ä¸€æ¥å°±èƒ½ä½¿å¾—æ¨¡å‹ä¸ä¼šå¤ªåå‘äºè§„æ¨¡è¾ƒå¤§çš„æ•°æ®é›†ï¼Œä»è€Œå¤±å»å¯¹è§„æ¨¡å°ä½†ä½œç”¨å¤§çš„æ•°æ®é›†ä¸Šçš„å­¦ä¹ ä¿¡æ¯ã€‚</p><h4 id="æ•°æ®é¢„å¤„ç†"><a href="#æ•°æ®é¢„å¤„ç†" class="headerlink" title="æ•°æ®é¢„å¤„ç†"></a><strong>æ•°æ®é¢„å¤„ç†</strong></h4><p>æ•°æ®é¢„å¤„ç†ä¸»è¦æŒ‡å¦‚ä½•å°†ã€Œæ–‡æ¡£ã€è¿›è¡Œå‘é‡åŒ–ã€‚</p><p>é€šå¸¸æ¥è®²ï¼Œåœ¨ <code>Finetune</code> ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šç›´æ¥ä½¿ç”¨ <code>truncation</code> å°†è¶…è¿‡é˜ˆå€¼ï¼ˆ2048ï¼‰çš„æ–‡æœ¬ç»™æˆªæ–­ï¼Œ</p><p>ä½†åœ¨ <code>Pretrain</code> ä»»åŠ¡ä¸­ï¼Œè¿™ç§æ–¹å¼æ˜¾å¾—æœ‰äº›æµªè´¹ã€‚</p><p>ä»¥ä¹¦ç±æ•°æ®ä¸ºä¾‹ï¼Œä¸€æœ¬ä¹¦çš„å†…å®¹è‚¯å®šè¿œè¿œå¤šä½™ 2048 ä¸ª <code>token</code>ï¼Œä½†å¦‚æœé‡‡ç”¨å¤´éƒ¨æˆªæ–­çš„æ–¹å¼ï¼Œ</p><p>åˆ™æ¯æœ¬ä¹¦æ°¸è¿œåªèƒ½å¤Ÿå­¦ä¹ åˆ°å¼€å¤´çš„ 2048 tokens çš„å†…å®¹ï¼ˆè¿åºç« éƒ½ä¸ä¸€å®šèƒ½çœ‹å®Œï¼‰ã€‚</p><p>å› æ­¤ï¼Œæœ€å¥½çš„æ–¹å¼æ˜¯å°†é•¿æ–‡ç« æŒ‰ç…§ seq_lenï¼ˆ2048ï¼‰ä½œåˆ†å‰²ï¼Œå°†åˆ‡å‰²åçš„å‘é‡å–‚ç»™æ¨¡å‹åšè®­ç»ƒã€‚</p><h4 id="æ¨¡å‹ç»“æ„"><a href="#æ¨¡å‹ç»“æ„" class="headerlink" title="æ¨¡å‹ç»“æ„"></a><strong>æ¨¡å‹ç»“æ„</strong></h4><p>ä¸ºäº†åŠ å¿«æ¨¡å‹çš„è®­ç»ƒé€Ÿåº¦ï¼Œé€šå¸¸ä¼šåœ¨ decoder æ¨¡å‹ä¸­åŠ å…¥ä¸€äº› tricks æ¥ç¼©çŸ­æ¨¡å‹è®­ç»ƒå‘¨æœŸã€‚</p><p>ç›®å‰å¤§éƒ¨åˆ†åŠ é€Ÿ tricks éƒ½é›†ä¸­åœ¨ <code>Attention</code> è®¡ç®—ä¸Šï¼ˆå¦‚ï¼š<a href="#ä¸“æœ‰åè¯è§£é‡Š"><code>MQA[2]</code></a> å’Œ <a href="#ä¸“æœ‰åè¯è§£é‡Š"><code>Flash Attention[3]</code></a> [<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/tiiuae/falcon-40b">falcon</a>] ç­‰ï¼‰ï¼›</p><p>æ­¤å¤–ï¼Œä¸ºäº†è®©æ¨¡å‹èƒ½å¤Ÿåœ¨ä¸åŒé•¿åº¦çš„æ ·æœ¬ä¸Šéƒ½å…·å¤‡è¾ƒå¥½çš„æ¨ç†èƒ½åŠ›ï¼Œ</p><p>é€šå¸¸ä¹Ÿä¼šåœ¨ <code>Position Embedding</code> ä¸Šè¿›è¡Œäº›å¤„ç†ï¼Œé€‰ç”¨ ALiBiï¼ˆ[<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/bigscience/bloom-7b1">Bloom</a>]ï¼‰æˆ– RoPEï¼ˆ[<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/spaces/THUDM/GLM-130B">GLM-130B</a>]ï¼‰ç­‰ã€‚</p><p>å…·ä½“å†…å®¹å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« ï¼š</p><h3 id="æ•°æ®é›†æ¸…ç†"><a href="#æ•°æ®é›†æ¸…ç†" class="headerlink" title="æ•°æ®é›†æ¸…ç†"></a>æ•°æ®é›†æ¸…ç†</h3><p>ä¸­æ–‡é¢„è®­ç»ƒæ•°æ®é›†å¯ä»¥ä½¿ç”¨ [<a href="https://link.zhihu.com/?target=https%3A//data.baai.ac.cn/details/WuDaoCorporaText">æ‚Ÿé“</a>]ï¼Œæ•°æ®é›†åˆ†å¸ƒå¦‚ä¸‹ï¼ˆä¸»è¦ä»¥ç™¾ç§‘ã€åšå®¢ä¸ºä¸»ï¼‰ï¼š</p><p><img src="https://pic4.zhimg.com/v2-3062044c5131dd4589ed3fdb10ec94eb_b.jpg" alt></p><p>ä½†å¼€æºæ•°æ®é›†å¯ä»¥ç”¨äºå®éªŒï¼Œå¦‚æœæƒ³çªç ´æ€§èƒ½ï¼Œåˆ™éœ€è¦æˆ‘ä»¬è‡ªå·±è¿›è¡Œæ•°æ®é›†æ„å»ºã€‚</p><p>åœ¨ [<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2306.01116.pdf">falcon paper</a>] ä¸­æåˆ°ï¼Œ</p><p>ä»…ä½¿ç”¨ã€Œæ¸…æ´—åçš„äº’è”ç½‘æ•°æ®ã€å°±èƒ½å¤Ÿè®©æ¨¡å‹æ¯”åœ¨ã€Œç²¾å¿ƒæ„å»ºçš„æ•°æ®é›†ã€ä¸Šæœ‰æ›´å¥½çš„æ•ˆæœï¼Œ</p><p>ä¸€äº›å·²æœ‰çš„æ•°æ®é›†å’Œå®ƒä»¬çš„å¤„ç†æ–¹æ³•å¦‚ä¸‹ï¼š</p><p><img src="https://pic2.zhimg.com/v2-9758e1401e4e7a38ea4df9e83d2c4665_b.jpg" alt></p><p>æœ‰å…³ Falcon æ›´å¤šçš„ç»†èŠ‚å¯ä»¥çœ‹è¿™é‡Œï¼š</p><h3 id="æ¨¡å‹æ•ˆæœè¯„æµ‹"><a href="#æ¨¡å‹æ•ˆæœè¯„æµ‹" class="headerlink" title="æ¨¡å‹æ•ˆæœè¯„æµ‹"></a>æ¨¡å‹æ•ˆæœè¯„æµ‹</h3><p>å…³äº Language Modeling çš„é‡åŒ–æŒ‡æ ‡ï¼Œè¾ƒä¸ºæ™®éçš„æœ‰ [<a href="https://zhuanlan.zhihu.com/p/424162193">PPL</a>]ï¼Œ[<a href="https://zhuanlan.zhihu.com/p/424162193">BPC</a>] ç­‰ï¼Œ</p><p>å¯ä»¥ç®€å•ç†è§£ä¸ºåœ¨ç”Ÿæˆç»“æœå’Œç›®æ ‡æ–‡æœ¬ä¹‹é—´çš„ Cross Entropy Loss ä¸Šåšäº†ä¸€äº›å¤„ç†ã€‚</p><p>è¿™ç§æ–¹å¼å¯ä»¥ç”¨æ¥è¯„ä¼°æ¨¡å‹å¯¹ã€Œè¯­è¨€æ¨¡æ¿ã€çš„æ‹Ÿåˆç¨‹åº¦ï¼Œ</p><p>å³ç»™å®šä¸€æ®µè¯ï¼Œé¢„æµ‹åé¢å¯èƒ½å‡ºç°å“ªäº›åˆæ³•çš„ã€é€šé¡ºçš„å­—è¯ã€‚</p><p>ä½†ä»…ä»…æ˜¯ã€Œç”Ÿæˆé€šé¡ºå¥å­ã€çš„èƒ½åŠ›ç°åœ¨å·²ç»å¾ˆéš¾æ»¡è¶³ç°åœ¨äººä»¬çš„éœ€æ±‚ï¼Œ</p><p>å¤§éƒ¨åˆ†<code>LLM</code>éƒ½å…·å¤‡ç”Ÿæˆæµç•…å’Œé€šé¡ºè¯­å¥èƒ½åŠ›ï¼Œå¾ˆéš¾æ¯”è¾ƒå“ªä¸ªå¥½ï¼Œå“ªä¸ªæ›´å¥½ã€‚</p><p><strong>ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦èƒ½å¤Ÿè¯„ä¼°å¦å¤–ä¸€ä¸ªå¤§æ¨¡å‹çš„é‡è¦èƒ½åŠ› â€”â€” çŸ¥è¯†è•´å«èƒ½åŠ›</strong>ã€‚</p><h4 id="C-Eval"><a href="#C-Eval" class="headerlink" title="C-Eval"></a><strong>C-Eval</strong></h4><p>ä¸€ä¸ªå¾ˆå¥½çš„ä¸­æ–‡çŸ¥è¯†èƒ½åŠ›æµ‹è¯•æ•°æ®é›†æ˜¯ [<a href="https://link.zhihu.com/?target=https%3A//github.com/SJTU-LIT/ceval">C-Eval</a>]ï¼Œæ¶µç›–1.4w é“é€‰æ‹©é¢˜ï¼Œå…± 52 ä¸ªå­¦ç§‘ã€‚</p><p>è¦†ç›–å­¦ç§‘å¦‚ä¸‹ï¼š</p><p><img src="https://pic1.zhimg.com/v2-9eaf3f515f7a0c45a8ebc312f0c86438_b.jpg" alt></p><p>ç”±äºæ˜¯é€‰æ‹©é¢˜çš„å½¢å¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†é¢˜ç›®å†™è¿› <code>prompt</code> ä¸­ï¼Œ</p><p>å¹¶è®©æ¨¡å‹ç»­å†™ 1 ä¸ª <code>token</code>ï¼Œåˆ¤æ–­è¿™ä¸ªç»­å†™ <code>token</code> çš„ç­”æ¡ˆæ˜¯ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆå³å¯ã€‚</p><p>ä½†å¤§éƒ¨åˆ†æ²¡æœ‰ç²¾è°ƒè¿‡çš„é¢„è®­ç»ƒæ¨¡å‹å¯èƒ½æ— æ³•ç»­å†™å‡ºã€ŒA B C Dã€è¿™æ ·çš„é€‰é¡¹ç­”æ¡ˆï¼Œ</p><p>å› æ­¤ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ 5-shot çš„æ–¹å¼æ¥è®©æ¨¡å‹çŸ¥é“å¦‚ä½•è¾“å‡ºç­”æ¡ˆï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ä»¥ä¸‹æ˜¯ä¸­å›½å…³äºä¼šè®¡è€ƒè¯•çš„å•é¡¹é€‰æ‹©é¢˜ï¼Œè¯·é€‰å‡ºå…¶ä¸­çš„æ­£ç¡®ç­”æ¡ˆã€‚</span><br><span class="line"></span><br><span class="line">ä¸‹åˆ—å…³äºç¨æ³•åŸºæœ¬åŸåˆ™çš„è¡¨è¿°ä¸­ï¼Œä¸æ­£ç¡®çš„æ˜¯____ã€‚</span><br><span class="line">A. ç¨æ”¶æ³•å®šåŸåˆ™åŒ…æ‹¬ç¨æ”¶è¦ä»¶æ³•å®šåŸåˆ™å’Œç¨åŠ¡åˆæ³•æ€§åŸåˆ™</span><br><span class="line">B. ç¨æ”¶å…¬å¹³åŸåˆ™æºäºæ³•å¾‹ä¸Šçš„å¹³ç­‰æ€§åŸåˆ™</span><br><span class="line">C. ç¨æ”¶æ•ˆç‡åŸåˆ™åŒ…å«ç»æµæ•ˆç‡å’Œè¡Œæ”¿æ•ˆç‡ä¸¤ä¸ªæ–¹é¢</span><br><span class="line">D. ç¨åŠ¡æœºå…³æŒ‰æ³•å®šç¨‹åºä¾æ³•å¾ç¨ï¼Œå¯ä»¥è‡ªç”±åšå‡ºå‡å¾ã€åœå¾æˆ–å…å¾ç¨æ¬¾çš„å†³å®š</span><br><span class="line">ç­”æ¡ˆï¼šD</span><br><span class="line"></span><br><span class="line">ç”²å…¬å¸æ˜¯å›½å†…ä¸€å®¶é¢†å…ˆçš„æ–°åª’ä½“ã€é€šä¿¡åŠç§»åŠ¨å¢å€¼æœåŠ¡å…¬å¸ï¼Œç”±äºé­å—ä¸–ç•Œé‡‘èå±æœºï¼Œç”²å…¬å¸ç»æµåˆ©æ¶¦ä¸¥é‡ä¸‹æ»‘ï¼Œç»è¥é¢ä¸´å›°å¢ƒï¼Œä½†ä¸ºäº†ç¨³å®šèŒå·¥é˜Ÿä¼ï¼Œå…¬å¸å¹¶æœªè¿›è¡Œè£å‘˜ï¼Œè€Œæ˜¯å®è¡Œé«˜å±‚ç®¡ç†äººå‘˜å‡è–ªæªæ–½ã€‚ç”²å…¬å¸æ­¤ä¸¾é‡‡ç”¨çš„æ”¶ç¼©æˆ˜ç•¥æ–¹å¼æ˜¯____ã€‚</span><br><span class="line">A. è½¬å‘æˆ˜ç•¥</span><br><span class="line">B. æ”¾å¼ƒæˆ˜ç•¥</span><br><span class="line">C. ç´§ç¼©ä¸é›†ä¸­æˆ˜ç•¥</span><br><span class="line">D. ç¨³å®šæˆ˜ç•¥</span><br><span class="line">ç­”æ¡ˆï¼šC</span><br><span class="line"></span><br><span class="line">...             # ç¬¬ 3, 4, 5 é“æ ·ä¾‹é¢˜</span><br><span class="line"></span><br><span class="line">ä¸‹åˆ—å„é¡¹ä¸­ï¼Œä¸èƒ½å¢åŠ ä¼ä¸šæ ¸å¿ƒç«äº‰åŠ›çš„æ˜¯____ã€‚</span><br><span class="line">A. äº§å“å·®å¼‚åŒ–</span><br><span class="line">B. è´­ä¹°ç”Ÿäº§ä¸“åˆ©æƒ</span><br><span class="line">C. åˆ›æ–°ç”Ÿäº§æŠ€æœ¯</span><br><span class="line">D. è˜ç”¨ç”Ÿäº§å¤–åŒ…å•†</span><br><span class="line">ç­”æ¡ˆï¼š</span><br></pre></td></tr></table></figure><p>é€šè¿‡å‰é¢çš„æ ·ä¾‹åï¼Œæ¨¡å‹èƒ½å¤ŸçŸ¥é“åœ¨ã€Œç­”æ¡ˆï¼šã€åé¢åº”è¯¥è¾“å‡ºé€‰é¡¹å­—æ¯ã€‚</p><p>äºæ˜¯ï¼Œæˆ‘ä»¬è·å¾—æ¨¡å‹ç»­å†™åçš„ç¬¬ä¸€ä¸ª <code>token</code> çš„æ¦‚ç‡åˆ†å¸ƒï¼ˆlogitsï¼‰ï¼Œ</p><p>å¹¶å–å‡ºã€ŒA B C Dã€è¿™ 4 ä¸ªå­—æ¯çš„æ¦‚ç‡ï¼Œé€šè¿‡ softmax è¿›è¡Œå½’ä¸€åŒ–ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">probs = (</span><br><span class="line">    torch.nn.functional.softmax(</span><br><span class="line">        torch.tensor(</span><br><span class="line">            [</span><br><span class="line">                logits[self.&lt;code&gt;tokenizer&lt;/code&gt;.encode(</span><br><span class="line">                    &quot;A&quot;, bos=False, eos=False)[0]],</span><br><span class="line">                logits[self.&lt;code&gt;tokenizer&lt;/code&gt;.encode(</span><br><span class="line">                    &quot;B&quot;, bos=False, eos=False)[0]],</span><br><span class="line">                logits[self.&lt;code&gt;tokenizer&lt;/code&gt;.encode(</span><br><span class="line">                    &quot;C&quot;, bos=False, eos=False)[0]],</span><br><span class="line">                logits[self.&lt;code&gt;tokenizer&lt;/code&gt;.encode(</span><br><span class="line">                    &quot;D&quot;, bos=False, eos=False)[0]],</span><br><span class="line">            ]</span><br><span class="line">        ),</span><br><span class="line">        dim=0,</span><br><span class="line">    ).detach().cpu().numpy()</span><br><span class="line">)</span><br><span class="line">pred = &#123;0: &quot;A&quot;, 1: &quot;B&quot;, 2: &quot;C&quot;, 3: &quot;D&quot;&#125;[np.argmax(probs)]           # å°†æ¦‚ç‡æœ€å¤§çš„é€‰é¡¹ä½œä¸ºæ¨¡å‹è¾“å‡ºçš„ç­”æ¡ˆ</span><br></pre></td></tr></table></figure><p>C-Eval é€šè¿‡è¿™ç§æ–¹å¼æµ‹å‡ºäº†è®¸å¤šæ¨¡å‹åœ¨ä¸­æ–‡çŸ¥è¯†ä¸Šçš„æ•ˆæœï¼Œ</p><p>ç”±äºæ˜¯ 4 é€‰é¡¹é—®é¢˜ï¼Œæ‰€ä»¥åŸºçº¿ï¼ˆéšæœºé€‰æ‹©ï¼‰çš„æ­£ç¡®ç‡æ˜¯ 25%ã€‚</p><p>C-Eval ä¹Ÿå†ä¸€æ¬¡è¯æ˜äº† <code>GPT-4</code> æ˜¯ä¸ªå¤šä¹ˆå¼ºå¤§çš„çŸ¥è¯†æ¨¡å‹ï¼š</p><p><img src="https://pic3.zhimg.com/v2-973fde52fa9667a4f2cea7794653b5da_b.jpg" alt></p><h2 id="æŒ‡ä»¤å¾®è°ƒé˜¶æ®µInstruction-Tuning-Stage"><a href="#æŒ‡ä»¤å¾®è°ƒé˜¶æ®µInstruction-Tuning-Stage" class="headerlink" title="æŒ‡ä»¤å¾®è°ƒé˜¶æ®µInstruction Tuning Stage"></a>æŒ‡ä»¤å¾®è°ƒé˜¶æ®µ<code>Instruction Tuning Stage</code></h2><p>åœ¨å®Œæˆç¬¬ä¸€é˜¶æ®µçš„é¢„è®­ç»ƒåï¼Œå°±å¯ä»¥å¼€å§‹è¿›åˆ°æŒ‡ä»¤å¾®è°ƒé˜¶æ®µäº†ã€‚</p><p>ç”±äºé¢„è®­ç»ƒä»»åŠ¡çš„æœ¬è´¨åœ¨äºã€Œç»­å†™ã€ï¼Œè€Œã€Œç»­å†™ã€çš„æ–¹å¼å¹¶ä¸€å®šèƒ½å¤Ÿå¾ˆå¥½çš„å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚</p><p>ä¾‹å¦‚ï¼š</p><div class="table-container"><table><thead><tr><th>ç”¨æˆ·é—®é¢˜</th><th>ç”¨æˆ·é¢„æœŸå›ç­”</th><th>æ¨¡å‹ç»­å†™ç»“æœ</th></tr></thead><tbody><tr><td>ã€Šæ— é—´é“ã€‹çš„ä¸»æ¼”æœ‰å“ªäº›ï¼Ÿ</td><td>åˆ˜å¾·åã€æ¢æœä¼Ÿ</td><td>ã€Šæ— é—´é“ã€‹çš„ä¸»æ¼”æœ‰å“ªäº›ï¼Ÿä¸å°‘è§‚ä¼—æœŸå¾…çœ‹åˆ°é˜µå®¹å…¬å‘Šï¼Œä»Šå¤©å°ç¼–â€¦</td></tr></tbody></table></div><p>å› ä¸ºè®­ç»ƒå¤§å¤šæ¥è‡ªäº’è”ç½‘ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬æ— æ³•ä¿è¯æ•°æ®ä¸­åªå­˜åœ¨å­˜åœ¨è§„èŒƒçš„ã€Œä¸€é—®ä¸€ç­”ã€æ ¼å¼ï¼Œ</p><p>è¿™å°±ä¼šé€ æˆé¢„è®­ç»ƒæ¨¡å‹é€šå¸¸æ— æ³•ç›´æ¥ç»™å‡ºäººä»¬æƒ³è¦çš„ç­”æ¡ˆã€‚</p><p>ä½†æ˜¯ï¼Œè¿™å¹¶ä¸ä»£è¡¨é¢„è®­ç»ƒæ¨¡å‹ã€Œæ— çŸ¥ã€ï¼Œåªæ˜¯éœ€è¦æˆ‘ä»¬ç”¨ä¸€äº›å·§å¦™çš„ã€ŒæŠ€å·§ã€æ¥å¼•å¯¼å‡ºç­”æ¡ˆï¼š</p><div class="table-container"><table><thead><tr><th>ç”¨æˆ·é—®é¢˜</th><th>ç”¨æˆ·é¢„æœŸå›ç­”</th><th>æ¨¡å‹ç»­å†™ç»“æœ</th></tr></thead><tbody><tr><td>ã€Šæ— é—´é“ã€‹çš„ä¸»æ¼”æœ‰</td><td>åˆ˜å¾·åã€æ¢æœä¼Ÿ</td><td>ã€Šæ— é—´é“ã€‹çš„ä¸»æ¼”æœ‰åˆ˜å¾·åã€æ¢æœä¼Ÿå’Œé»„ç§‹ç”Ÿ,è€Œè¿™éƒ¨ç”µå½±ä¹Ÿæ˜¯é¦™æ¸¯è­¦åŒªç‰‡çš„ä»£è¡¨ä½œä¹‹ä¸€ã€‚</td></tr></tbody></table></div><p>ä¸è¿‡ï¼Œè¿™ç§éœ€è¦ç”¨æˆ·ç²¾å¿ƒè®¾è®¡ä»è€Œå»ã€Œå¥—ã€ç­”æ¡ˆçš„æ–¹å¼ï¼Œæ˜¾ç„¶æ²¡æœ‰é‚£ä¹ˆä¼˜é›…ã€‚</p><p><code>æ—¢ç„¶æ¨¡å‹çŸ¥é“è¿™äº›çŸ¥è¯†ï¼Œåªæ˜¯ä¸ç¬¦åˆæˆ‘ä»¬äººç±»çš„å¯¹è¯ä¹ æƒ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦å†å»æ•™ä¼šæ¨¡å‹ã€Œå¦‚ä½•å¯¹è¯ã€å°±å¥½äº†ã€‚</code></p><p><strong>è¿™å°±æ˜¯ <code>Instruction Tuning</code> è¦åšçš„äº‹æƒ…ï¼Œå³<code>æŒ‡ä»¤å¯¹é½</code></strong>ã€‚</p><p>OpenAI åœ¨ [<a href="https://link.zhihu.com/?target=https%3A//openai.com/research/instruction-following">instruction-following</a>] ä¸­å±•ç¤ºäº† GPT-3 å’Œç»è¿‡æŒ‡ä»¤å¾®è°ƒå‰åæ¨¡å‹çš„åŒºåˆ«ï¼š</p><p><img src="https://pic3.zhimg.com/v2-a7a8e7aed0750d189f792b19e8272dfe_b.jpg" alt></p><h3 id="Self-Instruction"><a href="#Self-Instruction" class="headerlink" title="Self Instruction"></a><code>Self Instruction</code></h3><p>æ—¢ç„¶æˆ‘ä»¬éœ€è¦å»ã€Œæ•™ä¼šæ¨¡å‹è¯´äººè¯ã€ï¼Œ</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å»ç²¾å¿ƒç¼–å†™å„å¼å„æ ·äººä»¬åœ¨å¯¹è¯ä¸­å¯èƒ½è¯¢é—®çš„é—®é¢˜ï¼Œä»¥åŠé—®é¢˜çš„ç­”æ¡ˆã€‚</p><p>åœ¨ [<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/2203.02155.pdf">InstructGPT Paper</a>] ä¸­ï¼Œä½¿ç”¨äº† 1.3w çš„æ•°æ®æ¥å¯¹ GPT-3.5 è¿›è¡Œç›‘ç£å­¦ä¹ ï¼ˆä¸‹å›¾ä¸­å·¦ <code>SFT Data</code>ï¼‰ï¼š</p><p><img src="https://pic1.zhimg.com/v2-23f809decd7d6f6c77a640cfbd8ad3c4_b.jpg" alt></p><p>å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œæ•°æ®é›†ä¸­äººå·¥æ ‡æ³¨ï¼ˆlabelerï¼‰å å¤§å¤´ï¼Œ</p><p>è¿™è¿˜ä»…ä»…åªæ˜¯ <code>InstructGPT</code>ï¼Œå’Œ <code>ChatGPT</code> è¿œè¿œä¸æ˜¯ä¸€ä¸ªé‡çº§ã€‚</p><blockquote><p>éå®˜æ–¹æ¶ˆæ¯ï¼š<code>ChatGPT</code> ä½¿ç”¨äº†ç™¾ä¸‡é‡çº§çš„æ•°æ®è¿›è¡ŒæŒ‡ä»¤å¾®è°ƒã€‚</p></blockquote><p>å¯è§ï¼Œä½¿ç”¨äººå·¥æ ‡æ³¨æ˜¯ä¸€ä»¶æˆæœ¬å·¨å¤§çš„äº‹æƒ…ï¼Œåªæ˜¯æ‰¾åˆ°äººä¸å¤Ÿï¼Œéœ€è¦æ‰¾åˆ°ã€Œä¸“ä¸šã€ä¸”ã€Œè®¤çŸ¥ä¸€è‡´ã€çš„æ ‡æ³¨å›¢é˜Ÿã€‚</p><p>å¦‚æœè¿™ä»¶äº‹ä»å¤´å¼€å§‹åšè‡ªç„¶å¾ˆéš¾ï¼ˆOpenAI ç¡®å®å‰å®³ï¼‰ï¼Œä½†ä»Šå¤©æˆ‘ä»¬å·²ç»æœ‰äº† <code>ChatGPT</code> äº†ï¼Œ</p><p><strong>æˆ‘ä»¬è®© <code>ChatGPT</code> æ¥æ•™æˆ‘ä»¬è‡ªå·±çš„æ¨¡å‹ä¸å°±å¥½äº†å—ï¼Ÿ</strong></p><p>è¿™å°±æ˜¯ <code>Self Instruction</code> çš„æ€è·¯ï¼Œå³é€šè¿‡ <code>ChatGPT</code> çš„è¾“å…¥è¾“å‡ºæ¥è’¸é¦è‡ªå·±çš„æ¨¡å‹ã€‚</p><p>ä¸€ä¸ªéå¸¸å‡ºåçš„é¡¹ç›®æ˜¯ [<a href="https://link.zhihu.com/?target=https%3A//github.com/tatsu-lab/stanford_alpaca">stanford_alpaca</a>]ã€‚</p><p>å¦‚æœä» <code>ChatGPT</code> ã€Œå¥—ã€æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‡³å°‘éœ€è¦ã€Œå¥—ã€å“ªäº›æ•°æ®ã€‚</p><p><code>Instruction Tuning</code> ä¸­çš„ã€Œè¾“å…¥ã€ï¼ˆé—®é¢˜ï¼‰å’Œã€Œè¾“å‡ºã€ï¼ˆç­”æ¡ˆï¼‰æ˜¯è®­ç»ƒæ¨¡å‹çš„å…³é”®ï¼Œ</p><p>ç­”æ¡ˆå¾ˆå¥½å¾—åˆ°ï¼Œå–‚ç»™ <code>ChatGPT</code> é—®é¢˜æ ¹æ®è¿”å›ç»“æœå°±èƒ½è·å¾—ï¼Œ</p><p>ä½†ã€Œé—®é¢˜ã€ä»å“ªé‡Œè·å¾—å‘¢ï¼Ÿ</p><p>ï¼ˆé äººæƒ³å¤ªç´¯äº†ï¼Œå±å¹•å‰çš„ä½ ä¸å¦¨è¯•è¯•ï¼Œçœ‹çœ‹çŸ­æ—¶é—´å†…èƒ½æƒ³å‡ºå¤šå°‘æœ‰ä»·å€¼çš„é—®é¢˜ï¼‰</p><p>Alpaca åˆ™æ˜¯ä½¿ç”¨ã€Œç§å­æŒ‡ä»¤ï¼ˆseedï¼‰ã€ï¼Œä½¿å¾— <code>ChatGPT</code> æ—¢ç”Ÿæˆã€Œé—®é¢˜ã€åˆç”Ÿæˆã€Œç­”æ¡ˆã€ã€‚</p><p>ç”±äº Alpaca æ˜¯è‹±æ–‡é¡¹ç›®ï¼Œä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸åŒæ€è·¯çš„ä¸­æ–‡é¡¹ç›® [<a href="https://link.zhihu.com/?target=https%3A//github.com/LianjiaTech/BELLE">BELLE</a>] ä½œä¸ºä¾‹å­ã€‚</p><p>é€šä¿—æ¥è®²ï¼Œå°±æ˜¯äººä¸ºçš„å…ˆç»™ä¸€äº›ã€Œè®­ç»ƒæ•°æ®æ ·ä¾‹ã€è®© <code>ChatGPT</code> çœ‹ï¼Œ</p><p>ç´§æ¥ç€åˆ©ç”¨ <code>ChatGPT</code> çš„ç»­å†™åŠŸèƒ½ï¼Œè®©å…¶ä¸æ–­åœ°ä¸¾ä¸€åä¸‰å‡ºæ–°çš„è®­ç»ƒæ•°æ®é›†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ä½ è¢«è¦æ±‚æä¾›10ä¸ªå¤šæ ·åŒ–çš„ä»»åŠ¡æŒ‡ä»¤ã€‚è¿™äº›ä»»åŠ¡æŒ‡ä»¤å°†è¢«æä¾›ç»™GPTæ¨¡å‹ï¼Œæˆ‘ä»¬å°†è¯„ä¼°GPTæ¨¡å‹å®ŒæˆæŒ‡ä»¤çš„èƒ½åŠ›ã€‚</span><br><span class="line">ä»¥ä¸‹æ˜¯ä½ æä¾›æŒ‡ä»¤éœ€è¦æ»¡è¶³çš„è¦æ±‚ï¼š</span><br><span class="line">1.å°½é‡ä¸è¦åœ¨æ¯ä¸ªæŒ‡ä»¤ä¸­é‡å¤åŠ¨è¯ï¼Œè¦æœ€å¤§åŒ–æŒ‡ä»¤çš„å¤šæ ·æ€§ã€‚</span><br><span class="line">2.ä½¿ç”¨æŒ‡ä»¤çš„è¯­æ°”ä¹Ÿåº”è¯¥å¤šæ ·åŒ–ã€‚ä¾‹å¦‚ï¼Œå°†é—®é¢˜ä¸ç¥ˆä½¿å¥ç»“åˆèµ·æ¥ã€‚</span><br><span class="line">3.æŒ‡ä»¤ç±»å‹åº”è¯¥æ˜¯å¤šæ ·åŒ–çš„ï¼ŒåŒ…æ‹¬å„ç§ç±»å‹çš„ä»»åŠ¡ï¼Œç±»åˆ«ç§ç±»ä¾‹å¦‚ï¼šbrainstormingï¼Œopen QAï¼Œclosed QAï¼Œrewriteï¼Œextractï¼Œgenerationï¼Œclassificationï¼Œchatï¼Œsummarizationã€‚</span><br><span class="line">4.GPTè¯­è¨€æ¨¡å‹åº”è¯¥èƒ½å¤Ÿå®Œæˆè¿™äº›æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œä¸è¦è¦æ±‚åŠ©æ‰‹åˆ›å»ºä»»ä½•è§†è§‰æˆ–éŸ³é¢‘è¾“å‡ºã€‚ä¾‹å¦‚ï¼Œä¸è¦è¦æ±‚åŠ©æ‰‹åœ¨ä¸‹åˆ5ç‚¹å«é†’ä½ æˆ–è®¾ç½®æé†’ï¼Œå› ä¸ºå®ƒæ— æ³•æ‰§è¡Œä»»ä½•æ“ä½œã€‚ä¾‹å¦‚ï¼ŒæŒ‡ä»¤ä¸åº”è¯¥å’ŒéŸ³é¢‘ã€è§†é¢‘ã€å›¾ç‰‡ã€é“¾æ¥ç›¸å…³ï¼Œå› ä¸ºGPTæ¨¡å‹æ— æ³•æ‰§è¡Œè¿™ä¸ªæ“ä½œã€‚</span><br><span class="line">5.æŒ‡ä»¤ç”¨ä¸­æ–‡ä¹¦å†™ï¼ŒæŒ‡ä»¤åº”è¯¥æ˜¯1åˆ°2ä¸ªå¥å­ï¼Œå…è®¸ä½¿ç”¨ç¥ˆä½¿å¥æˆ–é—®å¥ã€‚</span><br><span class="line">6.ä½ åº”è¯¥ç»™æŒ‡ä»¤ç”Ÿæˆé€‚å½“çš„è¾“å…¥ï¼Œè¾“å…¥å­—æ®µåº”åŒ…å«ä¸ºæŒ‡ä»¤æä¾›çš„å…·ä½“ç¤ºä¾‹ï¼Œå®ƒåº”è¯¥æ¶‰åŠç°å®æ•°æ®ï¼Œä¸åº”åŒ…å«ç®€å•çš„å ä½ç¬¦ã€‚è¾“å…¥åº”æä¾›å……å®çš„å†…å®¹ï¼Œä½¿æŒ‡ä»¤å…·æœ‰æŒ‘æˆ˜æ€§ã€‚</span><br><span class="line">7.å¹¶éæ‰€æœ‰æŒ‡ä»¤éƒ½éœ€è¦è¾“å…¥ã€‚ä¾‹å¦‚ï¼Œå½“æŒ‡ä»¤è¯¢é—®ä¸€äº›å¸¸è¯†ä¿¡æ¯ï¼Œæ¯”å¦‚â€œä¸–ç•Œä¸Šæœ€é«˜çš„å±±å³°æ˜¯ä»€ä¹ˆâ€ï¼Œä¸éœ€è¦æä¾›å…·ä½“çš„ä¸Šä¸‹æ–‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€åœ¨è¾“å…¥å­—æ®µä¸­æ”¾ç½®â€œ&lt;æ— è¾“å…¥&gt;â€ã€‚å½“è¾“å…¥éœ€è¦æä¾›ä¸€äº›æ–‡æœ¬ç´ æï¼ˆä¾‹å¦‚æ–‡ç« ï¼Œæ–‡ç« é“¾æ¥ï¼‰æ—¶ï¼Œå°±åœ¨è¾“å…¥éƒ¨åˆ†ç›´æ¥æä¾›ä¸€äº›æ ·ä¾‹ã€‚å½“è¾“å…¥éœ€è¦æä¾›éŸ³é¢‘ã€å›¾ç‰‡ã€è§†é¢‘æˆ–è€…é“¾æ¥æ—¶ï¼Œåˆ™ä¸æ˜¯æ»¡è¶³è¦æ±‚çš„æŒ‡ä»¤ã€‚</span><br><span class="line">8.è¾“å‡ºåº”è¯¥æ˜¯é’ˆå¯¹æŒ‡ä»¤å’Œè¾“å…¥çš„æ°å½“å›ç­”ã€‚ </span><br><span class="line">ä¸‹é¢æ˜¯10ä¸ªä»»åŠ¡æŒ‡ä»¤çš„åˆ—è¡¨ï¼š</span><br><span class="line">###</span><br><span class="line">1. æŒ‡ä»¤: åœ¨é¢è¯•ä¸­å¦‚ä½•å›ç­”è¿™ä¸ªé—®é¢˜ï¼Ÿ</span><br><span class="line">1. è¾“å…¥:å½“ä½ åœ¨è½¦é‡Œç‹¬å¤„æ—¶ï¼Œä½ ä¼šæƒ³äº›ä»€ä¹ˆï¼Ÿ</span><br><span class="line">1. è¾“å‡º:å¦‚æœæ˜¯åœ¨æ™šä¸Šï¼Œæˆ‘é€šå¸¸ä¼šè€ƒè™‘æˆ‘ä»Šå¤©æ‰€å–å¾—çš„è¿›æ­¥ï¼Œå¦‚æœæ˜¯åœ¨æ—©ä¸Šï¼Œæˆ‘ä¼šæ€è€ƒå¦‚ä½•åšåˆ°æœ€å¥½ã€‚æˆ‘ä¹Ÿä¼šå°è¯•ç»ƒä¹ æ„Ÿæ©å’Œæ´»åœ¨å½“ä¸‹çš„çŠ¶æ€ï¼Œä»¥é¿å…åˆ†å¿ƒé©¾é©¶ã€‚</span><br><span class="line">###</span><br><span class="line">2. æŒ‡ä»¤: æŒ‰äººå£å¯¹è¿™äº›å›½å®¶è¿›è¡Œæ’åã€‚</span><br><span class="line">2. è¾“å…¥:å·´è¥¿ï¼Œä¸­å›½ï¼Œç¾å›½ï¼Œæ—¥æœ¬ï¼ŒåŠ æ‹¿å¤§ï¼Œæ¾³å¤§åˆ©äºš</span><br><span class="line">2. è¾“å‡º:ä¸­å›½ï¼Œç¾å›½ï¼Œå·´è¥¿ï¼Œæ—¥æœ¬ï¼ŒåŠ æ‹¿å¤§ï¼Œæ¾³å¤§åˆ©äºš</span><br><span class="line">###</span><br><span class="line">3. æŒ‡ä»¤:</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šè¿°ä¾‹å­æ‰€ç¤ºï¼Œæˆ‘ä»¬å…ˆç»™å‡º 2 ä¸ªæ ·ä¾‹ï¼Œå¹¶è®© <code>ChatGPT</code> è¿›è¡Œç»­å†™ï¼š</p><p><img src="https://pic1.zhimg.com/v2-9bc23dd4ff89c4a463a6f92eb4c54c90_b.jpg" alt></p><p>å…³äº BELLE çš„æ›´å¤šç»†èŠ‚å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š</p><h3 id="å¼€æºæ•°æ®é›†æ•´ç†"><a href="#å¼€æºæ•°æ®é›†æ•´ç†" class="headerlink" title="å¼€æºæ•°æ®é›†æ•´ç†"></a>å¼€æºæ•°æ®é›†æ•´ç†</h3><p>åœ¨è¿™ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢³ç†ä¸€äº›å¼€æºçš„ <code>Instruction Tuning</code> çš„æ•°æ®é›†ï¼Œ</p><p>é™¤äº†ç›´æ¥æ‹¿æ¥ç”¨ä»¥å¤–ï¼Œæˆ‘ä»¬æœŸæœ›é€šè¿‡åˆ†æè¿™äº›å·²æœ‰æ•°æ®é›†ï¼Œä»è€Œå­¦ä¹ å¦‚ä½•æ„å»ºä¸€ä¸ªæŒ‡ä»¤æ•°æ®é›†ã€‚</p><h4 id="Alpaca"><a href="#Alpaca" class="headerlink" title="Alpaca"></a><strong>Alpaca</strong></h4><p>[<a href="https://link.zhihu.com/?target=https%3A//github.com/tatsu-lab/stanford_alpaca/blob/main/alpaca_data.json">stanford_alpaca</a>] é‡‡ç”¨ä¸Šè¿°çš„ <code>Self Instruction</code> çš„æ–¹å¼é‡‡é›†äº† 5200 æ¡æŒ‡ä»¤è®­ç»ƒæ•°æ®é›†ã€‚</p><p>æ•°æ®æ ·ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;instruction&quot;: &quot;Arrange the words in the given sentence to form a grammatically correct sentence.&quot;,</span><br><span class="line">    &quot;input&quot;: &quot;quickly the brown fox jumped&quot;,</span><br><span class="line">    &quot;output&quot;: &quot;The quick brown fox jumped quickly.&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œinstruction ä»£è¡¨è¦æ±‚æ¨¡å‹åšçš„ä»»åŠ¡ï¼Œinput ä»£è¡¨ç”¨æˆ·è¾“å…¥ï¼Œ output ä»£è¡¨å–‚ç»™æ¨¡å‹çš„ labelã€‚</p><p>Alpaca è¦†ç›–äº†å¤šç§ç±»å‹çš„æŒ‡ä»¤ï¼Œå…¶æ•°æ®åˆ†å¸ƒå¦‚ä¸‹ï¼š</p><p><img src="https://pic1.zhimg.com/v2-90866e67c5ae6f0e383db95db5bcc0a4_b.jpg" alt></p><p>åŒ…å«å†™ä½œã€æè¿°ã€åˆ†ç±»ã€æ‘˜è¦ç­‰å¤šç§ç±»å‹çš„ä»»åŠ¡é›†åˆã€‚</p><h4 id="BELLE"><a href="#BELLE" class="headerlink" title="BELLE"></a><strong>BELLE</strong></h4><p>BELLE å¼€æ”¾äº†å¥½å‡ ç§è§„æ¨¡çš„æ•°æ®é›†ï¼Œ[<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/datasets/BelleGroup/train_1M_CN">100ä¸‡</a>]ã€[<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/datasets/BelleGroup/train_2M_CN">200ä¸‡</a>]ã€[<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/datasets/BelleGroup/train_3.5M_CN">350ä¸‡</a>] ç­‰ã€‚</p><p>è®­ç»ƒæ•°æ®é›†æ ·ä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;instruction&quot;: &quot;åˆ¤æ–­ç»™å®šçš„æ–‡ç« æ˜¯å¦ç¬¦åˆè¯­æ³•è§„åˆ™ã€‚å¦‚æœä¸ç¬¦åˆï¼Œè¯·æä¾›ä¿®æ”¹å»ºè®®ã€‚ ä¸‹é¢æ˜¯ä¸€ç¯‡æ–‡ç« çš„å¼€å¤´: â€˜ä¸ºäº†æ¢è®¨è¿™ä¸ªä¸»é¢˜ï¼Œæœ¬æ–‡å°†æä¾›ä¸€ç³»åˆ—æ•°æ®å’Œå®ä¾‹ï¼Œä»¥è¯æ˜è¿™ä¸€è§‚ç‚¹ã€‚â€™&quot;,</span><br><span class="line">    &quot;input&quot;: &quot;&quot;,</span><br><span class="line">    &quot;output&quot;: &quot;è¿™ä¸ªå¼€å¤´ç¬¦åˆè¯­æ³•è§„åˆ™ã€‚&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºæ•°æ®é‡å¾ˆå¤§ï¼Œæˆ‘ä»¬æ— æ³•ç»Ÿè®¡å‡ºè®­ç»ƒæ•°æ®é›†ä¸­å„ä»»åŠ¡çš„çœŸå®å æ¯”ï¼Œ</p><p>ä½†ä» [<a href="https://link.zhihu.com/?target=https%3A//github.com/LianjiaTech/BELLE/blob/main/eval/eval_set.json">1000æ¡è¯„æµ‹é›†</a>] æ•°æ®åˆ†å¸ƒå¯ä»¥æ¨æµ‹å‡ºï¼Œè®­ç»ƒæ•°æ®é›†ä¸­åŒæ ·åŒ…å«ï¼šæ‘˜è¦ã€é—®ç­”ã€åˆ†ç±»ç­‰ä»»åŠ¡ã€‚</p><p><img src="https://pic1.zhimg.com/v2-6698ae5b6e3d6b7485ea66f82726f428_b.jpg" alt></p><p>æˆ‘ä»¬æŒ‰ç…§ç±»åˆ«å¯¹è¯„æµ‹æ•°æ®è¿›è¡Œé‡‡æ ·ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><div class="table-container"><table><thead><tr><th>ä»»åŠ¡åç§°</th><th>ä¾‹å­</th></tr></thead><tbody><tr><td>æ–‡æœ¬ç”Ÿæˆ</td><td>ä¸ºä¸€ç§æ™ºèƒ½æ‰‹è¡¨ç¼–å†™ç”¨æˆ·æ‰‹å†Œï¼ŒåŒ…æ‹¬è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’Œæ“ä½œæ­¥éª¤ã€‚</td></tr><tr><td>å¤´è„‘é£æš´</td><td>é’ˆå¯¹ç»™å®šçš„ä¸»é¢˜ï¼Œè¿›è¡Œå¤´è„‘é£æš´å¹¶è®°å½•æ‰€æœ‰æƒ³æ³•ã€‚  </td></tr></tbody></table></div><p>å¦‚ä½•æé«˜å…¬å¸çš„é”€å”®é¢ï¼Ÿ |<br>| å¼€æ”¾åŸŸé—®ç­” | ç”¨ä¸€ä¸¤å¥è¯æè¿°è‘—åçš„å°¼ç½—æ²³æ˜¯å¦‚ä½•å½¢æˆçš„ã€‚ |<br>| å°é—­åŸŸé—®ç­” | ä»ä»¥ä¸‹é€‰é¡¹ä¸­é€‰æ‹©æ­£ç¡®çš„è¯æ±‡å¡«ç©ºä»¥å®Œæ•´ä¸‹é¢çš„å¥å­ã€‚ ä»–å–œæ¬¢å»_______çœ‹ç”µå½±ã€‚A) é‚®å±€ Bï¼‰è¶…å¸‚ Cï¼‰ç”µå½±é™¢ Dï¼‰éŸ³ä¹ä¼š |<br>| åˆ†ç±» | è¯·å°†ä»¥ä¸‹è¿™ç¯‡æ–‡ç« åˆ†ç±»ä¸ºæ–°é—»æŠ¥é“ã€ç§‘å­¦æ–‡ç« æˆ–ç¤¾è®ºã€‚<br>æ®åª’ä½“æ–°é—»æ´å¼•ç¾å›½ç¦å…‹æ–¯æ–°é—»ç½‘æŠ¥é“ï¼Œç¾å›½ä¼¯å…‹å¸Œå°”å“ˆæ’’éŸ¦å…¬å¸é¦–å¸­æ‰§è¡Œå®˜ã€è‘—åæŠ•èµ„äººå·´è²ç‰¹è¿‘æ—¥å°±ç¾å›½é“¶è¡Œä¸šå±æœºä¸æ€»ç»Ÿæ‹œç™»çš„å›¢é˜Ÿè¿›è¡Œå¯¹è¯ã€‚ |<br>| æŠ½å– | åŸºäºä»¥ä¸‹è¡¨æ ¼ï¼Œè¯·é—®å¼ ä¸‰çš„è€ƒå‹¤æƒ…å†µ<br>å‘˜å·¥å§“å,æ—¥æœŸ,ä¸Šç­æ—¶é—´,ä¸‹ç­æ—¶é—´,æ˜¯å¦è¿Ÿåˆ°,æ˜¯å¦æ—©é€€,æ˜¯å¦è¯·å‡<br>å¼ ä¸‰,1æœˆ1æ—¥,8:30,17:30,å¦,å¦,å¦<br>æå››,1æœˆ1æ—¥,9:00,18:00,æ˜¯,å¦,å¦<br>ç‹äº”,1æœˆ1æ—¥,8:00,16:30,å¦,æ˜¯,å¦<br>èµµå…­,1æœˆ1æ—¥,8:30,17:00,å¦,å¦,æ˜¯<br>å¼ ä¸‰,1æœˆ2æ—¥,8:00,17:00,å¦,å¦,å¦<br>æå››,1æœˆ2æ—¥,8:30,17:30,å¦,å¦,å¦<br>ç‹äº”,1æœˆ2æ—¥,9:00,18:00,æ˜¯,å¦,å¦<br>èµµå…­,1æœˆ2æ—¥,8:30,17:00,å¦,å¦,æ˜¯ |<br>| é‡å†™ | æ ¹æ®æä¾›çš„æ–‡æœ¬é‡å†™å…¶ä¸­çš„ä¸€æ®µï¼Œä½¿ä¹‹æ›´åŠ ç®€æ˜æ‰¼è¦ï¼ŒåŒæ—¶ä¸ä¸¢å¤±åŸæ–‡æœ¬çš„ä¸»è¦ä¿¡æ¯ã€‚<br>çº½çº¦å¸‚ï¼Œç®€ç§°â€œçº½çº¦â€ï¼Œé€šå¸¸è¢«ç§°ä¸ºâ€œå¤§è‹¹æœâ€ï¼Œæ˜¯ç¾å›½æœ€å¤§çš„åŸå¸‚ï¼Œä¹Ÿæ˜¯å…¨ä¸–ç•Œæœ€å¤§çš„åŸå¸‚ä¹‹ä¸€ã€‚ä½äºç¾å›½ä¸œæµ·å²¸ï¼Œä¸œåŒ—éƒ¨è¾¹ç•Œæ˜¯å¤§è¥¿æ´‹ï¼Œåœ¨æ–°æ³½è¥¿å·çš„ä¸œå—éƒ¨ã€‚ |<br>| æ‘˜è¦ | åŸºäºä¸‹é¢çš„è¿™ä¸ªæ•…äº‹ï¼Œæ€»ç»“å…¶ä¸­æœ€é‡è¦çš„ä¸‰ä¸ªäº‹ä»¶ã€‚<br>å°æ˜æ˜¯ä¸€ä¸ªå¥½å­¦ç”Ÿï¼Œæ¯å¤©æ—©ä¸Šéƒ½è¦èµ·å¾—å¾ˆæ—©å»ä¸Šå­¦ã€‚æœ‰ä¸€å¤©ï¼Œä»–è¿Ÿåˆ°äº†ï¼Œå› ä¸ºä»–çš„å®¶é‡Œæ¥äº†ä¸€ä¸ªå®¢äººã€‚æ™šä¸Šï¼Œä»–å‚åŠ äº†ä¸€æ¬¡ç­çº§ä¼šè®®ï¼Œä¼šè®®ä¸»é¢˜æ˜¯å¦‚ä½•æé«˜å­¦ä¹ æ•ˆç‡ã€‚å›åˆ°å®¶åï¼Œä»–åˆèŠ±äº†ä¸€äº›æ—¶é—´å¤ä¹ åŠŸè¯¾ã€‚ |<br>| Code &amp; Math | æŒ‰ç…§ä»¥ä¸‹è¦æ±‚ï¼Œå†™ä¸€ä¸ªSQLæŸ¥è¯¢è¯­å¥ï¼šä»è¡¨ä¸­æŸ¥æ‰¾æ‰€æœ‰æ€§åˆ«ä¸ºå¥³æ€§çš„å­¦ç”Ÿçš„å§“åå’Œå­¦å·ã€‚<br>SELECT name, id FROM students WHERE gender = â€˜å¥³æ€§â€™ |</p><h4 id="Vicuna"><a href="#Vicuna" class="headerlink" title="Vicuna"></a><strong>Vicuna</strong></h4><h4 id="BAIZE"><a href="#BAIZE" class="headerlink" title="BAIZE"></a><strong>BAIZE</strong></h4><h3 id="æ¨¡å‹çš„è¯„æµ‹æ–¹æ³•"><a href="#æ¨¡å‹çš„è¯„æµ‹æ–¹æ³•" class="headerlink" title="æ¨¡å‹çš„è¯„æµ‹æ–¹æ³•"></a>æ¨¡å‹çš„è¯„æµ‹æ–¹æ³•</h3><p>æ¯”èµ·é¢„è®­ç»ƒï¼ˆ<code>Pretrain</code>ï¼‰ç¯èŠ‚é‡Œç›¸å¯¹æ˜ç¡®çš„è¯„ä»·æŒ‡æ ‡ï¼ˆå¦‚PPLã€NLLç­‰ï¼‰ï¼Œ</p><p>Instruction ç¯èŠ‚ä¸­çš„è¯„ä»·æŒ‡æ ‡æ¯”è¾ƒä»¤äººå¤´ç–¼ã€‚</p><p>é‰´äºè¯­è¨€ç”Ÿæˆæ¨¡å‹çš„å‘å±•é€Ÿåº¦ï¼ŒBLEU å’Œ ROUGH è¿™æ ·çš„æŒ‡æ ‡å·²ç»ä¸å†å®¢è§‚ã€‚</p><p>ä¸€ç§æ¯”è¾ƒæµè¡Œçš„æ–¹å¼æ˜¯åƒ [<a href="https://link.zhihu.com/?target=https%3A//github.com/lm-sys/FastChat/blob/main/fastchat/eval/table/&lt;code&gt;prompt&lt;/code&gt;.jsonl">FastChat</a>] ä¸­ä¸€æ ·ï¼Œåˆ©ç”¨ <code>GPT-4</code> ä¸ºæ¨¡å‹çš„ç”Ÿæˆç»“æœæ‰“åˆ†ï¼Œ</p><p>æˆ‘ä»¬ä¹Ÿå°è¯•ä½¿ç”¨åŒæ ·çš„ <code>prompt</code> å¯¹ 3 ç§å¼€æºæ¨¡å‹ï¼šOpenLlamaã€ChatGLMã€BELLE è¿›è¡Œæµ‹è¯•ã€‚</p><blockquote><p>æ³¨æ„ï¼šä¸‹é¢çš„æµ‹è¯•ç»“æœä»…æºè‡ªæˆ‘ä»¬è‡ªå·±çš„å®éªŒï¼Œ<strong>ä¸å…·å¤‡ä»»ä½•æƒå¨æ€§</strong>ã€‚</p></blockquote><p>å¯¹äºæ¯ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆè·å¾— <code>ChatGPT</code> çš„å›å¤ï¼Œä»¥åŠå¦å¤– 3 ç§æ¨¡å‹çš„å›å¤ï¼Œ</p><p>æ¥ç€æˆ‘ä»¬å°† ã€Œ<code>ChatGPT</code> ç­”æ¡ˆ - å€™é€‰æ¨¡å‹ç­”æ¡ˆã€è¿™æ ·çš„ pair å–‚ç»™ <code>GPT-4</code> æ‰“åˆ†ï¼ˆæ»¡åˆ†ä¸º 10 åˆ†ï¼‰ã€‚</p><p>å¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://pic1.zhimg.com/v2-30369e5361b3097e6c9c3254c1f9b5e4_b.jpg" alt></p><p>æˆ‘ä»¬å¯¹æ¯ä¸ªä»»åŠ¡å•ç‹¬è¿›è¡Œäº†ç»Ÿè®¡ï¼Œå¹¶åœ¨æœ€åä¸€åˆ—æ±‚å¾—å¹³å‡å€¼ã€‚</p><p><code>GPT-4</code> ä¼šå¯¹æ¯ä¸€æ¡æµ‹è¯•æ ·æœ¬çš„ 2 ä¸ªç­”æ¡ˆåˆ†åˆ«è¿›è¡Œæ‰“åˆ†ï¼Œå¹¶ç»™å‡ºæ‰“åˆ†ç†ç”±ï¼š</p><p><img src="https://pic3.zhimg.com/v2-8adadb3bab29880e9fecacb673da87d2_b.jpg" alt></p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å‘ç°ï¼Œ<code>GPT-4</code> æ‰“å‡ºçš„åˆ†æ•°å’Œç»™å‡ºç†ç”±<strong>å¹¶ä¸ä¸€å®šæ­£ç¡®</strong>ã€‚</p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œ<code>GPT-4</code> ä¸ºå³è¾¹æ¨¡å‹çš„ç­”æ¡ˆæ‰“å‡ºäº†æ›´é«˜çš„åˆ†æ•°ï¼Œç»™å‡ºçš„ç†ç”±æ˜¯ï¼š</p><p>å°†ã€Œæœ€é•¿æ—¶æœŸã€æ”¹ä¸ºäº†ã€Œæœ€é•¿æ—¶æœŸä¹‹ä¸€ã€ä¼šæ›´å‡†ç¡®ã€‚</p><p>ä½†äº‹å®ä¸Šï¼ŒInstruction ä¸­æ˜ç¡®è®¾å®šå°±æ˜¯ã€Œæœ€é•¿æ—¶æœŸã€ï¼Œ</p><p>è¿™ç§ã€Œç»™é«˜åˆ†ã€çš„ç†ç”±å…¶å®æ˜¯ä¸æ­£ç¡®çš„ã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å‘ç°ï¼Œä»…ä»…è°ƒæ¢å¥å­é¡ºåºä¹Ÿä¼šå¯¹æœ€åæ‰“åˆ†ç»“æœäº§ç”Ÿå½±å“ï¼Œ</p><p>é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è€ƒè™‘ã€Œè°ƒæ¢å¥å­é¡ºåºå¹¶æ±‚å’Œå¹³å‡ã€æ¥ç¼“è§£ã€‚</p><p>ä½†ä¸ç®¡æ€ä¹ˆæ ·ï¼Œ<code>GPT-4</code> ç»™å‡ºçš„åˆ†æ•°æˆ–è®¸å¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è±¡ä¸­çš„é‚£ä¹ˆé è°±ï¼Œ</p><p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬é€šè¿‡äººå·¥çš„ Review çš„æ–¹å¼å¯¹æ¯ä¸ªç­”æ¡ˆè¿›è¡Œäº†ä¸€æ¬¡å›æ‰«ï¼Œå¾—åˆ°çš„ç»“æœå’Œæ ‡å‡†å¦‚ä¸‹ï¼š</p><blockquote><p>å†æ¬¡é‡ç”³ï¼šæˆ‘ä»¬åªæ˜¯æœŸæœ›æŒ‡å‡º <code>GPT-4</code> æ‰“åˆ†å¯èƒ½ä¼šå’Œå®é™…äº§ç”Ÿåå·®çš„é—®é¢˜ï¼Œ<strong>è¿™é‡Œæ’åä¸å…·å¤‡ä»»ä½•æƒå¨æ€§</strong>ã€‚</p></blockquote><p><img src="https://pic1.zhimg.com/v2-73395d9c1c2bb8b8376009716428f530_b.jpg" alt></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ</p><p>åœ¨ <code>GPT-4</code> æ‰“åˆ†çš„ç»“æœä¸­ï¼Œå·²ç»æœ‰æ¨¡å‹çš„æ•ˆæœç”šè‡³è¶…è¿‡äº† <code>ChatGPT</code>ï¼ˆåˆ†æ•°ä¸º 1.02ï¼‰ï¼Œ</p><p>ä½†å†ç»è¿‡äººå·¥ Review åï¼Œ<code>ChatGPT</code> çš„ç­”æ¡ˆæ˜¯æˆ‘ä»¬è®¤ä¸ºæ›´åˆç†ä¸€äº›çš„ã€‚</p><p>å½“ç„¶ï¼Œæœ€è¿‘é™†é™†ç»­ç»­çš„æ¨å‡ºäº†è®¸å¤šæ–°çš„è¯„æµ‹æ–¹æ³•ï¼Œå¦‚ï¼š[<a href="https://link.zhihu.com/?target=https%3A//github.com/WeOpenML/PandaLM">PandaLM</a>]ï¼Œ</p><p>ä»¥åŠè®¸å¤šæ¯”è¾ƒæœ‰å½±å“åŠ›çš„è¯„æµ‹é›†ï¼Œå¦‚ï¼š[<a href="https://link.zhihu.com/?target=https%3A//github.com/SJTU-LIT/ceval">C-Eval</a>]ã€[<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/spaces/HuggingFaceH4/open_llm_leaderboard">open_llm_leaderboard</a>] ç­‰ï¼Œ</p><p>æˆ‘ä»¬æˆ–è®¸ä¼šåœ¨åç»­çš„æ•´ç†ä¸­æ›´æ–°ã€‚</p><h2 id="ä¸“æœ‰åè¯è§£é‡Š"><a href="#ä¸“æœ‰åè¯è§£é‡Š" class="headerlink" title="ä¸“æœ‰åè¯è§£é‡Š"></a><strong>ä¸“æœ‰åè¯è§£é‡Š</strong></h2><h3 id="soft-fine-tuning"><a href="#soft-fine-tuning" class="headerlink" title="soft fine tuning"></a><code>soft fine tuning</code></h3><p><code>Soft Fine-Tuning for Cross-Domain Transfer Learning</code>ï¼ˆè½¯ç²¾è°ƒç”¨äºè·¨é¢†åŸŸè¿ç§»å­¦ä¹ ï¼‰æ˜¯ä¸€ç§ç”¨äºè§£å†³è·¨é¢†åŸŸè¿ç§»å­¦ä¹ é—®é¢˜çš„æ–¹æ³•ã€‚<br>è¯¥æ–¹æ³•æ—¨åœ¨é€šè¿‡åœ¨æºé¢†åŸŸå’Œç›®æ ‡é¢†åŸŸä¹‹é—´è¿›è¡ŒçŸ¥è¯†ä¼ é€’ï¼Œä»è€Œæé«˜ç›®æ ‡é¢†åŸŸçš„æ€§èƒ½ã€‚<br><code>Soft Fine-Tuning</code>æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†<code>æºé¢†åŸŸå’Œç›®æ ‡é¢†åŸŸçš„æ•°æ®è¿›è¡Œå¯¹é½ï¼Œç„¶åä½¿ç”¨æºé¢†åŸŸçš„çŸ¥è¯†æ¥æŒ‡å¯¼ç›®æ ‡é¢†åŸŸçš„å­¦ä¹ è¿‡ç¨‹</code>ã€‚<br>å…·ä½“è€Œè¨€ï¼Œè¯¥æ–¹æ³•ä½¿ç”¨ä¸€ä¸ª<code>å…±äº«çš„ç‰¹å¾æå–å™¨æ¥æå–æºé¢†åŸŸå’Œç›®æ ‡é¢†åŸŸçš„ç‰¹å¾è¡¨ç¤º</code>ã€‚<br>ç„¶åï¼Œé€šè¿‡<code>æœ€å°åŒ–æºé¢†åŸŸå’Œç›®æ ‡é¢†åŸŸä¹‹é—´çš„ç‰¹å¾åˆ†å¸ƒå·®å¼‚æ¥å¯¹ç‰¹å¾è¿›è¡Œå¯¹é½</code>ã€‚æœ€åï¼Œä½¿ç”¨æºé¢†åŸŸçš„æ ‡ç­¾ä¿¡æ¯æ¥è¾…åŠ©ç›®æ ‡é¢†åŸŸçš„å­¦ä¹ è¿‡ç¨‹ï¼Œä»¥æé«˜ç›®æ ‡é¢†åŸŸçš„æ€§èƒ½ã€‚</p><ol><li>è®ºæ–‡ï¼š<code>Soft Fine-Tuning for Cross-Domain Transfer Learning</code></li><li><code>GitHub</code>ä»£ç å®ç°ï¼š<ul><li>é“¾æ¥ï¼šå¾…å®š</li></ul></li></ol><h3 id="MQA"><a href="#MQA" class="headerlink" title="MQA"></a><code>MQA</code></h3><p><code>æ€»    ç»“</code>ï¼š<code>MQA</code>æ˜¯æŒ‡å¤šå¤´è‡ªæ³¨æ„åŠ›(<code>Multi-Head Self-Attention</code>)æœºåˆ¶ï¼Œæ˜¯ä¸€ç§åœ¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ä¸­<code>å¼•å…¥å¤šä¸ªå¤´éƒ¨</code>çš„æ–¹æ³•ã€‚<br><code>èƒŒ    æ™¯</code>ï¼šè‡ªæ³¨æ„åŠ›æœºåˆ¶æ˜¯ä¸€ç§åœ¨åºåˆ—ä¸­è®¡ç®—æ¯ä¸ªä½ç½®ä¸å…¶ä»–ä½ç½®çš„å…³è”æ€§çš„æ–¹æ³•ï¼Œé€šè¿‡è®¡ç®—æ¯ä¸ªä½ç½®ä¸å…¶ä»–ä½ç½®çš„<code>ç›¸ä¼¼åº¦</code>å¾—åˆ°ä¸€ä¸ªæƒé‡å‘é‡ï¼Œç”¨äºåŠ æƒæ±‚å’Œå¾—åˆ°æ¯ä¸ªä½ç½®çš„è¡¨ç¤ºã€‚<br><code>ä¸»è¦è´¡çŒ®</code>ï¼š<code>MQA</code>åˆ™æ˜¯åœ¨è®¡ç®—ç›¸ä¼¼åº¦æ—¶<code>å¼•å…¥äº†å¤šä¸ªå¤´éƒ¨ï¼Œæ¯ä¸ªå¤´éƒ¨è®¡ç®—ä¸€ç§ä¸åŒçš„ç›¸ä¼¼åº¦</code>ã€‚<br><code>ç›®    çš„</code>ï¼š<br>1ã€é€šè¿‡å¼•å…¥å¤šä¸ªå¤´éƒ¨ï¼Œå¯ä»¥æ•æ‰åˆ°ä¸åŒçš„å…³ç³»å’Œè¯­ä¹‰ä¿¡æ¯ï¼Œæé«˜æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚<br>2ã€æé«˜æ¨¡å‹åœ¨å¤„ç†<code>åºåˆ—æ•°æ®</code>æ—¶çš„æ€§èƒ½ã€‚</p><h3 id="Flash-Attention"><a href="#Flash-Attention" class="headerlink" title="Flash Attention"></a><code>Flash Attention</code></h3><p><code>æ€»    ç»“</code>ï¼š<code>Flash Attention</code>æ˜¯ä¸€ç§æ³¨æ„åŠ›æœºåˆ¶ï¼Œé€šè¿‡å¼•å…¥å…¨å±€ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œèƒ½å¤Ÿæ›´å…¨é¢åœ°æ•æ‰åºåˆ—æ•°æ®ä¸­çš„ä¾èµ–å…³ç³»ï¼Œç”¨äºæé«˜ç¥ç»ç½‘ç»œåœ¨å¤„ç†åºåˆ—æ•°æ®æ—¶çš„æ€§èƒ½ã€‚</p><p><code>èƒŒ    æ™¯</code>ï¼šåœ¨åºåˆ—æ•°æ®ä¸­ï¼Œæ¯ä¸ªå…ƒç´ éƒ½ä¸å…¶å‘¨å›´çš„å…ƒç´ ç›¸å…³è”ï¼Œè€Œä¼ ç»Ÿçš„æ³¨æ„åŠ›æœºåˆ¶é€šå¸¸<code>åªè€ƒè™‘äº†å…ƒç´ ä¹‹é—´çš„å±€éƒ¨å…³ç³»</code>ã€‚<br><code>ä¸»è¦è´¡çŒ®</code>ï¼šé€šè¿‡å¼•å…¥<code>å…¨å±€ä¸Šä¸‹æ–‡ä¿¡æ¯</code>ï¼Œèƒ½å¤Ÿæ›´å…¨é¢åœ°æ•æ‰åºåˆ—æ•°æ®ä¸­çš„ä¾èµ–å…³ç³»ã€‚<br><code>å…·ä½“åšæ³•</code>ï¼š<br>1ã€é€šè¿‡å°†åºåˆ—æ•°æ®åˆ†ä¸ºå¤šä¸ªå­åºåˆ—ï¼Œæ¯ä¸ªå­åºåˆ—éƒ½åŒ…å«äº†åŸå§‹åºåˆ—æ•°æ®çš„ä¸€éƒ¨åˆ†ã€‚<br>2ã€ç„¶åï¼Œæ¯ä¸ªå­åºåˆ—éƒ½ä¼šä¸å…¶ä»–å­åºåˆ—è¿›è¡Œ<code>äº¤äº’</code>ï¼Œä»¥è·å–å…¨å±€ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚è¿™ç§äº¤äº’å¯ä»¥é€šè¿‡ä¸åŒçš„æ–¹å¼å®ç°ï¼Œä¾‹å¦‚è®¡ç®—å­åºåˆ—ä¹‹é—´çš„ç›¸ä¼¼åº¦å¾—åˆ†ï¼Œç„¶åæ ¹æ®å¾—åˆ†æ¥å†³å®šä¿¡æ¯çš„ä¼ é€’ç¨‹åº¦ã€‚<br><code>ç›®    çš„</code>ï¼š1ã€æ•æ‰åºåˆ—æ•°æ®ä¸­çš„ä¾èµ–å…³ç³» 2ã€æé«˜ç¥ç»ç½‘ç»œåœ¨å¤„ç†åºåˆ—æ•°æ®æ—¶çš„æ€§èƒ½<br><code>è®º    æ–‡</code>: <a href="https://arxiv.org/abs/2205.14135"><code>FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness</code></a><br><code>è®ºæ–‡æ€»ç»“</code>:<br>è¿™æ®µå†…å®¹è®¨è®ºäº†Transformeræ¨¡å‹åœ¨å¤„ç†é•¿åºåˆ—æ—¶çš„é€Ÿåº¦å’Œå†…å­˜æ¶ˆè€—é—®é¢˜ã€‚ç”±äºè‡ªæ³¨æ„åŠ›æœºåˆ¶çš„æ—¶é—´å’Œå†…å­˜å¤æ‚åº¦ä¸åºåˆ—é•¿åº¦çš„å¹³æ–¹æˆæ­£æ¯”ï¼Œå› æ­¤Transformeråœ¨é•¿åºåˆ—ä¸Šè¿è¡Œå¾—æ¯”è¾ƒæ…¢ä¸”æ¶ˆè€—å¤§é‡å†…å­˜ã€‚è¿‘ä¼¼æ³¨æ„åŠ›æ–¹æ³•è¯•å›¾é€šè¿‡åœ¨æ¨¡å‹è´¨é‡å’Œè®¡ç®—å¤æ‚åº¦ä¹‹é—´è¿›è¡Œæƒè¡¡æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†é€šå¸¸ä¸èƒ½å®ç°æ˜¾è‘—çš„é€Ÿåº¦æå‡ã€‚ä½œè€…è®¤ä¸ºä¸€ä¸ªç¼ºå¤±çš„åŸåˆ™æ˜¯ä½¿æ³¨æ„åŠ›ç®—æ³•èƒ½å¤Ÿè€ƒè™‘è¾“å…¥è¾“å‡º(I/O)æ“ä½œï¼Œå³åœ¨ä¸åŒå±‚çº§çš„GPUå†…å­˜ä¹‹é—´è¿›è¡Œè¯»å†™æ“ä½œã€‚ä½œè€…æå‡ºäº†ä¸€ç§åä¸ºFlashAttentionçš„I/Oæ„ŸçŸ¥ç²¾ç¡®æ³¨æ„åŠ›ç®—æ³•ï¼Œä½¿ç”¨åˆ†å—æŠ€æœ¯æ¥å‡å°‘GPUé«˜å¸¦å®½å†…å­˜(HBM)å’ŒGPUç‰‡ä¸Šé™æ€éšæœºå­˜å‚¨å™¨(SRAM)ä¹‹é—´çš„å†…å­˜è¯»å†™æ¬¡æ•°ã€‚ä½œè€…åˆ†æäº†FlashAttentionçš„I/Oå¤æ‚åº¦ï¼Œè¡¨æ˜å®ƒéœ€è¦æ¯”æ ‡å‡†æ³¨æ„åŠ›æ›´å°‘çš„HBMè®¿é—®æ¬¡æ•°ï¼Œå¹¶ä¸”å¯¹äºä¸€å®šå¤§å°çš„SRAMæ˜¯æœ€ä¼˜çš„ã€‚ä½œè€…è¿˜å°†FlashAttentionæ‰©å±•åˆ°äº†å—ç¨€ç–æ³¨æ„åŠ›ï¼Œå¾—åˆ°äº†ä¸€ç§æ¯”ä»»ä½•ç°æœ‰çš„è¿‘ä¼¼æ³¨æ„åŠ›ç®—æ³•æ›´å¿«çš„è¿‘ä¼¼æ³¨æ„åŠ›ç®—æ³•ã€‚FlashAttentionåœ¨è®­ç»ƒTransformeræ¨¡å‹æ–¹é¢è¡¨ç°æ¯”ç°æœ‰åŸºå‡†æ›´å¿«ï¼šç›¸è¾ƒäºMLPerf 1.1è®­ç»ƒé€Ÿåº¦è®°å½•ï¼ŒBERT-large (seq. length 512)çš„ç«¯åˆ°ç«¯å¢™æ—¶é’Ÿé€Ÿåº¦æå‡äº†15%ï¼ŒGPT-2 (seq. length 1K)çš„é€Ÿåº¦æå‡äº†3å€ï¼Œé•¿è·ç¦»ç«æŠ€åœº (seq. length 1K-4K)çš„é€Ÿåº¦æå‡äº†2.4å€ã€‚FlashAttentionå’Œå—ç¨€ç–FlashAttentionä½¿å¾—Transformeræ¨¡å‹å¯ä»¥å¤„ç†æ›´é•¿çš„ä¸Šä¸‹æ–‡ï¼Œä»è€Œå¾—åˆ°æ›´é«˜è´¨é‡çš„æ¨¡å‹(GPT-2 perplexityæé«˜äº†0.7ï¼Œé•¿æ–‡æ¡£åˆ†ç±»è¾¾åˆ°äº†6.4ä¸ªç‚¹çš„æå‡)ï¼Œå¹¶ä¸”å®ç°äº†å…¨æ–°çš„èƒ½åŠ›ï¼šåœ¨Path-XæŒ‘æˆ˜èµ›ä¸Šï¼Œå®ƒæ˜¯é¦–ä¸ªåœ¨åºåˆ—é•¿åº¦ä¸º16Kæ—¶è¾¾åˆ°è¶…è¿‡éšæœºçŒœæµ‹å‡†ç¡®ç‡çš„Transformeræ¨¡å‹(61.4%å‡†ç¡®ç‡)ï¼Œåœ¨Path-256æŒ‘æˆ˜èµ›ä¸Šï¼Œåˆ™æ˜¯åºåˆ—é•¿åº¦ä¸º64Kæ—¶è·å¾—è¶…è¿‡éšæœºçŒœæµ‹å‡†ç¡®ç‡çš„é¦–ä¸ªTransformeræ¨¡å‹(63.1%å‡†ç¡®ç‡)ã€‚</p><h3 id="ALiBiçš„position-embedding"><a href="#ALiBiçš„position-embedding" class="headerlink" title="ALiBiçš„position embedding"></a><code>ALiBiçš„position embedding<code></code></code></h3><p>ALiBiæ˜¯é˜¿é‡Œå·´å·´å¼€å‘çš„ä¸€ä¸ªè‡ªç„¶è¯­è¨€å¤„ç†æ¨¡å‹ï¼Œå®ƒåœ¨Transformeræ¨¡å‹ä¸­ä½¿ç”¨äº†position embeddingæ¥ç¼–ç è¾“å…¥åºåˆ—ä¸­æ¯ä¸ªå•è¯çš„ä½ç½®ä¿¡æ¯ã€‚</p><p>åœ¨Transformeræ¨¡å‹ä¸­ï¼Œè¾“å…¥åºåˆ—çš„æ¯ä¸ªå•è¯éƒ½ä¼šç»è¿‡ä¸€ä¸ªembeddingå±‚è¿›è¡Œç¼–ç ï¼Œå°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªå›ºå®šç»´åº¦çš„å‘é‡è¡¨ç¤ºã€‚ç„¶è€Œï¼Œç”±äºTransformeræ¨¡å‹æ˜¯åŸºäºæ³¨æ„åŠ›æœºåˆ¶çš„ï¼Œå®ƒå¹¶æ²¡æœ‰å¯¹è¾“å…¥åºåˆ—çš„é¡ºåºè¿›è¡Œå»ºæ¨¡ã€‚ä¸ºäº†å¼•å…¥ä½ç½®ä¿¡æ¯ï¼ŒTransformeræ¨¡å‹å¼•å…¥äº†position embeddingã€‚</p><p>position embeddingæ˜¯ä¸€ä¸ªä¸è¾“å…¥åºåˆ—çš„ä½ç½®ç›¸å…³çš„å‘é‡ã€‚å®ƒçš„ç»´åº¦ä¸å•è¯çš„embeddingç»´åº¦ç›¸åŒï¼Œä½†æ˜¯æ¯ä¸ªä½ç½®ä¸Šçš„å€¼æ˜¯ä¸åŒçš„ã€‚é€šè¿‡å°†position embeddingä¸å•è¯çš„embeddingç›¸åŠ ï¼Œå¯ä»¥å°†ä½ç½®ä¿¡æ¯èå…¥åˆ°è¾“å…¥å‘é‡ä¸­ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œposition embeddingæ˜¯é€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„çŸ©é˜µè¿›è¡Œè®¡ç®—å¾—åˆ°çš„ã€‚è¿™ä¸ªçŸ©é˜µçš„ç»´åº¦æ˜¯(positions, embedding_dim)ï¼Œå…¶ä¸­positionsè¡¨ç¤ºè¾“å…¥åºåˆ—çš„æœ€å¤§é•¿åº¦ï¼Œembedding_dimè¡¨ç¤ºå•è¯embeddingçš„ç»´åº¦ã€‚çŸ©é˜µä¸­çš„æ¯ä¸€è¡Œå¯¹åº”ä¸€ä¸ªä½ç½®ï¼Œæ¯ä¸€åˆ—å¯¹åº”embeddingå‘é‡çš„ä¸€ä¸ªç»´åº¦ã€‚é€šè¿‡æŸ¥è¡¨çš„æ–¹å¼ï¼Œå¯ä»¥è·å–åˆ°è¾“å…¥åºåˆ—ä¸­æ¯ä¸ªå•è¯çš„ä½ç½®ç¼–ç ã€‚</p><p>åœ¨ALiBiä¸­ï¼Œposition embeddingä¼šä¸å•è¯çš„embeddingç›¸åŠ ï¼Œç„¶åä½œä¸ºè¾“å…¥ä¼ é€’ç»™Transformeræ¨¡å‹ã€‚è¿™æ ·ï¼ŒTransformeræ¨¡å‹å°±èƒ½å¤ŸåŒæ—¶è€ƒè™‘åˆ°å•è¯çš„è¯­ä¹‰ä¿¡æ¯å’Œä½ç½®ä¿¡æ¯ï¼Œä»è€Œæ›´å¥½åœ°ç†è§£è¾“å…¥åºåˆ—ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NLP </category>
          
          <category> LLM </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>LC931. ä¸‹é™è·¯å¾„æœ€å°å’Œ</title>
      <link href="/post/LC931.html"/>
      <url>/post/LC931.html</url>
      
        <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ª <code>n x n</code> çš„<strong> æ–¹å½¢ </strong>æ•´æ•°æ•°ç»„&nbsp;<code>matrix</code> ï¼Œè¯·ä½ æ‰¾å‡ºå¹¶è¿”å›é€šè¿‡ <code>matrix</code> çš„<strong>ä¸‹é™è·¯å¾„</strong><em> </em>çš„<strong> </strong><strong>æœ€å°å’Œ</strong> ã€‚</p><p><strong>ä¸‹é™è·¯å¾„</strong> å¯ä»¥ä»ç¬¬ä¸€è¡Œä¸­çš„ä»»ä½•å…ƒç´ å¼€å§‹ï¼Œå¹¶ä»æ¯ä¸€è¡Œä¸­é€‰æ‹©ä¸€ä¸ªå…ƒç´ ã€‚åœ¨ä¸‹ä¸€è¡Œé€‰æ‹©çš„å…ƒç´ å’Œå½“å‰è¡Œæ‰€é€‰å…ƒç´ æœ€å¤šç›¸éš”ä¸€åˆ—ï¼ˆå³ä½äºæ­£ä¸‹æ–¹æˆ–è€…æ²¿å¯¹è§’çº¿å‘å·¦æˆ–è€…å‘å³çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚å…·ä½“æ¥è¯´ï¼Œä½ç½® <code>(row, col)</code> çš„ä¸‹ä¸€ä¸ªå…ƒç´ åº”å½“æ˜¯ <code>(row + 1, col - 1)</code>ã€<code>(row + 1, col)</code> æˆ–è€… <code>(row + 1, col + 1)</code> ã€‚</p><p>&nbsp;</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img alt src="https://assets.leetcode.com/uploads/2021/11/03/failing1-grid.jpg" style="height: 500px; width: 499px;"></p><pre><strong>è¾“å…¥ï¼š</strong>matrix = [[2,1,3],[6,5,4],[7,8,9]]<strong>è¾“å‡ºï¼š</strong>13<strong>è§£é‡Šï¼š</strong>å¦‚å›¾æ‰€ç¤ºï¼Œä¸ºå’Œæœ€å°çš„ä¸¤æ¡ä¸‹é™è·¯å¾„</pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img alt src="https://assets.leetcode.com/uploads/2021/11/03/failing2-grid.jpg" style="height: 365px; width: 164px;"></p><pre><strong>è¾“å…¥ï¼š</strong>matrix = [[-19,57],[-40,-5]]<strong>è¾“å‡ºï¼š</strong>-59<strong>è§£é‡Šï¼š</strong>å¦‚å›¾æ‰€ç¤ºï¼Œä¸ºå’Œæœ€å°çš„ä¸‹é™è·¯å¾„</pre><p>&nbsp;</p><p><strong>æç¤ºï¼š</strong></p><ul>    <li><code>n == matrix.length == matrix[i].length</code></li>    <li><code>1 &lt;= n &lt;= 100</code></li>    <li><code>-100 &lt;= matrix[i][j] &lt;= 100</code></li></ul><h2 id="æ€è·¯åˆ†æ"><a href="#æ€è·¯åˆ†æ" class="headerlink" title="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ</h2><p>æ ‡å‡†çš„<code>å¤šç‚¹dfs</code>æˆ–è€…<code>äºŒç»´dp</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="comment"># å¤šç‚¹dfs</span></span><br><span class="line">    <span class="comment"># è‡ªä¸Šè€Œä¸‹ã€è‡ªä¸‹è€Œä¸Šéƒ½å¯ä»¥ + è®°å¿†åŒ–æœç´¢</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">minFallingPathSum</span>(<span class="params">self, matrix: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        </span><br><span class="line"><span class="meta">        @cache</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">x,y</span>):</span><br><span class="line">            ans = matrix[x][y]</span><br><span class="line">            <span class="keyword">if</span> x == n-<span class="number">1</span> :</span><br><span class="line">                <span class="keyword">return</span> ans</span><br><span class="line">            res = inf</span><br><span class="line">            <span class="keyword">for</span> dy <span class="keyword">in</span> <span class="built_in">range</span>(y-<span class="number">1</span>,y+<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">if</span> dy &gt;= <span class="number">0</span> <span class="keyword">and</span> dy &lt;= n-<span class="number">1</span>:</span><br><span class="line">                    res = <span class="built_in">min</span>(res,dfs(x+<span class="number">1</span>,dy))</span><br><span class="line">            <span class="keyword">return</span>  ans+res</span><br><span class="line"></span><br><span class="line">        mi = inf </span><br><span class="line">        n = <span class="built_in">len</span>(matrix)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            <span class="comment"># ä»ç¬¬ä¸€è¡Œè¿›è¡Œdfs</span></span><br><span class="line">            mi = <span class="built_in">min</span>(mi,dfs(<span class="number">0</span>,i))</span><br><span class="line">        <span class="keyword">return</span> mi</span><br></pre></td></tr></table></figure></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">minFallingPathSum</span>(<span class="params">self, matrix: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="comment">#æ»šåŠ¨æ•°ç»„ ä¹Ÿå¯ä»¥äºŒç»´æ•°ç»„</span></span><br><span class="line">        n = <span class="built_in">len</span>(matrix)</span><br><span class="line">        dp = [[<span class="number">0</span>]*n <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">        <span class="comment"># dp = [[0]*n for i in range(n)]</span></span><br><span class="line">        dp[<span class="number">0</span>] = [x <span class="keyword">for</span> x <span class="keyword">in</span> matrix[<span class="number">0</span>]]</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">                res = inf</span><br><span class="line">                <span class="keyword">if</span> y-<span class="number">1</span> &gt;= <span class="number">0</span>:</span><br><span class="line">                    res = <span class="built_in">min</span>(res,dp[<span class="number">0</span>][y-<span class="number">1</span>])</span><br><span class="line">                <span class="keyword">if</span> y+<span class="number">1</span> &lt; n:</span><br><span class="line">                    res = <span class="built_in">min</span>(res,dp[<span class="number">0</span>][y+<span class="number">1</span>])</span><br><span class="line">                res = <span class="built_in">min</span>(res,dp[<span class="number">0</span>][y])</span><br><span class="line">                dp[<span class="number">1</span>][y] = res + matrix[x][y]</span><br><span class="line">            dp = [dp[<span class="number">1</span>],[<span class="number">0</span>]*n]</span><br><span class="line">            <span class="comment"># æ»šåŠ¨æ•°ç»„éœ€è¦é‡å¤åˆ©ç”¨ç©ºé—´</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(dp[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><h2 id="å®˜è§£"><a href="#å®˜è§£" class="headerlink" title="å®˜è§£"></a><a href="https://leetcode.cn/problems/minimum-falling-path-sum/solution/xia-jiang-lu-jing-zui-xiao-he-by-leetcod-vyww/">å®˜è§£</a></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">minFallingPathSum</span>(<span class="params">self, matrix: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        dp = [matrix[<span class="number">0</span>]]</span><br><span class="line">        n = <span class="built_in">len</span>(matrix)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">            cur = [<span class="number">0</span>] * n</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">                mn = dp[-<span class="number">1</span>][j]</span><br><span class="line">                <span class="keyword">if</span> j &gt; <span class="number">0</span>:</span><br><span class="line">                    mn = <span class="built_in">min</span>(mn, dp[-<span class="number">1</span>][j - <span class="number">1</span>])</span><br><span class="line">                <span class="keyword">if</span> j &lt; n - <span class="number">1</span>:</span><br><span class="line">                    mn = <span class="built_in">min</span>(mn, dp[-<span class="number">1</span>][j + <span class="number">1</span>])</span><br><span class="line">                cur[j] = mn + matrix[i][j]</span><br><span class="line">            dp.append(cur)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(dp[-<span class="number">1</span>])</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚åº¦åˆ†æ"><a href="#å¤æ‚åº¦åˆ†æ" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>æ—¶é—´å¤æ‚åº¦ï¼šO(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.345ex" height="1.912ex" role="img" focusable="false" viewbox="0 -833.9 1036.6 844.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-8-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-8-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-8-TEX-I-1D45B"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-8-TEX-N-32"/></g></g></g></g></g></svg></mjx-container>)ï¼Œéœ€è¦è®¡ç®—æ¯ä¸ªåæ ‡çš„å’Œæœ€å°ä¸‹é™è·¯å¾„ã€‚<br>ç©ºé—´å¤æ‚åº¦ï¼šO(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.345ex" height="1.912ex" role="img" focusable="false" viewbox="0 -833.9 1036.6 844.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-5-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-5-TEX-I-1D45B"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-5-TEX-N-32"/></g></g></g></g></g></svg></mjx-container>)ï¼Œéœ€è¦è®°å½•æ¯ä¸ªåæ ‡çš„å’Œæœ€å°ä¸‹é™è·¯å¾„ã€‚<br>å› ä¸ºæ¯ä¸ªåæ ‡çš„å’Œæœ€å°ä¸‹é™è·¯å¾„ä»…ä¸ä¸Šä¸€è¡Œæœ‰å…³ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„ï¼Œä½¿å¾—ç©ºé—´å¤æ‚åº¦é™ä½ä¸º O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-4-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-4-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>)ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> LeetCode-medium </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯æ—¥ä¸€é¢˜ </tag>
            
            <tag> LCå‘¨èµ›Q3 </tag>
            
            <tag> LeetCode1500 </tag>
            
            <tag> äºŒç»´dp </tag>
            
            <tag> å¤šç‚¹dfs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo Blogå®ç”¨å·¥å…·</title>
      <link href="/post/d2b8e29c.html"/>
      <url>/post/d2b8e29c.html</url>
      
        <content type="html"><![CDATA[<h2 id="å°†ç½‘é¡µè½¬æ¢ä¸ºMarkdownçš„æ–¹æ³•-2023-07-12"><a href="#å°†ç½‘é¡µè½¬æ¢ä¸ºMarkdownçš„æ–¹æ³•-2023-07-12" class="headerlink" title="å°†ç½‘é¡µè½¬æ¢ä¸ºMarkdownçš„æ–¹æ³• (2023.07.12)"></a>å°†ç½‘é¡µè½¬æ¢ä¸º<code>Markdown</code>çš„æ–¹æ³• (2023.07.12)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://zhuanlan.zhihu.com/p/637848680">å°†HTMLç½‘é¡µè½¬æ¢ä¸ºMarkdownæ ¼å¼çš„å·¥å…·åŠæ–¹æ³•</a><br><a href="https://microsoftedge.microsoft.com/addons/detail/markdownload-markdown-w/hajanaajapkhaabfcofdjgjnlgkdkknm">edgeæ‰©å±•åœ°å€</a><br><a href="https://products.aspose.app/html/zh/conversion/html-to-md">HTML åˆ° Markdown è½¬æ¢å™¨(ä¸å¤ªå®ç”¨)</a></p><h2 id="Markdown-åœ¨çº¿ç¼–è¾‘å™¨-2023-07-12"><a href="#Markdown-åœ¨çº¿ç¼–è¾‘å™¨-2023-07-12" class="headerlink" title="Markdown åœ¨çº¿ç¼–è¾‘å™¨ (2023.07.12)"></a><code>Markdown</code> åœ¨çº¿ç¼–è¾‘å™¨ (2023.07.12)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://c.runoob.com/front-end/712/">Markdown åœ¨çº¿ç¼–è¾‘å™¨</a></p><h2 id="Markdown-æ’å…¥pdf-2023-07-15"><a href="#Markdown-æ’å…¥pdf-2023-07-15" class="headerlink" title="Markdown æ’å…¥pdf (2023.07.15)"></a><code>Markdown</code> æ’å…¥<code>pdf</code> (2023.07.15)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://zhuanlan.zhihu.com/p/550626417">å‘hexoä¸­æ’å…¥PDF</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>002 å¤§æ¨¡å‹LLM-å¾®è°ƒç»éªŒåˆ†äº«&amp;æ€»ç»“-çŸ¥ä¹-åˆ˜èªNLP</title>
      <link href="/post/nlp002.html"/>
      <url>/post/nlp002.html</url>
      
        <content type="html"><![CDATA[<h2 id="è½¬è½½"><a href="#è½¬è½½" class="headerlink" title="è½¬è½½"></a><strong>è½¬è½½</strong></h2><p>æœ¬æ–‡è½¬è½½äºï¼š<a href="https://zhuanlan.zhihu.com/p/620885226">@çŸ¥ä¹-åˆ˜èªNLP</a></p><h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a><strong>å†™åœ¨å‰é¢</strong></h2><p>å¤§å‹è¯­è¨€æ¨¡å‹æ¨ªè¡Œï¼Œä¹‹å‰éå¸¸ç„¦è™‘ï¼Œç°åœ¨å…¨é¢æ‹¥æŠ±ã€‚ç›®å‰ä¹Ÿæœ‰å¾ˆå¤šå¼€æºé¡¹ç›®è¿›è¡Œå¤§æ¨¡å‹å¾®è°ƒç­‰ï¼Œç¬”è€…ä¹Ÿåšäº†ä¸€é˜µå­å¤§æ¨¡å‹äº†ï¼Œç‰¹æ­¤æ¥ä»‹ç»ä¸€ä¸‹<code>ChatGLM-6B</code>æ¨¡å‹å¾®è°ƒç»éªŒï¼Œå¹¶æ±‡æ€»äº†ä¸€ä¸‹ç›®å‰å¼€æºé¡¹ç›®&amp;æ•°æ®ã€‚ç¬”è€…ä¸å¾ˆå¤šäººå¾®è°ƒç»“è®ºä¸åŒï¼Œæœ¬äººåœ¨é‡‡ç”¨å•æŒ‡ä»¤ä¸Šè¿›è¡Œæ¨¡å‹å¾®è°ƒï¼Œå‘ç°æ¨¡å‹å¾®è°ƒä¹‹åï¼Œ<strong>ã€Œå¹¶æ²¡æœ‰å‡ºç°ç¾éš¾æ€§é—å¿˜ç°è±¡ã€</strong>ã€‚</p><h2 id="ChatGLM-6Bæ¨¡å‹å¾®è°ƒ-å…³ç³»æŠ½å–"><a href="#ChatGLM-6Bæ¨¡å‹å¾®è°ƒ-å…³ç³»æŠ½å–" class="headerlink" title="ChatGLM-6Bæ¨¡å‹å¾®è°ƒ(å…³ç³»æŠ½å–)"></a><strong><code>ChatGLM-6B</code>æ¨¡å‹å¾®è°ƒ(å…³ç³»æŠ½å–)</strong></h2><p>æ¨¡å‹è¶Šå¤§å¯¹æ˜¾å¡çš„è¦æ±‚è¶Šé«˜ï¼Œç›®å‰ä¸»æµå¯¹å¤§æ¨¡å‹è¿›è¡Œå¾®è°ƒæ–¹æ³•æœ‰ä¸‰ç§ï¼š<code>Freezeæ–¹æ³•</code>ã€<code>P-Tuningæ–¹æ³•</code>å’Œ<code>Lora</code>æ–¹æ³•ã€‚ç¬”è€…ä¹Ÿé€šè¿‡è¿™ä¸‰ç§æ–¹æ³•ï¼Œåœ¨ä¿¡æ¯æŠ½å–ä»»åŠ¡ä¸Šï¼Œå¯¹<code>ChatGLM-6B</code>å¤§æ¨¡å‹è¿›è¡Œæ¨¡å‹å¾®è°ƒã€‚ä¸ºäº†é˜²æ­¢å¤§æ¨¡å‹çš„æ•°æ®æ³„éœ²ï¼Œé‡‡ç”¨ä¸€ä¸ªé¢†åŸŸæ¯”èµ›æ•°æ®é›†-<a href="https://link.zhihu.com/?target=https%3A//www.datafountain.cn/competitions/584">æ±½è½¦å·¥ä¸šæ•…éšœæ¨¡å¼å…³ç³»æŠ½å–</a>ï¼ŒéšæœºæŠ½å–50æ¡ä½œä¸ºæµ‹è¯•é›†ã€‚</p><p>è¯¦ç»†ä»£ç è§ä¸Šé¢çš„<code>GitHub</code>é“¾æ¥ï¼Œå¹¶ä¸”ä¹Ÿè¢«<code>ChatGLM</code>å®˜æ–¹æ”¶å½•ã€‚</p><p><img src="https://pic4.zhimg.com/v2-f048824d8732efb7bc97b27996d88f03_b.jpg" alt></p><h3 id="Freezeæ–¹æ³•"><a href="#Freezeæ–¹æ³•" class="headerlink" title="Freezeæ–¹æ³•"></a><strong><code>Freezeæ–¹æ³•</code></strong></h3><p><code>Freezeæ–¹æ³•</code>ï¼Œå³å‚æ•°å†»ç»“ï¼Œå¯¹åŸå§‹æ¨¡å‹éƒ¨åˆ†å‚æ•°è¿›è¡Œå†»ç»“æ“ä½œï¼Œä»…è®­ç»ƒéƒ¨åˆ†å‚æ•°ï¼Œä»¥è¾¾åˆ°åœ¨å•å¡æˆ–ä¸è¿›è¡ŒTPæˆ–PPæ“ä½œï¼Œå°±å¯ä»¥å¯¹å¤§æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚</p><p>å¾®è°ƒä»£ç ï¼Œè§<code>finetuning_freeze.py</code>ï¼Œæ ¸å¿ƒéƒ¨åˆ†å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> name, param <span class="keyword">in</span> model.named_parameters():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>(nd <span class="keyword">in</span> name <span class="keyword">for</span> nd <span class="keyword">in</span> [<span class="string">&quot;layers.27&quot;</span>, \</span><br><span class="line">        <span class="string">&quot;layers.26&quot;</span>, <span class="string">&quot;layers.25&quot;</span>, <span class="string">&quot;layers.24&quot;</span>, <span class="string">&quot;layers.23&quot;</span>]):</span><br><span class="line">        param.requires_grad = <span class="literal">False</span></span><br></pre></td></tr></table></figure><p>é’ˆå¯¹æ¨¡å‹ä¸åŒå±‚è¿›è¡Œä¿®æ”¹ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹ã€‚è®­ç»ƒä»£ç å‡é‡‡ç”¨<code>DeepSpeed</code>è¿›è¡Œè®­ç»ƒï¼Œå¯è®¾ç½®å‚æ•°åŒ…å«train_pathã€model_dirã€num_train_epochsã€train_batch_sizeã€gradient_accumulation_stepsã€output_dirã€prompt_textç­‰ï¼Œå¯æ ¹æ®è‡ªå·±çš„ä»»åŠ¡é…ç½®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CUDA_VISIBLE_DEVICES=0 DeepSpeed finetuning_freeze.py --num_train_epochs 5 </span><br><span class="line">    --train_batch_size 2</span><br></pre></td></tr></table></figure><p>ä¸‰å…ƒç»„æŠ½å–çš„æ¨ç†ä»£ç ï¼Œè§<code>predict_freeze.py</code>ï¼Œå…¶ä»–ä»»åŠ¡å¯ä»¥æ ¹æ®è‡ªå·±çš„è¯„ä»·æ ‡å‡†è¿›è¡Œæ¨ç†é¢„æµ‹ã€‚</p><h3 id="P-Tuningæ–¹æ³•"><a href="#P-Tuningæ–¹æ³•" class="headerlink" title="P-Tuningæ–¹æ³•"></a><strong>P-Tuningæ–¹æ³•</strong></h3><p><code>P-Tuningæ–¹æ³•</code>ï¼Œå‚è€ƒ<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/THUDM/&lt;code&gt;ChatGLM-6B&lt;/code&gt;/blob/main/ptuning/README.md">ChatGLMå®˜æ–¹ä»£ç </a> ï¼Œæ˜¯ä¸€ç§é’ˆå¯¹äºå¤§æ¨¡å‹çš„<a href="#ä¸“æœ‰åè¯è§£é‡Š"><code>soft-prompt[1]</code></a>æ–¹æ³•ã€‚</p><p><img src="https://pic2.zhimg.com/v2-0906021c2338dfe9c60de250c3965a55_b.jpg" alt></p><ul><li><a href="https://link.zhihu.com/?target=https%3A//arxiv.org/abs/2103.10385"><code>P-Tuning</code></a>ï¼Œä»…å¯¹å¤§æ¨¡å‹çš„<code>Embedding</code>åŠ å…¥æ–°çš„å‚æ•°ã€‚</li><li><a href="https://link.zhihu.com/?target=https%3A//arxiv.org/abs/2110.07602"><code>P-Tuning-V2</code></a>ï¼Œå°†å¤§æ¨¡å‹çš„<code>Embedding</code>å’Œæ¯ä¸€å±‚å‰éƒ½åŠ ä¸Šæ–°çš„å‚æ•°ã€‚</li></ul><p>å¾®è°ƒä»£ç ï¼Œè§<code>finetuning_pt.py<code>ï¼Œæ ¸å¿ƒéƒ¨åˆ†å¦‚ä¸‹ï¼š</code></code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">config = ChatGLMConfig.from_pretrained(args.model_dir)</span><br><span class="line">config.pre_seq_len = args.pre_seq_len</span><br><span class="line">config.prefix_projection = args.prefix_projection</span><br><span class="line"></span><br><span class="line">model = ChatGLMForConditionalGeneration.from_pretrained(args.model_dir, config=config)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> name, param <span class="keyword">in</span> model.named_parameters():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">any</span>(nd <span class="keyword">in</span> name <span class="keyword">for</span> nd <span class="keyword">in</span> [<span class="string">&quot;prefix_encoder&quot;</span>]):</span><br><span class="line">        param.requires_grad = <span class="literal">False</span></span><br></pre></td></tr></table></figure><p>å½“prefix_projectionä¸ºTrue æ—¶ï¼Œä¸º<code>P-Tuning-V2</code>æ–¹æ³•ï¼Œåœ¨å¤§æ¨¡å‹çš„<code>Embedding</code>å’Œæ¯ä¸€å±‚å‰éƒ½åŠ ä¸Šæ–°çš„å‚æ•°ï¼›<br>å½“prefix_projectionä¸ºFalseæ—¶ï¼Œä¸º<code>P-Tuning</code>æ–¹æ³•ï¼Œ ä»…åœ¨å¤§æ¨¡å‹çš„<code>Embedding</code>ä¸Šæ–°çš„å‚æ•°ã€‚</p><p>å¯è®¾ç½®å‚æ•°åŒ…å«train_pathã€model_dirã€num_train_epochsã€train_batch_sizeã€gradient_accumulation_stepsã€output_dirã€prompt_textã€pre_seq_lenã€prompt_textç­‰ï¼Œ å¯æ ¹æ®è‡ªå·±çš„ä»»åŠ¡é…ç½®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CUDA_VISIBLE_DEVICES=0 DeepSpeed finetuning_pt.py --num_train_epochs 5 </span><br><span class="line">     --train_batch_size 2 --pre_seq_len 16</span><br></pre></td></tr></table></figure><p>ä¸‰å…ƒç»„æŠ½å–çš„æ¨ç†ä»£ç ï¼Œè§<code>predict_pt.py</code>ï¼Œå…¶ä»–ä»»åŠ¡å¯ä»¥æ ¹æ®è‡ªå·±çš„è¯„ä»·æ ‡å‡†è¿›è¡Œæ¨ç†é¢„æµ‹ã€‚</p><h3 id="Loraæ–¹æ³•"><a href="#Loraæ–¹æ³•" class="headerlink" title="Loraæ–¹æ³•"></a><strong><code>Lora</code>æ–¹æ³•</strong></h3><p><code>Lora</code>æ–¹æ³•ï¼Œå³åœ¨å¤§å‹è¯­è¨€æ¨¡å‹ä¸Šå¯¹æŒ‡å®šå‚æ•°å¢åŠ é¢å¤–çš„<code>ä½ç§©çŸ©é˜µ</code>ï¼Œå¹¶åœ¨æ¨¡å‹è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œä»…è®­ç»ƒè€Œå¤–å¢åŠ çš„å‚æ•°ã€‚å½“â€œç§©å€¼â€è¿œå°äºåŸå§‹å‚æ•°ç»´åº¦æ—¶ï¼Œæ–°å¢çš„ä½ç§©çŸ©é˜µå‚æ•°é‡å¾ˆå°ï¼Œè¾¾åˆ°ä»…è®­ç»ƒå¾ˆå°çš„å‚æ•°ï¼Œå°±èƒ½è·å–è¾ƒå¥½çš„ç»“æœã€‚</p><p><img src="https://pic1.zhimg.com/v2-e9965e231005d772d5ea5a6d2351fe60_b.jpg" alt></p><ul><li><code>Lora</code>è®ºæ–‡ï¼š<a href="https://link.zhihu.com/?target=https%3A//arxiv.org/abs/2106.09685">Paper</a></li><li>å®˜æ–¹ä»£ç ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/microsoft/&lt;code&gt;Lora&lt;/code"><code>GitHub</code></a></li><li>HuggingFaceå°è£…çš„peftåº“ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/huggingface/peft"><code>GitHub</code></a></li></ul><p>å¾®è°ƒä»£ç ï¼Œè§<code>finetuning_Lora</code>.pyï¼Œæ ¸å¿ƒéƒ¨åˆ†å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">model = ChatGLMForConditionalGeneration.from_pretrained(args.model_dir)</span><br><span class="line">config = LoraConfig(r=args.Lora_r,</span><br><span class="line">                    Lora_alpha=<span class="number">32</span>,</span><br><span class="line">                    target_modules=[<span class="string">&quot;query_key_value&quot;</span>],</span><br><span class="line">                    Lora_dropout=<span class="number">0.1</span>,</span><br><span class="line">                    bias=<span class="string">&quot;none&quot;</span>,</span><br><span class="line">                    task_type=<span class="string">&quot;CAUSAL_LM&quot;</span>,</span><br><span class="line">                    inference_mode=<span class="literal">False</span>,</span><br><span class="line">                    )</span><br><span class="line"></span><br><span class="line">model = get_peft_model(model, config)</span><br></pre></td></tr></table></figure><p>å¯è®¾ç½®å‚æ•°åŒ…å«train_pathã€model_dirã€num_train_epochsã€train_batch_sizeã€gradient_accumulation_stepsã€output_dirã€prompt_textã€Lora_rç­‰ï¼Œå¯æ ¹æ®è‡ªå·±çš„ä»»åŠ¡é…ç½®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CUDA_VISIBLE_DEVICES=0 DeepSpeed finetuning_Lora.py --num_train_epochs 5 </span><br><span class="line">    --train_batch_size 2 --Lora_r 8</span><br></pre></td></tr></table></figure><p>ä¸‰å…ƒç»„æŠ½å–çš„æ¨ç†ä»£ç ï¼Œè§<code>predict_Lora.py</code>ï¼Œå…¶ä»–ä»»åŠ¡å¯ä»¥æ ¹æ®è‡ªå·±çš„è¯„ä»·æ ‡å‡†è¿›è¡Œæ¨ç†é¢„æµ‹ã€‚</p><p>æ³¨æ„ï¼šå¯¹äºç»“æœéœ€è¦ä¿æŒä¸€è‡´çš„ä»»åŠ¡(å³å…³æ‰dropoutï¼Œè§£ç å…³æ‰do_sample)ï¼Œéœ€è¦ä¿å­˜æ¨¡å‹çš„adapter_config.jsonæ–‡ä»¶ä¸­ï¼Œinference_modeå‚æ•°ä¿®æ”¹æˆfalseï¼Œå¹¶å°†æ¨¡å‹æ‰§è¡Œmodel.eval()æ“ä½œã€‚ ä¸»è¦åŸå› æ˜¯chatglmæ¨¡å‹ä»£ç ä¸­ï¼Œæ²¡æœ‰é‡‡ç”¨Conv1Då‡½æ•°ã€‚</p><h2 id="å®éªŒæ–¹æ³•"><a href="#å®éªŒæ–¹æ³•" class="headerlink" title="å®éªŒæ–¹æ³•"></a><strong>å®éªŒæ–¹æ³•</strong></h2><h3 id="ä¸‰å…ƒç»„æŠ½å–"><a href="#ä¸‰å…ƒç»„æŠ½å–" class="headerlink" title="ä¸‰å…ƒç»„æŠ½å–"></a><strong>ä¸‰å…ƒç»„æŠ½å–</strong></h3><ul><li>æ¨¡å‹è®­ç»ƒæ—¶ï¼Œæœ€å¤§é•¿åº¦ä¸º768ï¼ŒBatchå¤§å°ä¸º2ï¼Œè®­ç»ƒè½®æ•°ä¸º5ï¼Œfp16è®­ç»ƒï¼Œé‡‡ç”¨<code>DeepSpeed</code>çš„<a href="#ä¸“æœ‰åè¯è§£é‡Š"><code>Zero-1[2]</code></a>è®­ç»ƒï¼›</li><li><code>P-Tuning V2</code>è®­ç»ƒæ–¹æ³•ï¼Œ<code>PT-Only-Embedding</code>è¡¨ç¤ºä»…å¯¹<code>Embedding</code>è¿›è¡Œ<code>soft-prompt</code>ï¼Œ<code>Freeze</code>ä»…è®­ç»ƒæ¨¡å‹åäº”å±‚å‚æ•°ï¼Œ<code>Lora</code>é‡‡ç”¨ä½ç§©çŸ©é˜µæ–¹æ³•è®­ç»ƒï¼Œç§©ä¸º<code>8</code>ï¼›</li><li>ç”±äºä¹‹å‰è®­ç»ƒPTåœ¨48G-A40æ˜¾å¡ä¸Šä¼šå‡ºç°<a href="#ä¸“æœ‰åè¯è§£é‡Š"><code>OOM[3]</code></a>ï¼Œå› æ­¤ä¹‹å‰è¿›è¡ŒPTå®éªŒæ—¶å¯¹æ¨¡å‹å¼€å¯äº†<a href="#ä¸“æœ‰åè¯è§£é‡Š"><code>gradient_checkpointing_enable[4]</code></a>ï¼Œä½¿å¾—æ¨¡å‹æ˜¾å­˜å ç”¨å˜å°ï¼Œä½†è®­ç»ƒæ—¶é•¿å¢åŠ ã€‚</li><li>è®­ç»ƒç¤ºä¾‹ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">prompt_textï¼šä½ ç°åœ¨æ˜¯ä¸€ä¸ªä¿¡æ¯æŠ½å–æ¨¡å‹ï¼Œè¯·ä½ å¸®æˆ‘æŠ½å–å‡ºå…³ç³»å†…å®¹ä¸º\&quot;æ€§èƒ½æ•…éšœ\&quot;, </span><br><span class="line">             \&quot;éƒ¨ä»¶æ•…éšœ\&quot;, \&quot;ç»„æˆ\&quot;å’Œ \&quot;æ£€æµ‹å·¥å…·\&quot;çš„ç›¸å…³ä¸‰å…ƒç»„ï¼Œ</span><br><span class="line">            ä¸‰å…ƒç»„å†…éƒ¨ç”¨\&quot;_\&quot;è¿æ¥ï¼Œä¸‰å…ƒç»„ä¹‹é—´ç”¨\\nåˆ†å‰²ã€‚æ–‡æœ¬ï¼š</span><br><span class="line">è¾“å…¥ï¼šæ•…éšœç°è±¡ï¼šå‘åŠ¨æœºæ°´æ¸©é«˜ï¼Œé£æ‰‡å§‹ç»ˆæ˜¯ä½é€Ÿè½¬åŠ¨ï¼Œé«˜é€Ÿæ¡£ä¸å·¥ä½œï¼Œå¼€ç©ºè°ƒå°¤å…¶å¦‚æ­¤ã€‚</span><br><span class="line">è¾“å‡ºï¼šå‘åŠ¨æœº_éƒ¨ä»¶æ•…éšœ_æ°´æ¸©é«˜\né£æ‰‡_éƒ¨ä»¶æ•…éšœ_ä½é€Ÿè½¬åŠ¨</span><br></pre></td></tr></table></figure><p>æ—¶é—´æ¢ç©ºé—´ï¼Œå¯ç”¨å¾ˆå¥½çš„è§£å†³æ˜¾å¡çš„èµ„æºé—®é¢˜ï¼Œç®€å•ç©ç©è¿˜å¯ä»¥ï¼Œå¦‚æœæƒ³è¦æ¨¡å‹è¾¾åˆ°æœ€ä¼˜æ•ˆæœæˆ–å¯ç”¨å¿«é€Ÿçœ‹åˆ°æ•ˆæœï¼Œè¿˜ä¸å¦‚ç§Ÿå¼ A100å¡ï¼Œå¿«é€Ÿå®éªŒï¼Œæ¨ç†é˜¶æ®µå†ç”¨è‡ªå·±çš„å°ç ´å¡ã€‚</p><p>ä¸‹é¢å®éªŒç»“æœå‡æ˜¯åœ¨ç§Ÿçš„80G-A100ä¸Šè¿›è¡Œçš„å®éªŒï¼Œä¸<code>GitHub</code>é‡Œç”¨çš„A40çš„å®éªŒç»“æœä¼šæœ‰äº›å·®å¼‚ï¼Œä¸»è¦åœ¨è®­ç»ƒæ—¶é•¿(çº¯è®­ç»ƒé€Ÿåº¦ï¼Œå‰”é™¤æ¨¡å‹ä¿å­˜çš„æ—¶é—´)ã€‚è¯´å®è¯ï¼ŒçœŸçš„è¦è®­ç»ƒä¸€ä¸ªå¤§æ¨¡å‹ï¼Œå¤šä¸ªA100æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå¯ä»¥å‡å°‘å¾ˆå¤šæ¨¡å‹å¹¶è¡Œçš„æ“ä½œï¼Œæ•ˆæœä¸Šä¹Ÿæ›´å¥½æŠŠæ§ä¸€äº›ã€‚</p><div class="table-container"><table><thead><tr><th style="text-align:center">å¾®è°ƒæ–¹æ³•</th><th style="text-align:center"><code>PT-Only-Embedding</code></th><th style="text-align:center"><code>P-Tuning V2</code></th><th style="text-align:center"><code>Freeze</code></th><th style="text-align:center"><code>Lora</code></th></tr></thead><tbody><tr><td style="text-align:center">æ˜¾å¡å ç”¨</td><td style="text-align:center">37G</td><td style="text-align:center">56G</td><td style="text-align:center">24G</td><td style="text-align:center">39G</td></tr><tr><td style="text-align:center">æ€»å‚æ•°</td><td style="text-align:center">6.259B</td><td style="text-align:center">7.211B</td><td style="text-align:center">6.255B</td><td style="text-align:center">6.259B</td></tr><tr><td style="text-align:center">å¯è®­ç»ƒå‚æ•°å æ¯”</td><td style="text-align:center">0.0586%</td><td style="text-align:center">13.26%</td><td style="text-align:center">16.10%</td><td style="text-align:center">0.0586%</td></tr><tr><td style="text-align:center">è®­ç»ƒè€—æ—¶</td><td style="text-align:center">20min</td><td style="text-align:center">52min</td><td style="text-align:center">46min</td><td style="text-align:center">25min</td></tr><tr><td style="text-align:center">æµ‹è¯•ç»“æœF1</td><td style="text-align:center">0.0</td><td style="text-align:center">0.6283</td><td style="text-align:center">0.5675</td><td style="text-align:center">0.5359</td></tr></tbody></table></div><p>ç»“æœåˆ†æï¼š</p><ul><li>æ•ˆæœä¸º<code>P-Tuning V2</code> &gt; <code>Freeze</code> &gt; <code>Lora</code> &gt; <code>PT-Only-Embedding</code>;</li><li>é€Ÿåº¦ä¸º<code>PT-Only-Embedding</code> &gt; <code>Lora</code> &gt; <code>Freeze</code> &gt; <code>P-Tuning V2</code>;</li><li><strong><code>PT-Only-Embedding</code>æ•ˆæœå¾ˆä¸ç†æƒ³ï¼Œå‘ç°åœ¨è®­ç»ƒæ—¶ï¼Œæœ€åçš„<code>loss</code>ä»…èƒ½æ”¶æ•›åˆ°2.å‡ ï¼Œè€Œå…¶ä»–æœºåˆ¶å¯ä»¥æ”¶æ•›åˆ°0.å‡ ã€‚åˆ†æåŸå› ä¸ºï¼Œè¾“å‡ºå†…å®¹å½¢å¼ä¸åŸæœ‰è¯­è¨€æ¨¡å‹ä»»åŠ¡ç›¸å·®å¾ˆå¤§ï¼Œä»…å¢åŠ é¢å¤–<code>Embedding</code>å‚æ•°ï¼Œä¸è¶³ä»¥æ”¹å˜å¤æ‚çš„ä¸‹æ¸¸ä»»åŠ¡</strong>;</li><li><code>P-Tuning V2</code>æ–¹æ³•å ç”¨æ˜¾å­˜æ›´å¤§ï¼Œå› ä¸ºä¹Ÿå¢åŠ äº†å¾ˆå¤šè€Œå¤–å‚æ•°;</li><li>æµ‹è¯•è€—æ—¶ï¼Œé‡‡ç”¨float16è¿›è¡Œæ¨¡å‹æ¨ç†ï¼Œç”±äºå…¶ä»–æ–¹æ³•å‡å¢åŠ äº†é¢å¤–å‚æ•°ï¼Œå› æ­¤å…¶ä»–æ–¹æ³•çš„æ¨ç†è€—æ—¶ä¼šæ¯”<code>Freezeæ–¹æ³•</code>è¦é«˜ã€‚å½“ç„¶ç”±äºæ˜¯ç”Ÿæˆæ¨¡å‹ï¼Œæ‰€ä»¥ç”Ÿæˆçš„é•¿åº¦ä¹Ÿä¼šå½±å“è€—æ—¶;</li><li>æ¨¡å‹åœ¨æŒ‡å®šä»»åŠ¡ä¸Šå¾®è°ƒä¹‹åï¼Œå¹¶æ²¡æœ‰ä¸§å¤±åŸæœ‰èƒ½åŠ›ï¼Œä¾‹å¦‚ç”Ÿæˆâ€œå¸®æˆ‘å†™ä¸ªå¿«æ’ç®—æ³•â€ï¼Œä¾ç„¶å¯ä»¥ç”Ÿæˆ-å¿«æ’ä»£ç ;</li><li><strong>ç”±äºå¤§æ¨¡å‹å¾®è°ƒéƒ½é‡‡ç”¨å¤§é‡<code>instruction</code>è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œä»…é‡‡ç”¨å•ä¸€çš„æŒ‡ä»¤è¿›è¡Œå¾®è°ƒæ—¶ï¼Œå¯¹åŸæ¥å…¶ä»–çš„æŒ‡ä»¤å½±å“ä¸å¤§ï¼Œå› æ­¤å¹¶æ²¡å¯¼è‡´åŸæ¥æ¨¡å‹çš„èƒ½åŠ›ä¸§å¤±</strong>;</li><li>ä¸Šé¢æµ‹è¯•ä»…ä»£è¡¨ä¸ªäººæµ‹è¯•ç»“æœã€‚</li></ul><p>å¾ˆå¤šåŒå­¦åœ¨å¾®è°ƒåå‡ºç°äº†ç¾éš¾æ€§é—å¿˜ç°è±¡ï¼Œä½†æˆ‘è¿™è¾¹å¹¶æ²¡æœ‰å‡ºç°ï¼Œå¯¹â€œç¿»è¯‘ä»»åŠ¡â€ã€â€œä»£ç ä»»åŠ¡â€ã€â€œé—®ç­”ä»»åŠ¡â€è¿›è¡Œæµ‹è¯•ï¼Œé‡‡ç”¨freezeæ¨¡å‹ï¼Œå¯ä»¥ç”¨test_forgetting.pyè¿›è¡Œæµ‹è¯•ï¼Œå…·ä½“æµ‹è¯•æ•ˆæœå¦‚ä¸‹ï¼š</p><ul><li>ç¿»è¯‘ä»»åŠ¡</li></ul><p><img src="https://pic2.zhimg.com/v2-6d4d29a974c10411a915b51fb226e919_b.png" alt></p><ul><li>ä»£ç ä»»åŠ¡</li></ul><p><img src="https://pic4.zhimg.com/v2-bd9a3e20503f83d7f57b5dabf98fef43_b.jpg" alt></p><ul><li>é—®ç­”ä»»åŠ¡</li></ul><p><img src="https://pic4.zhimg.com/v2-b0901617f0084a1bffdeeb1961fc05d3_b.png" alt></p><p>åé¢ä¼šæŠŠç”Ÿæˆä»»åŠ¡ã€åˆ†ç±»ä»»åŠ¡åšå®Œï¼Œè¯·æŒç»­å…³æ³¨<code>GitHub</code>ï¼Œä¼šå®šæœŸæ›´æ–°ã€‚ï¼ˆå¤ªå¿™äº†ï¼Œä¼šæŠ“ç´§æ—¶é—´æ›´æ–°ï¼Œå¹¶ä¸”å®˜æ–¹ä»£ç ä¹Ÿåœ¨æŒç»­æ›´æ–°ï¼Œå¦‚é‡åˆ°ä»£ç ä»£ç è°ƒä¸é€šçš„æƒ…å†µï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ï¼Œæˆ‘åœ¨<code>GitHub</code>ä¹Ÿç»™å‡ºäº†æˆ‘çš„ä»£ç ç‰ˆæœ¬å’Œæ¨¡å‹ç‰ˆæœ¬ï¼‰</p><h3 id="æ–‡æœ¬ç”Ÿæˆ"><a href="#æ–‡æœ¬ç”Ÿæˆ" class="headerlink" title="æ–‡æœ¬ç”Ÿæˆ"></a><strong>æ–‡æœ¬ç”Ÿæˆ</strong></h3><ul><li>ä¸ºäº†é˜²æ­¢å¤§æ¨¡å‹çš„æ•°æ®æ³„éœ²ï¼Œé‡‡ç”¨ä¸€ä¸ªâ€œä¸‡åˆ›æ¯â€ä¸­åŒ»è¯å¤©æ± å¤§æ•°æ®ç«èµ›-<a href="https://link.zhihu.com/?target=https%3A//tianchi.aliyun.com/competition/entrance/531826/introduction">ä¸­åŒ»æ–‡çŒ®é—®é¢˜ç”ŸæˆæŒ‘æˆ˜</a>ï¼ŒéšæœºæŠ½å–20æ¡ä½œä¸ºæµ‹è¯•é›†</li><li>PTä¸ºå®˜æ–¹çš„<code>P-Tuning V2</code>è®­ç»ƒæ–¹æ³•ï¼Œ<code>PT-Only-Embedding</code>è¡¨ç¤ºä»…å¯¹<code>Embedding</code>è¿›è¡Œ<code>soft-prompt</code>ï¼Œ<code>Freeze</code>ä»…è®­ç»ƒæ¨¡å‹åäº”å±‚å‚æ•°ï¼Œ<code>Lora</code>é‡‡ç”¨ä½ç§©çŸ©é˜µæ–¹æ³•è®­ç»ƒï¼Œç§©ä¸º<code>8</code>ï¼›</li><li>è®­ç»ƒç¤ºä¾‹ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">prompt_textï¼šä½ ç°åœ¨æ˜¯ä¸€ä¸ªé—®é¢˜ç”Ÿæˆæ¨¡å‹ï¼Œè¯·æ ¹æ®ä¸‹é¢æ–‡æ¡£ç”Ÿæˆä¸€ä¸ªé—®é¢˜ï¼Œæ–‡æ¡£ï¼š</span><br><span class="line">è¾“å…¥ï¼šç´«è‰²çº¢è–¯æ˜¯è¿‘å¹´ä»æ—¥æœ¬å¼•è¿›çš„æ–°å“ç§çº¢è–¯ï¼Œä¸­å›½å†œä¸šå¤§å­¦å†œå­¦ä¸ç”Ÿç‰©æŠ€æœ¯å­¦é™¢å‰¯é™¢é•¿åˆ˜åº†æ˜ŒæŒ‡å‡ºï¼Œ</span><br><span class="line">      ç´«è–¯ä¸­çš„èŠ±é’ç´ å…·æœ‰æ˜¾è‘—çš„æŠ—ç”Ÿç‰©æ°§åŒ–ä½œç”¨ï¼Œåœ¨å»¶ç¼“äººä½“è¡°è€æ–¹é¢å…·æœ‰éå¸¸å¥½çš„æ•ˆæœã€‚</span><br><span class="line">      ç´«è–¯ä¸­æ‰€å«èµ–æ°¨é…¸ã€é“œã€é”°ã€é’¾ã€é”Œçš„å«é‡é«˜äºä¸€èˆ¬çº¢è–¯5-8å€ï¼Œå°¤å…¶æ˜¯æŠ—ç™Œç‰©è´¨ç¢˜ã€</span><br><span class="line">      ç¡’çš„å«é‡æ¯”å…¶ä»–çº¢è–¯é«˜å‡º20å€ä»¥ä¸Šï¼Œå é£Ÿç‰©ä¸­çš„ç¬¬ä¸€ä½ã€‚</span><br><span class="line">è¾“å‡ºï¼šç´«è–¯å’Œçº¢è–¯åƒå“ªä¸ªå¥½ï¼Ÿ</span><br></pre></td></tr></table></figure><p>æ¨¡å‹è®­ç»ƒï¼Œä»¥<code>Freezeæ–¹æ³•</code>ä¸ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CUDA_VISIBLE_DEVICES=0 <span class="built_in">nohup</span> DeepSpeed --master_port 5555 finetuning_freeze.py </span><br><span class="line">        --train_path <span class="string">&quot;data/d2q_0.json&quot;</span> </span><br><span class="line">        --output_dir <span class="string">&quot;output_dir_freeze/&quot;</span> </span><br><span class="line">        --prompt_text <span class="string">&quot;ä½ ç°åœ¨æ˜¯ä¸€ä¸ªé—®é¢˜ç”Ÿæˆæ¨¡å‹ï¼Œè¯·æ ¹æ®ä¸‹é¢æ–‡æ¡£ç”Ÿæˆä¸€ä¸ªé—®é¢˜ï¼Œæ–‡æ¡£ï¼š&quot;</span> </span><br><span class="line">        &gt; log_fz.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><p>ç”±äºç”Ÿæˆæ¨¡å‹çš„å†…å®¹ä¸èƒ½æƒ³ä¿¡æ¯æŠ½å–ä»»åŠ¡ä¸€æ ·è¯„ä»·ï¼Œç”¨ç°æœ‰çš„BLUEæˆ–è€…Rougeæ¥è¯„ä»·ä¹Ÿæ˜¯ä¸åˆé€‚ï¼Œå› æ­¤åˆ¶å®šäº†è¯„åˆ†è§„åˆ™ã€‚ é€šè¿‡å¤šæ ·æ€§å’Œå‡†ç¡®æ€§ä¸¤ä¸ªè§’åº¦åˆ¤æ–­D2Qæ¨¡å‹å¥½åï¼Œæ¯ä¸ªæ ·æœ¬æ€»è®¡5åˆ†ï¼Œå…±20ä¸ªæ ·æœ¬ã€‚</p><ul><li><p>å¤šæ ·æ€§ï¼š</p></li><li><p>é—®é¢˜æ˜¯å¦é«˜åº¦ç›¸ä¼¼ï¼Œæ¯é‡å¤ä¸€ä¸ªé—®é¢˜æ‰£0.25åˆ†ï¼›</p></li><li><p>é—®é¢˜å¯¹åº”ç­”æ¡ˆæ˜¯å¦ç›¸åŒï¼Œæ¯æœ‰ä¸€ä¸ªé‡å¤ç­”æ¡ˆæˆ–æ‰¾ä¸åˆ°ç­”æ¡ˆï¼Œæ‰£0.25åˆ†ï¼›</p></li><li><p>å‡†ç¡®æ€§ï¼š</p></li><li><p>é—®é¢˜èƒ½å¦ä»æ–‡æ¡£ä¸­æ‰¾åˆ°ç­”æ¡ˆï¼Œæ¯æœ‰ä¸€ä¸ªæ‰¾ä¸åˆ°ç­”æ¡ˆï¼Œæ‰£0.25åˆ†ï¼›</p></li><li>é—®é¢˜å†…å®¹æ˜¯å¦æµç•…ï¼Œæ¯æœ‰ä¸€ä¸ªé—®é¢˜ä¸æµç•…ï¼Œæ‰£0.25åˆ†ï¼›</li><li>é—®é¢˜å†…å®¹æ˜¯å¦æœ‰å®³ï¼Œæ¯æœ‰ä¸€ä¸ªæœ‰å®³ï¼Œæ‰£0.25åˆ†ï¼›</li></ul><p>æµ‹è¯•æ•°æ®è§d2q_result_data/ï¼Œæµ‹è¯•ä»£ç è§predict_d2q.py</p><div class="table-container"><table><thead><tr><th style="text-align:center">å¾®è°ƒæ–¹æ³•</th><th style="text-align:center">åŸå§‹æ¨¡å‹</th><th style="text-align:center"><code>PT-Only-Embedding</code></th><th style="text-align:center"><code>P-Tuning V2</code></th><th style="text-align:center"><code>Freeze</code></th><th style="text-align:center"><code>Lora</code></th></tr></thead><tbody><tr><td style="text-align:center">åˆ†æ•°</td><td style="text-align:center">51.75</td><td style="text-align:center">73.75</td><td style="text-align:center">87.75</td><td style="text-align:center">79.25</td><td style="text-align:center">86.75</td></tr></tbody></table></div><h2 id="ä¸­æ–‡å¼€æºå¤§æ¨¡å‹-amp-é¡¹ç›®"><a href="#ä¸­æ–‡å¼€æºå¤§æ¨¡å‹-amp-é¡¹ç›®" class="headerlink" title="ä¸­æ–‡å¼€æºå¤§æ¨¡å‹&amp;é¡¹ç›®"></a><strong>ä¸­æ–‡å¼€æºå¤§æ¨¡å‹&amp;é¡¹ç›®</strong></h2><p>è™½ç„¶å‡ºæ¥å¾ˆå¤šå¤§æ¨¡å‹ï¼Œä½†Opençš„&amp;ä¸­æ–‡å¯ç›´æ¥ä½¿ç”¨çš„å¹¶ä¸å¤šï¼Œä¸‹é¢å¯¹ä¸­æ–‡å¼€æºå¤§æ¨¡å‹ã€æ•°æ®é›†å’Œé¡¹ç›®è¿›è¡Œä¸€ä¸‹æ±‡æ€»ã€‚</p><p><img src="https://pic2.zhimg.com/v2-3422e1fd8f182d35418d30216a079905_b.jpg" alt></p><h3 id="ä¸­æ–‡å¼€æºå¤§æ¨¡å‹"><a href="#ä¸­æ–‡å¼€æºå¤§æ¨¡å‹" class="headerlink" title="ä¸­æ–‡å¼€æºå¤§æ¨¡å‹"></a><strong>ä¸­æ–‡å¼€æºå¤§æ¨¡å‹</strong></h3><p>ç›´æ¥å¯å¾®è°ƒï¼Œ<code>æ— éœ€æŒ‡ä»¤å¢é‡è®­ç»ƒ</code>ï¼š</p><ul><li><code>ChatGLM-6B</code>ï¼š<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/THUDM/&lt;code&gt;ChatGLM-6B&lt;/code">æ¨¡å‹åœ°å€</a></li><li><code>ChatYuan-large-v2</code>ï¼š<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/ClueAI/ChatYuan-large-v2">æ¨¡å‹åœ°å€</a></li></ul><p>åŸå§‹æ¨¡å‹å¤šè¯­è¨€orè‹±æ–‡ï¼Œ<code>éœ€è¦ä¸­æ–‡æŒ‡ä»¤æ•°æ®é›†+å¢é‡è®­ç»ƒ</code>ï¼š</p><ul><li><code>BloomZ</code>ï¼š<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/bigscience/bloomz">æ¨¡å‹åœ°å€</a></li><li><code>LLama</code>ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/facebookresearch/llama">æ¨¡å‹åœ°å€</a></li><li><code>Flan-T5</code>ï¼š<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/google/flan-t5-xxl">æ¨¡å‹åœ°å€</a></li><li><code>OPT</code>ï¼š<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/facebook/opt-66b">æ¨¡å‹åœ°å€</a></li></ul><h3 id="ä¸­æ–‡å¼€æºæŒ‡ä»¤æ•°æ®"><a href="#ä¸­æ–‡å¼€æºæŒ‡ä»¤æ•°æ®" class="headerlink" title="ä¸­æ–‡å¼€æºæŒ‡ä»¤æ•°æ®"></a><strong>ä¸­æ–‡å¼€æºæŒ‡ä»¤æ•°æ®</strong></h3><p>ä¸‹é¢ä¸­æ–‡æŒ‡ä»¤é›†ï¼Œå¤§å¤šæ•°ä»Alpacaç¿»è¯‘è€Œæ¥ï¼Œè¯·çœ‹ä¸‹é¢é¡¹ç›®ä¸­dataç›®å½•ã€‚ç›®å‰é€šè¿‡ChatGPTæˆ–è€…GPT4ä½œä¸ºå»‰ä»·æ ‡æ³¨å·¥ä¸ºè‡ªå·±çš„æ•°æ®è¿›è¡Œæ•°æ®æ ‡æ³¨ä¸€ä¸ªä¸é”™çš„æ€è·¯ã€‚</p><ul><li>[1]ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/LC1332/Chinese-alpaca-&lt;code&gt;Lora&lt;/code">æ•°æ®åœ°å€</a></li><li>[2]ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/hikariming/alpaca_chinese_dataset">æ•°æ®åœ°å€</a></li><li>[3]ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/carbonz0/alpaca-chinese-dataset">æ•°æ®åœ°å€</a></li><li>[4]ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/Instruction-Tuning-with-GPT-4/GPT-4-LLM">æ•°æ®åœ°å€</a></li><li>[5]ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/LianjiaTech/BELLE">æ•°æ®åœ°å€</a></li><li>[6]ï¼š<a href="https://link.zhihu.com/?target=https%3A//huggingface.co/datasets/JosephusCheung/GuanacoDataset">æ•°æ®åœ°å€</a></li></ul><h3 id="å¼€æºé¡¹ç›®"><a href="#å¼€æºé¡¹ç›®" class="headerlink" title="å¼€æºé¡¹ç›®"></a><strong>å¼€æºé¡¹ç›®</strong></h3><p>æ€»ç»“ä¸‹é¢è¾ƒç«çš„å¼€æºé¡¹ç›®ï¼š</p><ul><li><code>BELLE</code>ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/LianjiaTech/BELLE">é¡¹ç›®åœ°å€</a></li><li><code>ChatGLM</code>ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/THUDM/&lt;code&gt;ChatGLM-6B&lt;/code">é¡¹ç›®åœ°å€</a></li><li><code>Luotuo-Chinese-LLM</code>ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/LC1332/Luotuo-Chinese-LLM">é¡¹ç›®åœ°å€</a></li><li><code>stanford_alpaca</code>ï¼š<a href="https://link.zhihu.com/?target=https%3A//&lt;code&gt;GitHub&lt;/code&gt;.com/tatsu-lab/stanford_alpaca">é¡¹ç›®åœ°å€</a></li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><p>ç›®å‰å„å¤§å‚çš„å¤§æ¨¡å‹é™†é™†ç»­ç»­æ”¾å‡ºï¼Œå ªç§°ç™¾å®¶äº‰é¸£ï¼ä¸ªäººç©å®¶ä¹Ÿæ˜¯å…¨é¢æ‹¥æŠ±ï¼Œæƒ³å°½ä¸€åˆ‡åŠæ³•æ¥è®­ç»ƒå¾®è°ƒå¤§æ¨¡å‹ã€‚åªæ„¿å¤§å®¶ä»¥åå¯ä»¥å®ç°â€œå¤§æ¨¡å‹â€è‡ªç”±ã€‚æ„¿å†æ— â€œmodel-as-a-serviceâ€ã€‚</p><h2 id="ä¸“æœ‰åè¯è§£é‡Š"><a href="#ä¸“æœ‰åè¯è§£é‡Š" class="headerlink" title="ä¸“æœ‰åè¯è§£é‡Š"></a><strong>ä¸“æœ‰åè¯è§£é‡Š</strong></h2><h3 id="soft-promptæ–¹æ³•"><a href="#soft-promptæ–¹æ³•" class="headerlink" title="soft-promptæ–¹æ³•"></a><code>soft-promptæ–¹æ³•</code></h3><p>æ˜¯ä¸€ç§ç”¨äºç”Ÿæˆæ–‡æœ¬çš„æŠ€æœ¯ã€‚åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œç”Ÿæˆæ–‡æœ¬æ˜¯æŒ‡æ ¹æ®ç»™å®šçš„è¾“å…¥ç”Ÿæˆç›¸å…³çš„æ–‡æœ¬è¾“å‡ºã€‚<code>soft-prompt</code>æ–¹æ³•æ˜¯ä¸€ç§ç”Ÿæˆæ–‡æœ¬çš„æ–¹æ³•ï¼Œå®ƒä½¿ç”¨ç»™å®šçš„è½¯æç¤ºï¼ˆsoft promptï¼‰æ¥æŒ‡å¯¼ç”Ÿæˆçš„æ–‡æœ¬ã€‚<br>è½¯æç¤ºæ˜¯ä¸€ç§å¯¹ç”Ÿæˆæ–‡æœ¬çš„è¦æ±‚æˆ–æŒ‡å¯¼ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªçŸ­è¯­ã€ä¸€ä¸ªé—®é¢˜æˆ–ä¸€ä¸ªä¸»é¢˜ã€‚è½¯æç¤ºæä¾›äº†ä¸€å®šçš„ä¸Šä¸‹æ–‡ï¼Œå¸®åŠ©æ¨¡å‹ç†è§£è¦ç”Ÿæˆçš„æ–‡æœ¬åº”è¯¥å…·æœ‰çš„ç‰¹å®šç‰¹å¾æˆ–å†…å®¹ã€‚é€šè¿‡æä¾›è½¯æç¤ºï¼Œå¯ä»¥å¼•å¯¼æ¨¡å‹ç”Ÿæˆä¸æç¤ºç›¸å…³çš„æ–‡æœ¬ã€‚<br><code>soft-prompt</code>æ–¹æ³•å¯ä»¥åº”ç”¨äºå„ç§ç”Ÿæˆæ–‡æœ¬çš„ä»»åŠ¡ï¼Œå¦‚æœºå™¨ç¿»è¯‘ã€æ–‡æœ¬æ‘˜è¦ã€å¯¹è¯ç³»ç»Ÿç­‰ã€‚å®ƒå¯ä»¥æé«˜ç”Ÿæˆæ–‡æœ¬çš„è´¨é‡å’Œç›¸å…³æ€§ï¼Œä½¿å¾—ç”Ÿæˆçš„æ–‡æœ¬æ›´ç¬¦åˆé¢„æœŸçš„è¦æ±‚ã€‚<br>è½¯æç¤ºæ–¹æ³•ä¸ä¼ ç»Ÿçš„ç”Ÿæˆæ–‡æœ¬æ–¹æ³•ç›¸æ¯”ï¼Œå…·æœ‰æ›´å¤§çš„çµæ´»æ€§å’Œå¯æ§æ€§ã€‚é€šè¿‡è°ƒæ•´è½¯æç¤ºçš„å†…å®¹å’Œå½¢å¼ï¼Œå¯ä»¥å¯¹ç”Ÿæˆçš„æ–‡æœ¬è¿›è¡Œæ›´ç²¾ç¡®çš„æ§åˆ¶ï¼Œä½¿å…¶æ»¡è¶³ç‰¹å®šçš„éœ€æ±‚æˆ–è¦æ±‚ã€‚è¿™ä½¿å¾—è½¯æç¤ºæ–¹æ³•æˆä¸ºç”Ÿæˆæ–‡æœ¬é¢†åŸŸä¸­çš„ä¸€ç§é‡è¦æŠ€æœ¯ã€‚</p><h3 id="DeepSpeedçš„Zero-1"><a href="#DeepSpeedçš„Zero-1" class="headerlink" title="DeepSpeedçš„Zero-1"></a><code>DeepSpeedçš„Zero-1</code></h3><p><code>DeepSpeed</code>çš„<code>Zero-1</code>æ˜¯ä¸€ä¸ªä¼˜åŒ–è®­ç»ƒå¤§å‹æ¨¡å‹çš„æŠ€æœ¯ã€‚<code>DeepSpeed</code>æ˜¯ä¸€ä¸ªå¼€æºçš„æ·±åº¦å­¦ä¹ ä¼˜åŒ–åº“ï¼Œå¯ä»¥æ˜¾è‘—æé«˜è®­ç»ƒé€Ÿåº¦å’Œæ¨¡å‹è§„æ¨¡ã€‚<code>Zero-1</code>æ˜¯<code>DeepSpeed</code>ä¸­çš„ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œä¸“é—¨ç”¨äºå‡å°‘æ¨¡å‹å‚æ•°çš„å†…å­˜å ç”¨å’Œé€šä¿¡å¼€é”€ã€‚<br><code>Zero-1é€šè¿‡å°†æ¨¡å‹å‚æ•°åˆ†æˆå¤šä¸ªå°å—ï¼Œåªåœ¨æ¯ä¸ªå°å—ä¸Šè¿›è¡Œè®¡ç®—å’Œé€šä¿¡ï¼Œä»è€Œå‡å°‘äº†æ¯æ¬¡è®¡ç®—å’Œé€šä¿¡çš„æ•°æ®é‡ã€‚</code>è¿™ç§æ–¹å¼å¯ä»¥æœ‰æ•ˆåœ°é™ä½æ¨¡å‹å‚æ•°çš„å†…å­˜å ç”¨å’Œé€šä¿¡å¼€é”€ï¼Œç‰¹åˆ«é€‚ç”¨äºè®­ç»ƒå¤§å‹æ¨¡å‹ã€‚<br>é€šè¿‡ä½¿ç”¨<code>Zero-1</code>ï¼Œ<code>DeepSpeed</code>å¯ä»¥åœ¨<code>ä¸å¢åŠ é¢å¤–è®¡ç®—å’Œé€šä¿¡å¼€é”€çš„æƒ…å†µä¸‹ï¼Œå°†æ¨¡å‹è§„æ¨¡æ‰©å±•åˆ°æ›´å¤§çš„å°ºå¯¸</code>ã€‚è¿™å¯¹äºè®­ç»ƒæ›´å¤æ‚çš„æ¨¡å‹å’Œå¤„ç†æ›´å¤§è§„æ¨¡çš„æ•°æ®é›†éå¸¸æœ‰å¸®åŠ©ã€‚åŒæ—¶ï¼Œ<code>Zero-1</code>è¿˜å¯ä»¥æé«˜è®­ç»ƒé€Ÿåº¦ï¼Œå› ä¸ºå‡å°‘äº†æ¯æ¬¡è®¡ç®—å’Œé€šä¿¡çš„æ•°æ®é‡ï¼Œä»è€Œå‡å°‘äº†è®­ç»ƒçš„æ€»ä½“æ—¶é—´ã€‚<br>æ€»ä¹‹ï¼Œ<code>DeepSpeed</code>çš„<code>Zero-1</code>æ˜¯ä¸€ç§ä¼˜åŒ–æŠ€æœ¯ï¼Œé€šè¿‡å‡å°‘æ¨¡å‹å‚æ•°çš„å†…å­˜å ç”¨å’Œé€šä¿¡å¼€é”€ï¼Œå¯ä»¥æé«˜è®­ç»ƒå¤§å‹æ¨¡å‹çš„æ•ˆç‡å’Œé€Ÿåº¦ã€‚</p><h3 id="å‡ºç°OOMçš„åŸå› å’Œè§£å†³æ–¹æ³•"><a href="#å‡ºç°OOMçš„åŸå› å’Œè§£å†³æ–¹æ³•" class="headerlink" title="å‡ºç°OOMçš„åŸå› å’Œè§£å†³æ–¹æ³•"></a><code>å‡ºç°OOMçš„åŸå› å’Œè§£å†³æ–¹æ³•</code></h3><p><code>OOM</code>æ˜¯<code>Out of Memory</code>çš„ç¼©å†™ï¼ŒæŒ‡çš„æ˜¯å†…å­˜ä¸è¶³ã€‚åœ¨æ·±åº¦å­¦ä¹ è®­ç»ƒä¸­ï¼Œ<code>OOM</code>é€šå¸¸æ˜¯ç”±ä»¥ä¸‹åŸå› å¼•èµ·çš„ï¼š</p><ol><li>æ¨¡å‹å¤æ‚åº¦é«˜ï¼šæ·±åº¦å­¦ä¹ æ¨¡å‹é€šå¸¸åŒ…å«å¤§é‡çš„å‚æ•°å’Œå±‚ï¼Œéœ€è¦å¤§é‡çš„å†…å­˜æ¥å­˜å‚¨æ¨¡å‹çš„æƒé‡å’Œä¸­é—´è®¡ç®—ç»“æœã€‚å¦‚æœæ¨¡å‹è¿‡äºå¤æ‚ï¼Œè¶…å‡ºäº†å¯ç”¨å†…å­˜çš„é™åˆ¶ï¼Œå°±ä¼šå‡ºç°<code>OOM</code>ã€‚</li><li>æ‰¹é‡å¤§å°è¿‡å¤§ï¼šåœ¨æ·±åº¦å­¦ä¹ è®­ç»ƒä¸­ï¼Œé€šå¸¸ä¼šå°†è®­ç»ƒæ•°æ®åˆ’åˆ†ä¸ºå°æ‰¹é‡è¿›è¡Œå¤„ç†ã€‚æ¯ä¸ªæ‰¹é‡çš„æ•°æ®ä¼šè¢«åŒæ—¶è¾“å…¥åˆ°æ¨¡å‹ä¸­è¿›è¡Œè®¡ç®—ï¼Œå› æ­¤æ‰¹é‡å¤§å°ä¼šç›´æ¥å½±å“å†…å­˜çš„ä½¿ç”¨ã€‚å¦‚æœæ‰¹é‡å¤§å°è®¾ç½®è¿‡å¤§ï¼Œè¶…å‡ºäº†å¯ç”¨å†…å­˜çš„é™åˆ¶ï¼Œå°±ä¼šå‡ºç°OOMã€‚</li><li>å›¾åƒåˆ†è¾¨ç‡è¿‡é«˜ï¼šåœ¨å›¾åƒå¤„ç†ä»»åŠ¡ä¸­ï¼Œé«˜åˆ†è¾¨ç‡çš„å›¾åƒä¼šå ç”¨æ›´å¤šçš„å†…å­˜ã€‚å¦‚æœè¾“å…¥çš„å›¾åƒåˆ†è¾¨ç‡è¿‡é«˜ï¼Œè¶…å‡ºäº†å¯ç”¨å†…å­˜çš„é™åˆ¶ï¼Œå°±ä¼šå‡ºç°<code>OOM</code>ã€‚</li><li>å†…å­˜æ³„æ¼ï¼šå†…å­˜æ³„æ¼æ˜¯æŒ‡ç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­æ— æ³•é‡Šæ”¾å·²ç»åˆ†é…çš„å†…å­˜ï¼Œå¯¼è‡´å†…å­˜å ç”¨ä¸æ–­å¢åŠ ã€‚å¦‚æœæ·±åº¦å­¦ä¹ è®­ç»ƒè¿‡ç¨‹ä¸­å­˜åœ¨å†…å­˜æ³„æ¼é—®é¢˜ï¼Œæœ€ç»ˆä¼šå¯¼è‡´å†…å­˜ä¸è¶³è€Œå‡ºç°<code>OOM</code>ã€‚</li></ol><p>ä¸ºè§£å†³<code>OOM</code>é—®é¢˜ï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š</p><ol><li>å‡å°æ¨¡å‹å¤æ‚åº¦ï¼šå¯ä»¥å°è¯•å‡å°‘æ¨¡å‹çš„å‚æ•°é‡æˆ–å±‚æ•°ï¼Œä»¥é™ä½å†…å­˜éœ€æ±‚ã€‚</li><li>å‡å°æ‰¹é‡å¤§å°ï¼šå¯ä»¥å°è¯•å‡å°æ¯ä¸ªæ‰¹é‡çš„æ•°æ®é‡ï¼Œä»¥é™ä½å†…å­˜éœ€æ±‚ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œè¾ƒå°çš„æ‰¹é‡å¤§å°å¯èƒ½ä¼šå½±å“è®­ç»ƒçš„æ•ˆæœã€‚</li><li>é™ä½å›¾åƒåˆ†è¾¨ç‡ï¼šå¯ä»¥å°è¯•å°†è¾“å…¥å›¾åƒçš„åˆ†è¾¨ç‡é™ä½ï¼Œä»¥å‡å°‘å†…å­˜å ç”¨ã€‚</li><li>æ£€æŸ¥å’Œä¿®å¤å†…å­˜æ³„æ¼é—®é¢˜ï¼šå¯ä»¥é€šè¿‡ä»£ç å®¡æŸ¥å’Œå†…å­˜åˆ†æå·¥å…·æ¥æ£€æŸ¥æ˜¯å¦å­˜åœ¨å†…å­˜æ³„æ¼é—®é¢˜ï¼Œå¹¶è¿›è¡Œä¿®å¤ã€‚</li><li>ä½¿ç”¨æ›´å¤§çš„å†…å­˜æˆ–åˆ†å¸ƒå¼è®­ç»ƒï¼šå¦‚æœä»¥ä¸Šæªæ–½æ— æ³•è§£å†³<code>OOM</code>é—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘å¢åŠ å¯ç”¨å†…å­˜çš„é™åˆ¶ï¼Œä¾‹å¦‚ä½¿ç”¨æ›´å¤§å†…å­˜çš„è®¡ç®—è®¾å¤‡æˆ–é‡‡ç”¨åˆ†å¸ƒå¼è®­ç»ƒçš„æ–¹å¼ã€‚</li></ol><h3 id="gradient-checkpointing-enableæ¢¯åº¦æ£€æŸ¥ç‚¹æŠ€æœ¯"><a href="#gradient-checkpointing-enableæ¢¯åº¦æ£€æŸ¥ç‚¹æŠ€æœ¯" class="headerlink" title="gradient_checkpointing_enableæ¢¯åº¦æ£€æŸ¥ç‚¹æŠ€æœ¯"></a><code>gradient_checkpointing_enableæ¢¯åº¦æ£€æŸ¥ç‚¹æŠ€æœ¯</code></h3><p>æ˜¯ä¸€ä¸ªå‚æ•°æˆ–é€‰é¡¹ï¼Œç”¨äºå¯ç”¨æ¢¯åº¦æ£€æŸ¥ç‚¹æŠ€æœ¯ã€‚æ¢¯åº¦æ£€æŸ¥ç‚¹æŠ€æœ¯æ˜¯ä¸€ç§ä¼˜åŒ–æ–¹æ³•ï¼Œç”¨äº<code>å‡å°‘è®¡ç®—å›¾ä¸­çš„å†…å­˜æ¶ˆè€—</code>ï¼Œç‰¹åˆ«é€‚ç”¨äºæ·±åº¦å­¦ä¹ æ¨¡å‹ä¸­çš„å¤§å‹è®¡ç®—å›¾ã€‚<br>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè®¡ç®—å›¾ä¸­çš„æ¯ä¸ªæ“ä½œéƒ½ä¼šä¿å­˜å…¶æ¢¯åº¦ä¿¡æ¯ï¼Œä»¥ä¾¿åœ¨åå‘ä¼ æ’­æ—¶ä½¿ç”¨ã€‚ç„¶è€Œï¼Œå¯¹äºå…·æœ‰å¤§é‡å‚æ•°å’Œå±‚çš„æ¨¡å‹ï¼Œè¿™äº›æ¢¯åº¦ä¿¡æ¯å¯èƒ½ä¼šå ç”¨å¤§é‡å†…å­˜ã€‚<br>æ¢¯åº¦æ£€æŸ¥ç‚¹æŠ€æœ¯é€šè¿‡åœ¨<code>è®¡ç®—å›¾ä¸­çš„æŸäº›æ“ä½œå¤„ä¿å­˜ä¸­é—´çŠ¶æ€ï¼Œè€Œä¸æ˜¯ä¿å­˜æ‰€æœ‰æ“ä½œçš„æ¢¯åº¦ä¿¡æ¯</code>ï¼Œæ¥å‡å°‘å†…å­˜æ¶ˆè€—ã€‚<br>è¿™æ ·ï¼Œåœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œåªéœ€è¦é‡æ–°è®¡ç®—<code>ä»æ£€æŸ¥ç‚¹å¼€å§‹çš„æ“ä½œçš„æ¢¯åº¦ï¼Œè€Œä¸æ˜¯é‡å¤è®¡ç®—æ•´ä¸ªè®¡ç®—å›¾çš„æ¢¯åº¦ã€‚</code><br>é€šè¿‡å¯ç”¨<code>gradient_checkpointing_enable</code>ï¼Œå¯ä»¥åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨æ¢¯åº¦æ£€æŸ¥ç‚¹æŠ€æœ¯æ¥å‡å°‘å†…å­˜æ¶ˆè€—ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NLP </category>
          
          <category> LLM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Chatgpt </tag>
            
            <tag> p-tuning </tag>
            
            <tag> p-tuningv2 </tag>
            
            <tag> loRA </tag>
            
            <tag> DeepSpeed </tag>
            
            <tag> Zero </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LC15. ä¸‰æ•°ä¹‹å’Œ</title>
      <link href="/post/LC15.html"/>
      <url>/post/LC15.html</url>
      
        <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code> ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸‰å…ƒç»„ <code>[nums[i], nums[j], nums[k]]</code> æ»¡è¶³ <code>i != j</code>ã€<code>i != k</code> ä¸” <code>j != k</code> ï¼ŒåŒæ—¶è¿˜æ»¡è¶³ <code>nums[i] + nums[j] + nums[k] == 0</code> ã€‚è¯·</p><p>ä½ è¿”å›æ‰€æœ‰å’Œä¸º <code>0</code> ä¸”ä¸é‡å¤çš„ä¸‰å…ƒç»„ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>ç­”æ¡ˆä¸­ä¸å¯ä»¥åŒ…å«é‡å¤çš„ä¸‰å…ƒç»„ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>nums = [-1,0,1,2,-1,-4]<strong>è¾“å‡ºï¼š</strong>[[-1,-1,2],[-1,0,1]]<strong>è§£é‡Šï¼š</strong>nums[0] + nums[1] + nums[2] = (-1) + 0 + 1 = 0 ã€‚nums[1] + nums[2] + nums[4] = 0 + 1 + (-1) = 0 ã€‚nums[0] + nums[3] + nums[4] = (-1) + 2 + (-1) = 0 ã€‚ä¸åŒçš„ä¸‰å…ƒç»„æ˜¯ [-1,0,1] å’Œ [-1,-1,2] ã€‚æ³¨æ„ï¼Œè¾“å‡ºçš„é¡ºåºå’Œä¸‰å…ƒç»„çš„é¡ºåºå¹¶ä¸é‡è¦ã€‚</pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>nums = [0,1,1]<strong>è¾“å‡ºï¼š</strong>[]<strong>è§£é‡Šï¼š</strong>å”¯ä¸€å¯èƒ½çš„ä¸‰å…ƒç»„å’Œä¸ä¸º 0 ã€‚</pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>nums = [0,0,0]<strong>è¾“å‡ºï¼š</strong>[[0,0,0]]<strong>è§£é‡Šï¼š</strong>å”¯ä¸€å¯èƒ½çš„ä¸‰å…ƒç»„å’Œä¸º 0 ã€‚</pre><p><strong>æç¤ºï¼š</strong></p><p><ul>    <li><code>3 &lt;= nums.length &lt;= 3000</code></li>    <li><code>-10<sup>5</sup> &lt;= nums[i] &lt;= 10<sup>5</sup></code></li></ul></p><h2 id="æ€è·¯åˆ†æ"><a href="#æ€è·¯åˆ†æ" class="headerlink" title="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ</h2><p>æ ¹æ®èŒƒå›´ï¼Œå¤æ‚åº¦æœ€å¤š O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="6.553ex" height="2.351ex" role="img" focusable="false" viewbox="0 -833.9 2896.6 1038.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-3-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-3-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/><path id="MJX-3-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"/><path id="MJX-3-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/><path id="MJX-3-TEX-I-1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-3-TEX-I-1D45B"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-3-TEX-N-32"/></g></g><g data-mml-node="mi" transform="translate(1036.6,0)"><use data-c="1D459" xlink:href="#MJX-3-TEX-I-1D459"/></g><g data-mml-node="mi" transform="translate(1334.6,0)"><use data-c="1D45C" xlink:href="#MJX-3-TEX-I-1D45C"/></g><g data-mml-node="mi" transform="translate(1819.6,0)"><use data-c="1D454" xlink:href="#MJX-3-TEX-I-1D454"/></g><g data-mml-node="mi" transform="translate(2296.6,0)"><use data-c="1D45B" xlink:href="#MJX-3-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>)ï¼Œå› æ­¤å¯ä»¥å‚è€ƒçš„æ–¹æ³•å¤æ‚åº¦æœ‰O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.345ex" height="1.912ex" role="img" focusable="false" viewbox="0 -833.9 1036.6 844.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-2-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-2-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-2-TEX-I-1D45B"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"/></g></g></g></g></g></svg></mjx-container>)ï¼ŒO(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="5.566ex" height="2.034ex" role="img" focusable="false" viewbox="0 -694 2460 899" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-1-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"/><path id="MJX-1-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/><path id="MJX-1-TEX-I-1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"/></g><g data-mml-node="mi" transform="translate(600,0)"><use data-c="1D459" xlink:href="#MJX-1-TEX-I-1D459"/></g><g data-mml-node="mi" transform="translate(898,0)"><use data-c="1D45C" xlink:href="#MJX-1-TEX-I-1D45C"/></g><g data-mml-node="mi" transform="translate(1383,0)"><use data-c="1D454" xlink:href="#MJX-1-TEX-I-1D454"/></g><g data-mml-node="mi" transform="translate(1860,0)"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>)</p><h2 id="æ’åº-åŒæŒ‡é’ˆ"><a href="#æ’åº-åŒæŒ‡é’ˆ" class="headerlink" title="æ’åº+åŒæŒ‡é’ˆ"></a>æ’åº+åŒæŒ‡é’ˆ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">threeSum</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">        nums.sort()</span><br><span class="line">        ans = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">            <span class="keyword">if</span> i &gt; <span class="number">0</span> <span class="keyword">and</span> nums[i] == nums[i-<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            l,r = i+<span class="number">1</span>,<span class="built_in">len</span>(nums)-<span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> l &lt; r:</span><br><span class="line">                <span class="keyword">if</span> nums[i]+nums[l]+nums[r] == <span class="number">0</span>:</span><br><span class="line">                    ans.append([nums[i],nums[l],nums[r]])  </span><br><span class="line">                    pre_l,pre_r = l,r </span><br><span class="line">                    <span class="keyword">while</span> l &lt; r <span class="keyword">and</span> nums[l] == nums[pre_l]:</span><br><span class="line">                        l+=<span class="number">1</span></span><br><span class="line">                    r-=<span class="number">1</span></span><br><span class="line">                <span class="keyword">elif</span> nums[i]+nums[l]+nums[r] &lt; <span class="number">0</span>:</span><br><span class="line">                    l+=<span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    r-=<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure><h2 id="å“ˆå¸Œå­—å…¸"><a href="#å“ˆå¸Œå­—å…¸" class="headerlink" title="å“ˆå¸Œå­—å…¸"></a>å“ˆå¸Œå­—å…¸</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">threeSum</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">    d = &#123;&#125;</span><br><span class="line">    ans = []</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> nums:</span><br><span class="line">        d[x] = d.get(x,<span class="number">0</span>)+<span class="number">1</span></span><br><span class="line">    <span class="comment">###æ­¤å¤„abå‡æ˜¯å»é‡åçš„</span></span><br><span class="line">    a = [x <span class="keyword">for</span> x <span class="keyword">in</span> d <span class="keyword">if</span> x &gt; <span class="number">0</span>]</span><br><span class="line">    b = [x <span class="keyword">for</span> x <span class="keyword">in</span> d <span class="keyword">if</span> x &lt;= <span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> d.get(<span class="number">0</span>,<span class="number">0</span>) &gt; <span class="number">2</span>:</span><br><span class="line">        ans.append([<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> b:</span><br><span class="line">            target = -(i+j)</span><br><span class="line">            <span class="keyword">if</span> target <span class="keyword">in</span> d:</span><br><span class="line">                <span class="keyword">if</span> target == i <span class="keyword">and</span> d[target] &gt; <span class="number">1</span>:</span><br><span class="line">                    ans.append([i,i,j])</span><br><span class="line">                <span class="keyword">if</span> target == j <span class="keyword">and</span> d[target] &gt; <span class="number">1</span>:</span><br><span class="line">                    ans.append([i,j,j])</span><br><span class="line">                <span class="comment">###ä¸‹ä¸€ä¸ªifæ¡ä»¶è¦æ³¨æ„ï¼Œå¦‚æœæ˜¯åœ¨(i,j)åŒºé—´ï¼Œå¾—b&gt;0</span></span><br><span class="line">                <span class="comment">###ä¸»è¦æ˜¯ä¸ºäº†å»é‡ï¼Œå¦‚æœæ˜¯åœ¨(taget,i)å’Œ(j,target)å¾—b&gt;=0</span></span><br><span class="line">                <span class="keyword">if</span> target &gt; i <span class="keyword">or</span> target &lt; j:</span><br><span class="line">                    ans.append([i,j,target])</span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure><h2 id="äºŒåˆ†æŸ¥æ‰¾"><a href="#äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾"></a>äºŒåˆ†æŸ¥æ‰¾</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">threeSum</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">        <span class="comment">###å¤§ç¥ç­”æ¡ˆ</span></span><br><span class="line">        <span class="comment">###å…ˆè€ƒè™‘é‡å¤å¤§äº1æ¬¡çš„</span></span><br><span class="line">        <span class="comment">###å†è€ƒè™‘é€šè¿‡bisectäºŒåˆ†æŸ¥æ‰¾å»å¯»æ‰¾</span></span><br><span class="line">        ans = []</span><br><span class="line">        counts = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> nums:</span><br><span class="line">            counts[i] = counts.get(i, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        nums = <span class="built_in">sorted</span>(counts)</span><br><span class="line">        <span class="keyword">for</span> i, num <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            <span class="keyword">if</span> counts[num] &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">if</span> counts[num] &gt; <span class="number">2</span>:</span><br><span class="line">                        ans.append([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> -num * <span class="number">2</span> <span class="keyword">in</span> counts:</span><br><span class="line">                        ans.append([num, num, -<span class="number">2</span> * num])</span><br><span class="line">            <span class="keyword">if</span> num &lt; <span class="number">0</span>:</span><br><span class="line">                two_sum = -num</span><br><span class="line">                left = bisect.bisect_left(nums, (two_sum - nums[-<span class="number">1</span>]), i + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> nums[left: bisect.bisect_right(nums, (two_sum // <span class="number">2</span>), left)]:</span><br><span class="line">                    j = two_sum - i</span><br><span class="line">                    <span class="keyword">if</span> j <span class="keyword">in</span> counts <span class="keyword">and</span> j != i:</span><br><span class="line">                        ans.append([num, i, j])</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure><h2 id="æš´åŠ›"><a href="#æš´åŠ›" class="headerlink" title="æš´åŠ›"></a>æš´åŠ›</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">threeSum</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">        <span class="comment">#hashè¡¨</span></span><br><span class="line">        nums.sort()</span><br><span class="line">        d  = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">            <span class="keyword">if</span> nums[i] <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">list</span>(d.keys()):</span><br><span class="line">                d[nums[i]] = [i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                d[nums[i]].append(i)</span><br><span class="line">        ans = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">            <span class="keyword">if</span> i&gt;=<span class="number">1</span> <span class="keyword">and</span> nums[i-<span class="number">1</span>]==nums[i]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                flag = <span class="number">0</span></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="built_in">len</span>(nums)):</span><br><span class="line">                    <span class="keyword">if</span> flag <span class="keyword">and</span> j&gt;<span class="number">1</span> <span class="keyword">and</span> nums[j-<span class="number">1</span>]==nums[j]:</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        x = -<span class="number">1</span>*(nums[i]+nums[j])</span><br><span class="line">                        <span class="keyword">try</span>:</span><br><span class="line">                            <span class="comment">###è¿™é‡Œä¸åˆ¤æ–­tmpæ˜¯å¦åœ¨dä¸­å‡ºç°è¿‡ï¼Œè¦ä¸ç„¶æ—¶é—´å¤æ‚åº¦æ›´é«˜ï¼Œç”¨tryèƒ½å¤Ÿçœæ—¶é—´</span></span><br><span class="line">                            idx = [_ <span class="keyword">for</span> _ <span class="keyword">in</span> d[x] <span class="keyword">if</span> _ &gt; j]</span><br><span class="line">                            <span class="keyword">if</span> <span class="built_in">len</span>(idx):</span><br><span class="line">                                ans.append([nums[i],nums[j],x])</span><br><span class="line">                                flag = <span class="number">1</span></span><br><span class="line">                        <span class="keyword">except</span>:</span><br><span class="line">                            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode-medium </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯æ—¥ä¸€é¢˜ </tag>
            
            <tag> å“ˆå¸Œ </tag>
            
            <tag> äºŒåˆ†æŸ¥æ‰¾ </tag>
            
            <tag> æ’åº </tag>
            
            <tag> åŒæŒ‡é’ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LC2178. æ‹†åˆ†æˆæœ€å¤šæ•°ç›®çš„æ­£å¶æ•°ä¹‹å’Œ</title>
      <link href="/post/LC2178.html"/>
      <url>/post/LC2178.html</url>
      
        <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°&nbsp;<code>finalSum</code>&nbsp;ã€‚è¯·ä½ å°†å®ƒæ‹†åˆ†æˆè‹¥å¹²ä¸ª&nbsp;<strong>äº’ä¸ç›¸åŒ</strong> çš„æ­£å¶æ•°ä¹‹å’Œï¼Œä¸”æ‹†åˆ†å‡ºæ¥çš„æ­£å¶æ•°æ•°ç›®&nbsp;<strong>æœ€å¤š</strong>&nbsp;ã€‚</p><ul>    <li>æ¯”æ–¹è¯´ï¼Œç»™ä½ &nbsp;<code>finalSum = 12</code>&nbsp;ï¼Œé‚£ä¹ˆè¿™äº›æ‹†åˆ†æ˜¯&nbsp;<strong>ç¬¦åˆè¦æ±‚</strong> çš„ï¼ˆäº’ä¸ç›¸åŒçš„æ­£å¶æ•°ä¸”å’Œä¸º&nbsp;<code>finalSum</code>ï¼‰ï¼š<code>(2 + 10)</code>&nbsp;ï¼Œ<code>(2 + 4 + 6)</code>&nbsp;å’Œ&nbsp;<code>(4 + 8)</code>&nbsp;ã€‚å®ƒä»¬ä¸­ï¼Œ<code>(2 + 4 + 6)</code>&nbsp;åŒ…å«æœ€å¤šæ•°ç›®çš„æ•´æ•°ã€‚æ³¨æ„&nbsp;<code>finalSum</code>&nbsp;ä¸èƒ½æ‹†åˆ†æˆ&nbsp;<code>(2 + 2 + 4 + 4)</code>&nbsp;ï¼Œå› ä¸ºæ‹†åˆ†å‡ºæ¥çš„æ•´æ•°å¿…é¡»äº’ä¸ç›¸åŒã€‚</li></ul><p>è¯·ä½ è¿”å›ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œè¡¨ç¤ºå°†æ•´æ•°æ‹†åˆ†æˆ <strong>æœ€å¤š</strong> æ•°ç›®çš„æ­£å¶æ•°æ•°ç»„ã€‚å¦‚æœæ²¡æœ‰åŠæ³•å°†&nbsp;<code>finalSum</code>&nbsp;è¿›è¡Œæ‹†åˆ†ï¼Œè¯·ä½ è¿”å›ä¸€ä¸ª&nbsp;<strong>ç©º</strong>&nbsp;æ•°ç»„ã€‚ä½ å¯ä»¥æŒ‰ <b>ä»»æ„</b>&nbsp;é¡ºåºè¿”å›è¿™äº›æ•´æ•°ã€‚</p><p>&nbsp;</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><b>è¾“å…¥ï¼š</b>finalSum = 12<b>è¾“å‡ºï¼š</b>[2,4,6]<b>è§£é‡Šï¼š</b>ä»¥ä¸‹æ˜¯ä¸€äº›ç¬¦åˆè¦æ±‚çš„æ‹†åˆ†ï¼š<code>(2 + 10)<span style>ï¼Œ</span></code><code>(2 + 4 + 6) </code>å’Œ <code>(4 + 8) ã€‚</code>(2 + 4 + 6) ä¸ºæœ€å¤šæ•°ç›®çš„æ•´æ•°ï¼Œæ•°ç›®ä¸º 3 ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿”å› [2,4,6] ã€‚[2,6,4] ï¼Œ[6,2,4] ç­‰ç­‰ä¹Ÿéƒ½æ˜¯å¯è¡Œçš„è§£ã€‚</pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><b>è¾“å…¥ï¼š</b>finalSum = 7<b>è¾“å‡ºï¼š</b>[]<b>è§£é‡Šï¼š</b>æ²¡æœ‰åŠæ³•å°† finalSum è¿›è¡Œæ‹†åˆ†ã€‚æ‰€ä»¥è¿”å›ç©ºæ•°ç»„ã€‚</pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><b>è¾“å…¥ï¼š</b>finalSum = 28<b>è¾“å‡ºï¼š</b>[6,8,2,12]<b>è§£é‡Šï¼š</b>ä»¥ä¸‹æ˜¯ä¸€äº›ç¬¦åˆè¦æ±‚çš„æ‹†åˆ†ï¼š<code>(2 + 26)<span style>ï¼Œ</span></code><code>(6 + 8 + 2 + 12)</code> å’Œ <code>(4 + 24) ã€‚</code><code>(6 + 8 + 2 + 12)</code> æœ‰æœ€å¤šæ•°ç›®çš„æ•´æ•°ï¼Œæ•°ç›®ä¸º 4 ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿”å› [6,8,2,12] ã€‚[10,2,4,12] ï¼Œ[6,2,4,16] ç­‰ç­‰ä¹Ÿéƒ½æ˜¯å¯è¡Œçš„è§£ã€‚</pre><p>&nbsp;</p><p><strong>æç¤ºï¼š</strong></p><p><ul>    <li><code>1 &lt;= finalSum &lt;= 10<sup>10</sup></code></li></ul></p><h2 id="æ€è·¯åˆ†æ"><a href="#æ€è·¯åˆ†æ" class="headerlink" title="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ</h2><p>å¶æ•°æ€»èƒ½åˆ†è§£æˆè‹¥å¹²ä¸ªå¶æ•°ï¼Œå› ä¸ºè¦åˆ†è§£çš„å¤Ÿå¤šï¼Œæ‰€ä»¥ä»<code>2</code>å¼€å§‹æšä¸¾<br>æ³¨ï¼šæ¯æ¬¡æšä¸¾<code>2,4,6</code>,åŒæ—¶åˆ¤æ–­<code>finalSum - start</code>æ˜¯å¦å·²ç»è®¿é—®è¿‡äº†ï¼Œå¦‚æœè®¿é—®è¿‡äº†åˆ™è·³è¿‡<br>å¦‚æœ<code>finalSum - start = start</code>ä¹Ÿéœ€è¦è¿›è¡Œåˆ¤æ–­<br>å¦‚æœæ˜¯å¥‡æ•°ç›´æ¥è¿”å›<code>[]</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maximumEvenSplit</span>(<span class="params">self, finalSum: <span class="built_in">int</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        <span class="comment"># è´ªå¿ƒ </span></span><br><span class="line">        <span class="comment"># æ¯æ¬¡ä»2å¼€å§‹è¿›è¡Œé€‰å–</span></span><br><span class="line">        <span class="keyword">if</span> finalSum%<span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        se = <span class="built_in">set</span>()</span><br><span class="line">        start = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> finalSum &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> finalSum != <span class="number">2</span>*start <span class="keyword">and</span> finalSum - start <span class="keyword">not</span> <span class="keyword">in</span> se:</span><br><span class="line">                se.add(start)</span><br><span class="line">                finalSum -= start</span><br><span class="line">            start +=<span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>(se)</span><br><span class="line"></span><br></pre></td></tr></table></figure></p><h2 id="å®˜æ–¹ä»£ç "><a href="#å®˜æ–¹ä»£ç " class="headerlink" title="å®˜æ–¹ä»£ç "></a><a href="https://leetcode.cn/problems/maximum-split-of-positive-even-integers/solution/chai-fen-cheng-zui-duo-shu-mu-de-ou-zhen-dntf/">å®˜æ–¹ä»£ç </a></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">maximumEvenSplit</span>(<span class="params">self, finalSum: <span class="built_in">int</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">if</span> finalSum % <span class="number">2</span> &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        i = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;= finalSum:</span><br><span class="line">            res.append(i)</span><br><span class="line">            finalSum -= i</span><br><span class="line">            i += <span class="number">2</span></span><br><span class="line">        <span class="comment"># 10 &lt; 8 ä¸ç¬¦åˆï¼Œåˆ™å°†8+res[-1]</span></span><br><span class="line">        res[-<span class="number">1</span>] += finalSum</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚åº¦åˆ†æ"><a href="#å¤æ‚åº¦åˆ†æ" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>æ—¶é—´å¤æ‚åº¦ï¼šO(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.491ex;" xmlns="http://www.w3.org/2000/svg" width="3.287ex" height="2.398ex" role="img" focusable="false" viewbox="0 -843 1453 1060" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-4-TEX-N-221A" d="M95 178Q89 178 81 186T72 200T103 230T169 280T207 309Q209 311 212 311H213Q219 311 227 294T281 177Q300 134 312 108L397 -77Q398 -77 501 136T707 565T814 786Q820 800 834 800Q841 800 846 794T853 782V776L620 293L385 -193Q381 -200 366 -200Q357 -200 354 -197Q352 -195 256 15L160 225L144 214Q129 202 113 190T95 178Z"/><path id="MJX-4-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-4-TEX-N-200B" d=""/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msqrt"><g transform="translate(853,0)"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-4-TEX-I-1D45B"/></g></g><g data-mml-node="mo" transform="translate(0,-17)"><use data-c="221A" xlink:href="#MJX-4-TEX-N-221A"/></g><rect width="600" height="60" x="853" y="723"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1453,0)"><g data-mml-node="mo"><use data-c="200B" xlink:href="#MJX-4-TEX-N-200B"/></g></g></g></g></g></svg></mjx-container>)ï¼Œå³ä¸ºæ‹†åˆ†åçš„æ•´æ•°ä¸ªæ•°ï¼Œå…¶ä¸­ <code>n=finalSum</code><br>ç©ºé—´å¤æ‚åº¦ï¼šO(1)ï¼Œè¾“å‡ºæ•°ç»„ä¸è®¡å…¥ç©ºé—´å¤æ‚åº¦ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> LeetCode-medium </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯æ—¥ä¸€é¢˜ </tag>
            
            <tag> LCå‘¨èµ›Q3 </tag>
            
            <tag> è´ªå¿ƒ </tag>
            
            <tag> LeetCode1500 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeå‘¨èµ›æ‰“å¡è®°å½•</title>
      <link href="/post/LeetCodeContest.html"/>
      <url>/post/LeetCodeContest.html</url>
      
        <content type="html"><![CDATA[<p><a href="https://clist.by/coder/michealxie94/"><img src="/post/LeetCodeContest/clist.png" class title="img"></a></p><div class="table-container"><table><thead><tr><th style="text-align:left">æ—¥æœŸ</th><th style="text-align:center">ç«èµ›</th><th style="text-align:center">ç«èµ›åˆ†æ•°/Î”</th><th style="text-align:center">rank/æ€»äººæ•°</th><th style="text-align:center">ç™¾åˆ†æ¯”</th><th style="text-align:center">å¾—åˆ†/æ€»åˆ†</th><th style="text-align:center">Knight/Guardian</th></tr></thead><tbody><tr><td style="text-align:left">2023-07-16</td><td style="text-align:center"><a href="https://leetcode.cn/contest/weekly-contest-354/">weekly-354</a></td><td style="text-align:center"><code>1666/-25</code></td><td style="text-align:center">2419 / 3957</td><td style="text-align:center">å‰61.13%</td><td style="text-align:center"><code>3/17</code></td><td style="text-align:center"><code> / </code></td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">åˆ†æ•°</th><th style="text-align:center">éš¾åº¦</th><th style="text-align:left">é¢˜å·</th><th style="text-align:center">AC time</th><th style="text-align:center">æ€è·¯</th><th style="text-align:center">å¤‡  æ³¨</th></tr></thead><tbody><tr><td style="text-align:left">3</td><td style="text-align:center"></td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC6889.html">6889. ç‰¹æ®Šå…ƒç´ å¹³æ–¹å’Œ</a></td><td style="text-align:center">0:04:14</td><td style="text-align:center">æ¨¡æ‹Ÿ</td><td style="text-align:center"></td></tr><tr><td style="text-align:left">4</td><td style="text-align:center"></td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC6929.html">6929. æ•°ç»„çš„æœ€å¤§ç¾ä¸½å€¼</a></td><td style="text-align:center"></td><td style="text-align:center">æ’åº+äºŒåˆ† / åŒºé—´ä¿®æ”¹</td><td style="text-align:center">æœ‰åºæ•°ç»„å¿˜è®°äº†äºŒåˆ†æŸ¥æ‰¾</td></tr><tr><td style="text-align:left">4</td><td style="text-align:center"></td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC6927.html">6927. åˆæ³•åˆ†å‰²çš„æœ€å°ä¸‹æ ‡</a></td><td style="text-align:center"></td><td style="text-align:center">hash+è´ªå¿ƒ</td><td style="text-align:center">æ²¡æ—¶é—´åš</td></tr><tr><td style="text-align:left">6</td><td style="text-align:center"></td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC6924.html">6924. æœ€é•¿åˆæ³•å­å­—ç¬¦ä¸²çš„é•¿åº¦</a></td><td style="text-align:center"></td><td style="text-align:center">å­—ç¬¦ä¸²</td><td style="text-align:center"></td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">æ—¥æœŸ</th><th style="text-align:center">ç«èµ›</th><th style="text-align:center">ç«èµ›åˆ†æ•°/Î”</th><th style="text-align:center">rank/æ€»äººæ•°</th><th style="text-align:center">ç™¾åˆ†æ¯”</th><th style="text-align:center">å¾—åˆ†/æ€»åˆ†</th><th style="text-align:center">Knight/Guardian</th></tr></thead><tbody><tr><td style="text-align:left">2023-07-09</td><td style="text-align:center"><a href="https://leetcode.cn/contest/weekly-contest-353/">weekly-353</a></td><td style="text-align:center"><code>1691/+37</code></td><td style="text-align:center">1083 / 4112</td><td style="text-align:center">å‰26.33%</td><td style="text-align:center"><code>12/17</code></td><td style="text-align:center"><code>1884/2262</code></td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">åˆ†æ•°</th><th style="text-align:center">éš¾åº¦<code>6544</code></th><th style="text-align:left">é¢˜å·</th><th style="text-align:center">AC time</th><th style="text-align:center">æ€è·¯</th><th style="text-align:center">å¤‡  æ³¨</th></tr></thead><tbody><tr><td style="text-align:left">3</td><td style="text-align:center">1191</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2769.html">2769. æ‰¾å‡ºæœ€å¤§çš„å¯è¾¾æˆæ•°å­—</a></td><td style="text-align:center">0:01:42</td><td style="text-align:center">æ•°å­¦ã€æ¨¡æ‹Ÿ</td><td style="text-align:center"></td></tr><tr><td style="text-align:left">4</td><td style="text-align:center">1533</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2770.html">2770. è¾¾åˆ°æœ«å°¾ä¸‹æ ‡æ‰€éœ€çš„æœ€å¤§è·³è·ƒæ¬¡æ•°</a></td><td style="text-align:center">0:09:37</td><td style="text-align:center">çº¿æ€§dp</td><td style="text-align:center">WA1æ¬¡<p>(è´ªå¿ƒ or dpä¼˜å…ˆè€ƒè™‘dp)</p></td></tr><tr><td style="text-align:left">5</td><td style="text-align:center">1791</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2771.html">2771. æ„é€ æœ€é•¿éé€’å‡å­æ•°ç»„</a></td><td style="text-align:center">0:34:07</td><td style="text-align:center">äºŒç»´dp</td><td style="text-align:center">WA2æ¬¡</td></tr><tr><td style="text-align:left">5</td><td style="text-align:center">2029</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2772.html">2772. ä½¿æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ç­‰äºé›¶</a></td><td style="text-align:center"></td><td style="text-align:center">å·®åˆ† or çº¿æ®µæ ‘</td><td style="text-align:center">æš´åŠ›è¶…æ—¶/åŒºé—´ä¿®æ”¹</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">æ—¥æœŸ</th><th style="text-align:center">ç«èµ›</th><th style="text-align:center">ç«èµ›åˆ†æ•°/Î”</th><th style="text-align:center">rank/æ€»äººæ•°</th><th style="text-align:center">ç™¾åˆ†æ¯”</th><th style="text-align:center">å¾—åˆ†/æ€»åˆ†</th></tr></thead><tbody><tr><td style="text-align:left">2023-07-08</td><td style="text-align:center"><a href="https://leetcode.cn/contest/biweekly-contest-108/">biweekly-108</a></td><td style="text-align:center"><code>1654/-4</code></td><td style="text-align:center">1058 / 2349</td><td style="text-align:center">å‰45.04%</td><td style="text-align:center"><code>7/16</code></td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">åˆ†æ•°</th><th style="text-align:center">éš¾åº¦<code>7232</code></th><th style="text-align:left">é¢˜å·</th><th style="text-align:center">AC time</th><th style="text-align:center">æ€è·¯</th><th style="text-align:center">å¤‡  æ³¨</th></tr></thead><tbody><tr><td style="text-align:left">3</td><td style="text-align:center">1580</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2765.html">2765. æœ€é•¿äº¤æ›¿å­åºåˆ—</a></td><td style="text-align:center">0:11:29</td><td style="text-align:center">æ¨¡æ‹Ÿ</td><td style="text-align:center">WA3æ¬¡</td></tr><tr><td style="text-align:left">4</td><td style="text-align:center">1613</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2766.html">2766. é‡æ–°æ”¾ç½®çŸ³å—</a></td><td style="text-align:center">0:17:11</td><td style="text-align:center">æ¨¡æ‹Ÿ</td><td style="text-align:center"></td></tr><tr><td style="text-align:left">4</td><td style="text-align:center">1864</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2767.html">2767. å°†å­—ç¬¦ä¸²åˆ†å‰²ä¸ºæœ€å°‘çš„ç¾ä¸½å­å­—ç¬¦ä¸²</a></td><td style="text-align:center">01:31:00</td><td style="text-align:center"></td><td style="text-align:center">è€ƒè¯•ç»“æŸ1åˆ†é’Ÿdebugå‡ºæ¥<p>5çš„å¹‚æ¬¡æ–¹å’Œ5çš„å€æ•°æ··æ·†</p></td></tr><tr><td style="text-align:left">5</td><td style="text-align:center">2175</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2768.html">2768. é»‘æ ¼å­çš„æ•°ç›®</a></td><td style="text-align:center"></td><td style="text-align:center">å“ˆå¸Œ+æ€ç»´é¢˜</td><td style="text-align:center">æš´åŠ›è¶…æ—¶ï¼Œæ²¡æœ‰åˆ©ç”¨æ•°ç»„ä¿¡æ¯</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">æ—¥æœŸ</th><th style="text-align:center">ç«èµ›</th><th style="text-align:center">ç«èµ›åˆ†æ•°/Î”</th><th style="text-align:center">rank/æ€»äººæ•°</th><th style="text-align:center">ç™¾åˆ†æ¯”</th><th style="text-align:center">å¾—åˆ†/æ€»åˆ†</th><th style="text-align:center">Knight/Guardian</th></tr></thead><tbody><tr><td style="text-align:left">2023-07-02</td><td style="text-align:center"><a href="https://leetcode.cn/contest/weekly-contest-352/">weekly-352</a></td><td style="text-align:center"><code>1658/+87</code></td><td style="text-align:center">395 / 3437</td><td style="text-align:center">å‰11.49%</td><td style="text-align:center"><code>13/18</code></td><td style="text-align:center"><code>1884/2260</code></td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">åˆ†æ•°</th><th style="text-align:center">éš¾åº¦<code>7141</code></th><th style="text-align:left">é¢˜å·</th><th style="text-align:center">AC time</th><th style="text-align:center">æ€è·¯</th><th style="text-align:center">å¤‡  æ³¨</th></tr></thead><tbody><tr><td style="text-align:left">3</td><td style="text-align:center">1420</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2760.html">2760. æœ€é•¿å¥‡å¶å­æ•°ç»„</a></td><td style="text-align:center">0:17:56</td><td style="text-align:center">æ¨¡æ‹Ÿ</td><td style="text-align:center">WA2æ¬¡</td></tr><tr><td style="text-align:left">4</td><td style="text-align:center">1504</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2761.html">2761. å’Œç­‰äºç›®æ ‡å€¼çš„è´¨æ•°å¯¹</a></td><td style="text-align:center">0:46:32</td><td style="text-align:center">è´¨æ•°+ç±»å¤–é¢„å¤„ç†</td><td style="text-align:center">WA4æ¬¡</td></tr><tr><td style="text-align:left">5</td><td style="text-align:center">1940</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2762.html">2762. ä¸é—´æ–­å­æ•°ç»„</a></td><td style="text-align:center"></td><td style="text-align:center">æ»‘åŠ¨çª—å£<p><code>æ ‘çŠ¶æ•°ç»„+çº¿æ®µæ ‘æ²¡è§£å†³</code></p></td><td style="text-align:center">æ²¡æ€è·¯ï¼Œä»¥ä¸ºæ˜¯çº¿æ®µæ ‘</td></tr><tr><td style="text-align:left">6</td><td style="text-align:center">2277</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2763.html">2763. æ‰€æœ‰å­æ•°ç»„ä¸­ä¸å¹³è¡¡æ•°å­—ä¹‹å’Œ</a></td><td style="text-align:center">1:28:07</td><td style="text-align:center">O(n^2logn)ã€O(n^2)<p><code>O(n)è´¡çŒ®æ³•æ²¡è§£å†³</code></p></td><td style="text-align:center">WA1æ¬¡</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">æ—¥æœŸ</th><th style="text-align:center">ç«èµ›</th><th style="text-align:center">ç«èµ›åˆ†æ•°/Î”</th><th style="text-align:center">rank/æ€»äººæ•°</th><th style="text-align:center">ç™¾åˆ†æ¯”</th><th style="text-align:center">å¾—åˆ†/æ€»åˆ†</th><th style="text-align:center">Knight/Guardian</th></tr></thead><tbody><tr><td style="text-align:left">2023-06-25</td><td style="text-align:center"><a href="https://leetcode.cn/contest/weekly-contest-351/">weekly-351</a></td><td style="text-align:center"><code>1571/-1</code></td><td style="text-align:center">1360 / 2471</td><td style="text-align:center">å‰55.03%</td><td style="text-align:center"><code>3/17</code></td><td style="text-align:center"><code>1883/2260</code></td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">åˆ†æ•°</th><th style="text-align:center">éš¾åº¦<code>7123</code></th><th style="text-align:left">é¢˜å·</th><th style="text-align:center">AC time</th><th style="text-align:center">æ€è·¯</th><th style="text-align:center">å¤‡  æ³¨</th></tr></thead><tbody><tr><td style="text-align:left">3</td><td style="text-align:center">1301</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2748.html">2748. ç¾ä¸½ä¸‹æ ‡å¯¹çš„æ•°ç›®</a></td><td style="text-align:center">0:03:25</td><td style="text-align:center">æš´åŠ›</td><td style="text-align:center"></td></tr><tr><td style="text-align:left">4</td><td style="text-align:center">2132</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2749.html">2749. å¾—åˆ°æ•´æ•°é›¶éœ€è¦æ‰§è¡Œçš„æœ€å°‘æ“ä½œæ•°</a></td><td style="text-align:center"></td><td style="text-align:center">æ€ç»´é¢˜+ä½è¿ç®—+ç»†èŠ‚å¤„ç†</td><td style="text-align:center">æœ€åä¸€ä¸ªæµ‹è¯•ç‚¹è¢«å¡<p>å¡20åˆ†é’Ÿéœ€è¦è·³è¿‡ï¼Œä¸æŒ‰éš¾åº¦é¡ºåºå‡ºé¢˜</p></td></tr><tr><td style="text-align:left">4</td><td style="text-align:center">1598</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2750.html">2750. å°†æ•°ç»„åˆ’åˆ†æˆè‹¥å¹²å¥½å­æ•°ç»„çš„æ–¹å¼</a></td><td style="text-align:center"></td><td style="text-align:center">ä¹˜æ³•è¿ç®—</td><td style="text-align:center">æ²¡æ—¶é—´</td></tr><tr><td style="text-align:left">6</td><td style="text-align:center">2092</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2751.html">2751. æœºå™¨äººç¢°æ’</a></td><td style="text-align:center"></td><td style="text-align:center">æ ˆ</td><td style="text-align:center">æ²¡æ—¶é—´</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">æ—¥æœŸ</th><th style="text-align:center">ç«èµ›</th><th style="text-align:center">ç«èµ›åˆ†æ•°/Î”</th><th style="text-align:center">rank/æ€»äººæ•°</th><th style="text-align:center">ç™¾åˆ†æ¯”</th><th style="text-align:center">å¾—åˆ†/æ€»åˆ†</th></tr></thead><tbody><tr><td style="text-align:left">2023-06-24</td><td style="text-align:center"><a href="https://leetcode.cn/contest/biweekly-contest-107/">biweekly-107</a></td><td style="text-align:center"><code>1572/-6</code></td><td style="text-align:center">1026 / 1870</td><td style="text-align:center">å‰54.86%</td><td style="text-align:center"><code>7/17</code></td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">åˆ†æ•°</th><th style="text-align:center">éš¾åº¦<code>7231</code></th><th style="text-align:left">é¢˜å·</th><th style="text-align:center">AC time</th><th style="text-align:center">æ€è·¯</th><th style="text-align:center">å¤‡  æ³¨</th></tr></thead><tbody><tr><td style="text-align:left">3</td><td style="text-align:center">1406</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2744.html">2744. æœ€å¤§å­—ç¬¦ä¸²é…å¯¹æ•°ç›®</a></td><td style="text-align:center">0:02:10</td><td style="text-align:center">æš´åŠ›</td><td style="text-align:center"></td></tr><tr><td style="text-align:left">4</td><td style="text-align:center">1607</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2745.html">2745. æ„é€ æœ€é•¿çš„æ–°å­—ç¬¦ä¸²</a></td><td style="text-align:center">0:46:30</td><td style="text-align:center">æ€ç»´é¢˜</td><td style="text-align:center"></td></tr><tr><td style="text-align:left">4</td><td style="text-align:center">2126</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2746.html">2746. å­—ç¬¦ä¸²è¿æ¥åˆ å‡å­—æ¯</a></td><td style="text-align:center"></td><td style="text-align:center"><code>æ²¡è§£å†³</code></td><td style="text-align:center"></td></tr><tr><td style="text-align:left">6</td><td style="text-align:center">2092</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2747.html">2747. ç»Ÿè®¡æ²¡æœ‰æ”¶åˆ°è¯·æ±‚çš„æœåŠ¡å™¨æ•°ç›®</a></td><td style="text-align:center"></td><td style="text-align:center"><code>æ²¡è§£å†³</code>ç¦»çº¿æŸ¥è¯¢</td><td style="text-align:center">æš´åŠ›è¶…æ—¶</td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">æ—¥æœŸ</th><th style="text-align:center">ç«èµ›</th><th style="text-align:center">ç«èµ›åˆ†æ•°/Î”</th><th style="text-align:center">rank/æ€»äººæ•°</th><th style="text-align:center">ç™¾åˆ†æ¯”</th><th style="text-align:center">å¾—åˆ†/æ€»åˆ†</th><th style="text-align:center">Knight/Guardian</th></tr></thead><tbody><tr><td style="text-align:left">2023-06-18</td><td style="text-align:center"><a href="https://leetcode.cn/contest/weekly-contest-350/">weekly-350</a></td><td style="text-align:center"><code>1578/+49</code></td><td style="text-align:center">967 / 3580</td><td style="text-align:center">å‰27.01%</td><td style="text-align:center"><code>7/18</code></td><td style="text-align:center"><code>1883/2259</code></td></tr></tbody></table></div><div class="table-container"><table><thead><tr><th style="text-align:left">åˆ†æ•°</th><th style="text-align:center">éš¾åº¦<code>7007</code></th><th style="text-align:left">é¢˜å·</th><th style="text-align:center">AC time</th><th style="text-align:center">æ€è·¯</th><th style="text-align:center">å¤‡  æ³¨</th></tr></thead><tbody><tr><td style="text-align:left">3</td><td style="text-align:center">1262</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2739.html">2739. æ€»è¡Œé©¶è·ç¦»</a></td><td style="text-align:center">0:05:59</td><td style="text-align:center">æš´åŠ›</td><td style="text-align:center"></td></tr><tr><td style="text-align:left">4</td><td style="text-align:center">1301</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2740.html">2740. æ‰¾å‡ºåˆ†åŒºå€¼</a></td><td style="text-align:center">0:09:12</td><td style="text-align:center">æ’åº</td><td style="text-align:center"></td></tr><tr><td style="text-align:left">4</td><td style="text-align:center">2020</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2741.html">2741. ç‰¹åˆ«çš„æ’åˆ—</a></td><td style="text-align:center"></td><td style="text-align:center">dfs+çŠ¶æ€å‹ç¼©</td><td style="text-align:center">dfs+visitæ•°ç»„è¶…æ—¶</td></tr><tr><td style="text-align:left">6</td><td style="text-align:center">2424</td><td style="text-align:left"><a href="https://michealxie94.github.io/post/LC2742.html">2742. ç»™å¢™å£åˆ·æ²¹æ¼†</a></td><td style="text-align:center"></td><td style="text-align:center"><code>æ²¡è§£å†³</code></td><td style="text-align:center"></td></tr></tbody></table></div>]]></content>
      
      
      <categories>
          
          <category> LeetCodeå‘¨èµ› </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Hexo Butterflyæ­å»ºè¿‡ç¨‹å’Œè§£å†³æ–¹æ¡ˆ</title>
      <link href="/post/e5341844.html"/>
      <url>/post/e5341844.html</url>
      
        <content type="html"><![CDATA[<p><code></code></p><h2 id="hexoåˆæ¬¡æ­å»º-2023-06-27"><a href="#hexoåˆæ¬¡æ­å»º-2023-06-27" class="headerlink" title="hexoåˆæ¬¡æ­å»º (2023.06.27)"></a>hexoåˆæ¬¡æ­å»º (2023.06.27)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://maets-906.github.io/2023/04/11/%E5%9F%BA%E4%BA%8EHexo-Github%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/">åŸºäºHexo+Githubæ­å»ºä¸ªäººåšå®¢</a><br><a href="https://www.bilibili.com/video/BV1NY4y1C7Ng/">ã€2022æœ€æ–°ç‰ˆã€‘ä¿å§†çº§Hexo+githubæ­å»ºä¸ªäººåšå®¢å¹¶ç»‘å®šè‡ªå·±çš„åŸŸå</a></p><h2 id="æ·»åŠ è®¿å®¢åœ°å›¾-2023-07-05"><a href="#æ·»åŠ è®¿å®¢åœ°å›¾-2023-07-05" class="headerlink" title="æ·»åŠ è®¿å®¢åœ°å›¾ (2023.07.05)"></a>æ·»åŠ è®¿å®¢åœ°å›¾ (2023.07.05)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://blog.csdn.net/cungudafa/article/details/105925710">hexo(butterfly)åŠ å…¥clustrmapsè®¿é—®è€…åœ°å›¾</a></p><h2 id="æ·»åŠ twikooè¯„è®ºç³»ç»Ÿ-2023-07-03"><a href="#æ·»åŠ twikooè¯„è®ºç³»ç»Ÿ-2023-07-03" class="headerlink" title="æ·»åŠ twikooè¯„è®ºç³»ç»Ÿ (2023.07.03)"></a>æ·»åŠ <code>twikoo</code>è¯„è®ºç³»ç»Ÿ (2023.07.03)</h2><p>éš¾åº¦ï¼š<code>hard</code><br><a href="https://fe32.top/articles/hexo1611/">åŸºäº Hexo é”®å…¥è¯„è®ºåŠŸèƒ½ - Twikoo Vercel éƒ¨ç½²æ•™ç¨‹</a><br><code>bug:Vercel</code>éƒ¨ç½²ç»“æŸï¼Œåªæ˜¾ç¤ºç™»å½•å¯†ç ï¼Œæ²¡æœ‰æ³¨å†Œå¯†ç ç•Œé¢</p><p>éš¾åº¦ï¼š<code>medium</code><br><a href="https://ganzhe2028.github.io/posts/20419#">ä½¿ç”¨ zeabur éƒ¨ç½² twikoo</a><br><code>bugï¼š</code>åŒæ ·å‡ºç°æ²¡æœ‰æ³¨å†Œå¯†ç ç•Œé¢ï¼ŒåŸå› ï¼šé…ç½®<code>zeabur domain</code>åéœ€è¦<code>redeploy</code></p><h2 id="æ·»åŠ twikooè¯„è®ºç³»ç»Ÿé‚®ä»¶æ¨é€-2023-07-04"><a href="#æ·»åŠ twikooè¯„è®ºç³»ç»Ÿé‚®ä»¶æ¨é€-2023-07-04" class="headerlink" title="æ·»åŠ twikooè¯„è®ºç³»ç»Ÿé‚®ä»¶æ¨é€ (2023.07.04)"></a>æ·»åŠ <code>twikoo</code>è¯„è®ºç³»ç»Ÿé‚®ä»¶æ¨é€ (2023.07.04)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://blog.csdn.net/weixin_58068682/article/details/122770936#">éƒ¨ç½²Twikooè¯„è®ºç³»ç»ŸåŠå…¶é‚®ä»¶æ¨é€(Vercel)</a></p><h2 id="githubä¸ªäººç½‘ç«™åŠ é€Ÿ-2023-07-04"><a href="#githubä¸ªäººç½‘ç«™åŠ é€Ÿ-2023-07-04" class="headerlink" title="githubä¸ªäººç½‘ç«™åŠ é€Ÿ (2023.07.04)"></a><code>github</code>ä¸ªäººç½‘ç«™åŠ é€Ÿ (2023.07.04)</h2><p>éš¾åº¦ï¼š<code>easy</code><br>å°†ä¸ªäººç½‘ç«™æ·»åŠ åˆ°<code>zeabur</code>ä¸­ï¼ŒåŒ2<br><a href="https://ganzhe2028.github.io/posts/20419#">ä½¿ç”¨ zeabur éƒ¨ç½² twikoo</a></p><h2 id="æ·»åŠ twikooè¯„è®ºç³»ç»Ÿè¡¨æƒ…åŒ…-2023-07-04-å°šæœªè§£å†³"><a href="#æ·»åŠ twikooè¯„è®ºç³»ç»Ÿè¡¨æƒ…åŒ…-2023-07-04-å°šæœªè§£å†³" class="headerlink" title="æ·»åŠ twikooè¯„è®ºç³»ç»Ÿè¡¨æƒ…åŒ… (2023.07.04 å°šæœªè§£å†³)"></a>æ·»åŠ <code>twikoo</code>è¯„è®ºç³»ç»Ÿè¡¨æƒ…åŒ… (2023.07.04 å°šæœªè§£å†³)</h2><p>éš¾åº¦ï¼š<br><a href="https://github.com/2X-ercha/Twikoo-Magic">Twikoo-Magic</a><br><a href="https://dalinziaixiaozhouzhou.gitee.io/posts/255e503ca">Twikooè¡¨æƒ…åŒ…ä¿®æ”¹</a><br><code>bugï¼š</code>ä¸çŸ¥å¦‚ä½•ä¸Šä¼ è¡¨æƒ…åŒ…<code>json</code>åˆ°æœåŠ¡å™¨ï¼Œä¸Šä¼ åˆ°<code>github</code>ç›®å‰ä¸èƒ½é…ç½®å¥½</p><h2 id="æ·»åŠ socialå›¾æ ‡-2023-07-05"><a href="#æ·»åŠ socialå›¾æ ‡-2023-07-05" class="headerlink" title="æ·»åŠ socialå›¾æ ‡ (2023.07.05)"></a>æ·»åŠ <code>social</code>å›¾æ ‡ (2023.07.05)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://fontawesome.com/search">fontawesome</a><br>æœç´¢å›¾æ ‡ï¼Œå¯ä»¥ä¿®æ”¹æ ·å¼å’Œé¢œè‰²</p><h2 id="æ·»åŠ å¤©æ°”æ’ä»¶-2023-06-29"><a href="#æ·»åŠ å¤©æ°”æ’ä»¶-2023-06-29" class="headerlink" title="æ·»åŠ å¤©æ°”æ’ä»¶ (2023.06.29)"></a>æ·»åŠ å¤©æ°”æ’ä»¶ (2023.06.29)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://han1eng.github.io/2023/03/02/widget-weather/">Hexo æ·»åŠ å¤©æ°”æ’ä»¶</a></p><h2 id="æ·»åŠ æœç´¢åŠŸèƒ½-2023-06-28-å°šæœªè§£å†³"><a href="#æ·»åŠ æœç´¢åŠŸèƒ½-2023-06-28-å°šæœªè§£å†³" class="headerlink" title="æ·»åŠ æœç´¢åŠŸèƒ½ (2023.06.28 å°šæœªè§£å†³)"></a>æ·»åŠ æœç´¢åŠŸèƒ½ (2023.06.28 å°šæœªè§£å†³)</h2><p>éš¾åº¦ï¼š<code>medium</code><br><a href="https://fe32.top/articles/hexo1607/">åŸºäº Hexo é”®å…¥æœç´¢åŠŸèƒ½</a><br><code>Local search</code>    å…¨æ–‡æœç´¢   (ç›®å‰é‡‡ç”¨)<br><code>Algolia</code>         æ ‡é¢˜æœç´¢   (å¯å®ç°ï¼Œå¹¶æœªé‡‡ç”¨)<br><code>Algoliasearch</code>   å…¨æ–‡æœç´¢   (é‡åˆ°é—®é¢˜ï¼Œå°šæœªè§£å†³)</p><h2 id="æ·»åŠ è¡¨æ ¼-2023-07-05"><a href="#æ·»åŠ è¡¨æ ¼-2023-07-05" class="headerlink" title="æ·»åŠ è¡¨æ ¼ (2023.07.05)"></a>æ·»åŠ è¡¨æ ¼ (2023.07.05)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://blog.csdn.net/qq_34745941/article/details/111499783">Markdown å•å…ƒæ ¼åˆå¹¶è¯¦è§£ï¼ˆrowspanã€colspanï¼‰</a></p><p><table border="1">    <tr>        <th align="center">æ ‡é¢˜ 1</th>   <!-- å·¦å¯¹é½ -->        <th align="center">æ ‡é¢˜ 2</th> <!-- å±…ä¸­å¯¹é½ï¼ˆé»˜è®¤ï¼‰-->        <th align="center">æ ‡é¢˜ 3</th>  <!-- å³å¯¹é½-->    </tr>    <tr>        <td rowspan="2">col 11</td>        <td>col 12</td>        <td>col 13</td>    </tr>    <tr>        <td>col 22</td>        <td>col 23</td>    </tr></table><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span>æ ‡é¢˜ 1<span class="tag">&lt;/<span class="name">th</span>&gt;</span>   <span class="comment">&lt;!-- å·¦å¯¹é½ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span>æ ‡é¢˜ 2<span class="tag">&lt;/<span class="name">th</span>&gt;</span> <span class="comment">&lt;!-- å±…ä¸­å¯¹é½ï¼ˆé»˜è®¤ï¼‰--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span>æ ‡é¢˜ 3<span class="tag">&lt;/<span class="name">th</span>&gt;</span>  <span class="comment">&lt;!-- å³å¯¹é½--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">rowspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>col 11<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>col 12<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>col 13<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>col 22<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>col 23<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="å®˜æ–¹æ•™ç¨‹-2023-07-05"><a href="#å®˜æ–¹æ•™ç¨‹-2023-07-05" class="headerlink" title="å®˜æ–¹æ•™ç¨‹ (2023.07.05)"></a>å®˜æ–¹æ•™ç¨‹ (2023.07.05)</h2><p><a href="https://markdown.com.cn/">Markdown</a><br><a href="https://twikoo.js.org/">twikoo</a></p><h2 id="æŠ¥é”™spwan-failed-2023-07-05"><a href="#æŠ¥é”™spwan-failed-2023-07-05" class="headerlink" title="æŠ¥é”™spwan failed (2023.07.05)"></a>æŠ¥é”™spwan failed (2023.07.05)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://www.cnblogs.com/cairbin/p/14957855.html">è§£å†³hexoæŠ¥é”™spwan failed</a></p><h2 id="æ·»åŠ æ–‡ç« ç½®é¡¶åŠŸèƒ½-2023-07-06"><a href="#æ·»åŠ æ–‡ç« ç½®é¡¶åŠŸèƒ½-2023-07-06" class="headerlink" title="æ·»åŠ æ–‡ç« ç½®é¡¶åŠŸèƒ½ (2023.07.06)"></a>æ·»åŠ æ–‡ç« ç½®é¡¶åŠŸèƒ½ (2023.07.06)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://blog.csdn.net/weixin_43372529/article/details/114176470">hexoåšå®¢ä¸»é¢˜ Butterflyä¼˜åŒ–ä¹‹æ–‡ç« ç½®é¡¶</a></p><h2 id="markdownæ•°å­¦å…¬å¼-2023-07-06"><a href="#markdownæ•°å­¦å…¬å¼-2023-07-06" class="headerlink" title="markdownæ•°å­¦å…¬å¼  (2023.07.06)"></a><code>markdown</code>æ•°å­¦å…¬å¼  (2023.07.06)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://blog.csdn.net/Darlingqiang/article/details/119620489">Markdownæ•°å­¦ç¬¦å·&amp;å…¬å¼ï¼ˆå²ä¸Šæœ€å…¨å…¬å¼è¡¨ï¼‰</a></p><h2 id="åšå®¢æ–‡ç« æ€»ç»“TianliGPT-2023-07-12æ”¶è´¹æ²¡æ"><a href="#åšå®¢æ–‡ç« æ€»ç»“TianliGPT-2023-07-12æ”¶è´¹æ²¡æ" class="headerlink" title="åšå®¢æ–‡ç« æ€»ç»“TianliGPT  (2023.07.12æ”¶è´¹æ²¡æ)"></a>åšå®¢æ–‡ç« æ€»ç»“<code>TianliGPT</code>  (2023.07.12æ”¶è´¹æ²¡æ)</h2><p>éš¾åº¦ï¼š<code>easy</code><br><a href="https://github.com/zhheo/Post-Abstract-AI">TianliGPT</a><br><a href="https://flowus.cn/zhheo/share/927667b2-ba27-42b1-98f2-8fb184720ed2">hexo-theme-butterflyé…ç½®æ–¹æ³•</a><br><a href="https://afdian.net/item/f18c2e08db4411eda2f25254001e7c00">è´­ä¹°é“¾æ¥</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LC2601. è´¨æ•°å‡æ³•è¿ç®—</title>
      <link href="/post/LC2601.html"/>
      <url>/post/LC2601.html</url>
      
        <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» <strong>0</strong> å¼€å§‹çš„æ•´æ•°æ•°ç»„ <code>nums</code> ï¼Œæ•°ç»„é•¿åº¦ä¸º <code>n</code> ã€‚</p><p>ä½ å¯ä»¥æ‰§è¡Œæ— é™æ¬¡ä¸‹è¿°è¿ç®—ï¼š</p><ul>    <li>é€‰æ‹©ä¸€ä¸ªä¹‹å‰æœªé€‰è¿‡çš„ä¸‹æ ‡ <code>i</code> ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ª <strong>ä¸¥æ ¼å°äº</strong> <code>nums[i]</code> çš„è´¨æ•° <code>p</code> ï¼Œä» <code>nums[i]</code> ä¸­å‡å» <code>p</code> ã€‚</li></ul><p>å¦‚æœä½ èƒ½é€šè¿‡ä¸Šè¿°è¿ç®—ä½¿å¾— <code>nums</code> æˆä¸ºä¸¥æ ¼é€’å¢æ•°ç»„ï¼Œåˆ™è¿”å› <code>true</code> ï¼›å¦åˆ™è¿”å› <code>false</code> ã€‚</p><p><strong>ä¸¥æ ¼é€’å¢æ•°ç»„</strong> ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½ä¸¥æ ¼å¤§äºå…¶å‰é¢çš„å…ƒç´ ã€‚</p><p>&nbsp;</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>nums = [4,9,6,10]<strong>è¾“å‡ºï¼š</strong>true<strong>è§£é‡Šï¼š</strong>åœ¨ç¬¬ä¸€æ¬¡è¿ç®—ä¸­ï¼šé€‰æ‹© i = 0 å’Œ p = 3 ï¼Œç„¶åä» nums[0] å‡å» 3 ï¼Œnums å˜ä¸º [1,9,6,10] ã€‚åœ¨ç¬¬äºŒæ¬¡è¿ç®—ä¸­ï¼šé€‰æ‹© i = 1 å’Œ p = 7 ï¼Œç„¶åä» nums[1] å‡å» 7 ï¼Œnums å˜ä¸º [1,2,6,10] ã€‚ç¬¬äºŒæ¬¡è¿ç®—åï¼Œnums æŒ‰ä¸¥æ ¼é€’å¢é¡ºåºæ’åºï¼Œå› æ­¤ç­”æ¡ˆä¸º true ã€‚</pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>nums = [6,8,11,12]<strong>è¾“å‡ºï¼š</strong>true<strong>è§£é‡Šï¼š</strong>nums ä»ä¸€å¼€å§‹å°±æŒ‰ä¸¥æ ¼é€’å¢é¡ºåºæ’åºï¼Œå› æ­¤ä¸éœ€è¦æ‰§è¡Œä»»ä½•è¿ç®—ã€‚</pre><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>nums = [5,8,3]<strong>è¾“å‡ºï¼š</strong>false<strong>è§£é‡Šï¼š</strong>å¯ä»¥è¯æ˜ï¼Œæ‰§è¡Œè¿ç®—æ— æ³•ä½¿ nums æŒ‰ä¸¥æ ¼é€’å¢é¡ºåºæ’åºï¼Œå› æ­¤ç­”æ¡ˆæ˜¯ false ã€‚</pre><p>&nbsp;</p><p><strong>æç¤ºï¼š</strong></p><p><ul>    <li><code>1 &lt;= nums.length &lt;= 1000</code></li>    <li><code>1 &lt;= nums[i] &lt;= 1000</code></li>    <li><code>nums.length == n</code></li></ul></p><h2 id="æ€è·¯åˆ†æ"><a href="#æ€è·¯åˆ†æ" class="headerlink" title="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ</h2><p>é€†å‘æ€è€ƒï¼Œä»åå¾€å‰æ‰¾ï¼Œè®°å½•<code>last</code><br>å¦‚æœå½“å‰<code>x &lt; last</code>,åˆ™<code>continue</code><br>å¦‚æœå½“å‰<code>x &gt;= last</code>,åˆ™<code>x - p &lt; last</code> (<code>x-p</code>è¦è¶³å¤Ÿçš„å¤§ï¼Œåˆ™<code>p</code>éœ€è¦è¶³å¤Ÿçš„å°),ç­‰ä»·äº<code> p &gt; x - last</code>,<code>p</code>æ˜¯æ¯”<code>x-last</code>å¤§çš„æœ€å°è´¨æ•°<br>WAæ³¨æ„ï¼šéœ€è¦é¢å¤–å¢åŠ ä¸€ä¸ªè´¨æ•°ï¼Œå¯ä»¥æŠŠ<code>N</code>è®¾ç½®å¤§ä¸€äº›ã€‚<br>å¦‚æœ <code>last &lt;= 0</code>,è¯´æ˜å½“å‰çš„<code>p</code>å¹¶æ²¡æœ‰ä¸¥æ ¼å°äº<code>x</code>ï¼Œè¿”å›<code>False</code><br>ä¾‹å¦‚<code>[5,3,8]</code><br><code>last = inf,x = 3,3 &lt; inf,last = 3</code><br><code>last = 3,  x = 8,8 &gt; 3,  last = 8 - 7 = 1</code><br><code>last = 1,  x = 5,5 &gt; 1,  last = 5 - 5 = 0</code>(æ²¡æœ‰ä¸¥æ ¼é€’å¢)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¢„å¤„ç†</span></span><br><span class="line">MX = <span class="number">10</span> ** <span class="number">4</span> + <span class="number">1</span></span><br><span class="line">primes = [<span class="number">0</span>]</span><br><span class="line">is_prime = [<span class="literal">True</span>] * MX</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, MX):</span><br><span class="line">    <span class="keyword">if</span> is_prime[i]:</span><br><span class="line">        primes.append(i)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i * i, MX, i):</span><br><span class="line">            is_prime[j] = <span class="literal">False</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="comment"># æ­£å‘æ€è€ƒ</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">primeSubOperation_1</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        pre = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            <span class="keyword">if</span> x &lt;= pre:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            idx = bisect.bisect_left(primes,x - pre)-<span class="number">1</span></span><br><span class="line">            pre = x - primes[idx]</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># é€†å‘æ€è€ƒ</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">primeSubOperation</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        last = inf</span><br><span class="line">        n = <span class="built_in">len</span>(nums)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">            x = nums[i]</span><br><span class="line">            <span class="keyword">if</span> x &lt; last:</span><br><span class="line">                last = x</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                idx = bisect.bisect_left(primes,x - last + <span class="number">10e-9</span>)</span><br><span class="line">                last = x - primes[idx]</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> last &lt;= <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        </span><br></pre></td></tr></table></figure></p><h2 id="çµç¥ä»£ç "><a href="#çµç¥ä»£ç " class="headerlink" title="çµç¥ä»£ç "></a><a href="https://leetcode.cn/problems/prime-subtraction-operation/solution/jian-ji-xie-fa-shai-zhi-shu-er-fen-cha-z-wj7i/">çµç¥ä»£ç </a></h2><p>è®¾<code>pre</code>æ˜¯ä¸Šä¸€ä¸ªå‡å®Œåçš„æ•°å­—ï¼Œ<code>x=nums[i]</code> ä¸ºå½“å‰æ•°å­—ã€‚<br>è®¾<code>p</code>æ˜¯æ»¡è¶³<code>xâˆ’p&gt;pre</code> çš„æœ€å¤§è´¨æ•°ï¼Œæ¢è¨€ä¹‹<code>p </code>æ˜¯å°äº<code>xâˆ’pre </code>çš„æœ€å¤§è´¨æ•°ï¼Œè¿™å¯ä»¥é¢„å¤„ç†è´¨æ•°åˆ—è¡¨åï¼Œç”¨äºŒåˆ†æŸ¥æ‰¾å¾—åˆ°ã€‚<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MX = <span class="number">1000</span></span><br><span class="line">P = [<span class="number">0</span>]  <span class="comment"># å“¨å…µï¼Œé¿å…äºŒåˆ†è¶Šç•Œ</span></span><br><span class="line">is_prime = [<span class="literal">True</span>] * MX</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, MX):</span><br><span class="line">    <span class="keyword">if</span> is_prime[i]:</span><br><span class="line">        P.append(i)  <span class="comment"># é¢„å¤„ç†è´¨æ•°åˆ—è¡¨</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i * i, MX, i):</span><br><span class="line">            is_prime[j] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">primeSubOperation</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        pre = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> nums:</span><br><span class="line">            <span class="keyword">if</span> x &lt;= pre: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            pre = x - P[bisect_left(P, x - pre) - <span class="number">1</span>]  <span class="comment"># å‡å» &lt; x-pre çš„æœ€å¤§è´¨æ•°</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure></p><h2 id="å¤æ‚åº¦åˆ†æ"><a href="#å¤æ‚åº¦åˆ†æ" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>æ—¶é—´å¤æ‚åº¦ï¼šO(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="5.943ex" height="2.034ex" role="img" focusable="false" viewbox="0 -694 2627 899" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-5-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"/><path id="MJX-5-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/><path id="MJX-5-TEX-I-1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"/><path id="MJX-5-TEX-I-1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-5-TEX-I-1D45B"/></g><g data-mml-node="mi" transform="translate(600,0)"><use data-c="1D459" xlink:href="#MJX-5-TEX-I-1D459"/></g><g data-mml-node="mi" transform="translate(898,0)"><use data-c="1D45C" xlink:href="#MJX-5-TEX-I-1D45C"/></g><g data-mml-node="mi" transform="translate(1383,0)"><use data-c="1D454" xlink:href="#MJX-5-TEX-I-1D454"/></g><g data-mml-node="mi" transform="translate(1860,0)"><use data-c="1D448" xlink:href="#MJX-5-TEX-I-1D448"/></g></g></g></g></svg></mjx-container>)ï¼Œå…¶ä¸­ <code>n</code> ä¸º <code>nums</code> çš„é•¿åº¦ï¼Œ<code>U</code> ä¸º <code>1000</code> ä»¥å†…çš„è´¨æ•°ä¸ªæ•°ã€‚<br>ç©ºé—´å¤æ‚åº¦ï¼šO(1)</p>]]></content>
      
      
      <categories>
          
          <category> LeetCode-medium </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äºŒåˆ†æŸ¥æ‰¾ </tag>
            
            <tag> è´ªå¿ƒ </tag>
            
            <tag> LCå‘¨èµ›Q2 </tag>
            
            <tag> LeetCode1700 </tag>
            
            <tag> è´¨æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LC2679. çŸ©é˜µä¸­çš„å’Œ</title>
      <link href="/post/LC2679.html"/>
      <url>/post/LC2679.html</url>
      
        <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» <strong>0</strong>&nbsp;å¼€å§‹çš„äºŒç»´æ•´æ•°æ•°ç»„&nbsp;<code>nums</code>&nbsp;ã€‚ä¸€å¼€å§‹ä½ çš„åˆ†æ•°ä¸º&nbsp;<code>0</code>&nbsp;ã€‚ä½ éœ€è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œç›´åˆ°çŸ©é˜µå˜ä¸ºç©ºï¼š</p><ol>    <li>çŸ©é˜µä¸­æ¯ä¸€è¡Œé€‰å–æœ€å¤§çš„ä¸€ä¸ªæ•°ï¼Œå¹¶åˆ é™¤å®ƒã€‚å¦‚æœä¸€è¡Œä¸­æœ‰å¤šä¸ªæœ€å¤§çš„æ•°ï¼Œé€‰æ‹©ä»»æ„ä¸€ä¸ªå¹¶åˆ é™¤ã€‚</li>    <li>åœ¨æ­¥éª¤ 1 åˆ é™¤çš„æ‰€æœ‰æ•°å­—ä¸­æ‰¾åˆ°æœ€å¤§çš„ä¸€ä¸ªæ•°å­—ï¼Œå°†å®ƒæ·»åŠ åˆ°ä½ çš„ <strong>åˆ†æ•°</strong>&nbsp;ä¸­ã€‚</li></ol><p>è¯·ä½ è¿”å›æœ€åçš„ <strong>åˆ†æ•°</strong>&nbsp;ã€‚</p><p>&nbsp;</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><b>è¾“å…¥ï¼š</b>nums = [[7,2,1],[6,4,2],[6,5,3],[3,2,1]]<b>è¾“å‡ºï¼š</b>15<b>è§£é‡Šï¼š</b>ç¬¬ä¸€æ­¥æ“ä½œä¸­ï¼Œæˆ‘ä»¬åˆ é™¤ 7 ï¼Œ6 ï¼Œ6 å’Œ 3 ï¼Œå°†åˆ†æ•°å¢åŠ  7 ã€‚ä¸‹ä¸€æ­¥æ“ä½œä¸­ï¼Œåˆ é™¤ 2 ï¼Œ4 ï¼Œ5 å’Œ 2 ï¼Œå°†åˆ†æ•°å¢åŠ  5 ã€‚æœ€ååˆ é™¤ 1 ï¼Œ2 ï¼Œ3 å’Œ 1 ï¼Œå°†åˆ†æ•°å¢åŠ  3 ã€‚æ‰€ä»¥æ€»å¾—åˆ†ä¸º 7 + 5 + 3 = 15 ã€‚</pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><b>è¾“å…¥ï¼š</b>nums = [[1]]<b>è¾“å‡ºï¼š</b>1<b>è§£é‡Šï¼š</b>æˆ‘ä»¬åˆ é™¤ 1 å¹¶å°†åˆ†æ•°å¢åŠ  1 ï¼Œæ‰€ä»¥è¿”å› 1 ã€‚</pre><p>&nbsp;</p><p><strong>æç¤ºï¼š</strong></p><ul>    <li><code>1 &lt;= nums.length &lt;= 300</code></li>    <li><code>1 &lt;= nums[i].length &lt;= 500</code></li>    <li><code>0 &lt;= nums[i][j] &lt;= 10<sup>3</sup></code></li></ul><p>å¤æ‚åº¦ O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="6.553ex" height="2.351ex" role="img" focusable="false" viewbox="0 -833.9 2896.6 1038.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-9-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-9-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/><path id="MJX-9-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"/><path id="MJX-9-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/><path id="MJX-9-TEX-I-1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-9-TEX-I-1D45B"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-9-TEX-N-32"/></g></g><g data-mml-node="mi" transform="translate(1036.6,0)"><use data-c="1D459" xlink:href="#MJX-9-TEX-I-1D459"/></g><g data-mml-node="mi" transform="translate(1334.6,0)"><use data-c="1D45C" xlink:href="#MJX-9-TEX-I-1D45C"/></g><g data-mml-node="mi" transform="translate(1819.6,0)"><use data-c="1D454" xlink:href="#MJX-9-TEX-I-1D454"/></g><g data-mml-node="mi" transform="translate(2296.6,0)"><use data-c="1D45B" xlink:href="#MJX-9-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="comment">#å¤æ‚åº¦O(n^2logn)</span></span><br><span class="line">    <span class="comment">#ç”¨å †çš„è¯å¤æ‚åº¦ä¸€æ ·</span></span><br><span class="line">    <span class="comment">#ä¸»è¦è€ƒå¯ŸçŸ©é˜µçš„è½¬ç½®</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">matrixSum</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        ans = []</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> nums:</span><br><span class="line">            tmp = <span class="built_in">sorted</span>(item)</span><br><span class="line">            ans.append(tmp)</span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> <span class="built_in">zip</span>(*ans):</span><br><span class="line">            cnt+=<span class="built_in">max</span>(item)</span><br><span class="line">        <span class="keyword">return</span> cnt</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> LeetCode-medium </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯æ—¥ä¸€é¢˜ </tag>
            
            <tag> æ’åº </tag>
            
            <tag> è´ªå¿ƒ </tag>
            
            <tag> æ¨¡æ‹Ÿ </tag>
            
            <tag> LCå‘¨èµ›Q2 </tag>
            
            <tag> LeetCode1300 </tag>
            
            <tag> çŸ©é˜µè½¬ç½® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LC2600.K ä»¶ç‰©å“çš„æœ€å¤§å’Œ</title>
      <link href="/post/LC2600.html"/>
      <url>/post/LC2600.html</url>
      
        <content type="html"><![CDATA[<hr><p>è¢‹å­ä¸­è£…æœ‰ä¸€äº›ç‰©å“ï¼Œæ¯ä¸ªç‰©å“ä¸Šéƒ½æ ‡è®°ç€æ•°å­— <code>1</code> ã€<code>0</code> æˆ– <code>-1</code> ã€‚</p><p>ç»™ä½ å››ä¸ªéè´Ÿæ•´æ•° <code>numOnes</code> ã€<code>numZeros</code> ã€<code>numNegOnes</code> å’Œ <code>k</code> ã€‚</p><p>è¢‹å­æœ€åˆåŒ…å«ï¼š</p><ul>    <li><code>numOnes</code> ä»¶æ ‡è®°ä¸º <code>1</code> çš„ç‰©å“ã€‚</li>    <li><code>numZeroes</code> ä»¶æ ‡è®°ä¸º <code>0</code> çš„ç‰©å“ã€‚</li>    <li><code>numNegOnes</code> ä»¶æ ‡è®°ä¸º <code>-1</code> çš„ç‰©å“ã€‚</li></ul><p>ç°è®¡åˆ’ä»è¿™äº›ç‰©å“ä¸­æ°å¥½é€‰å‡º <code>k</code> ä»¶ç‰©å“ã€‚è¿”å›æ‰€æœ‰å¯è¡Œæ–¹æ¡ˆä¸­ï¼Œç‰©å“ä¸Šæ‰€æ ‡è®°æ•°å­—ä¹‹å’Œçš„æœ€å¤§å€¼ã€‚</p><p>&nbsp;</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>numOnes = 3, numZeros = 2, numNegOnes = 0, k = 2<strong>è¾“å‡ºï¼š</strong>2<strong>è§£é‡Šï¼š</strong>è¢‹å­ä¸­çš„ç‰©å“åˆ†åˆ«æ ‡è®°ä¸º {1, 1, 1, 0, 0} ã€‚å– 2 ä»¶æ ‡è®°ä¸º 1 çš„ç‰©å“ï¼Œå¾—åˆ°çš„æ•°å­—ä¹‹å’Œä¸º 2 ã€‚å¯ä»¥è¯æ˜ 2 æ˜¯æ‰€æœ‰å¯è¡Œæ–¹æ¡ˆä¸­çš„æœ€å¤§å€¼ã€‚</pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>numOnes = 3, numZeros = 2, numNegOnes = 0, k = 4<strong>è¾“å‡ºï¼š</strong>3<strong>è§£é‡Šï¼š</strong>è¢‹å­ä¸­çš„ç‰©å“åˆ†åˆ«æ ‡è®°ä¸º {1, 1, 1, 0, 0} ã€‚å– 3 ä»¶æ ‡è®°ä¸º 1 çš„ç‰©å“ï¼Œ1 ä»¶æ ‡è®°ä¸º 0 çš„ç‰©å“ï¼Œå¾—åˆ°çš„æ•°å­—ä¹‹å’Œä¸º 3 ã€‚å¯ä»¥è¯æ˜ 3 æ˜¯æ‰€æœ‰å¯è¡Œæ–¹æ¡ˆä¸­çš„æœ€å¤§å€¼ã€‚</pre><p>&nbsp;</p><p><strong>æç¤ºï¼š</strong></p><ul>    <li><code>0 &lt;= numOnes, numZeros, numNegOnes &lt;= 50</code></li>    <li><code>0 &lt;= k &lt;= numOnes + numZeros + numNegOnes</code></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">kItemsWithMaximumSum</span>(<span class="params">self, numOnes: <span class="built_in">int</span>, numZeros: <span class="built_in">int</span>, numNegOnes: <span class="built_in">int</span>, k: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> k &lt;= numOnes + numZeros:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">min</span>(k,numOnes)</span><br><span class="line">        <span class="keyword">return</span> numOnes - (k - numOnes - numZeros)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode-easy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯æ—¥ä¸€é¢˜ </tag>
            
            <tag> è´ªå¿ƒ </tag>
            
            <tag> LCå‘¨èµ›Q1 </tag>
            
            <tag> LeetCode1400 </tag>
            
            <tag> æ¨¡æ‹Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LC2761.å’Œç­‰äºç›®æ ‡å€¼çš„è´¨æ•°å¯¹</title>
      <link href="/post/LC2761.html"/>
      <url>/post/LC2761.html</url>
      
        <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªæ•´æ•° <code>n</code> ã€‚å¦‚æœä¸¤ä¸ªæ•´æ•° <code>x</code> å’Œ <code>y</code> æ»¡è¶³ä¸‹è¿°æ¡ä»¶ï¼Œåˆ™è®¤ä¸ºäºŒè€…å½¢æˆä¸€ä¸ªè´¨æ•°å¯¹ï¼š</p><ul>    <li><code>1 &lt;= x &lt;= y &lt;= n</code></li>    <li><code>x + y == n</code></li>    <li><code>x</code> å’Œ <code>y</code> éƒ½æ˜¯è´¨æ•°</li></ul><p>è¯·ä½ ä»¥äºŒç»´æœ‰åºåˆ—è¡¨çš„å½¢å¼è¿”å›ç¬¦åˆé¢˜ç›®è¦æ±‚çš„æ‰€æœ‰ <code>[x<sub>i</sub>, y<sub>i</sub>]</code> ï¼Œåˆ—è¡¨éœ€è¦æŒ‰ <code>x<sub>i</sub></code> çš„ <strong>éé€’å‡é¡ºåº</strong> æ’åºã€‚å¦‚æœä¸å­˜åœ¨ç¬¦åˆè¦æ±‚çš„è´¨æ•°å¯¹ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>è´¨æ•°æ˜¯å¤§äº <code>1</code> çš„è‡ªç„¶æ•°ï¼Œå¹¶ä¸”åªæœ‰ä¸¤ä¸ªå› å­ï¼Œå³å®ƒæœ¬èº«å’Œ <code>1</code> ã€‚</p><p>&nbsp;</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>n = 10<strong>è¾“å‡ºï¼š</strong>[[3,7],[5,5]]<strong>è§£é‡Šï¼š</strong>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå­˜åœ¨æ»¡è¶³æ¡ä»¶çš„ä¸¤ä¸ªè´¨æ•°å¯¹ã€‚ è¿™ä¸¤ä¸ªè´¨æ•°å¯¹åˆ†åˆ«æ˜¯ [3,7] å’Œ [5,5]ï¼ŒæŒ‰ç…§é¢˜é¢æè¿°ä¸­çš„æ–¹å¼æ’åºåè¿”å›ã€‚</pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>n = 2<strong>è¾“å‡ºï¼š</strong>[]<strong>è§£é‡Šï¼š</strong>å¯ä»¥è¯æ˜ä¸å­˜åœ¨å’Œä¸º 2 çš„è´¨æ•°å¯¹ï¼Œæ‰€ä»¥è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚ </pre><p>&nbsp;</p><p><strong>æç¤ºï¼š</strong></p><ul>    <li><code>1 &lt;= n &lt;= 10<sup>6</sup></code></li></ul><p>WAçš„åŸå› ï¼šéœ€è¦åœ¨ç±»å¤–è¿›è¡Œæ•°æ®çš„é¢„å¤„ç†</p><h2 id="æ¯”èµ›acä»£ç "><a href="#æ¯”èµ›acä»£ç " class="headerlink" title="æ¯”èµ›acä»£ç "></a>æ¯”èµ›acä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">findPrimePairs</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">            <span class="keyword">if</span> (x == <span class="number">2</span>) <span class="keyword">or</span> (x == <span class="number">3</span>):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> (x % <span class="number">6</span> != <span class="number">1</span>) <span class="keyword">and</span> (x % <span class="number">6</span> != <span class="number">5</span>):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>, <span class="built_in">int</span>(x ** <span class="number">0.5</span>) + <span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">                <span class="keyword">if</span> (x % i == <span class="number">0</span>) <span class="keyword">or</span> (x % (i + <span class="number">2</span>) == <span class="number">0</span>):</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># n = 3</span></span><br><span class="line">        <span class="comment"># se = set([i for i in range(2,n) if f(i)])</span></span><br><span class="line">        ans = []</span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,n):</span><br><span class="line">            r = n - l</span><br><span class="line">            <span class="keyword">if</span> l == <span class="number">2</span> <span class="keyword">or</span> ( l%<span class="number">2</span>==<span class="number">1</span> <span class="keyword">and</span> r%<span class="number">2</span>==<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> l &lt;= r  <span class="keyword">and</span> f(l) <span class="keyword">and</span> f(r):</span><br><span class="line">                    ans.append([l,r])</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure><h2 id="çµç¥ä»£ç "><a href="#çµç¥ä»£ç " class="headerlink" title="çµç¥ä»£ç "></a><a href="https://leetcode.cn/problems/prime-pairs-with-target-sum/solution/yu-chu-li-zhi-shu-mei-ju-by-endlesscheng-cq9b/">çµç¥ä»£ç </a></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¢„å¤„ç†</span></span><br><span class="line">MX = <span class="number">10</span> ** <span class="number">6</span> + <span class="number">1</span></span><br><span class="line">primes = []</span><br><span class="line">is_prime = [<span class="literal">True</span>] * MX</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, MX):</span><br><span class="line">    <span class="keyword">if</span> is_prime[i]:</span><br><span class="line">        primes.append(i)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i * i, MX, i):</span><br><span class="line">            is_prime[j] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">findPrimePairs</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">        <span class="keyword">if</span> n % <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> [[<span class="number">2</span>, n - <span class="number">2</span>]] <span class="keyword">if</span> n &gt; <span class="number">4</span> <span class="keyword">and</span> is_prime[n - <span class="number">2</span>] <span class="keyword">else</span> []</span><br><span class="line">        ans = []</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> primes:</span><br><span class="line">            y = n - x</span><br><span class="line">            <span class="keyword">if</span> y &lt; x:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> is_prime[y]:</span><br><span class="line">                ans.append([x, y])</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> LeetCode-medium </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LCå‘¨èµ›Q2 </tag>
            
            <tag> è´¨æ•° </tag>
            
            <tag> åŸƒæ°ç­› </tag>
            
            <tag> çº¿æ€§ç­› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LC2762.ä¸é—´æ–­å­æ•°ç»„</title>
      <link href="/post/LC2762.html"/>
      <url>/post/LC2762.html</url>
      
        <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» <strong>0</strong>&nbsp;å¼€å§‹çš„æ•´æ•°æ•°ç»„&nbsp;<code>nums</code>&nbsp;ã€‚<code>nums</code>&nbsp;çš„ä¸€ä¸ªå­æ•°ç»„å¦‚æœæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œé‚£ä¹ˆå®ƒæ˜¯ <strong>ä¸é—´æ–­</strong> çš„ï¼š</p><ul>    <li><code>i</code>ï¼Œ<code>i + 1</code>&nbsp;ï¼Œ...ï¼Œ<code>j</code><sub> </sub>&nbsp;è¡¨ç¤ºå­æ•°ç»„ä¸­çš„ä¸‹æ ‡ã€‚å¯¹äºæ‰€æœ‰æ»¡è¶³&nbsp;<code>i &lt;= i<sub>1</sub>, i<sub>2</sub> &lt;= j</code>&nbsp;çš„ä¸‹æ ‡å¯¹ï¼Œéƒ½æœ‰ <code>0 &lt;= |nums[i<sub>1</sub>] - nums[i<sub>2</sub>]| &lt;= 2</code>&nbsp;ã€‚</li></ul><p>è¯·ä½ è¿”å› <strong>ä¸é—´æ–­</strong> å­æ•°ç»„çš„æ€»æ•°ç›®ã€‚</p><p>å­æ•°ç»„æ˜¯ä¸€ä¸ªæ•°ç»„ä¸­ä¸€æ®µè¿ç»­ <strong>éç©º</strong>&nbsp;çš„å…ƒç´ åºåˆ—ã€‚</p><p>&nbsp;</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><b>è¾“å…¥ï¼š</b>nums = [5,4,2,4]<strong>è¾“å‡ºï¼š</strong>8<b>è§£é‡Šï¼š</b>å¤§å°ä¸º 1 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[5], [4], [2], [4] ã€‚å¤§å°ä¸º 2 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[5,4], [4,2], [2,4] ã€‚å¤§å°ä¸º 3 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[4,2,4] ã€‚æ²¡æœ‰å¤§å°ä¸º 4 çš„ä¸é—´æ–­å­æ•°ç»„ã€‚ä¸é—´æ–­å­æ•°ç»„çš„æ€»æ•°ç›®ä¸º 4 + 3 + 1 = 8 ã€‚é™¤äº†è¿™äº›ä»¥å¤–ï¼Œæ²¡æœ‰åˆ«çš„ä¸é—´æ–­å­æ•°ç»„ã€‚</pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><b>è¾“å…¥ï¼š</b>nums = [1,2,3]<b>è¾“å‡ºï¼š</b>6<b>è§£é‡Šï¼š</b>å¤§å°ä¸º 1 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[1], [2], [3] ã€‚å¤§å°ä¸º 2 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[1,2], [2,3] ã€‚å¤§å°ä¸º 3 çš„ä¸é—´æ–­å­æ•°ç»„ï¼š[1,2,3] ã€‚ä¸é—´æ–­å­æ•°ç»„çš„æ€»æ•°ç›®ä¸º 3 + 2 + 1 = 6 ã€‚</pre><p>&nbsp;</p><p><strong>æç¤ºï¼š</strong></p><ul>    <li><code>1 &lt;= nums.length &lt;= 10<sup>5</sup></code></li>    <li><code>1 &lt;= nums[i] &lt;= 10<sup>9</sup></code></li></ul><p>æ¯”èµ›æ²¡æœ‰ac</p><h2 id="çµç¥ä»£ç "><a href="#çµç¥ä»£ç " class="headerlink" title="çµç¥ä»£ç "></a><a href="https://leetcode.cn/problems/continuous-subarrays/solution/shuang-zhi-zhen-ping-heng-shu-ha-xi-biao-4frl/">çµç¥ä»£ç </a></h2><h3 id="æ€è·¯-æ»‘åŠ¨çª—å£"><a href="#æ€è·¯-æ»‘åŠ¨çª—å£" class="headerlink" title="æ€è·¯ æ»‘åŠ¨çª—å£"></a>æ€è·¯ æ»‘åŠ¨çª—å£</h3><p>å¤æ‚åº¦<br>æ—¶é—´å¤æ‚åº¦ O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-6-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-6-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>)<br>ç©ºé—´å¤æ‚åº¦ O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.131ex" height="1.507ex" role="img" focusable="false" viewbox="0 -666 500 666" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-3-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-3-TEX-N-31"/></g></g></g></g></svg></mjx-container>) </p><p>éš¾ç‚¹ï¼šç»´æŠ¤åŒºé—´çš„æœ€å€¼ï¼Œå®¹æ˜“è€ƒè™‘çº¿æ®µæ ‘ã€æ ‘çŠ¶æ•°ç»„è¿›è¡Œæ±‚è§£ï¼Œæ‰€ä»¥æ”¾å¼ƒäº†<br>åŒºé—´æœ€å€¼é€šè¿‡<code>hash</code>è¿›è¡Œç»´æŠ¤<br><code>left</code>æŒ‡é’ˆå›ºå®šï¼Œ<code>right</code>æŒ‡é’ˆå¾€å³æ‰©å±•ï¼Œ<code>right</code>æ¯æ‰©å±•ä¸€æ¬¡æ£€æŸ¥å½“å‰<code>hash</code>åŒºé—´æœ€å€¼æ˜¯å¦æ»¡è¶³è¦æ±‚ï¼Œå¦‚æœä¸æ»¡è¶³åˆ™<code>left++</code>ï¼Œè¿›è¡Œå¼¹å‡ºï¼Œç›´åˆ°æ»¡è¶³ä¸ºæ­¢<br>æ³¨ï¼šæœ¬é¢˜å·®å€¼ä¸ºå›ºå®šçš„2ï¼Œå¦‚æœæ˜¯å‚æ•°<code>k</code>ï¼Œåˆ™å¤æ‚åº¦ä¸ºO(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="4.673ex" height="1.595ex" role="img" focusable="false" viewbox="0 -694 2065.4 705" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-2-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-2-TEX-N-2217" d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z"/><path id="MJX-2-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-2-TEX-I-1D45B"/></g><g data-mml-node="mo" transform="translate(822.2,0)"><use data-c="2217" xlink:href="#MJX-2-TEX-N-2217"/></g><g data-mml-node="mi" transform="translate(1544.4,0)"><use data-c="1D458" xlink:href="#MJX-2-TEX-I-1D458"/></g></g></g></g></svg></mjx-container>)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">continuousSubarrays</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="comment">#æ»‘åŠ¨çª—å£</span></span><br><span class="line">        left = <span class="number">0</span></span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        d = Counter() <span class="comment"># hashè¿›è¡Œç»´æŠ¤åŒºé—´æœ€å€¼</span></span><br><span class="line">        <span class="keyword">for</span> right,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            d[x] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> <span class="built_in">max</span>(d) - <span class="built_in">min</span>(d) &gt; <span class="number">2</span>:</span><br><span class="line">                y = nums[left]</span><br><span class="line">                d[y] -= <span class="number">1</span>     <span class="comment"># è€ƒè™‘æ•°å€¼é‡å¤</span></span><br><span class="line">                <span class="keyword">if</span> d[y] == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">del</span> d[y]</span><br><span class="line">                left += <span class="number">1</span></span><br><span class="line">            ans += right - left + <span class="number">1</span> <span class="comment"># å½“å‰æ»‘åŠ¨çª—å£ä»¥rightä¸ºç»“å°¾çš„å­æ•°ç»„ä¸ªæ•°ï¼Œleftä¸ºæœ€è¿œçš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> LeetCode-medium </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LCå‘¨èµ›Q3 </tag>
            
            <tag> å­æ•°ç»„ </tag>
            
            <tag> æ»‘åŠ¨çª—å£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LC2763. æ‰€æœ‰å­æ•°ç»„ä¸­ä¸å¹³è¡¡æ•°å­—ä¹‹å’Œ</title>
      <link href="/post/LC2763.html"/>
      <url>/post/LC2763.html</url>
      
        <content type="html"><![CDATA[<p>ä¸€ä¸ªé•¿åº¦ä¸º <code>n</code>&nbsp;ä¸‹æ ‡ä» <strong>0</strong>&nbsp;å¼€å§‹çš„æ•´æ•°æ•°ç»„ <code>arr</code>&nbsp;çš„ <strong>ä¸å¹³è¡¡æ•°å­—</strong>&nbsp;å®šä¹‰ä¸ºï¼Œåœ¨&nbsp;<code>sarr = sorted(arr)</code>&nbsp;æ•°ç»„ä¸­ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„ä¸‹æ ‡æ•°ç›®ï¼š</p><ul>    <li><code>0 &lt;= i &lt; n - 1</code>&nbsp;ï¼Œå’Œ</li>    <li><code>sarr[i+1] - sarr[i] &gt; 1</code></li></ul><p>è¿™é‡Œï¼Œ<code>sorted(arr)</code>&nbsp;è¡¨ç¤ºå°†æ•°ç»„ <code>arr</code>&nbsp;æ’åºåå¾—åˆ°çš„æ•°ç»„ã€‚</p><p>ç»™ä½ ä¸€ä¸ªä¸‹æ ‡ä» <strong>0</strong>&nbsp;å¼€å§‹çš„æ•´æ•°æ•°ç»„&nbsp;<code>nums</code>&nbsp;ï¼Œè¯·ä½ è¿”å›å®ƒæ‰€æœ‰&nbsp;<strong>å­æ•°ç»„</strong>&nbsp;çš„&nbsp;<strong>ä¸å¹³è¡¡æ•°å­—</strong>&nbsp;ä¹‹å’Œã€‚</p><p>å­æ•°ç»„æŒ‡çš„æ˜¯ä¸€ä¸ªæ•°ç»„ä¸­è¿ç»­ä¸€æ®µ <strong>éç©º</strong>&nbsp;çš„å…ƒç´ åºåˆ—ã€‚</p><p>&nbsp;</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><pre><strong>è¾“å…¥ï¼š</strong>nums = [2,3,1,4]<b>è¾“å‡ºï¼š</b>3<b>è§£é‡Šï¼š</b>æ€»å…±æœ‰ 3 ä¸ªå­æ•°ç»„æœ‰é 0 ä¸å¹³è¡¡æ•°å­—ï¼š- å­æ•°ç»„ [3, 1] ï¼Œä¸å¹³è¡¡æ•°å­—ä¸º 1 ã€‚- å­æ•°ç»„ [3, 1, 4] ï¼Œä¸å¹³è¡¡æ•°å­—ä¸º 1 ã€‚- å­æ•°ç»„ [1, 4] ï¼Œä¸å¹³è¡¡æ•°å­—ä¸º 1 ã€‚å…¶ä»–æ‰€æœ‰å­æ•°ç»„çš„ä¸å¹³è¡¡æ•°å­—éƒ½æ˜¯ 0 ï¼Œæ‰€ä»¥æ‰€æœ‰å­æ•°ç»„çš„ä¸å¹³è¡¡æ•°å­—ä¹‹å’Œä¸º 3 ã€‚</pre><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><pre><g>è¾“å…¥ï¼šnums = [1,3,3,3,5]<b>è¾“å‡ºï¼š</b>8<b>è§£é‡Šï¼š</b>æ€»å…±æœ‰ 7 ä¸ªå­æ•°ç»„æœ‰é 0 ä¸å¹³è¡¡æ•°å­—ï¼š- å­æ•°ç»„ [1, 3] ï¼Œä¸å¹³è¡¡æ•°å­—ä¸º 1 ã€‚- å­æ•°ç»„ [1, 3, 3] ï¼Œä¸å¹³è¡¡æ•°å­—ä¸º 1 ã€‚- å­æ•°ç»„ [1, 3, 3, 3] ï¼Œä¸å¹³è¡¡æ•°å­—ä¸º 1 ã€‚- å­æ•°ç»„ [1, 3, 3, 3, 5] ï¼Œä¸å¹³è¡¡æ•°å­—ä¸º 2 ã€‚- å­æ•°ç»„ [3, 3, 3, 5] ï¼Œä¸å¹³è¡¡æ•°å­—ä¸º 1 ã€‚- å­æ•°ç»„ [3, 3, 5] ï¼Œä¸å¹³è¡¡æ•°å­—ä¸º 1 ã€‚- å­æ•°ç»„ [3, 5] ï¼Œä¸å¹³è¡¡æ•°å­—ä¸º 1 ã€‚å…¶ä»–æ‰€æœ‰å­æ•°ç»„çš„ä¸å¹³è¡¡æ•°å­—éƒ½æ˜¯ 0 ï¼Œæ‰€ä»¥æ‰€æœ‰å­æ•°ç»„çš„ä¸å¹³è¡¡æ•°å­—ä¹‹å’Œä¸º 8 ã€‚</g></pre><p>&nbsp;</p><p><strong>æç¤ºï¼š</strong></p><ul>    <li><code>1 &lt;= nums.length &lt;= 1000</code></li>    <li><code>1 &lt;= nums[i] &lt;= nums.length</code></li></ul><h2 id="æ¯”èµ›acä»£ç "><a href="#æ¯”èµ›acä»£ç " class="headerlink" title="æ¯”èµ›acä»£ç "></a>æ¯”èµ›acä»£ç </h2><h3 id="å¤æ‚åº¦"><a href="#å¤æ‚åº¦" class="headerlink" title="å¤æ‚åº¦"></a>å¤æ‚åº¦</h3><p>æ—¶é—´å¤æ‚åº¦ O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="6.553ex" height="2.351ex" role="img" focusable="false" viewbox="0 -833.9 2896.6 1038.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-7-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-7-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/><path id="MJX-7-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"/><path id="MJX-7-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/><path id="MJX-7-TEX-I-1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-7-TEX-I-1D45B"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-7-TEX-N-32"/></g></g><g data-mml-node="mi" transform="translate(1036.6,0)"><use data-c="1D459" xlink:href="#MJX-7-TEX-I-1D459"/></g><g data-mml-node="mi" transform="translate(1334.6,0)"><use data-c="1D45C" xlink:href="#MJX-7-TEX-I-1D45C"/></g><g data-mml-node="mi" transform="translate(1819.6,0)"><use data-c="1D454" xlink:href="#MJX-7-TEX-I-1D454"/></g><g data-mml-node="mi" transform="translate(2296.6,0)"><use data-c="1D45B" xlink:href="#MJX-7-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>)<br>ç©ºé—´å¤æ‚åº¦ O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.345ex" height="1.912ex" role="img" focusable="false" viewbox="0 -833.9 1036.6 844.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-4-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-4-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-4-TEX-I-1D45B"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-4-TEX-N-32"/></g></g></g></g></g></svg></mjx-container>)<br>å¯ä»¥ä¼˜åŒ–ä¸º O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-3-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-3-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>) </p><h3 id="æ€è·¯åˆ†æ"><a href="#æ€è·¯åˆ†æ" class="headerlink" title="æ€è·¯åˆ†æ"></a>æ€è·¯åˆ†æ</h3><p>æ•°æ®é‡ä¸º<code>1000</code>ï¼Œæš´åŠ›O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.345ex" height="1.91ex" role="img" focusable="false" viewbox="0 -833.2 1036.6 844.2" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-1-TEX-N-33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><use data-c="33" xlink:href="#MJX-1-TEX-N-33"/></g></g></g></g></g></svg></mjx-container>)å¤§çº¦O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="3.25ex" height="2.005ex" role="img" focusable="false" viewbox="0 -864 1436.6 886" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/><path id="MJX-1-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"/><path id="MJX-1-TEX-N-39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-1-TEX-N-31"/><use data-c="30" xlink:href="#MJX-1-TEX-N-30" transform="translate(500,0)"/></g><g data-mml-node="mn" transform="translate(1033,393.1) scale(0.707)"><use data-c="39" xlink:href="#MJX-1-TEX-N-39"/></g></g></g></g></g></svg></mjx-container>)ï¼Œå¯ä»¥è€ƒè™‘å°†ç¬¬ä¸‰æ¬¡çš„å¾ªç¯æ”¹ä¸º<code>bisect_left</code>ï¼Œé™ä½å¤æ‚åº¦O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="6.553ex" height="2.351ex" role="img" focusable="false" viewbox="0 -833.9 2896.6 1038.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-1-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/><path id="MJX-1-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"/><path id="MJX-1-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"/><path id="MJX-1-TEX-I-1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"/></g></g><g data-mml-node="mi" transform="translate(1036.6,0)"><use data-c="1D459" xlink:href="#MJX-1-TEX-I-1D459"/></g><g data-mml-node="mi" transform="translate(1334.6,0)"><use data-c="1D45C" xlink:href="#MJX-1-TEX-I-1D45C"/></g><g data-mml-node="mi" transform="translate(1819.6,0)"><use data-c="1D454" xlink:href="#MJX-1-TEX-I-1D454"/></g><g data-mml-node="mi" transform="translate(2296.6,0)"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>)<br>ç»´æŠ¤é€’å¢åŒºé—´<code>[L,R]</code>ï¼Œè¯¥åŒºé—´ä¸å¹³è¡¡æ•°å­—ä¹‹å’Œä¸º<code>cnt</code>ï¼Œåˆ™<code>[L,R+1]</code>åŒºé—´éœ€è¦åˆ¤æ–­<code>nums[R+1]</code>åœ¨é€’å¢æ•°ç»„çš„ä½ç½®ï¼Œ<br><code>idx = bisect.bisect_left(last,nums[R+1])</code><br>1ã€å¦‚æœå°äºé€’å¢åŒºé—´æœ€å°å€¼ä¸”å·®å€¼å¤§äº1ï¼Œåˆ™<code>cnt+=1</code><br>2ã€å¦‚æœå¤§äºé€’å¢åŒºé—´æœ€å¤§å€¼ä¸”å·®å€¼å¤§äº1ï¼Œåˆ™<code>cnt+=1</code><br>3ã€å¦‚æœåœ¨åŒºé—´å†…ï¼Œåˆ™åˆ¤æ–­<code>nums[R+1]</code>å’Œ<code>last[idx-1]</code>å’Œ<code>last[idx+1]</code>å·®å€¼å¤§å°<br><code>cnt += ((nums[R+1] - last[idx-1]) &gt; 1) + ((last[idx+1] - nums[R+1]) &gt; 1) - ((last[idx+1] - last[idx-1]) &gt; 1)</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sumImbalanceNumbers</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        n = <span class="built_in">len</span>(nums)</span><br><span class="line">        dp = [[<span class="number">0</span>]*n <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            last = []</span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(l+<span class="number">1</span>,n):</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> last:</span><br><span class="line">                    last = [<span class="built_in">min</span>(nums[l],nums[r]),<span class="built_in">max</span>(nums[l],nums[r])]</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">abs</span>(last[<span class="number">1</span>]-last[<span class="number">0</span>]) &gt; <span class="number">1</span>:</span><br><span class="line">                        dp[l][r]+=<span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    idx = bisect_left(last,nums[r])</span><br><span class="line">                    dp[l][r] = dp[l][r-<span class="number">1</span>]</span><br><span class="line">                    <span class="keyword">if</span> idx == <span class="number">0</span>:</span><br><span class="line">                        <span class="keyword">if</span> last[<span class="number">0</span>] - nums[r] &gt; <span class="number">1</span>:</span><br><span class="line">                            dp[l][r] += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">elif</span> idx == <span class="built_in">len</span>(last):</span><br><span class="line">                        <span class="keyword">if</span> nums[r] - last[-<span class="number">1</span>] &gt; <span class="number">1</span>:</span><br><span class="line">                            dp[l][r] += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">if</span> nums[r] - last[idx-<span class="number">1</span>] &gt; <span class="number">1</span>:</span><br><span class="line">                            dp[l][r] += <span class="number">1</span></span><br><span class="line">                        <span class="keyword">if</span> last[idx] - nums[r] &gt; <span class="number">1</span>:</span><br><span class="line">                            dp[l][r] += <span class="number">1</span></span><br><span class="line">                        <span class="keyword">if</span> last[idx] - last[idx-<span class="number">1</span>] &gt; <span class="number">1</span>:</span><br><span class="line">                            dp[l][r] -= <span class="number">1</span></span><br><span class="line">                    last.insert(idx,nums[r])</span><br><span class="line">        <span class="built_in">print</span>(dp)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(<span class="built_in">sum</span>(item) <span class="keyword">for</span> item <span class="keyword">in</span> dp)</span><br></pre></td></tr></table></figure></p><h2 id="çµç¥ä»£ç "><a href="#çµç¥ä»£ç " class="headerlink" title="çµç¥ä»£ç "></a><a href="https://leetcode.cn/problems/sum-of-imbalance-numbers-of-all-subarrays/solution/bao-li-mei-ju-pythonjavacgo-by-endlessch-2r7p/">çµç¥ä»£ç </a></h2><h3 id="æ€è·¯1"><a href="#æ€è·¯1" class="headerlink" title="æ€è·¯1"></a>æ€è·¯1</h3><p>å¤æ‚åº¦<br>æ—¶é—´å¤æ‚åº¦ O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.345ex" height="1.912ex" role="img" focusable="false" viewbox="0 -833.9 1036.6 844.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/><path id="MJX-1-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"/></g><g data-mml-node="mn" transform="translate(633,363) scale(0.707)"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"/></g></g></g></g></g></svg></mjx-container>)<br>ç©ºé—´å¤æ‚åº¦ O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>)<br>å°†é€’å¢æ•°ç»„é€šè¿‡<code>hash</code>è¿›è¡Œè¡¨ç¤ºï¼Œå¯¹äº<code>y = nums[r]</code>ï¼Œè€ƒè™‘<code>vis[y-1],vis[y],vis[y+1]</code>æ˜¯å¦å‡ºç°è¿‡<code>vis</code>æ•°ç»„ä¸­<br>1ã€å¦‚æœ<code>vis[y]</code>è®¿é—®è¿‡ï¼Œåˆ™ä¸å½±å“å†²çªæ•°é‡ï¼Œ<code>cnt = cnt</code><br>1ã€å¦‚æœ<code>vis[y-1]</code>è®¿é—®è¿‡ï¼Œ<code>cnt = 1 - vis[y-1]</code> # é»˜è®¤<code>vis[y]</code>æ²¡è®¿é—®è¿‡+1<br>2ã€å¦‚æœ<code>vis[y+1]</code>è®¿é—®è¿‡ï¼Œ<code>cnt = 1 - vis[y+1]</code><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sumImbalanceNumbers</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        n = <span class="built_in">len</span>(nums)</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> l,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            vis = [<span class="literal">False</span>]*(n+<span class="number">2</span>)</span><br><span class="line">            vis[x] = <span class="literal">True</span></span><br><span class="line">            cnt = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(l+<span class="number">1</span>,n):</span><br><span class="line">                y = nums[r]</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> vis[y]:</span><br><span class="line">                    cnt += <span class="number">1</span> - vis[y-<span class="number">1</span>] - vis[y+<span class="number">1</span>]</span><br><span class="line">                    vis[y] = <span class="literal">True</span></span><br><span class="line">                ans+=cnt</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure></p><h4 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h4><p>é‡å¤å¯¹<code>vis</code>æ•°ç»„è¿›è¡Œèµ‹å€¼ï¼Œå¯ä»¥è¿›è¡Œä¼˜åŒ–<code>vis</code>æ•°ç»„ï¼Œ<code>vis</code>æ•°ç»„è®°å½•åŒºé—´å¼€å§‹çš„<code>left</code>ä¸‹æ ‡<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sumImbalanceNumbers</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        n = <span class="built_in">len</span>(nums)</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        vis = [n]*(n+<span class="number">2</span>)  <span class="comment"># åˆå§‹èµ‹å€¼éœ€è¦è¿›è¡Œä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">for</span> l,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            vis[x] = l   <span class="comment"># æ­¤å¤„è®°å½•leftä¸‹æ ‡</span></span><br><span class="line">            cnt = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(l+<span class="number">1</span>,n):</span><br><span class="line">                y = nums[r]</span><br><span class="line">                <span class="keyword">if</span> vis[y]!=l: <span class="comment"># ä»¥leftå¼€å§‹å½“å‰yå€¼å¹¶æœªè®¿é—®è¿‡</span></span><br><span class="line">                    cnt += <span class="number">1</span> - (vis[y-<span class="number">1</span>] == l) - (vis[y+<span class="number">1</span>]==l)</span><br><span class="line">                    vis[y] = l <span class="comment"># æ›´æ–°yå€¼ä»¥leftå¼€å§‹è®¿é—®è¿‡</span></span><br><span class="line">                ans+=cnt</span><br></pre></td></tr></table></figure></p><h3 id="æ€è·¯2"><a href="#æ€è·¯2" class="headerlink" title="æ€è·¯2"></a>æ€è·¯2</h3><p>å¤æ‚åº¦<br>æ—¶é—´å¤æ‚åº¦ O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>)<br>ç©ºé—´å¤æ‚åº¦ O(<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"/></g></g></g></g></svg></mjx-container>)<br>å¾…å®š</p>]]></content>
      
      
      <categories>
          
          <category> LeetCode-hard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å­æ•°ç»„ </tag>
            
            <tag> æ»‘åŠ¨çª—å£ </tag>
            
            <tag> LCå‘¨èµ›Q4 </tag>
            
            <tag> è´¡çŒ®æ³• </tag>
            
            <tag> äºŒç»´dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PyTorchåƒåœ¾å›æ”¶-torch_gcå‡½æ•°</title>
      <link href="/post/bd8452a8.html"/>
      <url>/post/bd8452a8.html</url>
      
        <content type="html"><![CDATA[<p><code>torch_gc()</code>æ˜¯<code>PyTorch</code>åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæ‰‹åŠ¨è§¦å‘åƒåœ¾å›æ”¶ï¼ˆ<code>Garbage Collection</code>ï¼‰ã€‚åƒåœ¾å›æ”¶æ˜¯ä¸€ç§è‡ªåŠ¨å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œç”¨äºé‡Šæ”¾ä¸å†ä½¿ç”¨çš„å†…å­˜ç©ºé—´ï¼Œä»¥æé«˜å†…å­˜åˆ©ç”¨ç‡ã€‚<br>åœ¨<code>PyTorch</code>ä¸­ï¼Œåƒåœ¾å›æ”¶ä¸»è¦ç”¨äºé‡Šæ”¾ä¸å†éœ€è¦çš„å¼ é‡ï¼ˆ<code>Tensors</code>ï¼‰å’Œè®¡ç®—å›¾ï¼ˆ<code>Computation Graph</code>ï¼‰çš„å†…å­˜ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œ<code>PyTorch</code>ä¼šè‡ªåŠ¨è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‰‹åŠ¨è§¦å‘åƒåœ¾å›æ”¶å¯ä»¥æ›´åŠæ—¶åœ°é‡Šæ”¾å†…å­˜ï¼Œä»è€Œé¿å…å†…å­˜å ç”¨è¿‡é«˜çš„é—®é¢˜ã€‚<br><code>torch_gc()</code>å‡½æ•°çš„è°ƒç”¨ä¼šç«‹å³è§¦å‘åƒåœ¾å›æ”¶ï¼Œé‡Šæ”¾ä¸å†éœ€è¦çš„å†…å­˜ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¢‘ç¹åœ°æ‰‹åŠ¨è§¦å‘åƒåœ¾å›æ”¶å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œå› ä¸ºåƒåœ¾å›æ”¶æœ¬èº«ä¹Ÿéœ€è¦ä¸€å®šçš„è®¡ç®—èµ„æºã€‚å› æ­¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå»ºè®®ä½¿ç”¨é»˜è®¤çš„è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶ã€‚åªæœ‰åœ¨ç¡®å®éœ€è¦é‡Šæ”¾å¤§é‡å†…å­˜çš„æƒ…å†µä¸‹ï¼Œæ‰è€ƒè™‘æ‰‹åŠ¨è§¦å‘åƒåœ¾å›æ”¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> troch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> troch </tag>
            
            <tag> åƒåœ¾å›æ”¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>001 é˜¿é‡Œäº‘æ­å»ºlangchain-ChatGLMçŸ¥è¯†åº“é—®ç­”-ç¯å¢ƒæ­å»º</title>
      <link href="/post/nlp001.html"/>
      <url>/post/nlp001.html</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡è½¬è½½äºï¼š<a href="https://developer.aliyun.com/article/1228342">AIGCï¼šåœ¨äº‘ä¸Šä»0å¼€å§‹æ­å»ºlangchain-ChatGLMï¼Œæ„å»ºç§åŸŸçŸ¥è¯†é—®ç­”æœºå™¨äººDEMO</a><br>æ ¹æ®å®è·µè¿‡ç¨‹è¿›è¡Œéƒ¨åˆ†ä¿®æ”¹</p><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>AIGCçŸ­æ¿ï¼šçŸ¥è¯†èŒ§æˆ¿ï¼ˆç¼ºå°‘è¡Œä¸šé¢†åŸŸçš„ç§åŸŸæ•°æ®ï¼Œä¸“æœ‰é—®é¢˜è§£ç­”æ•ˆæœå·®ï¼›æ•°æ®æ—¶æ•ˆæ€§ç¼ºé™·ï¼Œå¯¹å®æ—¶è¦æ±‚é«˜çš„é—®é¢˜æ•ˆæœå·®ï¼‰ã€‚<br>è§£æ³•ä¹‹ä¸€ï¼šç§åŸŸæ•°æ®Embedding +å‘é‡æ•°æ®åº“ï¼ˆè¯­ä¹‰æ£€ç´¢â€”-å‘é‡ç›¸ä¼¼åº¦åŒ¹é…ï¼‰ã€‚å°†é—®é¢˜å‘é‡åŒ–ï¼Œç»“åˆç§åŸŸçŸ¥è¯†åº“ä¸­åŒ¹é…åˆ°çš„â€œç²¾ç¡®â€å†…å®¹ï¼Œç”Ÿæˆé«˜è´¨é‡promptï¼Œå†ç»“åˆLLMçš„æ—¢æœ‰çŸ¥è¯†ï¼Œä»¥åŠæ¦‚æ‹¬ã€æ¨ç†ã€æ‰©å±•ç­‰èƒ½åŠ›ï¼Œå¤§å¤§æå‡å›ç­”çš„å‡†ç¡®æ€§ã€‚è¿™ä¹Ÿæ˜¯langchain-ChatGLMçš„åŸºæœ¬åŸç†ï¼š<br><img src="/post/nlp001/1.png" class title="img"><br>æœ¬æ–‡ä»‹ç»äº†åœ¨é˜¿é‡Œäº‘ä¸Šä»0å¼€å§‹æ­å»ºlangchain-ChatGLMï¼Œæ„å»ºç§åŸŸçŸ¥è¯†é—®ç­”æœºå™¨äººDEMOã€‚å¯ç”¨äºæ—¥å¸¸å­¦ä¹ å’Œç ”ç©¶ï¼Œå‡å°‘ç¯å¢ƒæ­å»ºæ—¶è¸©å‘ã€‚</p><h2 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h2><p>ä»¥åœ¨CentOS  7.9 64ä½ 64ä½ç³»ç»Ÿæ­å»ºLLMç¯å¢ƒï¼Œå®‰è£…<a href="https://github.com/imClumsyPanda/langchain-ChatGLM?spm=a2c6h.12873639.article-detail.3.57f0fd88XubRds">ã€Šlangchain-ChatGLMã€‹</a>ä¸ºä¾‹ï¼š<br>æ³¨ï¼šCentosçš„å®‰è£…å’ŒUbuntuæœ‰åŒºåˆ«ï¼Œä¸æ˜¯aptè€Œæ˜¯yum</p><h3 id="1ã€-åˆ›å»ºGPUå®ä¾‹ï¼ˆæ˜¾å­˜8GBä»¥ä¸Šï¼Œç£ç›˜è‡³å°‘50Gï¼‰"><a href="#1ã€-åˆ›å»ºGPUå®ä¾‹ï¼ˆæ˜¾å­˜8GBä»¥ä¸Šï¼Œç£ç›˜è‡³å°‘50Gï¼‰" class="headerlink" title="1ã€ åˆ›å»ºGPUå®ä¾‹ï¼ˆæ˜¾å­˜8GBä»¥ä¸Šï¼Œç£ç›˜è‡³å°‘50Gï¼‰"></a>1ã€ åˆ›å»ºGPUå®ä¾‹ï¼ˆæ˜¾å­˜8GBä»¥ä¸Šï¼Œç£ç›˜è‡³å°‘50Gï¼‰</h3><p>æœ¬æ–‡é€‰æ‹©äº†å¸¦V100 GPUçš„ ecs.gn6e-c12g1.3xlargeå®ä¾‹ï¼Œåœ¨å®ä¾‹åˆ›å»ºæ—¶é€‰æ‹©å®‰è£…cuda 11.4ã€‚è®¾ç½®ç”¨æˆ·ååŠç™»å½•å¯†ç ã€‚<br>æ³¨ï¼šchatglm-6b 20G+ï¼Œtext2vec-large-chinese 2G+ ç³»ç»Ÿç›˜40G</p><h3 id="2ã€-è®¾ç½®å®‰å…¨ç»„é…ç½®"><a href="#2ã€-è®¾ç½®å®‰å…¨ç»„é…ç½®" class="headerlink" title="2ã€ è®¾ç½®å®‰å…¨ç»„é…ç½®"></a>2ã€ è®¾ç½®å®‰å…¨ç»„é…ç½®</h3><p>é…ç½®å‡ºæ–¹å‘ç«¯å£22ï¼Œå¹¶åœ¨æºIPä¸­åŠ å…¥æœ¬æœºIPã€‚<br>æ³¨ï¼šå¯ä»¥ä¸åŠ æœ¬æœºIPï¼Œè®¾ç½®å®‰å…¨ç»„å‡ºå£å³å¯ï¼Œpython webui.pyä¼šç”Ÿæˆå…¬ç½‘ipåœ°å€</p><h3 id="3ã€-sshåˆ°äº‘ECS"><a href="#3ã€-sshåˆ°äº‘ECS" class="headerlink" title="3ã€ sshåˆ°äº‘ECS"></a>3ã€ sshåˆ°äº‘ECS</h3><p>å¦‚æœæ˜¯rootç™»å½•ï¼Œç³»ç»Ÿä¼šæç¤ºæ­£åœ¨å®‰è£…CUDAï¼Œå¾…å®‰è£…å®Œæ¯•ï¼ŒæŸ¥çœ‹GPUè¯¦æƒ…ï¼ˆè‹¥å‘½ä»¤æ— æ³•æ­£å¸¸è¿è¡Œï¼Œåˆ™è¯´æ˜CUDAæ²¡å®‰è£…å¥½ï¼‰<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi</span><br></pre></td></tr></table></figure><br>æ³¨ï¼šnvidia-smiä¸­é—´æ²¡æœ‰ç©ºæ ¼<br>æœ¬æ–‡é‡‡ç”¨SecureCRT 8.3è¿æ¥ECSï¼Œç”±äºåŠ¨æ€ç”³è¯·GPUèµ„æºï¼Œå…¬ç½‘ipä¸€ç›´å˜åŠ¨ï¼Œéœ€è¦é‡æ–°ç»‘å®š<br>æ–°æœºå™¨éœ€è¦å¼€å¯sshæœåŠ¡(é»˜è®¤å¼€å¯çŠ¶æ€2023.06.30æµ‹)ï¼Œå‚è€ƒäº<a href="https://blog.csdn.net/qq_41906031/article/details/107158874">ä½¿ç”¨SecureCRTè¿œç¨‹è¿æ¥é˜¿é‡ŒæœåŠ¡å™¨</a><br>Aã€ä»¥Ubuntuä¸ºä¾‹ï¼ŒUbuntuå¼€å¯sshæœåŠ¡<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.å®‰è£…ssh-server</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install openssh-server</span><br><span class="line">ps -e | grep sshæ£€æµ‹shhæ˜¯å¦å¯åŠ¨</span><br><span class="line"><span class="comment">#2.å¯åŠ¨sshæœåŠ¡</span></span><br><span class="line">sudo /etc/init.d/ssh restart å¯åŠ¨sshæœåŠ¡</span><br><span class="line">service ssh statusæŸ¥çœ‹sshæœåŠ¡çŠ¶æ€</span><br><span class="line"><span class="comment"># service ssh start  å¯åŠ¨sshæœåŠ¡</span></span><br><span class="line"><span class="comment"># service ssh stopåœæ­¢sshæœåŠ¡</span></span><br></pre></td></tr></table></figure><br>Bã€ ä¿®æ”¹æœåŠ¡å™¨å†…ç½®æ–‡ä»¶<br>éœ€è¦æ›´æ”¹configæ–‡ä»¶<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config </span><br><span class="line">PasswordAuthentication no <span class="comment">#ä¿®æ”¹ </span></span><br><span class="line">PubkeyAuthentication <span class="built_in">yes</span>  <span class="comment">#ä¿®æ”¹ </span></span><br></pre></td></tr></table></figure><br>Cã€é‡å¯æœåŠ¡å™¨<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service sshd restart</span><br><span class="line">reboot</span><br></pre></td></tr></table></figure></p><h3 id="4ã€-åœ¨ECSä¸Šå®‰è£…ç›¸å…³è½¯ä»¶åŒ…"><a href="#4ã€-åœ¨ECSä¸Šå®‰è£…ç›¸å…³è½¯ä»¶åŒ…" class="headerlink" title="4ã€ åœ¨ECSä¸Šå®‰è£…ç›¸å…³è½¯ä»¶åŒ…"></a>4ã€ åœ¨ECSä¸Šå®‰è£…ç›¸å…³è½¯ä»¶åŒ…</h3><p>Aã€sudo yum-get update<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum-get update</span><br></pre></td></tr></table></figure><br>Bã€å®‰è£…gccç¼–è¯‘å™¨(å¯é€‰ï¼Œç³»ç»Ÿä¸­é€šå¸¸å·²æœ‰)(ä¸éœ€è¦)ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install build-essential</span><br></pre></td></tr></table></figure><br>Cã€å®‰è£…Pythonï¼Œä»¥3.8ä¸ºä¾‹(å¯é€‰ï¼Œç³»ç»Ÿä¸­é€šå¸¸å·²æœ‰)(ä¸éœ€è¦)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install python3.8</span><br></pre></td></tr></table></figure><br>Dã€å®‰è£…miniconda<br>ï¼ˆ1ï¼‰ä¸‹è½½å®‰è£…åŒ…ï¼šæ³¨æ„minicondaåŒ…éœ€é€‰æ‹©å¯¹åº”pythonç‰ˆæœ¬çš„åŒ…<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://repo.anaconda.com/miniconda/Miniconda3-py38_23.3.1-0-Linux-x86_64.sh</span><br></pre></td></tr></table></figure><br>ï¼ˆ2ï¼‰è¿è¡Œå®‰è£…è„šæœ¬ï¼Œå¹¶åˆå§‹åŒ–ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash Miniconda3-py38_23.3.1-0-Linux-x86_64.sh</span><br></pre></td></tr></table></figure><br>ï¼ˆ3ï¼‰ï¼ˆå¯åœ¨2ä¸­å®Œæˆï¼‰åˆå§‹åŒ–ç»ˆç«¯ Shellï¼Œä»¥ä¾¿è¿condaã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/miniconda3/bin/conda init</span><br></pre></td></tr></table></figure><br>ï¼ˆ4ï¼‰åˆå§‹åŒ–å®Œæˆåï¼Œè¿è¡Œbashå‘½ä»¤ï¼Œå³å¯è¿›å…¥condaç¯å¢ƒï¼šbash<br>ï¼ˆ5ï¼‰åˆ›å»ºâ¼€ä¸ªæ–°çš„ç¯å¢ƒï¼ˆå¯é€‰ï¼‰ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create --name py38 python=3.8 -y</span><br></pre></td></tr></table></figure><br>ï¼ˆ6ï¼‰æ¿€æ´»py38ç¯å¢ƒï¼ˆå¯é€‰ï¼‰ï¼š<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda activate py38</span><br></pre></td></tr></table></figure></p><h3 id="5ã€å®‰è£…git"><a href="#5ã€å®‰è£…git" class="headerlink" title="5ã€å®‰è£…git"></a>5ã€å®‰è£…git</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install git</span><br></pre></td></tr></table></figure><h3 id="6ã€ä¸‹è½½langchain-ChatGLMå¹¶å®‰è£…è½¯ä»¶ä¾èµ–"><a href="#6ã€ä¸‹è½½langchain-ChatGLMå¹¶å®‰è£…è½¯ä»¶ä¾èµ–" class="headerlink" title="6ã€ä¸‹è½½langchain-ChatGLMå¹¶å®‰è£…è½¯ä»¶ä¾èµ–"></a>6ã€ä¸‹è½½langchain-ChatGLMå¹¶å®‰è£…è½¯ä»¶ä¾èµ–</h3><p>git clone langchain-ChatGLM<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/imClumsyPanda/langchain-ChatGLM.git</span><br><span class="line"><span class="built_in">cd</span> langchain-ChatGLM &amp;&amp; pip install -r requirements.txt</span><br><span class="line">pip install fastapi uvicorn</span><br><span class="line">conda install nltk        <span class="comment"># langchainä¾èµ–çš„è¯­è¨€å·¥å…·åŒ…</span></span><br></pre></td></tr></table></figure></p><h3 id="7ã€æ¨¡å‹ä¸‹è½½"><a href="#7ã€æ¨¡å‹ä¸‹è½½" class="headerlink" title="7ã€æ¨¡å‹ä¸‹è½½"></a>7ã€æ¨¡å‹ä¸‹è½½</h3><p>å°†chatglm-6bæ¨¡å‹åŠEmbedding æ¨¡å‹ï¼Œä¸‹è½½åˆ°æœ¬åœ°ï¼ˆå¯ä»æœ¬åœ°åŠ è½½æ¨¡å‹ï¼‰ï¼šç›®å‰æ”¯æŒchatglm-6b-int4-qeã€chatglm-6b-int4ã€chatglm-6b-int8ã€chatglm-6bã€chatyuanã€mossã€‚æœ¬æ–‡ä»¥chatglm-6bä¸ºä¾‹ã€‚<br>æ³¨ï¼šæ¨¡å‹éœ€è¦å ç”¨æ•°åGç©ºé—´ï¼Œå¯å°†ECSå®ä¾‹çš„æœ¬åœ°ç›˜æ ¼å¼åŒ–åæŒ‚è½½ï¼Œå°†æ¨¡å‹å­˜æ”¾åœ¨æœ¬åœ°ç›˜ä¸Šã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install git-lfs <span class="comment">#å®‰è£…git-lfs</span></span><br><span class="line">git-lfs <span class="built_in">clone</span> https://huggingface.co/THUDM/chatglm-6b</span><br></pre></td></tr></table></figure><br>ä¸‹è½½ Embedding æ¨¡å‹<br>ç›®å‰æ”¯æŒernie-tinyã€ernie-baseã€text2vec-baseã€text2vecï¼Œæœ¬æ–‡ä»¥text2vecä¸ºä¾‹ã€‚<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://huggingface.co/GanymedeNil/text2vec-large-chinese</span><br></pre></td></tr></table></figure><br>æ¨¡å‹æ›´æ–°<br>å¯æ‰“å¼€æ¨¡å‹æ‰€åœ¨æ–‡ä»¶å¤¹åæ‹‰å–æœ€æ–°æ¨¡å‹æ–‡ä»¶/ä»£ç <br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git lfs pull</span><br></pre></td></tr></table></figure></p><h3 id="8ã€æ›´æ–°æ¨¡å‹è·¯å¾„"><a href="#8ã€æ›´æ–°æ¨¡å‹è·¯å¾„" class="headerlink" title="8ã€æ›´æ–°æ¨¡å‹è·¯å¾„"></a>8ã€æ›´æ–°æ¨¡å‹è·¯å¾„</h3><p>config/model_config.pyä¸­çš„æ¨¡å‹è·¯å¾„ä¸ºæœ¬åœ°è·¯å¾„ã€‚<br>llm_model_dictå˜é‡ä¸­â€chatglm-6bâ€ï¼šâ€pretrained_model_nameâ€: â€œ./chatglm-6bâ€<br>embedding_model_dictå˜é‡ä¸­â€text2vecâ€ï¼šâ€text2vecâ€: â€œ./text2vec-large-chineseâ€</p><h3 id="9ã€å¯¼å…¥æ–‡æ¡£"><a href="#9ã€å¯¼å…¥æ–‡æ¡£" class="headerlink" title="9ã€å¯¼å…¥æ–‡æ¡£"></a>9ã€å¯¼å…¥æ–‡æ¡£</h3><p>ç›®å‰ä¸»è¦æ”¯æŒmdã€txtã€pdfã€jpgæ ¼å¼ã€‚</p><h3 id="10ã€è¿è¡ŒCLIæˆ–web-DEMOï¼š"><a href="#10ã€è¿è¡ŒCLIæˆ–web-DEMOï¼š" class="headerlink" title="10ã€è¿è¡ŒCLIæˆ–web DEMOï¼š"></a>10ã€è¿è¡ŒCLIæˆ–web DEMOï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python cli_demo.py</span><br></pre></td></tr></table></figure><p>webuiï¼šå¦‚éœ€è¦å…¬ç½‘è®¿é—®ï¼Œè¿˜éœ€è¦å°†webui.pyä¸­ä¿®æ”¹ï¼šshare=True<br>Aã€å®‰è£…gradio<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install gradio</span><br></pre></td></tr></table></figure><br>Bã€åœ¨ECSå®ä¾‹å®‰å…¨ç»„çš„å…¥æ–¹å‘æ·»åŠ å®‰å…¨ç»„è§„åˆ™ï¼Œå¹¶æ”¾è¡Œ8501ç«¯å£ï¼ˆé»˜è®¤å…¬ç½‘æœåŠ¡ç«¯å£ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼‰ã€‚<br>Cã€åœ¨ECSä¸Šè¿è¡Œè„šæœ¬<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python webui.py</span><br></pre></td></tr></table></figure><br>Dã€è„šæœ¬è¿è¡ŒæˆåŠŸåï¼Œä¼šå±•ç¤ºç”Ÿæˆçš„å…¬ç½‘é“¾æ¥ã€‚åœ¨æœ¬æœºæµè§ˆå™¨ä¸­è¾“å…¥è¯¥é“¾æ¥ï¼Œå°±å¯ä»¥ä½¿ç”¨äº†ã€‚<br>æ­¤å¤–ï¼Œå¦‚æœä¸æƒ³ä¿®æ”¹å®‰å…¨ç»„ç«¯å£ï¼Œä¹Ÿæ— éœ€å…¬ç½‘è®¿é—®ã€‚å¯ä»¥æŠŠæ¨¡å‹çš„æœ¬åœ°æœåŠ¡ç«¯å£7860ç›´æ¥æ˜ å°„åˆ°è‡ªå·±çš„æœ¬åœ°ä¾¿æºä¸Šï¼Œç™»å½•ä½¿ç”¨ï¼š<br>Aã€æœ¬åœ°ä¾¿æºæœºä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°†äº‘ECSçš„7860ç«¯å£æ˜ å°„åˆ°æœ¬åœ°ï¼ˆIPåŠç”¨æˆ·åå¡«å®é™…çš„ï¼‰ï¼š<br>ssh -L7860:localhost:7860 ecs-user@æœ¬åœ°ä¾¿æºIP<br>Bã€åœ¨æœ¬åœ°æµè§ˆå™¨ç™»å½•webç•Œé¢ï¼š<a href="http://127.0.0.1:7860">http://127.0.0.1:7860</a><br>ç›¸åŒçš„é—®é¢˜ï¼Œåœ¨æœªç»“åˆç§åŸŸæ•°æ®ä¸‹ï¼Œä½¿ç”¨ç›¸åŒChatGLMæ¨¡å‹å›ç­”å¦‚ä¸‹ï¼šä»å¯¹æ¯”å¯ä»¥çœ‹å‡ºï¼Œæ— ç§åŸŸæ•°æ®æƒ…å†µä¸‹çš„å›ç­”æœ‰æ˜æ˜¾çš„é”™è¯¯ã€‚è€Œç»“åˆç§åŸŸæ•°æ®åï¼Œç­”æ¡ˆå¾ˆå‡†ç¡®ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>1ã€<a href="https://developer.aliyun.com/article/1228342">é˜¿é‡Œäº‘:AIGCï¼šåœ¨äº‘ä¸Šä»0å¼€å§‹æ­å»ºlangchain-ChatGLMï¼Œæ„å»ºç§åŸŸçŸ¥è¯†é—®ç­”æœºå™¨äººDEMO</a><br>2ã€<a href="https://www.bilibili.com/video/BV1yT41187ki">Bilibili:20å…ƒæå®šï¼Œä¹°äº‘GPUè®­ç»ƒä¸€ä¸ªè‡ªå·±çš„GPT</a><br>3ã€<a href="heywhale.com/mw/project/6436d82948f7da1fee2be59e">Model Whale:ChatGLM-6B åœ¨ ModelWhale å¹³å°çš„éƒ¨ç½²ä¸å¾®è°ƒæ•™ç¨‹</a><br>4ã€<a href="https://blog.csdn.net/qq_41906031/article/details/107158874">CSDN:ä½¿ç”¨SecureCRTè¿œç¨‹è¿æ¥é˜¿é‡ŒæœåŠ¡å™¨</a><br>5ã€<a href="https://github.com/THUDM/ChatGLM-6B#readme">https://github.com/THUDM/ChatGLM-6B#readme</a><br>6ã€<a href="https://github.com/imClumsyPanda/langchain-ChatGLM">https://github.com/imClumsyPanda/langchain-ChatGLM</a><br>7ã€<a href="https://github.com/imClumsyPanda/langchain-ChatGLM/blob/master/docs/FAQ.md">https://github.com/imClumsyPanda/langchain-ChatGLM/blob/master/docs/FAQ.md</a></p>]]></content>
      
      
      <categories>
          
          <category> NLP </category>
          
          <category> LLM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> langchain </tag>
            
            <tag> Chatgpt </tag>
            
            <tag> Linux </tag>
            
            <tag> é˜¿é‡Œäº‘ </tag>
            
            <tag> text2vec </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ‹è¯•math jax</title>
      <link href="/post/441c7c2.html"/>
      <url>/post/441c7c2.html</url>
      
        <content type="html"><![CDATA[<p>è¿™æ˜¯<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.985ex;" xmlns="http://www.w3.org/2000/svg" width="4.653ex" height="2.942ex" role="img" focusable="false" viewbox="0 -864.9 2056.8 1300.3" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-2-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/><path id="MJX-2-TEX-I-1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"/><path id="MJX-2-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/><path id="MJX-2-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(851.6,394) scale(0.707)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"/></g><g data-mml-node="mrow" transform="translate(220,-377.4) scale(0.707)"><g data-mml-node="msup"><g data-mml-node="mi"><use data-c="1D465" xlink:href="#MJX-2-TEX-I-1D465"/></g><g data-mml-node="mn" transform="translate(605,289) scale(0.707)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"/></g></g><g data-mml-node="mo" transform="translate(1008.6,0)"><use data-c="2212" xlink:href="#MJX-2-TEX-N-2212"/></g><g data-mml-node="mn" transform="translate(1786.6,0)"><use data-c="31" xlink:href="#MJX-2-TEX-N-31"/></g></g><rect width="1816.8" height="60" x="120" y="220"/></g></g></g></svg></mjx-container>ä¾‹å­</p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/post/4a17b156.html"/>
      <url>/post/4a17b156.html</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Michealxie94</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><h3 id="Deploy-to-remote-sites-1"><a href="#Deploy-to-remote-sites-1" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> lru_cache</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://leetcode-cn.com/graphql&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†é¡µåŠ è½½æ’ååˆ—è¡¨</span></span><br><span class="line"><span class="meta">@lru_cache</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">loadPage</span>(<span class="params">page</span>):</span><br><span class="line">    query = <span class="string">&quot;&#123;\n  localRankingV2(page:&quot;</span> + <span class="built_in">str</span>(</span><br><span class="line">        page) + <span class="string">&quot;) &#123;\nmyRank &#123;\nattendedContestCount\ncurrentRatingRanking\ndataRegion\nisDeleted\n&quot;</span> \</span><br><span class="line">                <span class="string">&quot;user &#123;\nrealName\nuserAvatar\nuserSlug\n__typename\n&#125;\n__typename\n&#125;\npage\ntotalUsers\nuserPerPage\n&quot;</span> \</span><br><span class="line">                <span class="string">&quot;rankingNodes &#123;\nattendedContestCount\ncurrentRatingRanking\ndataRegion\nisDeleted\n&quot;</span> \</span><br><span class="line">                <span class="string">&quot;user &#123;\nrealName\nuserAvatar\nuserSlug\n__typename\n&#125;\n__typename\n&#125;\n__typename\n  &#125;\n&#125;\n&quot;</span></span><br><span class="line">    retry = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> retry &lt; <span class="number">3</span>:</span><br><span class="line">        resp = requests.post(url=url, json=&#123;<span class="string">&#x27;query&#x27;</span>: query&#125;)</span><br><span class="line">        <span class="keyword">if</span> resp.status_code == <span class="number">200</span>:</span><br><span class="line">            nodes = resp.json()[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;localRankingV2&#x27;</span>][<span class="string">&#x27;rankingNodes&#x27;</span>]</span><br><span class="line">            <span class="keyword">return</span> [(<span class="built_in">int</span>(nd[<span class="string">&#x27;currentRatingRanking&#x27;</span>]), nd[<span class="string">&#x27;user&#x27;</span>][<span class="string">&#x27;userSlug&#x27;</span>]) <span class="keyword">for</span> nd <span class="keyword">in</span> nodes]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            retry += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®ç”¨æˆ·åè·å–å…¶ä¸ªäººä¸»é¡µæ˜¾ç¤ºçš„çœŸå®åˆ†æ•°ï¼Œå› ä¸ºå››èˆäº”å…¥ä¼šå¯¼è‡´ä¸€éƒ¨åˆ† 1599.xxx çš„ç”¨æˆ·ä¹Ÿæ˜¾ç¤ºä¸º 1600 åˆ†</span></span><br><span class="line"><span class="meta">@lru_cache</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getUserRank</span>(<span class="params">uid</span>):</span><br><span class="line">    operationName = <span class="string">&quot;userContest&quot;</span></span><br><span class="line">    query = <span class="string">&quot;query userContest($userSlug: String!)&#123;\n userContestRanking(userSlug: $userSlug)&#123;&quot;</span> \</span><br><span class="line">            <span class="string">&quot;\ncurrentRatingRanking\nratingHistory\n&#125;\n&#125;\n &quot;</span></span><br><span class="line">    variables = &#123;<span class="string">&#x27;userSlug&#x27;</span>: uid&#125;</span><br><span class="line">    retry = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> retry &lt; <span class="number">3</span>:</span><br><span class="line">        resp = requests.post(url=url, json=&#123;</span><br><span class="line">            <span class="string">&#x27;operationName&#x27;</span>: operationName,</span><br><span class="line">            <span class="string">&#x27;query&#x27;</span>: query,</span><br><span class="line">            <span class="string">&#x27;variables&#x27;</span>: variables</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span> resp.status_code == <span class="number">200</span>:</span><br><span class="line">            ranking = resp.json()[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;userContestRanking&#x27;</span>]</span><br><span class="line">            score = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">if</span> ranking <span class="keyword">and</span> <span class="string">&#x27;ratingHistory&#x27;</span> <span class="keyword">in</span> ranking:</span><br><span class="line">                s = ranking[<span class="string">&#x27;ratingHistory&#x27;</span>]</span><br><span class="line">                mth = re.search(<span class="string">r&#x27;(\d+(?:\.\d+)?)(?:, null)*]$&#x27;</span>, s)</span><br><span class="line">                <span class="keyword">if</span> mth:</span><br><span class="line">                    score = mth.group(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> (ranking[<span class="string">&#x27;currentRatingRanking&#x27;</span>], <span class="built_in">float</span>(score)) <span class="keyword">if</span> score <span class="keyword">else</span> (<span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            retry += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨äºŒåˆ†çš„æ–¹å¼è·å–1600åˆ†ä»¥ä¸Šçš„äººæ•°ï¼Œå¹¶ä½¿ç”¨ getUserRank æ–¹æ³•æ ¡å‡†</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get1600Count</span>() -&gt; <span class="built_in">int</span>:</span><br><span class="line">    l, r = <span class="number">1</span>, <span class="number">3000</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l + r + <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">        page = loadPage(mid)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;ç¬¬ <span class="subst">&#123;mid&#125;</span> é¡µï¼š&#x27;</span>, page)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> page:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        score = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> _, uid <span class="keyword">in</span> page:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> uid:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            score = getUserRank(uid)[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> score <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> score &lt; <span class="number">1600</span>:</span><br><span class="line">            r = mid - <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l = mid</span><br><span class="line">    page = [uid <span class="keyword">for</span> _, uid <span class="keyword">in</span> loadPage(l) <span class="keyword">if</span> uid]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;æ ¡å‡†ä¸­...&#x27;</span>)</span><br><span class="line">    l, r = <span class="number">0</span>, <span class="built_in">len</span>(page) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> l &lt; r:</span><br><span class="line">        mid = (l + r + <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">        ranking, score = getUserRank(page[mid])</span><br><span class="line">        <span class="keyword">if</span> score &lt; <span class="number">1600</span>:</span><br><span class="line">            r = mid - <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> getUserRank(page[l])[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–æŒ‡å®šæ’åçš„ç”¨æˆ·, alter: æ›¿è¡¥æ–¹å‘ï¼Œå‘ä¸­é—´æ›¿è¡¥</span></span><br><span class="line"><span class="meta">@lru_cache</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getUser</span>(<span class="params">rank, alter</span>):</span><br><span class="line">    <span class="keyword">while</span> rank:</span><br><span class="line">        <span class="keyword">if</span> rank &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;æ— æ•ˆçš„æ’å&#x27;</span>)</span><br><span class="line">        p = (rank - <span class="number">1</span>) // <span class="number">25</span> + <span class="number">1</span></span><br><span class="line">        off = (rank - <span class="number">1</span>) % <span class="number">25</span></span><br><span class="line">        page = loadPage(p)</span><br><span class="line">        <span class="keyword">if</span> page[off][<span class="number">1</span>]:</span><br><span class="line">            ranking, score = getUserRank(page[off][<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">return</span> score, page[off][<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            rank += alter</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;--&#x27;</span>, <span class="string">&#x27;--&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">total = get1600Count()</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> total:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ç½‘ç»œæ•…éšœ&#x27;</span>)</span><br><span class="line">    sys.exit()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;1600 åˆ†ä»¥ä¸Šå…±è®¡ <span class="subst">&#123;total&#125;</span> äºº&#x27;</span>)</span><br><span class="line"></span><br><span class="line">guardian = <span class="built_in">int</span>(total * <span class="number">0.05</span>)</span><br><span class="line">knight = <span class="built_in">int</span>(total * <span class="number">0.25</span>)</span><br><span class="line">g_first, g_last = getUser(<span class="number">1</span>, <span class="number">1</span>), getUser(guardian, -<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Guardian(top 5%): å…± <span class="subst">&#123;guardian&#125;</span> åï¼Œå®ˆé—¨å‘˜ <span class="subst">&#123;g_last[<span class="number">0</span>]&#125;</span> åˆ†ï¼ˆuid: <span class="subst">&#123;g_last[<span class="number">1</span>]&#125;</span>ï¼‰ï¼Œæœ€é«˜ <span class="subst">&#123;g_first[<span class="number">0</span>]&#125;</span> åˆ†ï¼ˆuid: <span class="subst">&#123;g_first[<span class="number">1</span>]&#125;</span>ï¼‰&#x27;</span>)</span><br><span class="line">k_first, k_last = getUser(guardian + <span class="number">1</span>, <span class="number">1</span>), getUser(knight, -<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Knight(top 25%): å…± <span class="subst">&#123;knight&#125;</span> åï¼Œå®ˆé—¨å‘˜ <span class="subst">&#123;k_last[<span class="number">0</span>]&#125;</span> åˆ†ï¼ˆuid: <span class="subst">&#123;k_last[<span class="number">1</span>]&#125;</span>ï¼‰ï¼Œæœ€é«˜ <span class="subst">&#123;k_first[<span class="number">0</span>]&#125;</span> åˆ†ï¼ˆuid: <span class="subst">&#123;k_first[<span class="number">1</span>]&#125;</span>ï¼‰&#x27;</span>)</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title>å…³äºæˆ‘</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†ç±»</title>
      <link href="/categories/index.html"/>
      <url>/categories/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/css/custom.css"/>
      <url>/css/custom.css</url>
      
        <content type="html"><![CDATA[/* Twikoo è¯„è®ºæ ·å¼ */.tk-input .el-textarea__inner {    min-height: 120px !important;}#twikoo .OwO-body {    max-width: 100% !important;}#twikoo .OwO .OwO-body .OwO-items:nth-child(1),#twikoo .OwO .OwO-body .OwO-items:nth-child(4) {    max-height: 360px !important;}#twikoo .OwO-items li[title|=menhera] img {    width: 100% !important;    margin: 5px 10px;}.tk-comment .tk-owo-emotion[alt*=menhera] {    width: 300px !important;}.tk-comment .vemoji[alt|=menhera],.tk-comment .tk-owo-emotion[alt*=menhera] {    max-width: 300px !important;    max-height: 300px !important;    margin: 8px 1px;    display: block !important;}@media screen and (max-width: 768px) {    .tk-comment .vemoji[alt|=menhera], .tk-comment .tk-owo-emotion[alt*=menhera] {        max-width: calc(100% - 30px) !important;        max-height: calc(100% - 30px) !important;    }    .OwO .OwO-body .OwO-items-image .OwO-item[title*=menhera] {        max-width: calc(50% - 10px);        box-sizing: border-box;    }    }]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‡ç­¾</title>
      <link href="/tags/index.html"/>
      <url>/tags/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>å‹æƒ…é“¾æ¥</title>
      <link href="/link/index.html"/>
      <url>/link/index.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
